-- JavaScript Courses, Modules, and Lessons Export
-- Generated: 2026-01-03 11:00:38

SET FOREIGN_KEY_CHECKS=0;

-- ============================================
-- JavaScript Courses
-- ============================================

INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (2, NULL, 'JavaScript Programming', 'javascript-programming', 'Learn JavaScript from scratch. Master the fundamentals of web programming, DOM manipulation, modern ES6+ features, and build interactive web applications.', NULL, 'beginner', 'published', 2, '2025-12-30 18:25:44', '2025-12-30 18:25:44', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (10, 2, 'JavaScript Fundamentals', 'javascript-fundamentals', 'Learn the fundamentals of JavaScript programming. Master syntax, variables, data types, operators, control flow, functions, objects, and arrays.', NULL, 'beginner', 'published', 1, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (11, 2, 'Intermediate JavaScript', 'intermediate-javascript', 'Advance your JavaScript skills with ES6+ features, advanced functions, asynchronous JavaScript, iterators, generators, and modules.', NULL, 'intermediate', 'published', 2, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (12, 2, 'DOM Manipulation and Events', 'dom-manipulation-events', 'Master the Document Object Model (DOM), event handling, form validation, and creating interactive web pages.', NULL, 'intermediate', 'published', 3, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (13, 2, 'Browser APIs and Storage', 'browser-apis-storage', 'Learn browser storage (localStorage, sessionStorage, IndexedDB) and browser APIs for modern web development.', NULL, 'intermediate', 'published', 4, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (14, 2, 'Advanced JavaScript', 'advanced-javascript', 'Master advanced JavaScript concepts including functional programming, design patterns, error handling, debugging, and performance optimization.', NULL, 'advanced', 'published', 5, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (15, 2, 'Testing and Tools', 'javascript-testing-tools', 'Learn JavaScript testing frameworks, build tools, bundlers, code quality tools, and linting for professional development.', NULL, 'intermediate', 'published', 6, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (16, 2, 'Frontend Frameworks', 'frontend-frameworks', 'Explore modern frontend frameworks including React basics and advanced concepts, and Vue.js as an alternative framework.', NULL, 'intermediate', 'published', 7, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (17, 2, 'Node.js and Backend Development', 'nodejs-backend-development', 'Build backend applications with Node.js. Learn to create web servers, work with databases, and implement authentication.', NULL, 'intermediate', 'published', 8, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);
INSERT INTO `courses` (`id`, `parent_course_id`, `title`, `slug`, `description`, `image`, `difficulty`, `status`, `sort_order`, `created_at`, `updated_at`, `category_id`, `instructor_id`, `enrollment_type`, `is_free`, `is_self_paced`, `capacity`, `syllabus`, `tags`) VALUES (18, 2, 'Practical Projects', 'javascript-practical-projects', 'Build real-world JavaScript projects including interactive web applications, API integrations, and full-stack applications.', NULL, 'intermediate', 'published', 9, '2026-01-03 09:03:38', '2026-01-03 09:03:38', NULL, NULL, 'open', 1, 1, NULL, NULL, NULL);

-- ============================================
-- JavaScript Modules
-- ============================================

INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (41, 10, 'Getting Started with JavaScript', 'Learn the fundamentals of JavaScript programming and set up your development environment.', 1, '2026-01-03 09:04:11', '2026-01-03 09:04:11');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (42, 10, 'Operators and Expressions', 'Learn about arithmetic, comparison, logical, and assignment operators in JavaScript.', 2, '2026-01-03 09:11:26', '2026-01-03 09:11:26');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (43, 10, 'Control Flow', 'Learn about conditional statements, loops, and error handling in JavaScript.', 3, '2026-01-03 09:13:00', '2026-01-03 09:13:00');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (44, 10, 'Functions', 'Learn about function declarations, expressions, arrow functions, scope, hoisting, and advanced function concepts.', 4, '2026-01-03 09:31:17', '2026-01-03 09:31:17');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (45, 10, 'Objects and Arrays', 'Learn about objects, arrays, object methods, array methods, iteration, and advanced array operations.', 5, '2026-01-03 09:33:30', '2026-01-03 09:33:30');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (46, 10, 'Object-Oriented Programming', 'Learn object-oriented programming concepts in JavaScript including classes, objects, inheritance, prototypes, and encapsulation.', 6, '2026-01-03 09:36:30', '2026-01-03 09:36:30');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (47, 11, 'ES6+ Features', 'Learn modern JavaScript features including let, const, block scope, destructuring, template literals, and symbols.', 1, '2026-01-03 09:40:36', '2026-01-03 09:40:36');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (48, 11, 'Advanced Functions', 'Learn advanced function concepts including closures, IIFE, bind, call, apply, and function composition.', 2, '2026-01-03 09:46:18', '2026-01-03 09:46:18');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (49, 11, 'Asynchronous JavaScript', 'Learn asynchronous JavaScript concepts including callbacks, promises, async/await, and handling asynchronous operations.', 3, '2026-01-03 09:47:33', '2026-01-03 09:47:33');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (50, 11, 'Iterators and Generators', 'Learn about iterators, generators, and how to create custom iterable objects in JavaScript.', 4, '2026-01-03 09:48:39', '2026-01-03 09:48:39');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (51, 11, 'Modules', 'Learn about ES6 modules, CommonJS, module systems, and module bundlers in JavaScript.', 5, '2026-01-03 09:49:46', '2026-01-03 09:49:46');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (52, 11, 'Working with APIs', 'Learn how to make HTTP requests using Fetch API, Axios, and handle API responses and errors.', 6, '2026-01-03 09:51:41', '2026-01-03 09:51:41');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (53, 12, 'Document Object Model (DOM)', 'Learn about the DOM, DOM structure, accessing elements, manipulating the DOM, and DOM traversal.', 1, '2026-01-03 09:52:47', '2026-01-03 09:52:47');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (54, 12, 'Events', 'Learn about event handling, event types, event propagation, and advanced event patterns in JavaScript.', 2, '2026-01-03 09:53:34', '2026-01-03 09:53:34');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (55, 12, 'Forms and Validation', 'Learn how to work with forms, form elements, form validation, and input types in JavaScript.', 3, '2026-01-03 09:53:34', '2026-01-03 09:53:34');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (56, 13, 'Browser Storage', 'Learn about browser storage APIs including localStorage, sessionStorage, and IndexedDB.', 1, '2026-01-03 09:54:38', '2026-01-03 09:54:38');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (57, 13, 'Browser APIs', 'Learn about various browser APIs including Geolocation, Canvas, Web Audio, and other browser APIs.', 2, '2026-01-03 09:54:38', '2026-01-03 09:54:38');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (58, 14, 'Functional Programming', 'Learn functional programming concepts including pure functions, immutability, higher-order functions, and functional patterns.', 1, '2026-01-03 09:59:25', '2026-01-03 09:59:25');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (59, 14, 'Design Patterns', 'Learn common design patterns in JavaScript including creational, structural, and behavioral patterns.', 2, '2026-01-03 09:59:25', '2026-01-03 09:59:25');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (60, 14, 'Error Handling and Debugging', 'Learn advanced error handling techniques and debugging strategies for JavaScript applications.', 3, '2026-01-03 10:03:01', '2026-01-03 10:03:01');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (61, 14, 'Performance Optimization', 'Learn techniques for optimizing JavaScript code performance, memory management, and rendering optimization.', 4, '2026-01-03 10:03:01', '2026-01-03 10:03:01');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (62, 15, 'Testing', 'Learn JavaScript testing fundamentals, Jest framework, and testing best practices.', 1, '2026-01-03 10:04:29', '2026-01-03 10:04:29');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (63, 15, 'Build Tools and Bundlers', 'Learn about build tools, bundlers like Webpack, and code quality tools for JavaScript development.', 2, '2026-01-03 10:04:29', '2026-01-03 10:04:29');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (64, 15, 'Code Quality and Linting', 'Learn about code quality tools, ESLint, Prettier, and best practices for maintaining JavaScript code quality.', 3, '2026-01-03 10:07:13', '2026-01-03 10:07:13');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (65, 16, 'React Basics', 'Learn React fundamentals including components, JSX, props, state, and React hooks.', 1, '2026-01-03 10:07:13', '2026-01-03 10:07:13');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (66, 16, 'React Advanced', 'Learn advanced React concepts including hooks, routing, state management, and performance optimization.', 2, '2026-01-03 10:09:12', '2026-01-03 10:09:12');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (67, 16, 'Vue.js (Alternative Framework)', 'Learn Vue.js as an alternative frontend framework, including Vue components, directives, and Vue ecosystem.', 3, '2026-01-03 10:09:12', '2026-01-03 10:09:12');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (68, 17, 'Node.js Basics', 'Learn Node.js fundamentals including modules, file system operations, and Node.js runtime environment.', 1, '2026-01-03 10:13:14', '2026-01-03 10:13:14');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (69, 17, 'Building Web Servers', 'Learn to build web servers using Node.js, Express.js framework, routing, and middleware.', 2, '2026-01-03 10:13:14', '2026-01-03 10:13:14');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (70, 17, 'Databases and Authentication', 'Learn to work with databases (MongoDB, SQL) and implement authentication in Node.js applications.', 3, '2026-01-03 10:13:14', '2026-01-03 10:13:14');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (71, 18, 'Interactive Web Pages', 'Build interactive web pages with DOM manipulation, event handling, and local storage.', 1, '2026-01-03 10:32:02', '2026-01-03 10:32:02');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (72, 18, 'Frontend Applications', 'Build frontend applications with React, including React components, routing, and state management.', 2, '2026-01-03 10:35:57', '2026-01-03 10:35:57');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (73, 18, 'Full-Stack Applications', 'Build full-stack applications with React frontend and Node.js backend, including database integration and authentication.', 3, '2026-01-03 10:37:38', '2026-01-03 10:37:38');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (74, 18, 'Advanced Projects', 'Build advanced projects including real-time applications, WebSockets, and complex JavaScript applications.', 4, '2026-01-03 10:39:34', '2026-01-03 10:39:34');
INSERT INTO `modules` (`id`, `course_id`, `title`, `description`, `sort_order`, `created_at`, `updated_at`) VALUES (75, 18, 'Capstone Projects', 'Complete capstone projects to demonstrate mastery of JavaScript, full-stack development, and modern web application architecture.', 5, '2026-01-03 10:41:52', '2026-01-03 10:41:52');

-- ============================================
-- JavaScript Lessons
-- ============================================

INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (108, 41, 10, 'Introduction to JavaScript', 'introduction-to-javascript', '# Lesson 1.1: Introduction to JavaScript

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what JavaScript is and its key characteristics
- Explain the history and evolution of JavaScript
- Distinguish between JavaScript in the browser and Node.js
- Set up a development environment for JavaScript
- Use the browser console and DevTools
- Write and run your first JavaScript program

---

## What is JavaScript?

JavaScript is a high-level, interpreted programming language that is one of the core technologies of the World Wide Web, alongside HTML and CSS. Created by Brendan Eich in 1995, JavaScript has evolved from a simple scripting language for web pages into a powerful, versatile language used for both frontend and backend development.

### Key Characteristics of JavaScript

1. **Interpreted Language**: JavaScript code is executed directly by a JavaScript engine (like V8 in Chrome) without needing compilation. However, modern engines use Just-In-Time (JIT) compilation for performance.

2. **Dynamic Typing**: Variables don''t need explicit type declarations. JavaScript automatically determines the type based on the value assigned.

3. **Prototype-Based**: JavaScript uses prototypes for inheritance rather than traditional classes (though ES6 introduced class syntax).

4. **First-Class Functions**: Functions in JavaScript are treated as objects - they can be assigned to variables, passed as arguments, and returned from other functions.

5. **Event-Driven**: JavaScript is designed to respond to user interactions and browser events, making it ideal for interactive web applications.

6. **Single-Threaded with Asynchronous Capabilities**: JavaScript runs on a single thread but uses an event loop and callbacks to handle asynchronous operations.

7. **Cross-Platform**: JavaScript runs in browsers (client-side) and on servers (Node.js), making it truly universal.

### JavaScript''s Role in Web Development

JavaScript is one of the three core web technologies:

- **HTML**: Structure and content
- **CSS**: Styling and layout
- **JavaScript**: Behavior and interactivity

Together, they create modern, dynamic web experiences.

---

## JavaScript History and Evolution

### The Early Years (1995-2000)

**1995 - Birth of JavaScript**
- Created by Brendan Eich at Netscape in just 10 days
- Originally named "Mocha," then "LiveScript," finally "JavaScript"
- Designed to add interactivity to static HTML pages
- Released with Netscape Navigator 2.0

**1996 - Standardization**
- JavaScript was submitted to ECMA International for standardization
- Became ECMAScript (ES1) - the official standard
- Microsoft created JScript for Internet Explorer (similar but not identical)

**1997-1999 - ECMAScript 2 & 3**
- ES2 (1998): Minor updates
- ES3 (1999): Added regular expressions, better string handling, try/catch
- ES3 became the dominant version for over a decade

### The Dark Ages (2000-2009)

- Browser wars led to compatibility issues
- Different browsers implemented JavaScript differently
- Developers had to write browser-specific code
- jQuery emerged (2006) to solve cross-browser compatibility

### The Renaissance (2009-2015)

**2009 - Node.js**
- Ryan Dahl created Node.js, bringing JavaScript to the server
- Enabled JavaScript to run outside browsers
- Revolutionized backend development

**2015 - ECMAScript 6 (ES6/ES2015)**
- Major update after 6 years
- Introduced: classes, arrow functions, let/const, modules, promises, and more
- Modern JavaScript as we know it today

### Modern Era (2015-Present)

**Annual Releases**
- ES2016, ES2017, ES2018, ES2019, ES2020, ES2021, ES2022, ES2023, ES2024
- Regular updates with new features
- Async/await, optional chaining, nullish coalescing, and more

**Current State**
- JavaScript is the most popular programming language (GitHub, Stack Overflow)
- Used in web, mobile (React Native), desktop (Electron), IoT, and more
- Massive ecosystem with npm (largest package registry)

---

## JavaScript in the Browser vs Node.js

### Browser JavaScript (Client-Side)

JavaScript in the browser runs on the user''s computer and interacts with:

**Capabilities:**
- Manipulate the DOM (Document Object Model)
- Handle user events (clicks, keyboard input, etc.)
- Make HTTP requests (AJAX/Fetch)
- Store data locally (localStorage, sessionStorage)
- Access browser APIs (Geolocation, Camera, etc.)
- Create animations and visual effects

**Limitations:**
- Cannot access the file system (security)
- Cannot make direct network connections (same-origin policy)
- Limited by browser security sandbox

**Example Use Cases:**
- Interactive web pages
- Form validation
- Dynamic content updates
- Single Page Applications (SPAs)
- Games and animations

### Node.js (Server-Side)

Node.js allows JavaScript to run on servers and provides:

**Capabilities:**
- File system access
- Network operations
- Database connections
- Server-side logic
- API development
- Command-line tools

**Differences:**
- No DOM (no `document` or `window` objects)
- Different global objects (`global` instead of `window`)
- Can use CommonJS modules (`require`/`module.exports`)
- Access to system resources

**Example Use Cases:**
- Web servers (Express.js)
- REST APIs
- Real-time applications (WebSockets)
- Build tools and automation
- Desktop applications (Electron)

### Key Similarities

Both environments share:
- Core JavaScript language features
- Same syntax and data types
- Same control structures (if/else, loops, functions)
- Modern ES6+ features

---

## Setting Up Your Development Environment

### 1. **Web Browser**

Any modern browser works, but recommended:
- **Google Chrome** (Recommended) - Best DevTools
- **Mozilla Firefox** - Excellent developer tools
- **Microsoft Edge** - Good DevTools, Chromium-based
- **Safari** - Good for macOS/iOS testing

### 2. **Code Editor**

Choose a code editor that fits your needs:

**Visual Studio Code (VS Code)** (Highly Recommended)
- Free and open-source
- Excellent JavaScript support
- Built-in terminal
- Extensions available
- Download: [code.visualstudio.com](https://code.visualstudio.com/)

**Other Options:**
- **Sublime Text**: Lightweight and fast
- **Atom**: Open-source, customizable
- **WebStorm**: Full-featured IDE (paid)
- **Notepad++**: Simple text editor (Windows)

### 3. **Installing VS Code Extensions**

Recommended extensions for JavaScript:

1. **JavaScript (ES6) code snippets** - Code completion
2. **Prettier** - Code formatter
3. **ESLint** - Code linting
4. **Live Server** - Local development server
5. **JavaScript Debugger** - Built-in debugging

**How to Install:**
1. Open VS Code
2. Click Extensions icon (or `Ctrl+Shift+X` / `Cmd+Shift+X`)
3. Search for extension name
4. Click Install

### 4. **Node.js (Optional but Recommended)**

Node.js is useful even for frontend development (build tools, package managers).

**Installation:**

**Windows/macOS:**
1. Visit [nodejs.org](https://nodejs.org/)
2. Download LTS (Long Term Support) version
3. Run installer
4. Verify: Open terminal and type `node --version`

**Linux:**
```bash
# Ubuntu/Debian
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
sudo apt-get install -y nodejs

# Verify
node --version
npm --version
```

**Verify Installation:**
```bash
node --version    # Should show v20.x.x or similar
npm --version     # Should show 10.x.x or similar
```

### 5. **Project Structure**

Create a folder for your JavaScript projects:

```bash
# Create project folder
mkdir javascript-learning
cd javascript-learning

# Create your first file
touch index.html
touch script.js
```

---

## Browser Console and DevTools

The browser console is your best friend for learning JavaScript. It allows you to:
- Run JavaScript code immediately
- See errors and debug issues
- Inspect variables and objects
- Test code snippets

### Opening DevTools

**Chrome/Edge:**
- Press `F12`
- Or `Ctrl+Shift+I` (Windows/Linux)
- Or `Cmd+Option+I` (macOS)
- Or Right-click → Inspect

**Firefox:**
- Press `F12`
- Or `Ctrl+Shift+I` (Windows/Linux)
- Or `Cmd+Option+I` (macOS)

**Safari:**
- Enable Developer menu: Preferences → Advanced → "Show Develop menu"
- Then `Cmd+Option+I`

### Console Tab

The Console tab is where you''ll spend most of your time:

**Basic Usage:**
```javascript
// Type JavaScript code and press Enter
console.log("Hello, World!");

// Perform calculations
2 + 2;

// Create variables
let name = "JavaScript";
console.log(name);
```

### Console Methods

**console.log()** - General output
```javascript
console.log("Hello");
console.log(42);
console.log(true);
```

**console.error()** - Error messages
```javascript
console.error("Something went wrong!");
```

**console.warn()** - Warning messages
```javascript
console.warn("This is a warning");
```

**console.info()** - Informational messages
```javascript
console.info("This is information");
```

**console.table()** - Display data as table
```javascript
let users = [
  {name: "Alice", age: 25},
  {name: "Bob", age: 30}
];
console.table(users);
```

### Other DevTools Tabs

- **Elements**: Inspect HTML and CSS
- **Network**: Monitor network requests
- **Sources**: Debug JavaScript files
- **Application**: View storage, cookies, etc.
- **Performance**: Analyze performance

### Tips for Using Console

1. **Clear Console**: Type `clear()` or `Ctrl+L`
2. **Multi-line Code**: Press `Shift+Enter` for new line
3. **Command History**: Use up/down arrows
4. **Auto-completion**: Press `Tab` for suggestions

---

## Your First JavaScript Program

### Method 1: Browser Console (Quickest)

1. **Open Browser Console** (F12)
2. **Type in Console:**
   ```javascript
   console.log("Hello, World!");
   ```
3. **Press Enter**
4. **See Output:**
   ```
   Hello, World!
   ```

### Method 2: HTML File with Inline Script

1. **Create `index.html`:**
   ```html
   <!DOCTYPE html>
   <html lang="en">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>My First JavaScript</title>
   </head>
   <body>
       <h1>Hello, World!</h1>
       
       <script>
           console.log("Hello from JavaScript!");
           alert("Welcome to JavaScript!");
       </script>
   </body>
   </html>
   ```

2. **Open in Browser**: Double-click the file or right-click → Open with browser

3. **Check Console**: Open DevTools (F12) to see the console output

### Method 3: External JavaScript File (Recommended)

1. **Create `index.html`:**
   ```html
   <!DOCTYPE html>
   <html lang="en">
   <head>
       <meta charset="UTF-8">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <title>My First JavaScript</title>
   </head>
   <body>
       <h1>Hello, World!</h1>
       <p id="output"></p>
       
       <script src="script.js"></script>
   </body>
   </html>
   ```

2. **Create `script.js`:**
   ```javascript
   // My first JavaScript program
   console.log("Hello, World!");
   
   // Display message on page
   document.getElementById("output").textContent = "JavaScript is working!";
   
   // Alert message
   alert("Welcome to JavaScript!");
   ```

3. **Open `index.html` in browser**

### Method 4: Node.js (Command Line)

1. **Create `hello.js`:**
   ```javascript
   console.log("Hello, World!");
   ```

2. **Run in Terminal:**
   ```bash
   node hello.js
   ```

3. **Output:**
   ```
   Hello, World!
   ```

### Understanding the Code

Let''s break down the basic example:

```javascript
console.log("Hello, World!");
```

- `console` - A global object that provides access to the browser console
- `.log()` - A method that outputs messages to the console
- `"Hello, World!"` - A string (text) enclosed in quotation marks
- `;` - Semicolon (optional in JavaScript but recommended)

### Variations to Try

```javascript
// Simple message
console.log("Hello, World!");

// Multiple messages
console.log("Hello");
console.log("World");

// Numbers
console.log(42);
console.log(3.14);

// Calculations
console.log(2 + 2);
console.log(10 * 5);

// Variables
let message = "Hello, JavaScript!";
console.log(message);

// Multiple values
console.log("Name:", "Alice", "Age:", 25);
```

---

## Practice Exercise

### Exercise: Write and Run Your First Program

**Objective**: Create a JavaScript program that introduces yourself and demonstrates basic console usage.

**Instructions**:

1. Create a new HTML file called `introduction.html`

2. Create a JavaScript file called `introduction.js`

3. Write a program that:
   - Prints your name to the console
   - Prints your favorite programming language
   - Performs a simple calculation (your age in days: age × 365)
   - Displays a message on the webpage
   - Uses at least 3 different console methods

4. Open the HTML file in a browser

5. Check the console (F12) to see your output

**Example Solution**:

**introduction.html:**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduction</title>
</head>
<body>
    <h1>Welcome!</h1>
    <div id="info"></div>
    <script src="introduction.js"></script>
</body>
</html>
```

**introduction.js:**
```javascript
// Introduction Program
let name = "Your Name";
let age = 25;
let favoriteLanguage = "JavaScript";

// Console output
console.log("=== Introduction ===");
console.log("Name:", name);
console.log("Favorite Language:", favoriteLanguage);
console.log("Age:", age);
console.log("Age in days:", age * 365);

// Display on page
document.getElementById("info").innerHTML = `
    <p><strong>Name:</strong> ${name}</p>
    <p><strong>Age:</strong> ${age}</p>
    <p><strong>Favorite Language:</strong> ${favoriteLanguage}</p>
`;

// Warning
console.warn("This is my first JavaScript program!");

// Info
console.info("JavaScript is awesome!");
```

**Expected Output in Console:**
```
=== Introduction ===
Name: Your Name
Favorite Language: JavaScript
Age: 25
Age in days: 9125
⚠ This is my first JavaScript program!
ℹ JavaScript is awesome!
```

**Challenge (Optional)**:
- Add more information about yourself
- Use `console.table()` to display your information
- Create multiple variables and combine them
- Try different console methods

---

## Key Takeaways

1. **JavaScript** is a versatile programming language for web development
2. **History**: Created in 1995, evolved through ES6 (2015) to modern JavaScript
3. **Two Environments**: Browser (client-side) and Node.js (server-side)
4. **DevTools**: Essential for debugging and testing JavaScript
5. **console.log()**: Primary method for outputting information
6. **Three Ways to Run**: Browser console, HTML with script, or Node.js
7. **External Files**: Best practice is to use separate `.js` files

---

## Common Mistakes to Avoid

1. **Forgetting to Open Console**: Always check DevTools console for output
2. **Syntax Errors**: Missing quotes, parentheses, or brackets
3. **File Path Issues**: Make sure script file path is correct in HTML
4. **Not Saving Files**: Always save before refreshing browser
5. **Case Sensitivity**: JavaScript is case-sensitive (`console` not `Console`)

---

## Quiz: JavaScript Basics

Test your understanding with these questions:

1. **What is JavaScript?**
   - A) A coffee brand
   - B) A programming language for web development
   - C) A database system
   - D) An operating system

2. **When was JavaScript created?**
   - A) 1990
   - B) 1995
   - C) 2000
   - D) 2010

3. **What does console.log() do?**
   - A) Creates a new file
   - B) Displays output in the browser console
   - C) Performs calculations
   - D) Styles web pages

4. **Which of these is NOT a way to run JavaScript?**
   - A) Browser console
   - B) HTML file with script tag
   - C) Node.js
   - D) Python interpreter

5. **True or False: JavaScript can only run in browsers.**
   - A) True
   - B) False (Node.js allows server-side JavaScript)

6. **What key opens DevTools in most browsers?**
   - A) F1
   - B) F12
   - C) F5
   - D) Ctrl+S

7. **What is the file extension for JavaScript files?**
   - A) .java
   - B) .js
   - C) .javascript
   - D) .script

**Answers**:
1. B) A programming language for web development
2. B) 1995
3. B) Displays output in the browser console
4. D) Python interpreter
5. B) False (Node.js allows server-side JavaScript)
6. B) F12
7. B) .js

---

## Next Steps

Congratulations! You''ve completed your first JavaScript lesson. You now know:
- What JavaScript is and its history
- How JavaScript works in browsers vs Node.js
- How to set up a development environment
- How to use browser DevTools and console
- How to write and run your first JavaScript program

**What''s Next?**
- Lesson 1.2: JavaScript Syntax and Basics
- Practice writing more console programs
- Experiment with different console methods
- Explore DevTools features
- Try creating interactive web pages

---

## Additional Resources

- **MDN Web Docs**: [developer.mozilla.org/en-US/docs/Web/JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)
- **JavaScript.info**: [javascript.info](https://javascript.info/)
- **Node.js Documentation**: [nodejs.org/docs](https://nodejs.org/docs)
- **Chrome DevTools Guide**: [developer.chrome.com/docs/devtools](https://developer.chrome.com/docs/devtools)
- **JavaScript History**: [en.wikipedia.org/wiki/JavaScript](https://en.wikipedia.org/wiki/JavaScript)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:04:11', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what JavaScript is and its key characteristics
- Explain the history and evolution of JavaScript
- Distinguish between JavaScript in the browser and Node.js
- Set up a development environment for JavaScript
- Use the browser console and DevTools
- Write and run your first JavaScript program');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (109, 41, 10, 'JavaScript Syntax and Basics', 'javascript-syntax-and-basics', '# Lesson 1.2: JavaScript Syntax and Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand JavaScript syntax rules and conventions
- Distinguish between statements and expressions
- Know when semicolons are required vs optional
- Write single-line and multi-line comments
- Understand code blocks and basic scope concepts
- Write syntactically correct JavaScript code

---

## JavaScript Syntax Rules

Syntax is the set of rules that defines how JavaScript code must be written. Understanding syntax is crucial for writing valid, executable code.

### Basic Syntax Rules

1. **Case Sensitivity**: JavaScript is case-sensitive
   ```javascript
   let name = "Alice";
   let Name = "Bob";  // Different variable
   let NAME = "Charlie";  // Another different variable
   ```

2. **Whitespace**: Spaces and tabs are generally ignored (except in strings)
   ```javascript
   let x=5;      // Valid
   let x = 5;    // Also valid (more readable)
   let x  =  5;  // Also valid (spaces ignored)
   ```

3. **Line Breaks**: Generally ignored, but can affect code readability
   ```javascript
   let x = 5; let y = 10;  // Multiple statements on one line
   let x = 5;
   let y = 10;  // More readable
   ```

4. **Identifiers**: Names for variables, functions, etc.
   - Must start with letter, underscore (_), or dollar sign ($)
   - Can contain letters, digits, underscores, or dollar signs
   - Cannot be reserved words (if, for, function, etc.)
   ```javascript
   let name = "Alice";      // Valid
   let _private = "secret"; // Valid
   let $element = "div";    // Valid
   let 2name = "invalid";   // Invalid - starts with number
   let my-name = "invalid"; // Invalid - contains hyphen
   ```

5. **Reserved Words**: Cannot be used as identifiers
   ```javascript
   // These are reserved and cannot be used:
   // if, else, for, while, function, var, let, const, return, etc.
   let function = "invalid";  // Error!
   ```

---

## Statements and Expressions

Understanding the difference between statements and expressions is fundamental to JavaScript.

### Expressions

An **expression** is a piece of code that produces a value. Expressions can be evaluated to a single value.

**Examples of Expressions:**
```javascript
// Literal values
42
"Hello"
true

// Variables
name
x

// Operations
2 + 2
x * 5
name.length

// Function calls (that return values)
Math.max(1, 2, 3)
parseInt("42")
```

**Expression Evaluation:**
```javascript
// Each of these evaluates to a value
console.log(5);           // 5
console.log(2 + 3);       // 5
console.log("Hello");     // "Hello"
console.log(name);        // Value of name variable
```

### Statements

A **statement** is an instruction that performs an action. Statements don''t necessarily produce values, but they do something.

**Examples of Statements:**
```javascript
// Variable declaration
let x = 5;

// Conditional statement
if (x > 0) {
    console.log("Positive");
}

// Loop statement
for (let i = 0; i < 5; i++) {
    console.log(i);
}

// Function declaration
function greet() {
    console.log("Hello");
}
```

### Expression Statements

Some expressions can be used as statements:

```javascript
// Assignment expression used as statement
x = 5;

// Function call expression used as statement
console.log("Hello");

// Increment expression used as statement
x++;
```

### Key Differences

| Expressions | Statements |
|------------|-----------|
| Produce values | Perform actions |
| Can be used in other expressions | Standalone instructions |
| Examples: `2 + 2`, `name.length` | Examples: `let x = 5;`, `if (condition) {}` |

---

## Semicolons in JavaScript

Semicolons (`;`) in JavaScript are used to mark the end of statements. However, JavaScript has a feature called **Automatic Semicolon Insertion (ASI)** that can automatically add semicolons in many cases.

### When Semicolons Are Required

**1. Multiple Statements on One Line:**
```javascript
let x = 5; let y = 10;  // Semicolons required
```

**2. Before Certain Keywords:**
```javascript
// Without semicolon, this could cause issues
let x = 5
[1, 2, 3].forEach(console.log)  // Could be interpreted as x[1, 2, 3]

// With semicolon, it''s clear
let x = 5;
[1, 2, 3].forEach(console.log);
```

**3. Return Statements:**
```javascript
function getValue() {
    return  // ASI adds semicolon here, returns undefined!
        5;
}

// Correct:
function getValue() {
    return 5;  // Explicit semicolon
}
```

### When Semicolons Are Optional

**Single Statement on a Line:**
```javascript
let x = 5;  // Semicolon optional
let x = 5   // Also works (ASI adds it)
```

**After Block Statements:**
```javascript
if (x > 0) {
    console.log("Positive");
}  // No semicolon needed after blocks
```

### Best Practices

**Recommended: Always Use Semicolons**
- Makes code more explicit
- Prevents potential ASI bugs
- Consistent style
- Required in some cases anyway

```javascript
// Good practice
let name = "Alice";
let age = 25;
console.log(name, age);

// Also acceptable (but less explicit)
let name = "Alice"
let age = 25
console.log(name, age)
```

**Common Semicolon Mistakes:**
```javascript
// Missing semicolon can cause issues
let x = 5
let y = 10  // Works, but risky

// Better:
let x = 5;
let y = 10;
```

---

## Comments

Comments are notes in your code that are ignored by JavaScript. They help document your code and explain what it does.

### Single-Line Comments

Use `//` for single-line comments. Everything after `//` on that line is ignored.

```javascript
// This is a single-line comment
let x = 5;  // This comment explains the variable

// You can also comment out code
// let y = 10;
// console.log(y);
```

**Common Uses:**
```javascript
// Explain what the code does
let userName = "Alice";  // Store the user''s name

// Temporarily disable code
// console.log("Debug message");

// Add notes
// TODO: Add error handling here
// FIXME: This needs optimization
```

### Multi-Line Comments

Use `/* */` for multi-line comments. Everything between `/*` and `*/` is ignored.

```javascript
/* This is a multi-line comment
   It can span multiple lines
   Useful for longer explanations */

let x = 5;

/*
 * This is a common style for multi-line comments
 * Each line starts with an asterisk
 * Makes it more readable
 */
```

**Block Comments:**
```javascript
/* 
   Function: calculateTotal
   Description: Calculates the total price
   Parameters: price (number), tax (number)
   Returns: total (number)
*/
function calculateTotal(price, tax) {
    return price + (price * tax);
}
```

### When to Use Comments

**Good Uses:**
- Explain **why** code exists, not what it does
- Document complex algorithms
- Add TODO notes
- Explain non-obvious code
- Document function parameters and return values

**Avoid:**
- Stating the obvious
- Commenting out large blocks of code (use version control instead)
- Outdated comments that don''t match the code

**Examples:**

```javascript
// Good comment
// Calculate discount based on user''s membership level
let discount = membershipLevel * 0.1;

// Bad comment (too obvious)
// Set x to 5
let x = 5;

// Good comment (explains why)
// Use Math.floor to prevent floating-point precision issues
let result = Math.floor(price * 1.1);

// Good multi-line comment for complex logic
/*
 * This algorithm uses the Euclidean method to find
 * the greatest common divisor of two numbers.
 * Time complexity: O(log(min(a, b)))
 */
function gcd(a, b) {
    // Implementation here
}
```

### Commenting Out Code

Comments are useful for temporarily disabling code:

```javascript
// Old implementation
// function oldFunction() {
//     return "old";
// }

// New implementation
function newFunction() {
    return "new";
}
```

**Note**: For large blocks of code, consider using version control (Git) instead of commenting out.

---

## Code Blocks and Scope

### Code Blocks

A **code block** is a group of statements enclosed in curly braces `{}`. Code blocks define scope and are used with control structures.

**Basic Syntax:**
```javascript
{
    // This is a code block
    let x = 5;
    let y = 10;
    console.log(x + y);
}
```

### Blocks with Control Structures

**If Statement:**
```javascript
if (condition) {
    // Code block
    console.log("Condition is true");
}
```

**Function:**
```javascript
function greet() {
    // Code block
    console.log("Hello");
}
```

**Loop:**
```javascript
for (let i = 0; i < 5; i++) {
    // Code block
    console.log(i);
}
```

### Scope Basics

**Scope** determines where variables are accessible. JavaScript has different types of scope:

**Global Scope:**
```javascript
// Variables declared outside any block
let globalVar = "I''m global";

function myFunction() {
    console.log(globalVar);  // Can access globalVar
}
```

**Local/Function Scope:**
```javascript
function myFunction() {
    let localVar = "I''m local";
    console.log(localVar);  // Can access localVar
}

// console.log(localVar);  // Error! localVar is not accessible here
```

**Block Scope (with let/const):**
```javascript
if (true) {
    let blockVar = "I''m in a block";
    console.log(blockVar);  // Can access blockVar
}

// console.log(blockVar);  // Error! blockVar is not accessible here
```

### Scope Rules

1. **Variables declared with `var`** have function scope (or global if outside function)
2. **Variables declared with `let`/`const`** have block scope
3. **Inner scopes can access outer scopes**, but not vice versa

**Example:**
```javascript
let outer = "I''m outside";

function myFunction() {
    let middle = "I''m in the function";
    
    if (true) {
        let inner = "I''m in the block";
        
        console.log(outer);   // ✅ Can access outer
        console.log(middle);  // ✅ Can access middle
        console.log(inner);    // ✅ Can access inner
    }
    
    console.log(outer);   // ✅ Can access outer
    console.log(middle);  // ✅ Can access middle
    // console.log(inner);  // ❌ Error! inner is not accessible
}

// console.log(outer);   // ✅ Can access outer
// console.log(middle);  // ❌ Error! middle is not accessible
// console.log(inner);   // ❌ Error! inner is not accessible
```

### Nested Blocks

Blocks can be nested inside other blocks:

```javascript
{
    let level1 = "Level 1";
    
    {
        let level2 = "Level 2";
        
        {
            let level3 = "Level 3";
            console.log(level1);  // ✅ Can access all levels
            console.log(level2);  // ✅ Can access level2 and level3
            console.log(level3);  // ✅ Can access level3
        }
        
        console.log(level1);  // ✅ Can access level1 and level2
        console.log(level2);  // ✅ Can access level2
        // console.log(level3);  // ❌ Error! level3 not accessible
    }
    
    console.log(level1);  // ✅ Can access level1
    // console.log(level2);  // ❌ Error! level2 not accessible
    // console.log(level3);  // ❌ Error! level3 not accessible
}
```

---

## Syntax Best Practices

### 1. Consistent Formatting

```javascript
// Good: Consistent spacing
let name = "Alice";
let age = 25;
let city = "New York";

// Bad: Inconsistent spacing
let name="Alice";
let age= 25;
let city ="New York";
```

### 2. Meaningful Names

```javascript
// Good: Descriptive names
let userName = "Alice";
let userAge = 25;

// Bad: Unclear names
let n = "Alice";
let a = 25;
```

### 3. Proper Indentation

```javascript
// Good: Proper indentation
if (condition) {
    console.log("True");
    if (nested) {
        console.log("Nested");
    }
}

// Bad: No indentation
if (condition) {
console.log("True");
if (nested) {
console.log("Nested");
}
}
```

### 4. Use Semicolons

```javascript
// Good: Explicit semicolons
let x = 5;
let y = 10;

// Acceptable but less explicit
let x = 5
let y = 10
```

### 5. Comment Wisely

```javascript
// Good: Comments explain why
// Calculate tax using state-specific rate
let tax = price * stateTaxRate;

// Bad: Comment states the obvious
// Set tax to price times stateTaxRate
let tax = price * stateTaxRate;
```

---

## Practice Exercise

### Exercise: Practice Syntax

**Objective**: Write JavaScript code that demonstrates proper syntax, comments, and code blocks.

**Instructions**:

1. Create a file called `syntax-practice.js`

2. Write code that includes:
   - At least 5 variable declarations with proper syntax
   - Single-line comments explaining each variable
   - A multi-line comment describing what the program does
   - At least 2 code blocks (if statements or functions)
   - Proper use of semicolons
   - Proper indentation

3. Your code should demonstrate:
   - Different data types (strings, numbers, booleans)
   - Scope (global and local variables)
   - Code blocks with proper formatting

**Example Solution**:

```javascript
/*
 * Syntax Practice Program
 * This program demonstrates JavaScript syntax rules,
 * comments, code blocks, and scope.
 */

// Global variables
let userName = "Alice";
let userAge = 25;
let isActive = true;
let userScore = 95.5;
let userCity = "New York";

// Function with local scope
function displayUserInfo() {
    // Local variable
    let greeting = "Hello";
    
    // Code block with if statement
    if (isActive) {
        console.log(greeting + ", " + userName);
        console.log("Age: " + userAge);
        console.log("City: " + userCity);
        console.log("Score: " + userScore);
    }
}

// Another code block
if (userScore >= 90) {
    let grade = "A";
    console.log("Grade: " + grade);
}

// Call the function
displayUserInfo();
```

**Expected Output**:
```
Hello, Alice
Age: 25
City: New York
Score: 95.5
Grade: A
```

**Challenge (Optional)**:
- Add nested code blocks
- Use different comment styles
- Create variables in different scopes
- Add more complex expressions

---

## Common Syntax Errors

### 1. Missing Quotes

```javascript
// Error
let name = Alice;  // Alice is not defined

// Correct
let name = "Alice";
```

### 2. Mismatched Brackets

```javascript
// Error
if (condition) {
    console.log("Hello";
}

// Correct
if (condition) {
    console.log("Hello");
}
```

### 3. Reserved Words

```javascript
// Error
let function = "invalid";

// Correct
let myFunction = "valid";
```

### 4. Invalid Identifiers

```javascript
// Error
let 2name = "invalid";
let my-name = "invalid";

// Correct
let name2 = "valid";
let myName = "valid";
```

### 5. Missing Semicolons (in some cases)

```javascript
// Can cause issues
let x = 5
[1, 2, 3].forEach(console.log)  // Could be interpreted as x[1, 2, 3]

// Better
let x = 5;
[1, 2, 3].forEach(console.log);
```

---

## Key Takeaways

1. **Syntax Rules**: JavaScript is case-sensitive, uses specific naming rules
2. **Statements vs Expressions**: Statements perform actions, expressions produce values
3. **Semicolons**: Optional but recommended for clarity and to avoid ASI bugs
4. **Comments**: Use `//` for single-line, `/* */` for multi-line
5. **Code Blocks**: Defined with `{}`, create scope boundaries
6. **Scope**: Variables are accessible based on where they''re declared
7. **Best Practices**: Consistent formatting, meaningful names, proper indentation

---

## Quiz: Syntax Fundamentals

Test your understanding with these questions:

1. **JavaScript is case-sensitive. True or False?**
   - A) True
   - B) False

2. **Which of these is a valid identifier?**
   - A) `2name`
   - B) `my-name`
   - C) `_name`
   - D) `function`

3. **What does `console.log(2 + 2)` represent?**
   - A) A statement
   - B) An expression
   - C) Both statement and expression
   - D) Neither

4. **Semicolons in JavaScript are:**
   - A) Always required
   - B) Always optional
   - C) Optional but recommended
   - D) Never used

5. **Which comment style is for multi-line comments?**
   - A) `//`
   - B) `/* */`
   - C) `#`
   - D) `<!-- -->`

6. **Variables declared inside a code block with `let` are accessible:**
   - A) Globally
   - B) Only within that block
   - C) In parent blocks only
   - D) Everywhere

7. **What symbol is used to define code blocks?**
   - A) `[]`
   - B) `()`
   - C) `{}`
   - D) `<>`

**Answers**:
1. A) True
2. C) `_name`
3. C) Both statement and expression (it''s an expression used as a statement)
4. C) Optional but recommended
5. B) `/* */`
6. B) Only within that block
7. C) `{}`

---

## Next Steps

Congratulations! You''ve learned JavaScript syntax fundamentals. You now know:
- JavaScript syntax rules and conventions
- The difference between statements and expressions
- How to use semicolons properly
- How to write comments
- How code blocks and scope work

**What''s Next?**
- Lesson 1.3: Variables and Data Types
- Practice writing syntactically correct code
- Experiment with different code block structures
- Explore scope with nested blocks

---

## Additional Resources

- **MDN: JavaScript Syntax**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types)
- **JavaScript.info: Code Quality**: [javascript.info/code-quality](https://javascript.info/code-quality)
- **Airbnb JavaScript Style Guide**: [github.com/airbnb/javascript](https://github.com/airbnb/javascript)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:06:44', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand JavaScript syntax rules and conventions
- Distinguish between statements and expressions
- Know when semicolons are required vs optional
- Write single-line and multi-line comments
- Understand code blocks and basic scope concepts
- Write syntactically correct JavaScript code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (110, 41, 10, 'Variables and Data Types', 'variables-and-data-types', '# Lesson 1.3: Variables and Data Types

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the three ways to declare variables (var, let, const)
- Know the differences between var, let, and const
- Identify all JavaScript primitive data types
- Understand type coercion and conversion
- Use the typeof operator to check data types
- Work with different data types in your code

---

## Variable Declarations

Variables are containers that store data values. In JavaScript, you can declare variables using three keywords: `var`, `let`, and `const`.

### var (Legacy - Avoid in Modern Code)

`var` was the original way to declare variables in JavaScript. It has function scope and some quirks.

```javascript
var name = "Alice";
var age = 25;
var isActive = true;
```

**Characteristics of var:**
- Function-scoped (not block-scoped)
- Can be redeclared
- Can be reassigned
- Hoisted (moved to top of scope)
- **Recommendation**: Avoid using `var` in modern JavaScript

**Example:**
```javascript
if (true) {
    var x = 5;
}
console.log(x);  // 5 - accessible outside block (function scope)
```

### let (Modern - Use for Variables That Change)

`let` was introduced in ES6 (2015) and is the modern way to declare variables that will be reassigned.

```javascript
let name = "Alice";
let age = 25;
let isActive = true;
```

**Characteristics of let:**
- Block-scoped
- Cannot be redeclared in the same scope
- Can be reassigned
- Not hoisted (temporal dead zone)
- **Use when**: Value will change

**Example:**
```javascript
let count = 0;
count = 1;      // ✅ Can reassign
count = 2;      // ✅ Can reassign

if (true) {
    let y = 10;
}
// console.log(y);  // ❌ Error - not accessible outside block
```

### const (Modern - Use for Constants)

`const` was also introduced in ES6. It creates constants that cannot be reassigned.

```javascript
const PI = 3.14159;
const MAX_SIZE = 100;
const API_URL = "https://api.example.com";
```

**Characteristics of const:**
- Block-scoped
- Cannot be redeclared
- Cannot be reassigned
- Must be initialized when declared
- Not hoisted (temporal dead zone)
- **Use when**: Value should not change

**Example:**
```javascript
const name = "Alice";
// name = "Bob";  // ❌ Error - cannot reassign

const numbers = [1, 2, 3];
numbers.push(4);  // ✅ Can modify array contents (not reassigning)
// numbers = [5, 6, 7];  // ❌ Error - cannot reassign
```

### When to Use Each

**Use `const` by default:**
```javascript
const userName = "Alice";
const userAge = 25;
const isLoggedIn = true;
```

**Use `let` when you need to reassign:**
```javascript
let counter = 0;
counter++;  // Need to change value

let currentUser = null;
currentUser = getUser();  // Will be assigned later
```

**Avoid `var` (legacy code only):**
```javascript
// Old style (avoid)
var oldStyle = "don''t use";

// Modern style
const modernStyle = "use this";
let changeableValue = "or this";
```

### Variable Naming Rules

1. **Must start with**: letter, underscore (_), or dollar sign ($)
2. **Can contain**: letters, digits, underscores, dollar signs
3. **Cannot be**: reserved words (if, for, function, etc.)
4. **Case-sensitive**: `name` and `Name` are different

**Good Names:**
```javascript
let userName = "Alice";
let user_age = 25;
let $element = document.getElementById("id");
let _private = "internal";
```

**Bad Names:**
```javascript
let 2name = "invalid";      // Starts with number
let my-name = "invalid";    // Contains hyphen
let let = "invalid";        // Reserved word
```

### Naming Conventions

**camelCase** (Recommended for variables):
```javascript
let userName = "Alice";
let userAge = 25;
let isActiveUser = true;
```

**UPPER_CASE** (For constants):
```javascript
const MAX_SIZE = 100;
const API_BASE_URL = "https://api.example.com";
const PI = 3.14159;
```

**PascalCase** (For classes/constructors):
```javascript
class UserAccount { }
function UserProfile() { }
```

---

## Primitive Data Types

JavaScript has 7 primitive data types. Primitives are immutable (cannot be changed) and are compared by value.

### 1. String

Strings represent text data, enclosed in quotes.

```javascript
let name = "Alice";           // Double quotes
let city = ''New York'';        // Single quotes
let message = `Hello`;        // Template literals (backticks)
```

**String Operations:**
```javascript
let firstName = "Alice";
let lastName = "Smith";

// Concatenation
let fullName = firstName + " " + lastName;  // "Alice Smith"

// Template literals (ES6)
let greeting = `Hello, ${firstName}!`;     // "Hello, Alice!"

// Length
console.log(firstName.length);              // 5

// Access characters
console.log(firstName[0]);                  // "A"
```

**Escape Characters:**
```javascript
let text = "She said \\"Hello\\"";     // Escape quotes
let newline = "Line 1\\nLine 2";      // New line
let tab = "Column1\\tColumn2";        // Tab
let backslash = "Path: C:\\\\Users";   // Backslash
```

### 2. Number

Numbers represent numeric values. JavaScript has one number type (no separate int/float).

```javascript
let integer = 42;
let decimal = 3.14;
let negative = -10;
let scientific = 1.5e6;  // 1,500,000
```

**Number Operations:**
```javascript
let a = 10;
let b = 3;

console.log(a + b);   // 13 (addition)
console.log(a - b);   // 7 (subtraction)
console.log(a * b);   // 30 (multiplication)
console.log(a / b);   // 3.333... (division)
console.log(a % b);   // 1 (modulo/remainder)
console.log(a ** b);  // 1000 (exponentiation)
```

**Special Number Values:**
```javascript
let infinity = Infinity;
let notANumber = NaN;  // Not a Number
let maxValue = Number.MAX_VALUE;
let minValue = Number.MIN_VALUE;
```

**Number Methods:**
```javascript
let num = 3.14159;

console.log(num.toFixed(2));      // "3.14" (string)
console.log(parseInt("42"));      // 42
console.log(parseFloat("3.14"));  // 3.14
console.log(Number("123"));       // 123
```

### 3. Boolean

Booleans represent logical values: `true` or `false`.

```javascript
let isActive = true;
let isLoggedIn = false;
let hasPermission = true;
```

**Boolean Operations:**
```javascript
let a = true;
let b = false;

console.log(a && b);   // false (AND)
console.log(a || b);   // true (OR)
console.log(!a);       // false (NOT)
```

**Truthy and Falsy Values:**
```javascript
// Falsy values (evaluate to false)
false
0
-0
0n (BigInt zero)
"" (empty string)
null
undefined
NaN

// Everything else is truthy
true
1
"hello"
[]
{}
```

### 4. undefined

`undefined` means a variable has been declared but not assigned a value.

```javascript
let x;
console.log(x);  // undefined

let y = undefined;  // Explicitly set to undefined
```

**Common Scenarios:**
```javascript
// Variable declared but not initialized
let name;
console.log(name);  // undefined

// Function with no return
function doNothing() { }
console.log(doNothing());  // undefined

// Accessing non-existent property
let obj = {};
console.log(obj.property);  // undefined
```

### 5. null

`null` represents the intentional absence of a value (different from `undefined`).

```javascript
let user = null;  // Explicitly set to null
```

**null vs undefined:**
```javascript
let a;           // undefined (not assigned)
let b = null;     // null (explicitly set)

console.log(a == null);   // true (loose equality)
console.log(a === null);  // false (strict equality)
console.log(b === null);  // true
```

**When to Use null:**
```javascript
// Indicate "no value" intentionally
let currentUser = null;  // No user logged in

// Reset a variable
let data = getData();
data = null;  // Clear the data
```

### 6. Symbol (ES6)

Symbols are unique, immutable identifiers, often used as object property keys.

```javascript
let id1 = Symbol("id");
let id2 = Symbol("id");

console.log(id1 === id2);  // false (each Symbol is unique)
```

**Common Uses:**
```javascript
// Create unique property keys
let user = {
    name: "Alice",
    [Symbol("id")]: 123  // Hidden property
};

// Well-known symbols
Symbol.iterator
Symbol.toStringTag
```

### 7. BigInt (ES2020)

BigInt represents integers of arbitrary length, useful for very large numbers.

```javascript
let bigNumber = 9007199254740991n;  // Note the ''n'' suffix
let anotherBig = BigInt(9007199254740991);
```

**When to Use:**
```javascript
// Regular numbers have limits
console.log(Number.MAX_SAFE_INTEGER);  // 9007199254740991

// BigInt for larger numbers
let huge = 9007199254740992n;
console.log(huge + 1n);  // 9007199254740993n
```

---

## Type Coercion and Conversion

JavaScript automatically converts types in certain situations (coercion) or you can explicitly convert types.

### Type Coercion (Automatic)

JavaScript automatically converts types when needed:

```javascript
// String + Number = String
console.log("5" + 3);        // "53" (concatenation)
console.log("5" + "3");      // "53"

// Number operations convert to number
console.log("5" - 3);        // 2
console.log("5" * "3");     // 15
console.log("10" / "2");    // 5

// Boolean in numeric context
console.log(true + 1);       // 2
console.log(false + 1);      // 1

// Loose equality (==) does coercion
console.log(5 == "5");       // true (coerced)
console.log(5 === "5");      // false (strict, no coercion)
```

### Type Conversion (Explicit)

You can explicitly convert types:

**To String:**
```javascript
let num = 42;
let str1 = String(num);      // "42"
let str2 = num.toString();   // "42"
let str3 = "" + num;         // "42" (coercion)
```

**To Number:**
```javascript
let str = "42";
let num1 = Number(str);      // 42
let num2 = parseInt(str);    // 42
let num3 = parseFloat("3.14"); // 3.14
let num4 = +str;             // 42 (unary plus)
```

**To Boolean:**
```javascript
let value = "hello";
let bool1 = Boolean(value);  // true
let bool2 = !!value;          // true (double negation)
```

**Common Conversions:**
```javascript
// String to Number
Number("42");        // 42
Number("3.14");      // 3.14
Number("abc");       // NaN

parseInt("42px");    // 42 (stops at first non-digit)
parseFloat("3.14.5"); // 3.14

// Number to String
String(42);          // "42"
(42).toString();     // "42"
42 + "";             // "42"

// To Boolean
Boolean(1);          // true
Boolean(0);          // false
Boolean("");         // false
Boolean("hello");    // true
```

---

## typeof Operator

The `typeof` operator returns a string indicating the type of a value.

### Basic Usage

```javascript
typeof "hello";        // "string"
typeof 42;             // "number"
typeof true;            // "boolean"
typeof undefined;       // "undefined"
typeof null;            // "object" (quirk - null is not an object!)
typeof Symbol("id");   // "symbol"
typeof 42n;            // "bigint"
```

### typeof Examples

```javascript
// Primitives
console.log(typeof "hello");      // "string"
console.log(typeof 42);           // "number"
console.log(typeof true);         // "boolean"
console.log(typeof undefined);    // "undefined"
console.log(typeof null);         // "object" (historical quirk)

// Objects
console.log(typeof {});           // "object"
console.log(typeof []);           // "object" (arrays are objects)
console.log(typeof function(){}); // "function"

// Variables
let name = "Alice";
console.log(typeof name);         // "string"

let age = 25;
console.log(typeof age);          // "number"
```

### typeof Quirks

```javascript
// null returns "object" (historical bug, can''t be fixed)
console.log(typeof null);         // "object"

// Arrays are objects
console.log(typeof []);           // "object"
console.log(Array.isArray([]));   // true (use this instead)

// Functions are objects but typeof returns "function"
console.log(typeof function(){}); // "function"
```

### Practical Uses

```javascript
// Type checking function
function processValue(value) {
    if (typeof value === "string") {
        return value.toUpperCase();
    } else if (typeof value === "number") {
        return value * 2;
    } else {
        return "Unknown type";
    }
}

console.log(processValue("hello"));  // "HELLO"
console.log(processValue(5));        // 10
```

---

## Working with Different Data Types

### String Operations

```javascript
let firstName = "Alice";
let lastName = "Smith";

// Concatenation
let fullName = firstName + " " + lastName;

// Template literals
let greeting = `Hello, ${firstName}!`;

// Methods
console.log(firstName.length);           // 5
console.log(firstName.toUpperCase());    // "ALICE"
console.log(firstName.toLowerCase());     // "alice"
console.log(firstName.charAt(0));         // "A"
console.log(firstName.includes("lic"));  // true
```

### Number Operations

```javascript
let num1 = 10;
let num2 = 3;

// Arithmetic
console.log(num1 + num2);   // 13
console.log(num1 - num2);   // 7
console.log(num1 * num2);   // 30
console.log(num1 / num2);   // 3.333...
console.log(num1 % num2);   // 1
console.log(num1 ** num2);  // 1000

// Math methods
console.log(Math.max(1, 2, 3));    // 3
console.log(Math.min(1, 2, 3));    // 1
console.log(Math.round(3.7));      // 4
console.log(Math.floor(3.7));      // 3
console.log(Math.ceil(3.2));       // 4
console.log(Math.random());        // Random number 0-1
```

### Boolean Logic

```javascript
let isActive = true;
let isLoggedIn = false;

// Logical operators
console.log(isActive && isLoggedIn);  // false
console.log(isActive || isLoggedIn);  // true
console.log(!isActive);               // false

// Comparison
let age = 25;
console.log(age >= 18);  // true
console.log(age < 30);   // true
console.log(age === 25); // true
```

---

## Practice Exercise

### Exercise: Variable Manipulation

**Objective**: Create a program that demonstrates working with different data types, variables, and type operations.

**Instructions**:

1. Create a file called `variables-practice.js`

2. Declare variables using `let` and `const`:
   - Your name (string)
   - Your age (number)
   - Whether you''re a student (boolean)
   - A constant for your birth year
   - An undefined variable
   - A null variable

3. Perform operations:
   - Concatenate your name with a greeting
   - Calculate your age in days (age × 365)
   - Use template literals to create a message
   - Convert a number to a string
   - Convert a string to a number
   - Check types using typeof

4. Display all results using console.log()

**Example Solution**:

```javascript
// Variable Declarations
let userName = "Alice";
let userAge = 25;
let isStudent = true;
const birthYear = 1999;
let futureValue = undefined;
let pastValue = null;

// String Operations
let greeting = "Hello, " + userName;
let message = `My name is ${userName} and I''m ${userAge} years old.`;

// Number Operations
let ageInDays = userAge * 365;
let ageInMonths = userAge * 12;

// Type Conversions
let ageString = String(userAge);        // "25"
let ageNumber = Number(ageString);      // 25
let ageBoolean = Boolean(userAge);      // true

// Type Checking
console.log("=== Variable Types ===");
console.log("userName type:", typeof userName);      // "string"
console.log("userAge type:", typeof userAge);        // "number"
console.log("isStudent type:", typeof isStudent);    // "boolean"
console.log("futureValue type:", typeof futureValue); // "undefined"
console.log("pastValue type:", typeof pastValue);    // "object"

// Display Results
console.log("\\n=== Variable Values ===");
console.log("Name:", userName);
console.log("Age:", userAge);
console.log("Is Student:", isStudent);
console.log("Birth Year:", birthYear);
console.log("Age in Days:", ageInDays);
console.log("Age in Months:", ageInMonths);

console.log("\\n=== String Operations ===");
console.log(greeting);
console.log(message);

console.log("\\n=== Type Conversions ===");
console.log("Age as String:", ageString, typeof ageString);
console.log("Age as Number:", ageNumber, typeof ageNumber);
console.log("Age as Boolean:", ageBoolean, typeof ageBoolean);
```

**Expected Output**:
```
=== Variable Types ===
userName type: string
userAge type: number
isStudent type: boolean
futureValue type: undefined
pastValue type: object

=== Variable Values ===
Name: Alice
Age: 25
Is Student: true
Birth Year: 1999
Age in Days: 9125
Age in Months: 300

=== String Operations ===
Hello, Alice
My name is Alice and I''m 25 years old.

=== Type Conversions ===
Age as String: 25 string
Age as Number: 25 number
Age as Boolean: true boolean
```

**Challenge (Optional)**:
- Create variables of all 7 primitive types
- Perform type coercion experiments
- Use BigInt for large numbers
- Create a Symbol and use it
- Test truthy/falsy values

---

## Common Mistakes

### 1. Using var Instead of let/const

```javascript
// ❌ Old style
var oldStyle = "avoid";

// ✅ Modern style
const modernStyle = "use this";
let changeable = "or this";
```

### 2. Reassigning const

```javascript
// ❌ Error
const PI = 3.14;
PI = 3.14159;  // TypeError

// ✅ Correct
const PI = 3.14159;  // Set correct value initially
```

### 3. Confusing null and undefined

```javascript
// Different meanings
let a;              // undefined (not assigned)
let b = null;       // null (explicitly no value)

// Check correctly
if (a === undefined) { }  // Check for undefined
if (b === null) { }        // Check for null
```

### 4. Type Coercion Surprises

```javascript
// ❌ Unexpected
console.log("5" + 3);      // "53" (not 8!)

// ✅ Explicit
console.log(Number("5") + 3);  // 8
```

### 5. typeof null Quirk

```javascript
// Remember: typeof null is "object"
console.log(typeof null);  // "object" (not "null"!)

// Check for null correctly
let value = null;
if (value === null) { }  // Use strict equality
```

---

## Key Takeaways

1. **Variable Declarations**: Use `const` by default, `let` when reassigning, avoid `var`
2. **Primitive Types**: 7 types - string, number, boolean, undefined, null, symbol, bigint
3. **Type Coercion**: JavaScript automatically converts types in some situations
4. **Type Conversion**: Use explicit methods (String(), Number(), Boolean()) when needed
5. **typeof Operator**: Returns type as string, but has quirks (null returns "object")
6. **Naming**: Use camelCase for variables, UPPER_CASE for constants
7. **Best Practice**: Prefer `const` and `let` over `var` in modern JavaScript

---

## Quiz: Data Types

Test your understanding with these questions:

1. **Which keyword should you use for a variable that won''t change?**
   - A) var
   - B) let
   - C) const
   - D) All of the above

2. **What is the result of `typeof null`?**
   - A) "null"
   - B) "object"
   - C) "undefined"
   - D) "number"

3. **What is the result of `"5" + 3`?**
   - A) 8
   - B) "8"
   - C) "53"
   - D) Error

4. **How many primitive data types does JavaScript have?**
   - A) 5
   - B) 6
   - C) 7
   - D) 8

5. **Which of these is NOT a primitive type?**
   - A) string
   - B) number
   - C) object
   - D) boolean

6. **What does `let` provide that `var` doesn''t?**
   - A) Block scope
   - B) Function scope
   - C) Global scope
   - D) All of the above

7. **What is the result of `Boolean("")`?**
   - A) true
   - B) false
   - C) undefined
   - D) null

**Answers**:
1. C) const
2. B) "object" (historical quirk)
3. C) "53" (string concatenation)
4. C) 7
5. C) object (objects are not primitives)
6. A) Block scope
7. B) false (empty string is falsy)

---

## Next Steps

Congratulations! You''ve learned about variables and data types. You now know:
- How to declare variables with var, let, and const
- All 7 primitive data types
- Type coercion and conversion
- How to use the typeof operator

**What''s Next?**
- Module 2: Operators and Expressions
- Lesson 2.1: Arithmetic Operators
- Practice working with different data types
- Experiment with type conversions

---

## Additional Resources

- **MDN: Variables**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#declarations](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Grammar_and_types#declarations)
- **MDN: Data Types**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Data_structures)
- **JavaScript.info: Variables**: [javascript.info/variables](https://javascript.info/variables)
- **JavaScript.info: Types**: [javascript.info/types](https://javascript.info/types)

---

*Lesson completed! You''re ready to move on to the next module.*

', NULL, 3, '2026-01-03 09:06:44', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the three ways to declare variables (var, let, const)
- Know the differences between var, let, and const
- Identify all JavaScript primitive data types
- Understand type coercion and conversion
- Use the typeof operator to check data types
- Work with different data types in your code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (111, 42, 10, 'Arithmetic Operators', 'arithmetic-operators', '# Lesson 2.1: Arithmetic Operators

## Learning Objectives

By the end of this lesson, you will be able to:
- Use all basic arithmetic operators (+, -, *, /)
- Understand and use the modulo operator (%)
- Work with exponentiation (**)
- Apply increment and decrement operators (++, --)
- Understand operator precedence and associativity
- Build a simple calculator program

---

## Introduction to Arithmetic Operators

Arithmetic operators perform mathematical operations on numbers (and sometimes strings). They are fundamental to any programming language and are used extensively in JavaScript.

### Basic Arithmetic Operators

JavaScript provides five basic arithmetic operators:

| Operator | Name | Example | Result |
|----------|------|---------|--------|
| `+` | Addition | `5 + 3` | `8` |
| `-` | Subtraction | `5 - 3` | `2` |
| `*` | Multiplication | `5 * 3` | `15` |
| `/` | Division | `5 / 3` | `1.666...` |
| `%` | Modulo (Remainder) | `5 % 3` | `2` |
| `**` | Exponentiation | `5 ** 3` | `125` |

---

## Addition (+)

The addition operator adds two numbers together.

### Basic Addition

```javascript
let sum = 5 + 3;
console.log(sum);  // 8

let a = 10;
let b = 20;
let result = a + b;
console.log(result);  // 30
```

### String Concatenation

When used with strings, `+` performs concatenation (joining strings):

```javascript
let firstName = "Alice";
let lastName = "Smith";
let fullName = firstName + " " + lastName;
console.log(fullName);  // "Alice Smith"

let greeting = "Hello, " + "World!";
console.log(greeting);  // "Hello, World!"
```

### Mixed Types

When mixing numbers and strings, JavaScript converts numbers to strings:

```javascript
console.log("5" + 3);      // "53" (string concatenation)
console.log(5 + "3");     // "53" (string concatenation)
console.log("Result: " + 10);  // "Result: 10"
```

**To force numeric addition:**
```javascript
console.log(Number("5") + 3);  // 8
console.log(+"5" + 3);          // 8 (unary plus)
```

### Multiple Additions

```javascript
let total = 10 + 20 + 30;
console.log(total);  // 60

let a = 5;
let b = 10;
let c = 15;
let sum = a + b + c;
console.log(sum);  // 30
```

---

## Subtraction (-)

The subtraction operator subtracts the right operand from the left operand.

### Basic Subtraction

```javascript
let difference = 10 - 3;
console.log(difference);  // 7

let a = 50;
let b = 20;
let result = a - b;
console.log(result);  // 30
```

### Negative Numbers

```javascript
let result = 5 - 10;
console.log(result);  // -5

let negative = -5;
let positive = 10;
let sum = negative + positive;
console.log(sum);  // 5
```

### Unary Minus

The minus operator can also be used as a unary operator to negate a value:

```javascript
let x = 5;
let y = -x;
console.log(y);  // -5

let positive = 10;
let negative = -positive;
console.log(negative);  // -10
```

### Multiple Subtractions

```javascript
let result = 100 - 20 - 10;
console.log(result);  // 70

// Order matters
let a = 100;
let b = 20;
let c = 10;
let difference = a - b - c;  // (100 - 20) - 10 = 70
console.log(difference);
```

---

## Multiplication (*)

The multiplication operator multiplies two numbers.

### Basic Multiplication

```javascript
let product = 5 * 3;
console.log(product);  // 15

let a = 10;
let b = 4;
let result = a * b;
console.log(result);  // 40
```

### Decimal Numbers

```javascript
let result = 3.5 * 2;
console.log(result);  // 7

let price = 9.99;
let quantity = 3;
let total = price * quantity;
console.log(total);  // 29.97
```

### Multiple Multiplications

```javascript
let result = 2 * 3 * 4;
console.log(result);  // 24

let a = 5;
let b = 2;
let c = 3;
let product = a * b * c;
console.log(product);  // 30
```

### Common Use Cases

```javascript
// Calculate area
let width = 10;
let height = 5;
let area = width * height;
console.log(area);  // 50

// Calculate total price
let unitPrice = 15.50;
let quantity = 4;
let totalPrice = unitPrice * quantity;
console.log(totalPrice);  // 62
```

---

## Division (/)

The division operator divides the left operand by the right operand.

### Basic Division

```javascript
let quotient = 10 / 2;
console.log(quotient);  // 5

let a = 20;
let b = 4;
let result = a / b;
console.log(result);  // 5
```

### Decimal Results

```javascript
let result = 10 / 3;
console.log(result);  // 3.3333333333333335

let a = 7;
let b = 2;
let quotient = a / b;
console.log(quotient);  // 3.5
```

### Division by Zero

```javascript
console.log(10 / 0);   // Infinity
console.log(-10 / 0);  // -Infinity
console.log(0 / 0);    // NaN (Not a Number)
```

### Integer Division

JavaScript doesn''t have integer division. To get integer results:

```javascript
// Using Math.floor()
let result = Math.floor(10 / 3);
console.log(result);  // 3

// Using parseInt()
let result2 = parseInt(10 / 3);
console.log(result2);  // 3

// Using bitwise operator (for positive numbers only)
let result3 = (10 / 3) | 0;
console.log(result3);  // 3
```

### Common Use Cases

```javascript
// Calculate average
let sum = 85 + 90 + 78;
let count = 3;
let average = sum / count;
console.log(average);  // 84.333...

// Calculate percentage
let part = 25;
let whole = 100;
let percentage = (part / whole) * 100;
console.log(percentage);  // 25
```

---

## Modulo Operator (%)

The modulo operator returns the remainder of a division operation.

### Basic Modulo

```javascript
let remainder = 10 % 3;
console.log(remainder);  // 1 (10 divided by 3 is 3 with remainder 1)

let result = 15 % 4;
console.log(result);  // 3 (15 divided by 4 is 3 with remainder 3)
```

### Understanding Modulo

```javascript
// 10 % 3 = 1
// Because: 10 = 3 * 3 + 1

// 15 % 4 = 3
// Because: 15 = 4 * 3 + 3

// 20 % 5 = 0
// Because: 20 = 5 * 4 + 0 (no remainder)
```

### Common Use Cases

**1. Check if a number is even or odd:**
```javascript
let number = 7;
if (number % 2 === 0) {
    console.log("Even");
} else {
    console.log("Odd");  // This runs
}

let num = 8;
console.log(num % 2 === 0);  // true (even)
```

**2. Check divisibility:**
```javascript
let number = 15;
if (number % 5 === 0) {
    console.log("Divisible by 5");  // This runs
}

let num = 12;
console.log(num % 3 === 0);  // true (divisible by 3)
```

**3. Get the last digit:**
```javascript
let number = 12345;
let lastDigit = number % 10;
console.log(lastDigit);  // 5
```

**4. Cycle through values:**
```javascript
// Cycle 0, 1, 2, 0, 1, 2...
for (let i = 0; i < 10; i++) {
    console.log(i % 3);  // 0, 1, 2, 0, 1, 2, 0, 1, 2, 0
}
```

**5. Wrap around values:**
```javascript
// Keep value between 0 and 9
let value = 15;
let wrapped = value % 10;
console.log(wrapped);  // 5
```

### Negative Modulo

```javascript
console.log(-10 % 3);   // -1
console.log(10 % -3);   // 1
console.log(-10 % -3);  // -1
```

---

## Exponentiation (**)

The exponentiation operator raises the left operand to the power of the right operand.

### Basic Exponentiation

```javascript
let result = 2 ** 3;
console.log(result);  // 8 (2 to the power of 3 = 2 * 2 * 2)

let power = 5 ** 2;
console.log(power);  // 25 (5 squared)
```

### Understanding Exponentiation

```javascript
// 2 ** 3 = 2 * 2 * 2 = 8
// 3 ** 2 = 3 * 3 = 9
// 4 ** 3 = 4 * 4 * 4 = 64
// 10 ** 2 = 10 * 10 = 100
```

### Common Use Cases

**1. Calculate squares:**
```javascript
let number = 5;
let square = number ** 2;
console.log(square);  // 25
```

**2. Calculate cubes:**
```javascript
let number = 3;
let cube = number ** 3;
console.log(cube);  // 27
```

**3. Calculate powers:**
```javascript
let base = 2;
let exponent = 10;
let result = base ** exponent;
console.log(result);  // 1024
```

**4. Square root (using fractional exponent):**
```javascript
let number = 16;
let squareRoot = number ** 0.5;
console.log(squareRoot);  // 4

// Or use Math.sqrt()
let sqrt = Math.sqrt(16);
console.log(sqrt);  // 4
```

**5. Cube root:**
```javascript
let number = 27;
let cubeRoot = number ** (1/3);
console.log(cubeRoot);  // 3
```

### Alternative: Math.pow()

Before ES2016, you had to use `Math.pow()`:

```javascript
// Old way
let result = Math.pow(2, 3);  // 8

// Modern way
let result2 = 2 ** 3;  // 8
```

---

## Increment and Decrement Operators

These operators increase or decrease a value by 1.

### Increment Operator (++)

**Post-increment** (returns value, then increments):
```javascript
let x = 5;
let y = x++;  // y = 5, x = 6
console.log(x);  // 6
console.log(y);  // 5
```

**Pre-increment** (increments, then returns value):
```javascript
let x = 5;
let y = ++x;  // x = 6, y = 6
console.log(x);  // 6
console.log(y);  // 6
```

### Decrement Operator (--)

**Post-decrement** (returns value, then decrements):
```javascript
let x = 5;
let y = x--;  // y = 5, x = 4
console.log(x);  // 4
console.log(y);  // 5
```

**Pre-decrement** (decrements, then returns value):
```javascript
let x = 5;
let y = --x;  // x = 4, y = 4
console.log(x);  // 4
console.log(y);  // 4
```

### Common Use Cases

**In loops:**
```javascript
for (let i = 0; i < 5; i++) {
    console.log(i);  // 0, 1, 2, 3, 4
}

// Equivalent to:
for (let i = 0; i < 5; i = i + 1) {
    console.log(i);
}
```

**Counter:**
```javascript
let count = 0;
count++;  // count is now 1
count++;  // count is now 2
console.log(count);  // 2
```

**Array indexing:**
```javascript
let index = 0;
let arr = [10, 20, 30];
console.log(arr[index++]);  // 10, index is now 1
console.log(arr[index++]);  // 20, index is now 2
```

### Important Notes

```javascript
// Be careful with post vs pre
let x = 5;
console.log(x++);  // 5 (prints, then increments)
console.log(x);    // 6

let y = 5;
console.log(++y);  // 6 (increments, then prints)
console.log(y);    // 6
```

---

## Operator Precedence

Operator precedence determines the order in which operations are performed when multiple operators are present.

### Precedence Order (Highest to Lowest)

1. **Parentheses** `()` - Highest precedence
2. **Exponentiation** `**`
3. **Multiplication, Division, Modulo** `*`, `/`, `%`
4. **Addition, Subtraction** `+`, `-`
5. **Assignment** `=`

### Examples

```javascript
// Without parentheses
let result = 2 + 3 * 4;
console.log(result);  // 14 (not 20!)
// Because: 2 + (3 * 4) = 2 + 12 = 14

// With parentheses
let result2 = (2 + 3) * 4;
console.log(result2);  // 20
// Because: (2 + 3) * 4 = 5 * 4 = 20
```

### More Examples

```javascript
// Exponentiation first
let a = 2 ** 3 + 1;
console.log(a);  // 9 (8 + 1, not 16!)

// Multiplication before addition
let b = 10 + 5 * 2;
console.log(b);  // 20 (10 + 10, not 30!)

// Modulo same as multiplication/division
let c = 10 + 15 % 4;
console.log(c);  // 13 (10 + 3)

// Complex expression
let d = 2 + 3 * 4 ** 2;
console.log(d);  // 50
// Step 1: 4 ** 2 = 16
// Step 2: 3 * 16 = 48
// Step 3: 2 + 48 = 50
```

### Using Parentheses

Parentheses override precedence and make code clearer:

```javascript
// Clear intent
let result = (2 + 3) * (4 + 5);
console.log(result);  // 45

// Complex calculation
let total = (10 + 5) * 2 - 3;
console.log(total);  // 27
// Step 1: (10 + 5) = 15
// Step 2: 15 * 2 = 30
// Step 3: 30 - 3 = 27
```

### Associativity

When operators have the same precedence, associativity determines the order:

```javascript
// Left-to-right for +, -, *, /
let result = 10 - 5 - 2;
console.log(result);  // 3
// Evaluated as: (10 - 5) - 2 = 5 - 2 = 3

// Right-to-left for **
let power = 2 ** 3 ** 2;
console.log(power);  // 512
// Evaluated as: 2 ** (3 ** 2) = 2 ** 9 = 512
```

---

## Combining Operators

You can combine multiple operators in expressions:

```javascript
// Simple combination
let result = 10 + 5 * 2;
console.log(result);  // 20

// Complex expression
let total = (100 - 20) / 2 + 10;
console.log(total);  // 50

// With variables
let a = 10;
let b = 5;
let c = 2;
let result2 = a + b * c;
console.log(result2);  // 20
```

### Best Practices

**1. Use parentheses for clarity:**
```javascript
// Unclear
let result = a + b * c / d;

// Clear
let result = a + (b * c / d);
```

**2. Break complex expressions:**
```javascript
// Hard to read
let result = (a + b) * (c - d) / (e + f) ** 2;

// Better
let sum1 = a + b;
let diff = c - d;
let sum2 = e + f;
let result = (sum1 * diff) / (sum2 ** 2);
```

---

## Practice Exercise

### Exercise: Calculator Program

**Objective**: Build a simple calculator program that performs basic arithmetic operations.

**Instructions**:

1. Create a file called `calculator.js`

2. Define variables for two numbers:
   ```javascript
   let num1 = 10;
   let num2 = 3;
   ```

3. Perform and display the following operations:
   - Addition
   - Subtraction
   - Multiplication
   - Division
   - Modulo
   - Exponentiation

4. Calculate and display:
   - The average of the two numbers
   - The square of num1
   - The cube of num2
   - Whether num1 is even or odd (using modulo)

5. Use proper formatting and clear output messages

**Example Solution**:

```javascript
// Simple Calculator Program
let num1 = 10;
let num2 = 3;

console.log("=== Simple Calculator ===");
console.log(`Number 1: ${num1}`);
console.log(`Number 2: ${num2}`);
console.log();

// Basic Operations
console.log("=== Basic Operations ===");
console.log(`${num1} + ${num2} = ${num1 + num2}`);
console.log(`${num1} - ${num2} = ${num1 - num2}`);
console.log(`${num1} * ${num2} = ${num1 * num2}`);
console.log(`${num1} / ${num2} = ${num1 / num2}`);
console.log(`${num1} % ${num2} = ${num1 % num2}`);
console.log(`${num1} ** ${num2} = ${num1 ** num2}`);
console.log();

// Advanced Calculations
console.log("=== Advanced Calculations ===");
let average = (num1 + num2) / 2;
console.log(`Average: ${average}`);

let square1 = num1 ** 2;
console.log(`${num1} squared: ${square1}`);

let cube2 = num2 ** 3;
console.log(`${num2} cubed: ${cube2}`);

// Check if even or odd
if (num1 % 2 === 0) {
    console.log(`${num1} is even`);
} else {
    console.log(`${num1} is odd`);
}

if (num2 % 2 === 0) {
    console.log(`${num2} is even`);
} else {
    console.log(`${num2} is odd`);
}
console.log();

// Operator Precedence Examples
console.log("=== Operator Precedence ===");
let result1 = 2 + 3 * 4;
console.log(`2 + 3 * 4 = ${result1} (not 20!)`);

let result2 = (2 + 3) * 4;
console.log(`(2 + 3) * 4 = ${result2}`);

let result3 = 2 ** 3 + 1;
console.log(`2 ** 3 + 1 = ${result3} (not 16!)`);
```

**Expected Output**:
```
=== Simple Calculator ===
Number 1: 10
Number 2: 3

=== Basic Operations ===
10 + 3 = 13
10 - 3 = 7
10 * 3 = 30
10 / 3 = 3.3333333333333335
10 % 3 = 1
10 ** 3 = 1000

=== Advanced Calculations ===
Average: 6.5
10 squared: 100
3 cubed: 27
10 is even
3 is odd

=== Operator Precedence ===
2 + 3 * 4 = 14 (not 20!)
(2 + 3) * 4 = 20
2 ** 3 + 1 = 9 (not 16!)
```

**Challenge (Optional)**:
- Add more operations (square root, percentage)
- Create functions for each operation
- Handle edge cases (division by zero)
- Add input validation
- Create an interactive calculator using prompt()

---

## Common Mistakes

### 1. Forgetting Operator Precedence

```javascript
// ❌ Wrong expectation
let result = 2 + 3 * 4;  // Expects 20, gets 14

// ✅ Correct
let result = (2 + 3) * 4;  // Gets 20
```

### 2. String Concatenation Instead of Addition

```javascript
// ❌ String concatenation
let result = "5" + 3;  // "53"

// ✅ Numeric addition
let result = Number("5") + 3;  // 8
```

### 3. Confusing Post vs Pre Increment

```javascript
// ❌ Wrong expectation
let x = 5;
let y = x++;  // Expects y = 6, gets y = 5

// ✅ Correct
let x = 5;
let y = ++x;  // Gets y = 6
```

### 4. Division by Zero

```javascript
// ⚠️ Be careful
let result = 10 / 0;  // Infinity (not an error!)
```

### 5. Modulo with Negative Numbers

```javascript
// Remember: result sign matches dividend
console.log(-10 % 3);  // -1 (not 2!)
```

---

## Key Takeaways

1. **Arithmetic Operators**: `+`, `-`, `*`, `/`, `%`, `**`
2. **Addition**: Can concatenate strings or add numbers
3. **Modulo**: Returns remainder, useful for checking even/odd, divisibility
4. **Exponentiation**: `**` raises to power (ES2016+)
5. **Increment/Decrement**: `++` and `--` change value by 1
6. **Precedence**: Parentheses > Exponentiation > * / % > + -
7. **Use Parentheses**: Make complex expressions clear and correct

---

## Quiz: Arithmetic Operations

Test your understanding with these questions:

1. **What is the result of `10 % 3`?**
   - A) 3
   - B) 1
   - C) 0
   - D) 3.33

2. **What is the result of `2 ** 3`?**
   - A) 6
   - B) 8
   - C) 9
   - D) 5

3. **What is the result of `2 + 3 * 4`?**
   - A) 20
   - B) 14
   - C) 24
   - D) 12

4. **What is the result of `"5" + 3`?**
   - A) 8
   - B) "8"
   - C) "53"
   - D) Error

5. **What is the result of `let x = 5; let y = x++;` (y = ?)**
   - A) 5
   - B) 6
   - C) 4
   - D) undefined

6. **What is the result of `10 / 0`?**
   - A) 0
   - B) Error
   - C) Infinity
   - D) NaN

7. **Which operator has the highest precedence?**
   - A) +
   - B) *
   - C) **
   - D) ()

**Answers**:
1. B) 1
2. B) 8
3. B) 14 (multiplication before addition)
4. C) "53" (string concatenation)
5. A) 5 (post-increment returns value first)
6. C) Infinity
7. D) () (parentheses have highest precedence)

---

## Next Steps

Congratulations! You''ve learned arithmetic operators. You now know:
- How to perform basic arithmetic operations
- How to use modulo and exponentiation
- How increment and decrement work
- How operator precedence affects calculations

**What''s Next?**
- Lesson 2.2: Comparison and Logical Operators
- Practice building more complex calculations
- Experiment with operator precedence
- Try building a more advanced calculator

---

## Additional Resources

- **MDN: Arithmetic Operators**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#arithmetic_operators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#arithmetic_operators)
- **MDN: Operator Precedence**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence)
- **JavaScript.info: Operators**: [javascript.info/operators](https://javascript.info/operators)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:11:26', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use all basic arithmetic operators (+, -, *, /)
- Understand and use the modulo operator (%)
- Work with exponentiation (**)
- Apply increment and decrement operators (++, --)
- Understand operator precedence and associativity
- Build a simple calculator program');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (112, 42, 10, 'Comparison and Logical Operators', 'comparison-and-logical-operators', '# Lesson 2.2: Comparison and Logical Operators

## Learning Objectives

By the end of this lesson, you will be able to:
- Use all comparison operators (==, ===, !=, !==, <, >, <=, >=)
- Understand the difference between strict (===) and loose (==) equality
- Apply logical operators (&&, ||, !)
- Understand short-circuit evaluation
- Combine comparison and logical operators
- Write conditional logic expressions

---

## Introduction to Comparison Operators

Comparison operators compare two values and return a boolean (`true` or `false`). They are essential for making decisions in your code.

### Comparison Operators Overview

| Operator | Name | Example | Result |
|----------|------|---------|--------|
| `==` | Loose equality | `5 == "5"` | `true` |
| `===` | Strict equality | `5 === "5"` | `false` |
| `!=` | Loose inequality | `5 != "5"` | `false` |
| `!==` | Strict inequality | `5 !== "5"` | `true` |
| `<` | Less than | `3 < 5` | `true` |
| `>` | Greater than | `5 > 3` | `true` |
| `<=` | Less than or equal | `5 <= 5` | `true` |
| `>=` | Greater than or equal | `5 >= 3` | `true` |

---

## Equality Operators

### Loose Equality (==)

The `==` operator performs type coercion before comparison. It converts operands to the same type before comparing.

```javascript
console.log(5 == 5);        // true
console.log(5 == "5");     // true (string converted to number)
console.log(true == 1);     // true (boolean converted to number)
console.log(false == 0);    // true (boolean converted to number)
console.log(null == undefined); // true (special case)
```

**Type Coercion Examples:**
```javascript
// String to number
console.log("5" == 5);      // true

// Boolean to number
console.log(true == 1);    // true
console.log(false == 0);   // true

// null and undefined
console.log(null == undefined);  // true
console.log(null == 0);         // false
console.log(undefined == 0);   // false

// Arrays and objects
console.log([] == 0);      // true (array converted to string, then number)
console.log([5] == 5);     // true
console.log([1, 2] == "1,2"); // true
```

**When Loose Equality Can Be Problematic:**
```javascript
// Unexpected results
console.log("" == 0);           // true
console.log("0" == 0);          // true
console.log(false == "false");  // false (string "false" is not converted to boolean false)
console.log([] == false);       // true
console.log([0] == false);      // true
```

### Strict Equality (===)

The `===` operator compares both value and type. No type coercion occurs.

```javascript
console.log(5 === 5);        // true
console.log(5 === "5");     // false (different types)
console.log(true === 1);     // false (different types)
console.log(false === 0);    // false (different types)
console.log(null === undefined); // false (different types)
```

**Why Use Strict Equality:**
```javascript
// More predictable
console.log(5 === 5);        // true
console.log(5 === "5");     // false (clear: different types)
console.log(true === 1);     // false (clear: different types)

// Prevents bugs
let value = "5";
if (value === 5) {  // false - won''t execute
    console.log("Number");
} else {
    console.log("String");  // This runs
}
```

**Best Practice: Always Use `===`**
```javascript
// ✅ Good
if (age === 18) { }
if (name === "Alice") { }
if (isActive === true) { }

// ❌ Avoid
if (age == 18) { }
if (name == "Alice") { }
```

### Inequality Operators

**Loose Inequality (!=):**
```javascript
console.log(5 != 3);        // true
console.log(5 != "5");     // false (coerced, so equal)
console.log(true != 1);     // false (coerced, so equal)
```

**Strict Inequality (!==):**
```javascript
console.log(5 !== 3);        // true
console.log(5 !== "5");     // true (different types)
console.log(true !== 1);     // true (different types)
```

**Best Practice: Always Use `!==`**
```javascript
// ✅ Good
if (age !== 18) { }
if (name !== "Alice") { }

// ❌ Avoid
if (age != 18) { }
```

---

## Relational Operators

Relational operators compare the order of values.

### Less Than (<)

```javascript
console.log(3 < 5);        // true
console.log(5 < 3);       // false
console.log(3 < 3);       // false
console.log("a" < "b");   // true (lexicographic comparison)
console.log("apple" < "banana"); // true
```

**String Comparison:**
```javascript
// Lexicographic (dictionary) order
console.log("a" < "b");        // true
console.log("A" < "a");        // true (uppercase < lowercase in ASCII)
console.log("10" < "2");      // true (string comparison, not numeric!)
console.log("10" < 2);        // false (string "10" converted to 10, then compared)
```

### Greater Than (>)

```javascript
console.log(5 > 3);        // true
console.log(3 > 5);       // false
console.log(5 > 5);       // false
console.log("b" > "a");   // true
```

### Less Than or Equal (<=)

```javascript
console.log(3 <= 5);       // true
console.log(5 <= 5);      // true
console.log(5 <= 3);      // false
```

### Greater Than or Equal (>=)

```javascript
console.log(5 >= 3);       // true
console.log(5 >= 5);      // true
console.log(3 >= 5);      // false
```

### Numeric Comparisons

```javascript
let age = 25;
console.log(age >= 18);    // true (adult)
console.log(age < 65);     // true (not senior)

let score = 85;
console.log(score >= 90);  // false (not A grade)
console.log(score >= 80);  // true (B grade or higher)
```

### String Comparisons

```javascript
// Alphabetical order
console.log("apple" < "banana");  // true
console.log("zebra" > "apple");   // true

// Case matters
console.log("Apple" < "apple");    // true (uppercase comes first in ASCII)
console.log("A" < "a");           // true

// Numbers as strings
console.log("10" < "2");          // true (lexicographic, not numeric!)
console.log("10" < 2);            // false (type coercion to number)
```

---

## Logical Operators

Logical operators combine or negate boolean values.

### Logical AND (&&)

Returns `true` only if both operands are `true`.

```javascript
console.log(true && true);    // true
console.log(true && false);   // false
console.log(false && true);   // false
console.log(false && false);  // false
```

**Practical Examples:**
```javascript
let age = 25;
let hasLicense = true;

if (age >= 18 && hasLicense) {
    console.log("Can drive");  // This runs
}

let isLoggedIn = true;
let isAdmin = false;

if (isLoggedIn && isAdmin) {
    console.log("Admin access");  // Doesn''t run
}
```

**Truth Table for AND:**
| A | B | A && B |
|---|---|--------|
| true | true | true |
| true | false | false |
| false | true | false |
| false | false | false |

### Logical OR (||)

Returns `true` if at least one operand is `true`.

```javascript
console.log(true || true);    // true
console.log(true || false);   // true
console.log(false || true);    // true
console.log(false || false);  // false
```

**Practical Examples:**
```javascript
let hasCreditCard = false;
let hasPayPal = true;

if (hasCreditCard || hasPayPal) {
    console.log("Can make payment");  // This runs
}

let isWeekend = false;
let isHoliday = true;

if (isWeekend || isHoliday) {
    console.log("No work today");  // This runs
}
```

**Truth Table for OR:**
| A | B | A \\|\\| B |
|---|---|----------|
| true | true | true |
| true | false | true |
| false | true | true |
| false | false | false |

### Logical NOT (!)

Negates a boolean value.

```javascript
console.log(!true);    // false
console.log(!false);   // true
console.log(!0);       // true (0 is falsy)
console.log(!1);       // false (1 is truthy)
console.log(!!"hello"); // true (double negation converts to boolean)
```

**Practical Examples:**
```javascript
let isLoggedOut = !isLoggedIn;

if (!isAdmin) {
    console.log("Regular user");
}

let isEmpty = !array.length;  // true if array is empty
```

**Truth Table for NOT:**
| A | !A |
|---|---|
| true | false |
| false | true |

### Combining Logical Operators

```javascript
let age = 25;
let hasLicense = true;
let hasInsurance = false;

// Complex condition
if (age >= 18 && hasLicense && hasInsurance) {
    console.log("Can drive legally");
} else {
    console.log("Cannot drive");  // This runs (missing insurance)
}

// Using OR
if (age < 18 || !hasLicense) {
    console.log("Cannot drive");
}

// Combining AND and OR
if ((age >= 18 && hasLicense) || hasInsurance) {
    console.log("Some form of driving allowed");
}
```

**Operator Precedence:**
```javascript
// NOT has highest precedence, then AND, then OR
let result = !false && true || false;
// Evaluated as: ((!false) && true) || false
// = (true && true) || false
// = true || false
// = true
```

---

## Short-Circuit Evaluation

JavaScript uses short-circuit evaluation for logical operators, meaning it stops evaluating as soon as the result is determined.

### AND Short-Circuit (&&)

If the left operand is `false`, the right operand is not evaluated.

```javascript
// If first is false, second is never evaluated
false && console.log("This won''t print");

// If first is true, second is evaluated
true && console.log("This will print");  // "This will print"
```

**Practical Use - Default Values:**
```javascript
// If user exists, get name, otherwise use "Guest"
let userName = user && user.name || "Guest";

// If config exists, use it, otherwise use default
let settings = config && config.settings || defaultSettings;
```

**Conditional Execution:**
```javascript
// Only call function if condition is true
isLoggedIn && showDashboard();

// Only set value if it exists
data && processData(data);
```

### OR Short-Circuit (||)

If the left operand is `true`, the right operand is not evaluated.

```javascript
// If first is true, second is never evaluated
true || console.log("This won''t print");

// If first is false, second is evaluated
false || console.log("This will print");  // "This will print"
```

**Practical Use - Default Values:**
```javascript
// Use provided value or default
let name = userName || "Guest";
let port = config.port || 3000;
let theme = userTheme || "light";
```

**Fallback Values:**
```javascript
// Try first option, fallback to second, then third
let value = option1 || option2 || option3 || "default";
```

### Real-World Examples

**1. Safe Property Access:**
```javascript
// Avoid errors if user might be null
let name = user && user.profile && user.profile.name || "Anonymous";

// Modern alternative (optional chaining - ES2020)
let name2 = user?.profile?.name || "Anonymous";
```

**2. Function Calls:**
```javascript
// Only call if function exists
callback && callback(data);

// Call with fallback
onSuccess && onSuccess(result) || console.log("No callback");
```

**3. Default Parameters:**
```javascript
function greet(name) {
    name = name || "Guest";
    console.log(`Hello, ${name}!`);
}

greet("Alice");  // "Hello, Alice!"
greet();        // "Hello, Guest!"
```

---

## Combining Comparison and Logical Operators

You can combine comparison and logical operators to create complex conditions.

### Examples

```javascript
let age = 25;
let hasLicense = true;
let hasInsurance = true;

// Multiple conditions
if (age >= 18 && age <= 65 && hasLicense && hasInsurance) {
    console.log("Fully qualified driver");
}

let score = 85;
let attendance = 0.95;

// Grade determination
if (score >= 90 && attendance >= 0.9) {
    console.log("Grade A");
} else if (score >= 80 && attendance >= 0.8) {
    console.log("Grade B");
} else if (score >= 70 || attendance < 0.7) {
    console.log("Grade C or needs improvement");
}
```

### Complex Conditions

```javascript
let temperature = 25;
let isRaining = false;
let isWeekend = true;

// Complex weather condition
if ((temperature > 20 && temperature < 30) && !isRaining && isWeekend) {
    console.log("Perfect day for outdoor activities");
}

let user = {
    age: 25,
    isPremium: true,
    isActive: true
};

// Multiple checks
if (user.age >= 18 && user.isPremium && user.isActive) {
    console.log("Full access granted");
}
```

### Precedence in Complex Expressions

```javascript
// Parentheses clarify intent
let result = (age >= 18 && hasLicense) || (hasParent && isSupervised);

// Without parentheses (same result due to precedence)
let result2 = age >= 18 && hasLicense || hasParent && isSupervised;
// Evaluated as: (age >= 18 && hasLicense) || (hasParent && isSupervised)
```

---

## Practice Exercise

### Exercise: Conditional Logic Practice

**Objective**: Write a program that uses comparison and logical operators to make decisions.

**Instructions**:

1. Create a file called `conditional-logic.js`

2. Define variables for a user profile:
   - Age
   - Has driver''s license (boolean)
   - Has insurance (boolean)
   - Credit score
   - Is premium member (boolean)

3. Write conditions to determine:
   - Can the user drive? (age >= 18 && hasLicense)
   - Can the user drive legally? (age >= 18 && hasLicense && hasInsurance)
   - Is the user eligible for a loan? (credit score >= 700 || isPremium)
   - What membership level? (premium or regular)
   - Age category (minor, adult, senior)

4. Display all results with clear messages

**Example Solution**:

```javascript
// Conditional Logic Practice
let age = 25;
let hasLicense = true;
let hasInsurance = true;
let creditScore = 750;
let isPremium = false;

console.log("=== User Profile ===");
console.log(`Age: ${age}`);
console.log(`Has License: ${hasLicense}`);
console.log(`Has Insurance: ${hasInsurance}`);
console.log(`Credit Score: ${creditScore}`);
console.log(`Premium Member: ${isPremium}`);
console.log();

// Driving Eligibility
console.log("=== Driving Eligibility ===");
if (age >= 18 && hasLicense) {
    console.log("✅ Can drive");
} else {
    console.log("❌ Cannot drive");
}

if (age >= 18 && hasLicense && hasInsurance) {
    console.log("✅ Can drive legally");
} else {
    console.log("❌ Cannot drive legally");
}
console.log();

// Loan Eligibility
console.log("=== Loan Eligibility ===");
if (creditScore >= 700 || isPremium) {
    console.log("✅ Eligible for loan");
} else {
    console.log("❌ Not eligible for loan");
}
console.log();

// Membership Level
console.log("=== Membership Level ===");
if (isPremium) {
    console.log("⭐ Premium Member");
} else {
    console.log("👤 Regular Member");
}
console.log();

// Age Category
console.log("=== Age Category ===");
if (age < 18) {
    console.log("Minor");
} else if (age >= 18 && age < 65) {
    console.log("Adult");
} else {
    console.log("Senior");
}
console.log();

// Complex Conditions
console.log("=== Complex Conditions ===");
let canRentCar = age >= 21 && hasLicense && hasInsurance && (creditScore >= 650 || isPremium);
if (canRentCar) {
    console.log("✅ Can rent a car");
} else {
    console.log("❌ Cannot rent a car");
}

let hasFullAccess = age >= 18 && isPremium && creditScore >= 700;
if (hasFullAccess) {
    console.log("✅ Has full platform access");
} else {
    console.log("❌ Limited access");
}

// Comparison Examples
console.log();
console.log("=== Comparison Examples ===");
console.log(`Age >= 18: ${age >= 18}`);
console.log(`Age < 30: ${age < 30}`);
console.log(`Credit Score > 700: ${creditScore > 700}`);
console.log(`Credit Score <= 800: ${creditScore <= 800}`);

// Logical Operator Examples
console.log();
console.log("=== Logical Operator Examples ===");
console.log(`hasLicense && hasInsurance: ${hasLicense && hasInsurance}`);
console.log(`hasLicense || hasInsurance: ${hasLicense || hasInsurance}`);
console.log(`!isPremium: ${!isPremium}`);
console.log(`age >= 18 && creditScore >= 700: ${age >= 18 && creditScore >= 700}`);
```

**Expected Output**:
```
=== User Profile ===
Age: 25
Has License: true
Has Insurance: true
Credit Score: 750
Premium Member: false

=== Driving Eligibility ===
✅ Can drive
✅ Can drive legally

=== Loan Eligibility ===
✅ Eligible for loan

=== Membership Level ===
👤 Regular Member

=== Age Category ===
Adult

=== Complex Conditions ===
✅ Can rent a car
✅ Has full platform access

=== Comparison Examples ===
Age >= 18: true
Age < 30: true
Credit Score > 700: true
Credit Score <= 800: true

=== Logical Operator Examples ===
hasLicense && hasInsurance: true
hasLicense || hasInsurance: true
!isPremium: true
age >= 18 && creditScore >= 700: true
```

**Challenge (Optional)**:
- Add more conditions (voting eligibility, senior discounts)
- Create a grading system (A, B, C, D, F)
- Build a discount calculator based on multiple conditions
- Use short-circuit evaluation for default values

---

## Common Mistakes

### 1. Using == Instead of ===

```javascript
// ❌ Can cause bugs
if (age == "18") { }  // Might be true unexpectedly

// ✅ Always use strict equality
if (age === 18) { }
```

### 2. Confusing && and ||

```javascript
// ❌ Wrong logic
if (age >= 18 || hasLicense) { }  // Too permissive

// ✅ Correct
if (age >= 18 && hasLicense) { }  // Both required
```

### 3. Forgetting Operator Precedence

```javascript
// ❌ Might not work as expected
if (age >= 18 && hasLicense || isParent) { }

// ✅ Use parentheses for clarity
if ((age >= 18 && hasLicense) || isParent) { }
```

### 4. String vs Number Comparison

```javascript
// ❌ String comparison
if ("10" < "2") { }  // true (lexicographic)

// ✅ Numeric comparison
if (10 < 2) { }  // false
if (Number("10") < 2) { }  // false
```

### 5. Truthy/Falsy Confusion

```javascript
// ⚠️ Be careful with truthy/falsy
if (userName) { }  // false if userName is "" or null

// ✅ Explicit check
if (userName !== "" && userName !== null) { }
// Or
if (userName && userName.length > 0) { }
```

---

## Key Takeaways

1. **Strict Equality**: Always use `===` and `!==` instead of `==` and `!=`
2. **Comparison Operators**: `<`, `>`, `<=`, `>=` compare values
3. **Logical Operators**: `&&` (AND), `||` (OR), `!` (NOT)
4. **Short-Circuit**: `&&` and `||` stop evaluating when result is known
5. **Combining Operators**: Use parentheses to clarify complex conditions
6. **Best Practice**: Use strict equality and explicit boolean checks

---

## Quiz: Operators

Test your understanding with these questions:

1. **What is the result of `5 === "5"`?**
   - A) true
   - B) false
   - C) undefined
   - D) Error

2. **What is the result of `true && false`?**
   - A) true
   - B) false
   - C) undefined
   - D) null

3. **What is the result of `true || false`?**
   - A) true
   - B) false
   - C) undefined
   - D) null

4. **Which operator should you use for equality?**
   - A) ==
   - B) ===
   - C) =
   - D) == or === (doesn''t matter)

5. **What is the result of `!true`?**
   - A) true
   - B) false
   - C) 1
   - D) 0

6. **What is the result of `"10" < "2"`?**
   - A) true
   - B) false
   - C) Error
   - D) undefined

7. **In `true && false || true`, what is evaluated first?**
   - A) true && false
   - B) false || true
   - C) They''re evaluated simultaneously
   - D) Depends on the context

**Answers**:
1. B) false (strict equality checks type)
2. B) false (AND requires both true)
3. A) true (OR needs at least one true)
4. B) === (always use strict equality)
5. B) false (NOT negates the value)
6. A) true (string comparison is lexicographic)
7. A) true && false (AND has higher precedence than OR)

---

## Next Steps

Congratulations! You''ve learned comparison and logical operators. You now know:
- How to compare values with comparison operators
- The difference between strict and loose equality
- How to use logical operators
- How short-circuit evaluation works

**What''s Next?**
- Lesson 2.3: Assignment and Other Operators
- Practice combining operators
- Experiment with short-circuit evaluation
- Build more complex conditional logic

---

## Additional Resources

- **MDN: Comparison Operators**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#comparison_operators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#comparison_operators)
- **MDN: Logical Operators**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#logical_operators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#logical_operators)
- **JavaScript.info: Comparisons**: [javascript.info/comparison](https://javascript.info/comparison)
- **JavaScript.info: Logical Operators**: [javascript.info/logical-operators](https://javascript.info/logical-operators)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:11:26', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use all comparison operators (==, ===, !=, !==, <, >, <=, >=)
- Understand the difference between strict (===) and loose (==) equality
- Apply logical operators (&&, ||, !)
- Understand short-circuit evaluation
- Combine comparison and logical operators
- Write conditional logic expressions');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (113, 42, 10, 'Assignment and Other Operators', 'assignment-and-other-operators', '# Lesson 2.3: Assignment and Other Operators

## Learning Objectives

By the end of this lesson, you will be able to:
- Use the assignment operator (=)
- Apply augmented assignment operators (+=, -=, *=, /=, %=, **=)
- Use the ternary operator (?:) for conditional expressions
- Understand nullish coalescing (??) for default values
- Use optional chaining (?.) for safe property access
- Combine these operators effectively in your code

---

## Assignment Operator (=)

The assignment operator assigns a value to a variable.

### Basic Assignment

```javascript
let x = 5;        // Assign 5 to x
let name = "Alice";  // Assign "Alice" to name
let isActive = true; // Assign true to isActive
```

### Multiple Assignments

```javascript
// Chain assignments (same value)
let a, b, c;
a = b = c = 10;
console.log(a, b, c);  // 10 10 10

// Multiple variables, different values
let x = 5, y = 10, z = 15;
```

### Assignment Returns a Value

The assignment operator returns the assigned value, allowing chaining:

```javascript
let x;
let y = x = 5;  // x = 5, then y = x (which is 5)
console.log(x, y);  // 5 5
```

### Common Patterns

```javascript
// Initialize variable
let count = 0;

// Update variable
count = count + 1;  // Increment

// Reassign with new value
let price = 10;
price = 15;  // Update price
```

---

## Augmented Assignment Operators

Augmented assignment operators combine an operation with assignment, making code more concise.

### Addition Assignment (+=)

```javascript
let x = 5;
x += 3;  // Equivalent to: x = x + 3
console.log(x);  // 8

// With strings (concatenation)
let message = "Hello";
message += " World";
console.log(message);  // "Hello World"
```

### Subtraction Assignment (-=)

```javascript
let x = 10;
x -= 3;  // Equivalent to: x = x - 3
console.log(x);  // 7
```

### Multiplication Assignment (*=)

```javascript
let x = 5;
x *= 3;  // Equivalent to: x = x * 3
console.log(x);  // 15
```

### Division Assignment (/=)

```javascript
let x = 15;
x /= 3;  // Equivalent to: x = x / 3
console.log(x);  // 5
```

### Modulo Assignment (%=)

```javascript
let x = 10;
x %= 3;  // Equivalent to: x = x % 3
console.log(x);  // 1
```

### Exponentiation Assignment (**=)

```javascript
let x = 2;
x **= 3;  // Equivalent to: x = x ** 3
console.log(x);  // 8
```

### Complete List

| Operator | Example | Equivalent To |
|----------|---------|--------------|
| `+=` | `x += 5` | `x = x + 5` |
| `-=` | `x -= 5` | `x = x - 5` |
| `*=` | `x *= 5` | `x = x * 5` |
| `/=` | `x /= 5` | `x = x / 5` |
| `%=` | `x %= 5` | `x = x % 5` |
| `**=` | `x **= 5` | `x = x ** 5` |

### Practical Examples

```javascript
// Counter
let count = 0;
count += 1;  // count is now 1
count += 1;  // count is now 2

// Accumulator
let total = 0;
total += 10;  // total is 10
total += 20;  // total is 30
total += 30;  // total is 60

// String building
let html = "";
html += "<div>";
html += "Hello";
html += "</div>";
console.log(html);  // "<div>Hello</div>"

// Percentage calculation
let price = 100;
price *= 1.1;  // Add 10% (price = price * 1.1)
console.log(price);  // 110

// Halving
let value = 100;
value /= 2;  // value = value / 2
console.log(value);  // 50
```

### Benefits of Augmented Assignment

**More Concise:**
```javascript
// Without augmented assignment
let x = 5;
x = x + 3;

// With augmented assignment
let x = 5;
x += 3;  // Shorter and clearer
```

**Less Error-Prone:**
```javascript
// Easy to make mistake
let x = 5;
x = x + 3;  // What if you forget the ''x ='' part?

// Harder to make mistake
let x = 5;
x += 3;  // Clear intent
```

---

## Ternary Operator (?:)

The ternary operator is a concise way to write conditional expressions. It''s the only operator that takes three operands.

### Syntax

```javascript
condition ? valueIfTrue : valueIfFalse
```

### Basic Usage

```javascript
let age = 20;
let status = age >= 18 ? "Adult" : "Minor";
console.log(status);  // "Adult"

// Equivalent if-else
let status2;
if (age >= 18) {
    status2 = "Adult";
} else {
    status2 = "Minor";
}
```

### Examples

**Simple Condition:**
```javascript
let isLoggedIn = true;
let message = isLoggedIn ? "Welcome back!" : "Please log in";
console.log(message);  // "Welcome back!"

let score = 85;
let grade = score >= 90 ? "A" : "B";
console.log(grade);  // "B"
```

**Multiple Uses:**
```javascript
let temperature = 25;
let weather = temperature > 20 ? "Warm" : "Cold";
console.log(weather);  // "Warm"

let user = null;
let userName = user ? user.name : "Guest";
console.log(userName);  // "Guest"
```

### Nested Ternary (Use Sparingly)

```javascript
let score = 85;
let grade = score >= 90 ? "A" : 
            score >= 80 ? "B" : 
            score >= 70 ? "C" : "F";
console.log(grade);  // "B"

// More readable with if-else
let grade2;
if (score >= 90) {
    grade2 = "A";
} else if (score >= 80) {
    grade2 = "B";
} else if (score >= 70) {
    grade2 = "C";
} else {
    grade2 = "F";
}
```

### Ternary in Expressions

```javascript
let x = 5;
let y = 10;
let max = x > y ? x : y;
console.log(max);  // 10

let a = 3;
let b = 7;
let result = a > b ? a * 2 : b * 2;
console.log(result);  // 14
```

### Ternary for Function Calls

```javascript
let isAdmin = true;
isAdmin ? showAdminPanel() : showUserPanel();

let user = getUser();
user ? logUserActivity(user) : logGuestActivity();
```

### When to Use Ternary

**Good Use Cases:**
- Simple true/false assignments
- Short, readable conditions
- Inline conditional values

**Avoid For:**
- Complex nested conditions
- Multiple statements
- When if-else is clearer

```javascript
// ✅ Good
let message = isActive ? "Active" : "Inactive";

// ❌ Too complex
let result = a > b ? (c > d ? e : f) : (g > h ? i : j);

// ✅ Better
let result;
if (a > b) {
    result = c > d ? e : f;
} else {
    result = g > h ? i : j;
}
```

---

## Nullish Coalescing (??)

The nullish coalescing operator (`??`) returns the right operand when the left is `null` or `undefined`, otherwise returns the left operand.

### Basic Usage

```javascript
let value = null;
let result = value ?? "default";
console.log(result);  // "default"

let value2 = undefined;
let result2 = value2 ?? "default";
console.log(result2);  // "default"

let value3 = "actual";
let result3 = value3 ?? "default";
console.log(result3);  // "actual"
```

### vs Logical OR (||)

**Key Difference:**
- `||` returns right operand for any falsy value (false, 0, "", null, undefined, NaN)
- `??` only returns right operand for `null` or `undefined`

```javascript
// With ||
let value1 = 0;
let result1 = value1 || "default";
console.log(result1);  // "default" (0 is falsy)

let value2 = "";
let result2 = value2 || "default";
console.log(result2);  // "default" ("" is falsy)

let value3 = false;
let result3 = value3 || "default";
console.log(result3);  // "default" (false is falsy)

// With ??
let value4 = 0;
let result4 = value4 ?? "default";
console.log(result4);  // 0 (0 is not null/undefined)

let value5 = "";
let result5 = value5 ?? "default";
console.log(result5);  // "" ("" is not null/undefined)

let value6 = false;
let result6 = value6 ?? "default";
console.log(result6);  // false (false is not null/undefined)

// Only null/undefined trigger ??
let value7 = null;
let result7 = value7 ?? "default";
console.log(result7);  // "default"

let value8 = undefined;
let result8 = value8 ?? "default";
console.log(result8);  // "default"
```

### Practical Examples

**Default Values:**
```javascript
// User input
let userName = getUserName() ?? "Guest";
console.log(userName);

// Configuration
let port = config.port ?? 3000;
let theme = userSettings.theme ?? "light";

// API response
let data = response.data ?? [];
let count = response.count ?? 0;
```

**Function Parameters:**
```javascript
function greet(name) {
    name = name ?? "Guest";
    console.log(`Hello, ${name}!`);
}

greet("Alice");  // "Hello, Alice!"
greet(null);     // "Hello, Guest!"
greet();         // "Hello, Guest!"
```

**Object Properties:**
```javascript
let user = {
    name: "Alice",
    age: null,
    email: undefined
};

let displayName = user.name ?? "Anonymous";
let displayAge = user.age ?? "Not specified";
let displayEmail = user.email ?? "No email";

console.log(displayName);   // "Alice"
console.log(displayAge);     // "Not specified"
console.log(displayEmail);   // "No email"
```

**Chaining:**
```javascript
let value = null;
let result = value ?? getDefault() ?? "fallback";
console.log(result);  // result of getDefault() or "fallback"
```

### When to Use ??

**Use `??` when:**
- You want to preserve falsy values (0, "", false)
- You only care about null/undefined
- Setting default values for optional properties

**Use `||` when:**
- You want to replace any falsy value
- Working with boolean logic
- Legacy code compatibility

```javascript
// ✅ Use ?? for numeric defaults
let count = userCount ?? 0;  // Preserves 0 if userCount is 0

// ✅ Use ?? for string defaults
let name = userName ?? "";  // Preserves "" if userName is ""

// ✅ Use || for boolean logic
let isActive = user.isActive || false;  // Converts truthy to true
```

---

## Optional Chaining (?.)

The optional chaining operator (`?.`) allows safe access to nested object properties and methods, returning `undefined` if any part of the chain is `null` or `undefined`.

### Property Access

```javascript
let user = {
    name: "Alice",
    address: {
        city: "New York"
    }
};

// Without optional chaining (can throw error)
let city1 = user.address.city;  // Works
// let city2 = user.address.street.name;  // Error if street is undefined

// With optional chaining (safe)
let city3 = user.address?.city;  // "New York"
let street = user.address?.street?.name;  // undefined (no error)
```

### Method Calls

```javascript
let user = {
    name: "Alice",
    greet: function() {
        return `Hello, ${this.name}`;
    }
};

// Safe method call
let greeting = user.greet?.();  // "Hello, Alice"

let user2 = null;
let greeting2 = user2.greet?.();  // undefined (no error)
```

### Array Access

```javascript
let users = [
    { name: "Alice" },
    { name: "Bob" }
];

// Safe array access
let firstName = users?.[0]?.name;  // "Alice"
let invalid = users?.[10]?.name;  // undefined (no error)

let emptyArray = null;
let item = emptyArray?.[0];  // undefined (no error)
```

### Combining with Nullish Coalescing

```javascript
let user = {
    profile: {
        name: "Alice"
    }
};

// Safe access with default
let name = user?.profile?.name ?? "Guest";
console.log(name);  // "Alice"

let user2 = null;
let name2 = user2?.profile?.name ?? "Guest";
console.log(name2);  // "Guest"
```

### Practical Examples

**API Responses:**
```javascript
let response = {
    data: {
        user: {
            name: "Alice",
            email: "alice@example.com"
        }
    }
};

// Safe access
let userName = response?.data?.user?.name ?? "Unknown";
let userEmail = response?.data?.user?.email ?? "No email";

// If response structure is different
let userName2 = response?.data?.users?.[0]?.name ?? "Unknown";
```

**DOM Manipulation:**
```javascript
// Safe DOM access
let element = document.querySelector(".my-element");
let text = element?.textContent ?? "Not found";

// Method calls
element?.addEventListener("click", handleClick);
element?.classList?.add("active");
```

**Function Calls:**
```javascript
let obj = {
    method: function() {
        return "result";
    }
};

// Safe method call
let result = obj.method?.();  // "result"

let obj2 = {};
let result2 = obj2.method?.();  // undefined (no error)
```

### When to Use Optional Chaining

**Use `?.` when:**
- Accessing nested properties that might not exist
- Working with API responses with uncertain structure
- Accessing DOM elements that might be null
- Calling methods that might not exist

**Benefits:**
- Prevents errors from null/undefined
- Cleaner code than multiple if checks
- Works well with nullish coalescing

```javascript
// Without optional chaining (verbose)
let city;
if (user && user.address && user.address.city) {
    city = user.address.city;
} else {
    city = "Unknown";
}

// With optional chaining (concise)
let city = user?.address?.city ?? "Unknown";
```

---

## Combining Operators

You can combine these operators for powerful, concise code.

### Examples

```javascript
// Augmented assignment with calculation
let total = 0;
total += 10;
total += 20;
total *= 1.1;  // Add 10%
console.log(total);  // 33

// Ternary with assignment
let age = 20;
let canVote = age >= 18 ? true : false;
let status = age >= 18 ? "Adult" : "Minor";

// Optional chaining with nullish coalescing
let user = getUser();
let name = user?.profile?.name ?? "Guest";
let email = user?.contact?.email ?? "No email";

// Complex expression
let result = (x ?? 0) + (y ?? 0);
let display = user?.name ?? config?.defaultName ?? "Anonymous";
```

### Real-World Example

```javascript
// User profile with safe defaults
let user = getUserFromAPI();

let profile = {
    name: user?.name ?? "Guest",
    age: user?.age ?? 0,
    email: user?.contact?.email ?? "No email",
    city: user?.address?.city ?? "Unknown",
    isPremium: user?.subscription?.type === "premium"
};

// Update counters
let viewCount = 0;
viewCount += 1;
viewCount *= 1.1;  // Add 10% bonus

// Conditional assignment
let discount = user?.isPremium ? 0.2 : 0.1;
let finalPrice = price * (1 - discount);
```

---

## Practice Exercise

### Exercise: Using Operators

**Objective**: Write a program that demonstrates all assignment and other operators.

**Instructions**:

1. Create a file called `operators-practice.js`

2. Use augmented assignment operators:
   - Start with a value and modify it using +=, -=, *=, /=

3. Use ternary operator:
   - Determine status based on conditions
   - Assign values conditionally

4. Use nullish coalescing:
   - Set default values for potentially null/undefined variables
   - Handle API-like data structures

5. Use optional chaining:
   - Safely access nested object properties
   - Handle potentially missing properties

6. Combine operators:
   - Create complex expressions using multiple operators

**Example Solution**:

```javascript
// Operators Practice
console.log("=== Augmented Assignment ===");
let total = 100;
console.log(`Initial: ${total}`);

total += 50;  // Add 50
console.log(`After += 50: ${total}`);  // 150

total -= 25;  // Subtract 25
console.log(`After -= 25: ${total}`);  // 125

total *= 2;   // Multiply by 2
console.log(`After *= 2: ${total}`);   // 250

total /= 5;   // Divide by 5
console.log(`After /= 5: ${total}`);   // 50

total %= 7;   // Modulo 7
console.log(`After %= 7: ${total}`);   // 1
console.log();

console.log("=== Ternary Operator ===");
let age = 20;
let status = age >= 18 ? "Adult" : "Minor";
console.log(`Age ${age}: ${status}`);  // "Adult"

let score = 85;
let grade = score >= 90 ? "A" : score >= 80 ? "B" : "C";
console.log(`Score ${score}: Grade ${grade}`);  // "B"

let isLoggedIn = true;
let message = isLoggedIn ? "Welcome back!" : "Please log in";
console.log(message);  // "Welcome back!"
console.log();

console.log("=== Nullish Coalescing ===");
let userName = null;
let displayName = userName ?? "Guest";
console.log(`User: ${displayName}`);  // "Guest"

let count = 0;
let result = count ?? 10;
console.log(`Count: ${result}`);  // 0 (preserved, not replaced)

let value = undefined;
let defaultValue = value ?? "Not set";
console.log(`Value: ${defaultValue}`);  // "Not set"

// With function
function getConfig() {
    return null;
}
let config = getConfig() ?? { port: 3000, theme: "light" };
console.log(`Config:`, config);
console.log();

console.log("=== Optional Chaining ===");
let user = {
    name: "Alice",
    profile: {
        age: 25,
        email: "alice@example.com"
    }
};

let name = user?.name ?? "Unknown";
let age = user?.profile?.age ?? 0;
let email = user?.profile?.email ?? "No email";
let city = user?.profile?.city ?? "Not specified";

console.log(`Name: ${name}`);
console.log(`Age: ${age}`);
console.log(`Email: ${email}`);
console.log(`City: ${city}`);

// Safe method call
let user2 = {
    greet: function() {
        return "Hello!";
    }
};
let greeting = user2.greet?.() ?? "No greeting";
console.log(`Greeting: ${greeting}`);  // "Hello!"

let user3 = null;
let greeting2 = user3.greet?.() ?? "No greeting";
console.log(`Greeting: ${greeting2}`);  // "No greeting"
console.log();

console.log("=== Combining Operators ===");
let data = {
    user: {
        profile: {
            name: "Bob",
            score: 85
        }
    }
};

// Complex expression
let finalScore = (data?.user?.profile?.score ?? 0) + 10;
let finalGrade = finalScore >= 90 ? "A" : finalScore >= 80 ? "B" : "C";

console.log(`Score: ${finalScore}`);
console.log(`Grade: ${finalGrade}`);

// Accumulator with conditions
let points = 0;
points += data?.user?.profile?.score ?? 0;
points *= 1.1;  // 10% bonus
console.log(`Final Points: ${points}`);

// Conditional assignment with defaults
let settings = {
    theme: null,
    language: "en"
};

let theme = settings?.theme ?? "light";
let language = settings?.language ?? "en";
let fontSize = settings?.fontSize ?? 16;

console.log(`Theme: ${theme}`);
console.log(`Language: ${language}`);
console.log(`Font Size: ${fontSize}`);
```

**Expected Output**:
```
=== Augmented Assignment ===
Initial: 100
After += 50: 150
After -= 25: 125
After *= 2: 250
After /= 5: 50
After %= 7: 1

=== Ternary Operator ===
Age 20: Adult
Score 85: Grade B
Welcome back!

=== Nullish Coalescing ===
User: Guest
Count: 0
Value: Not set
Config: { port: 3000, theme: ''light'' }

=== Optional Chaining ===
Name: Alice
Age: 25
Email: alice@example.com
City: Not specified
Greeting: Hello!
Greeting: No greeting

=== Combining Operators ===
Score: 95
Grade: A
Final Points: 104.5
Theme: light
Language: en
Font Size: 16
```

**Challenge (Optional)**:
- Create a shopping cart calculator using augmented assignment
- Build a user profile system with optional chaining and nullish coalescing
- Create a grading system using ternary operators
- Build a configuration manager with all operators

---

## Common Mistakes

### 1. Confusing = with == or ===

```javascript
// ❌ Wrong (assignment, not comparison)
if (x = 5) { }  // Always true, assigns 5 to x

// ✅ Correct
if (x === 5) { }  // Compares x with 5
```

### 2. Using || Instead of ??

```javascript
// ❌ Might not preserve 0 or ""
let count = userCount || 0;  // Loses 0 if userCount is 0

// ✅ Preserves falsy values
let count = userCount ?? 0;  // Keeps 0 if userCount is 0
```

### 3. Forgetting Optional Chaining

```javascript
// ❌ Can throw error
let city = user.address.city;  // Error if address is undefined

// ✅ Safe access
let city = user?.address?.city ?? "Unknown";
```

### 4. Overusing Ternary

```javascript
// ❌ Too complex
let result = a > b ? (c > d ? e : f) : (g > h ? i : j);

// ✅ More readable
let result;
if (a > b) {
    result = c > d ? e : f;
} else {
    result = g > h ? i : j;
}
```

### 5. Wrong Operator Precedence

```javascript
// ⚠️ Be careful with precedence
let x = 5;
let y = x += 3;  // x is 8, y is 8 (assignment returns value)

// Clearer
let x = 5;
x += 3;
let y = x;
```

---

## Key Takeaways

1. **Assignment (=)**: Assigns values to variables
2. **Augmented Assignment**: Shorthand for `x = x op y` (e.g., `x += 5`)
3. **Ternary (?:)**: Concise conditional expression
4. **Nullish Coalescing (??)**: Default values for null/undefined only
5. **Optional Chaining (?.)**: Safe access to nested properties
6. **Combine Operators**: Use together for powerful, concise code
7. **Best Practice**: Use `??` for defaults, `?.` for safe access, ternary for simple conditions

---

## Quiz: Assignment Operations

Test your understanding with these questions:

1. **What is the result of `let x = 5; x += 3;` (x = ?)**
   - A) 5
   - B) 8
   - C) 15
   - D) Error

2. **What is the result of `let x = 5; let y = x += 3;` (y = ?)**
   - A) 5
   - B) 8
   - C) 3
   - D) undefined

3. **What is the result of `5 > 3 ? "Yes" : "No"`?**
   - A) true
   - B) false
   - C) "Yes"
   - D) "No"

4. **What is the result of `null ?? "default"`?**
   - A) null
   - B) "default"
   - C) undefined
   - D) Error

5. **What is the result of `0 ?? "default"`?**
   - A) 0
   - B) "default"
   - C) undefined
   - D) false

6. **What is the result of `user?.profile?.name` if user is null?**
   - A) null
   - B) undefined
   - C) Error
   - D) ""

7. **Which operator should you use for default values when you want to preserve 0 and ""?**
   - A) ||
   - B) ??
   - C) ?.
   - D) :

**Answers**:
1. B) 8
2. B) 8 (assignment returns the assigned value)
3. C) "Yes" (ternary returns value based on condition)
4. B) "default" (null triggers nullish coalescing)
5. A) 0 (0 is not null/undefined, so it''s preserved)
6. B) undefined (optional chaining returns undefined for null)
7. B) ?? (nullish coalescing preserves falsy values except null/undefined)

---

## Next Steps

Congratulations! You''ve learned assignment and other operators. You now know:
- How to use augmented assignment operators
- How to write conditional expressions with ternary
- How to set defaults with nullish coalescing
- How to safely access properties with optional chaining

**What''s Next?**
- Module 3: Control Flow
- Lesson 3.1: Conditional Statements
- Practice combining all operators
- Build more complex programs

---

## Additional Resources

- **MDN: Assignment Operators**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#assignment_operators](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Expressions_and_Operators#assignment_operators)
- **MDN: Conditional (Ternary) Operator**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Conditional_Operator)
- **MDN: Nullish Coalescing**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Nullish_coalescing)
- **MDN: Optional Chaining**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining)
- **JavaScript.info: Operators**: [javascript.info/operators](https://javascript.info/operators)

---

*Lesson completed! You''ve finished Module 2. Ready for Module 3: Control Flow!*

', NULL, 3, '2026-01-03 09:11:26', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use the assignment operator (=)
- Apply augmented assignment operators (+=, -=, *=, /=, %=, **=)
- Use the ternary operator (?:) for conditional expressions
- Understand nullish coalescing (??) for default values
- Use optional chaining (?.) for safe property access
- Combine these operators effectively in your code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (114, 43, 10, 'Conditional Statements', 'conditional-statements', '# Lesson 3.1: Conditional Statements

## Learning Objectives

By the end of this lesson, you will be able to:
- Use if, else, and else if statements to make decisions
- Understand truthy and falsy values in JavaScript
- Use switch statements for multiple conditions
- Write nested conditional statements
- Apply conditional logic to solve real-world problems

---

## Introduction to Conditional Statements

Conditional statements allow your program to make decisions and execute different code based on conditions. They are fundamental to programming and enable your code to respond dynamically to different situations.

### Why Conditional Statements?

- Make decisions based on user input
- Handle different scenarios
- Validate data
- Control program flow
- Create interactive applications

---

## if Statement

The `if` statement executes a block of code only if a condition is true.

### Basic Syntax

```javascript
if (condition) {
    // Code to execute if condition is true
}
```

### Simple Example

```javascript
let age = 20;

if (age >= 18) {
    console.log("You are an adult");
}
// Output: "You are an adult"
```

### Multiple Statements

```javascript
let score = 85;

if (score >= 80) {
    console.log("Great job!");
    console.log("You passed the exam");
    console.log("Your grade is B or higher");
}
```

### Real-World Examples

```javascript
// Check if user is logged in
let isLoggedIn = true;

if (isLoggedIn) {
    console.log("Welcome back!");
    showDashboard();
}

// Check if number is positive
let number = 5;

if (number > 0) {
    console.log("Number is positive");
}

// Check if string is not empty
let name = "Alice";

if (name.length > 0) {
    console.log(`Hello, ${name}!`);
}
```

---

## else Statement

The `else` statement provides an alternative code block that executes when the condition is false.

### Basic Syntax

```javascript
if (condition) {
    // Code if condition is true
} else {
    // Code if condition is false
}
```

### Example

```javascript
let age = 15;

if (age >= 18) {
    console.log("You are an adult");
} else {
    console.log("You are a minor");
}
// Output: "You are a minor"
```

### More Examples

```javascript
// Even or odd
let number = 7;

if (number % 2 === 0) {
    console.log("Even");
} else {
    console.log("Odd");
}
// Output: "Odd"

// Login check
let isLoggedIn = false;

if (isLoggedIn) {
    console.log("Welcome!");
} else {
    console.log("Please log in");
}
// Output: "Please log in"

// Temperature check
let temperature = 25;

if (temperature > 20) {
    console.log("It''s warm");
} else {
    console.log("It''s cold");
}
// Output: "It''s warm"
```

---

## else if Statement

The `else if` statement allows you to check multiple conditions in sequence.

### Basic Syntax

```javascript
if (condition1) {
    // Code if condition1 is true
} else if (condition2) {
    // Code if condition2 is true
} else if (condition3) {
    // Code if condition3 is true
} else {
    // Code if all conditions are false
}
```

### Example: Grade System

```javascript
let score = 85;

if (score >= 90) {
    console.log("Grade A");
} else if (score >= 80) {
    console.log("Grade B");
} else if (score >= 70) {
    console.log("Grade C");
} else if (score >= 60) {
    console.log("Grade D");
} else {
    console.log("Grade F");
}
// Output: "Grade B"
```

### Multiple Conditions

```javascript
// Age categories
let age = 25;

if (age < 13) {
    console.log("Child");
} else if (age < 20) {
    console.log("Teenager");
} else if (age < 65) {
    console.log("Adult");
} else {
    console.log("Senior");
}
// Output: "Adult"

// Temperature ranges
let temp = 15;

if (temp > 30) {
    console.log("Hot");
} else if (temp > 20) {
    console.log("Warm");
} else if (temp > 10) {
    console.log("Cool");
} else {
    console.log("Cold");
}
// Output: "Cool"
```

### Important Notes

- Conditions are checked in order
- Only the first true condition executes
- Once a condition is true, remaining conditions are skipped

```javascript
let score = 95;

if (score >= 90) {
    console.log("A");  // This executes
} else if (score >= 80) {
    console.log("B");  // Skipped (already found match)
} else {
    console.log("C");  // Skipped
}
// Output: "A"
```

---

## Nested if Statements

You can nest if statements inside other if statements for complex logic.

### Basic Nested Structure

```javascript
if (condition1) {
    if (condition2) {
        // Code if both conditions are true
    }
}
```

### Example: Login and Permission Check

```javascript
let isLoggedIn = true;
let isAdmin = true;

if (isLoggedIn) {
    console.log("User is logged in");
    
    if (isAdmin) {
        console.log("Admin access granted");
        showAdminPanel();
    } else {
        console.log("Regular user access");
        showUserPanel();
    }
} else {
    console.log("Please log in");
}
```

### Example: Age and License Check

```javascript
let age = 20;
let hasLicense = true;

if (age >= 18) {
    console.log("Age requirement met");
    
    if (hasLicense) {
        console.log("Can drive");
    } else {
        console.log("Need a license");
    }
} else {
    console.log("Too young to drive");
}
```

### Complex Nested Example

```javascript
let user = {
    age: 25,
    hasLicense: true,
    hasInsurance: false
};

if (user.age >= 18) {
    if (user.hasLicense) {
        if (user.hasInsurance) {
            console.log("Can drive legally");
        } else {
            console.log("Need insurance");
        }
    } else {
        console.log("Need a license");
    }
} else {
    console.log("Too young");
}
```

### Best Practices for Nesting

**Avoid Deep Nesting:**
```javascript
// ❌ Too nested (hard to read)
if (condition1) {
    if (condition2) {
        if (condition3) {
            if (condition4) {
                // Code
            }
        }
    }
}

// ✅ Better (use else if or early returns)
if (!condition1) {
    return;
}
if (!condition2) {
    return;
}
if (!condition3) {
    return;
}
// Code here
```

---

## Truthy and Falsy Values

JavaScript uses truthy and falsy values in conditional statements. Understanding these is crucial for writing correct conditions.

### Falsy Values

These values evaluate to `false` in boolean context:

1. `false` - Boolean false
2. `0` - Number zero
3. `-0` - Negative zero
4. `0n` - BigInt zero
5. `""` - Empty string
6. `null` - Null value
7. `undefined` - Undefined value
8. `NaN` - Not a Number

```javascript
if (false) { }      // Falsy
if (0) { }          // Falsy
if (-0) { }         // Falsy
if (0n) { }         // Falsy
if ("") { }         // Falsy
if (null) { }       // Falsy
if (undefined) { }  // Falsy
if (NaN) { }        // Falsy
```

### Truthy Values

Everything else is truthy, including:

```javascript
if (true) { }           // Truthy
if (1) { }              // Truthy
if (-1) { }             // Truthy
if ("hello") { }        // Truthy
if ("0") { }            // Truthy (string)
if ("false") { }        // Truthy (string)
if ([]) { }             // Truthy (empty array)
if ({}) { }             // Truthy (empty object)
if (function() {}) { }  // Truthy
```

### Practical Examples

```javascript
// Check if variable exists
let name = "Alice";

if (name) {  // Truthy if name is not empty string
    console.log(`Hello, ${name}!`);
} else {
    console.log("No name provided");
}

// Check if array has items
let items = [1, 2, 3];

if (items.length) {  // Truthy if length > 0
    console.log("Array has items");
} else {
    console.log("Array is empty");
}

// Check if object property exists
let user = {
    name: "Alice"
};

if (user.name) {  // Truthy if name exists and is not empty
    console.log(user.name);
} else {
    console.log("No name");
}
```

### Common Pitfalls

```javascript
// ⚠️ Empty array is truthy!
let arr = [];
if (arr) {
    console.log("Array exists");  // This runs (array is truthy)
}

// ✅ Check length instead
if (arr.length > 0) {
    console.log("Array has items");
} else {
    console.log("Array is empty");
}

// ⚠️ String "0" is truthy!
let value = "0";
if (value) {
    console.log("Has value");  // This runs
}

// ✅ Explicit check
if (value !== "" && value !== null) {
    console.log("Has value");
}
```

### Explicit Boolean Conversion

```javascript
// Convert to boolean explicitly
let value = "hello";
if (Boolean(value)) { }  // Explicit
if (!!value) { }         // Double negation (common pattern)

// Check for specific values
let name = "";
if (name !== "" && name !== null && name !== undefined) {
    console.log(name);
}

// Or use nullish coalescing
let name2 = "";
let displayName = name2 || "Guest";
```

---

## Switch Statement

The `switch` statement provides an alternative to multiple `else if` statements when comparing one value against multiple options.

### Basic Syntax

```javascript
switch (expression) {
    case value1:
        // Code for value1
        break;
    case value2:
        // Code for value2
        break;
    default:
        // Code if no match
}
```

### Simple Example

```javascript
let day = "Monday";

switch (day) {
    case "Monday":
        console.log("Start of work week");
        break;
    case "Friday":
        console.log("TGIF!");
        break;
    case "Saturday":
    case "Sunday":
        console.log("Weekend!");
        break;
    default:
        console.log("Regular day");
}
// Output: "Start of work week"
```

### Grade System with Switch

```javascript
let grade = "B";

switch (grade) {
    case "A":
        console.log("Excellent!");
        break;
    case "B":
        console.log("Good job!");
        break;
    case "C":
        console.log("Average");
        break;
    case "D":
        console.log("Needs improvement");
        break;
    case "F":
        console.log("Failed");
        break;
    default:
        console.log("Invalid grade");
}
// Output: "Good job!"
```

### The break Statement

**Without break (fall-through):**
```javascript
let day = "Monday";

switch (day) {
    case "Monday":
        console.log("Monday");
        // No break - falls through!
    case "Tuesday":
        console.log("Tuesday");
        break;
}
// Output: "Monday" and "Tuesday"
```

**With break (stops execution):**
```javascript
let day = "Monday";

switch (day) {
    case "Monday":
        console.log("Monday");
        break;  // Stops here
    case "Tuesday":
        console.log("Tuesday");
        break;
}
// Output: "Monday" only
```

### Multiple Cases (Fall-Through)

You can have multiple cases execute the same code:

```javascript
let day = "Saturday";

switch (day) {
    case "Monday":
    case "Tuesday":
    case "Wednesday":
    case "Thursday":
    case "Friday":
        console.log("Weekday");
        break;
    case "Saturday":
    case "Sunday":
        console.log("Weekend");
        break;
    default:
        console.log("Invalid day");
}
// Output: "Weekend"
```

### Switch with Numbers

```javascript
let month = 3;

switch (month) {
    case 1:
        console.log("January");
        break;
    case 2:
        console.log("February");
        break;
    case 3:
        console.log("March");
        break;
    // ... more cases
    default:
        console.log("Invalid month");
}
// Output: "March"
```

### Switch vs if-else

**When to use switch:**
- Comparing one value against multiple options
- Clear, discrete values
- More readable for many conditions

**When to use if-else:**
- Complex conditions (>, <, >=, etc.)
- Multiple variables
- Range checks
- Boolean logic

```javascript
// ✅ Good for switch
let status = "active";
switch (status) {
    case "active":
    case "pending":
    case "inactive":
        // Handle
}

// ✅ Better with if-else
let score = 85;
if (score >= 90) {
    // A
} else if (score >= 80) {
    // B
} else if (score >= 70) {
    // C
}
```

### Default Case

The `default` case executes when no other case matches:

```javascript
let status = "unknown";

switch (status) {
    case "active":
        console.log("Active");
        break;
    case "inactive":
        console.log("Inactive");
        break;
    default:
        console.log("Unknown status");
}
// Output: "Unknown status"
```

---

## Combining Conditions

You can combine multiple conditions using logical operators.

### AND (&&)

```javascript
let age = 25;
let hasLicense = true;

if (age >= 18 && hasLicense) {
    console.log("Can drive");
} else {
    console.log("Cannot drive");
}
```

### OR (||)

```javascript
let isWeekend = false;
let isHoliday = true;

if (isWeekend || isHoliday) {
    console.log("No work today");
} else {
    console.log("Work day");
}
```

### NOT (!)

```javascript
let isLoggedIn = false;

if (!isLoggedIn) {
    console.log("Please log in");
} else {
    console.log("Welcome!");
}
```

### Complex Conditions

```javascript
let age = 25;
let hasLicense = true;
let hasInsurance = true;

if (age >= 18 && hasLicense && hasInsurance) {
    console.log("Can drive legally");
} else if (age >= 18 && hasLicense) {
    console.log("Need insurance");
} else if (age >= 18) {
    console.log("Need license");
} else {
    console.log("Too young");
}
```

---

## Practice Exercise

### Exercise: Building Decision Logic

**Objective**: Create a program that uses conditional statements to make various decisions.

**Instructions**:

1. Create a file called `conditional-practice.js`

2. Create a user profile with:
   - Age
   - Is student (boolean)
   - Has membership (boolean)
   - Score/grade

3. Write conditional logic for:
   - Age category (child, teenager, adult, senior)
   - Discount eligibility (student or member)
   - Grade determination (A, B, C, D, F)
   - Access level (admin, member, guest)
   - Day of week activities (using switch)

4. Use if-else, else if, switch, and nested conditions

**Example Solution**:

```javascript
// Conditional Logic Practice
console.log("=== User Profile ===");
let user = {
    age: 22,
    isStudent: true,
    hasMembership: false,
    score: 85,
    role: "member",
    day: "Saturday"
};

console.log(`Age: ${user.age}`);
console.log(`Student: ${user.isStudent}`);
console.log(`Member: ${user.hasMembership}`);
console.log(`Score: ${user.score}`);
console.log(`Role: ${user.role}`);
console.log(`Day: ${user.day}`);
console.log();

// Age Category
console.log("=== Age Category ===");
if (user.age < 13) {
    console.log("Child");
} else if (user.age < 20) {
    console.log("Teenager");
} else if (user.age < 65) {
    console.log("Adult");
} else {
    console.log("Senior");
}
console.log();

// Discount Eligibility
console.log("=== Discount Eligibility ===");
if (user.isStudent || user.hasMembership) {
    let discount = 0;
    if (user.isStudent && user.hasMembership) {
        discount = 25;  // Both
    } else if (user.isStudent) {
        discount = 15;  // Student only
    } else {
        discount = 10;  // Member only
    }
    console.log(`You qualify for a ${discount}% discount!`);
} else {
    console.log("No discount available");
}
console.log();

// Grade Determination
console.log("=== Grade Determination ===");
if (user.score >= 90) {
    console.log("Grade: A (Excellent)");
} else if (user.score >= 80) {
    console.log("Grade: B (Good)");
} else if (user.score >= 70) {
    console.log("Grade: C (Average)");
} else if (user.score >= 60) {
    console.log("Grade: D (Needs Improvement)");
} else {
    console.log("Grade: F (Failed)");
}
console.log();

// Access Level
console.log("=== Access Level ===");
if (user.role === "admin") {
    console.log("Full admin access");
    console.log("Can manage users");
    console.log("Can modify settings");
} else if (user.role === "member") {
    console.log("Member access");
    console.log("Can view content");
    console.log("Can post comments");
} else {
    console.log("Guest access");
    console.log("Limited content viewing");
}
console.log();

// Day Activities (Switch)
console.log("=== Day Activities ===");
switch (user.day) {
    case "Monday":
        console.log("Start of work week");
        console.log("Team meeting at 10 AM");
        break;
    case "Tuesday":
    case "Wednesday":
    case "Thursday":
        console.log("Regular work day");
        break;
    case "Friday":
        console.log("TGIF! End of work week");
        break;
    case "Saturday":
    case "Sunday":
        console.log("Weekend! Time to relax");
        break;
    default:
        console.log("Invalid day");
}
console.log();

// Complex Nested Condition
console.log("=== Complex Condition ===");
if (user.age >= 18) {
    if (user.isStudent) {
        if (user.score >= 80) {
            console.log("Eligible for scholarship");
        } else {
            console.log("Maintain good grades for scholarship");
        }
    } else {
        console.log("Not a student");
    }
} else {
    console.log("Too young");
}
console.log();

// Truthy/Falsy Examples
console.log("=== Truthy/Falsy Examples ===");
let values = [0, "", null, undefined, false, "hello", 42, [], {}];

values.forEach(value => {
    if (value) {
        console.log(`${JSON.stringify(value)} is truthy`);
    } else {
        console.log(`${JSON.stringify(value)} is falsy`);
    }
});
```

**Expected Output**:
```
=== User Profile ===
Age: 22
Student: true
Member: false
Score: 85
Role: member
Day: Saturday

=== Age Category ===
Adult

=== Discount Eligibility ===
You qualify for a 15% discount!

=== Grade Determination ===
Grade: B (Good)

=== Access Level ===
Member access
Can view content
Can post comments

=== Day Activities ===
Weekend! Time to relax

=== Complex Condition ===
Eligible for scholarship

=== Truthy/Falsy Examples ===
0 is falsy
"" is falsy
null is falsy
undefined is falsy
false is falsy
"hello" is truthy
42 is truthy
[] is truthy
{} is truthy
```

**Challenge (Optional)**:
- Create a weather-based activity planner
- Build a menu system with switch
- Create a permission system with nested conditions
- Add input validation with conditionals

---

## Common Mistakes

### 1. Using = Instead of ===

```javascript
// ❌ Wrong (assignment, not comparison)
if (x = 5) { }

// ✅ Correct
if (x === 5) { }
```

### 2. Missing break in Switch

```javascript
// ❌ Falls through
switch (day) {
    case "Monday":
        console.log("Monday");
        // Missing break!
    case "Tuesday":
        console.log("Tuesday");
}

// ✅ With break
switch (day) {
    case "Monday":
        console.log("Monday");
        break;
    case "Tuesday":
        console.log("Tuesday");
        break;
}
```

### 3. Truthy/Falsy Confusion

```javascript
// ⚠️ Empty array is truthy!
let arr = [];
if (arr) {
    console.log("Has items");  // Wrong! Array is empty
}

// ✅ Check length
if (arr.length > 0) {
    console.log("Has items");
}
```

### 4. Incorrect else if Order

```javascript
// ❌ Wrong order
if (score >= 60) {
    console.log("D");
} else if (score >= 90) {  // Never reached!
    console.log("A");
}

// ✅ Correct order
if (score >= 90) {
    console.log("A");
} else if (score >= 60) {
    console.log("D");
}
```

### 5. Forgetting Default Case

```javascript
// ⚠️ No handling for unexpected values
switch (status) {
    case "active":
        // Handle
    case "inactive":
        // Handle
    // What if status is "pending"?
}

// ✅ With default
switch (status) {
    case "active":
        // Handle
    case "inactive":
        // Handle
    default:
        console.log("Unknown status");
}
```

---

## Key Takeaways

1. **if Statement**: Executes code when condition is true
2. **else Statement**: Provides alternative when condition is false
3. **else if**: Checks multiple conditions in sequence
4. **Nested if**: if statements inside other if statements
5. **Switch**: Alternative to multiple else if for discrete values
6. **Truthy/Falsy**: Understand which values evaluate to true/false
7. **break**: Essential in switch to prevent fall-through
8. **Best Practice**: Use switch for discrete values, if-else for ranges

---

## Quiz: Conditionals

Test your understanding with these questions:

1. **What is the output of: `if (0) { console.log("Yes"); } else { console.log("No"); }`?**
   - A) "Yes"
   - B) "No"
   - C) Error
   - D) Nothing

2. **What happens if you forget `break` in a switch case?**
   - A) Error
   - B) Code stops executing
   - C) Code falls through to next case
   - D) Nothing

3. **Which is falsy in JavaScript?**
   - A) "0"
   - B) []
   - C) {}
   - D) ""

4. **How many `else if` statements can you have?**
   - A) 1
   - B) 2
   - C) Unlimited
   - D) 10

5. **What is the purpose of the `default` case in switch?**
   - A) Required syntax
   - B) Handles unmatched values
   - C) Always executes
   - D) Error handling

6. **Which evaluates to true?**
   - A) `if (0)`
   - B) `if ("")`
   - C) `if ([])`
   - D) `if (null)`

7. **When should you use switch instead of if-else?**
   - A) Always
   - B) For range checks
   - C) For discrete value comparisons
   - D) Never

**Answers**:
1. B) "No" (0 is falsy)
2. C) Code falls through to next case
3. D) "" (empty string is falsy)
4. C) Unlimited
5. B) Handles unmatched values
6. C) `if ([])` (empty array is truthy)
7. C) For discrete value comparisons

---

## Next Steps

Congratulations! You''ve learned conditional statements. You now know:
- How to use if, else, and else if
- How to use switch statements
- Understanding of truthy and falsy values
- How to write nested conditions

**What''s Next?**
- Lesson 3.2: Loops
- Practice building more complex conditional logic
- Experiment with switch statements
- Combine conditions with logical operators

---

## Additional Resources

- **MDN: if...else**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/if...else](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/if...else)
- **MDN: switch**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/switch)
- **JavaScript.info: Conditional Branching**: [javascript.info/ifelse](https://javascript.info/ifelse)
- **JavaScript.info: Switch**: [javascript.info/switch](https://javascript.info/switch)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:13:00', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use if, else, and else if statements to make decisions
- Understand truthy and falsy values in JavaScript
- Use switch statements for multiple conditions
- Write nested conditional statements
- Apply conditional logic to solve real-world problems');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (115, 43, 10, 'Loops', 'loops', '# Lesson 3.2: Loops

## Learning Objectives

By the end of this lesson, you will be able to:
- Use for loops to iterate a specific number of times
- Use while loops for condition-based iteration
- Use do...while loops for guaranteed execution
- Iterate over objects with for...in loops
- Iterate over iterables with for...of loops
- Control loop execution with break and continue
- Create and understand nested loops
- Choose the right loop for different scenarios

---

## Introduction to Loops

Loops allow you to execute a block of code repeatedly. They are essential for:
- Processing arrays and collections
- Repeating actions
- Iterating through data
- Automating repetitive tasks

---

## for Loop

The `for` loop is used when you know how many times you want to iterate.

### Basic Syntax

```javascript
for (initialization; condition; increment) {
    // Code to execute
}
```

### Simple Example

```javascript
for (let i = 0; i < 5; i++) {
    console.log(i);
}
// Output: 0, 1, 2, 3, 4
```

### How It Works

1. **Initialization**: `let i = 0` - Runs once at the start
2. **Condition**: `i < 5` - Checked before each iteration
3. **Code Block**: Executes if condition is true
4. **Increment**: `i++` - Runs after each iteration
5. **Repeat**: Go back to step 2

### Common Patterns

**Count from 0 to n-1:**
```javascript
for (let i = 0; i < 5; i++) {
    console.log(i);
}
// 0, 1, 2, 3, 4
```

**Count from 1 to n:**
```javascript
for (let i = 1; i <= 5; i++) {
    console.log(i);
}
// 1, 2, 3, 4, 5
```

**Count backwards:**
```javascript
for (let i = 5; i > 0; i--) {
    console.log(i);
}
// 5, 4, 3, 2, 1
```

**Count by steps:**
```javascript
for (let i = 0; i < 10; i += 2) {
    console.log(i);
}
// 0, 2, 4, 6, 8
```

### Iterating Over Arrays

```javascript
let fruits = ["apple", "banana", "orange"];

for (let i = 0; i < fruits.length; i++) {
    console.log(fruits[i]);
}
// Output: apple, banana, orange
```

### Practical Examples

**Sum numbers:**
```javascript
let sum = 0;
for (let i = 1; i <= 10; i++) {
    sum += i;
}
console.log(sum);  // 55
```

**Build a string:**
```javascript
let result = "";
for (let i = 0; i < 5; i++) {
    result += "*";
}
console.log(result);  // "*****"
```

**Calculate factorial:**
```javascript
let n = 5;
let factorial = 1;
for (let i = 1; i <= n; i++) {
    factorial *= i;
}
console.log(factorial);  // 120
```

---

## while Loop

The `while` loop continues as long as a condition is true.

### Basic Syntax

```javascript
while (condition) {
    // Code to execute
}
```

### Simple Example

```javascript
let i = 0;
while (i < 5) {
    console.log(i);
    i++;
}
// Output: 0, 1, 2, 3, 4
```

### When to Use while

- When you don''t know how many iterations
- When condition depends on external factors
- When you need to check condition before each iteration

### Examples

**Countdown:**
```javascript
let countdown = 5;
while (countdown > 0) {
    console.log(countdown);
    countdown--;
}
console.log("Blast off!");
// Output: 5, 4, 3, 2, 1, "Blast off!"
```

**User input simulation:**
```javascript
let userInput = "";
while (userInput !== "quit") {
    // Simulate getting input
    userInput = getUserInput();
    processInput(userInput);
}
```

**Processing until condition:**
```javascript
let total = 0;
let number = 1;
while (total < 100) {
    total += number;
    number++;
}
console.log(total);  // First sum >= 100
```

### Infinite Loops Warning

**⚠️ Be careful - this creates an infinite loop:**
```javascript
// ❌ Infinite loop!
let i = 0;
while (i < 5) {
    console.log(i);
    // Forgot to increment i!
}
```

**✅ Always ensure condition becomes false:**
```javascript
let i = 0;
while (i < 5) {
    console.log(i);
    i++;  // Increment to avoid infinite loop
}
```

---

## do...while Loop

The `do...while` loop executes the code block at least once, then checks the condition.

### Basic Syntax

```javascript
do {
    // Code to execute
} while (condition);
```

### Simple Example

```javascript
let i = 0;
do {
    console.log(i);
    i++;
} while (i < 5);
// Output: 0, 1, 2, 3, 4
```

### Key Difference from while

**while** - checks condition first (may not execute):
```javascript
let i = 10;
while (i < 5) {
    console.log(i);  // Never executes
    i++;
}
```

**do...while** - executes at least once:
```javascript
let i = 10;
do {
    console.log(i);  // Executes once: 10
    i++;
} while (i < 5);
```

### When to Use do...while

- When you need code to run at least once
- Menu systems
- Input validation (try at least once)

### Example: Menu System

```javascript
let choice;
do {
    console.log("1. Option 1");
    console.log("2. Option 2");
    console.log("3. Quit");
    choice = getUserChoice();
    processChoice(choice);
} while (choice !== 3);
```

---

## for...in Loop

The `for...in` loop iterates over the enumerable properties of an object.

### Basic Syntax

```javascript
for (let key in object) {
    // Code using key
}
```

### Iterating Over Objects

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

for (let key in person) {
    console.log(key + ": " + person[key]);
}
// Output:
// name: Alice
// age: 25
// city: New York
```

### Important Notes

**Order is not guaranteed** (though modern JS engines usually maintain insertion order for string keys)

**Only enumerable properties:**
```javascript
let obj = {
    a: 1,
    b: 2
};

Object.defineProperty(obj, ''c'', {
    value: 3,
    enumerable: false  // Not enumerable
});

for (let key in obj) {
    console.log(key);  // Only ''a'' and ''b''
}
```

### With Arrays (Not Recommended)

```javascript
let arr = ["a", "b", "c"];

for (let index in arr) {
    console.log(index, arr[index]);
}
// Output: "0 a", "1 b", "2 c"
// But index is a string, not a number!
```

**⚠️ Use for...of or regular for loop for arrays instead**

### Practical Example

```javascript
let config = {
    host: "localhost",
    port: 3000,
    debug: true
};

for (let key in config) {
    console.log(`Setting ${key} to ${config[key]}`);
}
```

---

## for...of Loop

The `for...of` loop iterates over iterable objects (arrays, strings, etc.).

### Basic Syntax

```javascript
for (let item of iterable) {
    // Code using item
}
```

### Iterating Over Arrays

```javascript
let fruits = ["apple", "banana", "orange"];

for (let fruit of fruits) {
    console.log(fruit);
}
// Output: apple, banana, orange
```

### Iterating Over Strings

```javascript
let text = "Hello";

for (let char of text) {
    console.log(char);
}
// Output: H, e, l, l, o
```

### Getting Index with for...of

```javascript
let fruits = ["apple", "banana", "orange"];

for (let [index, fruit] of fruits.entries()) {
    console.log(index, fruit);
}
// Output: 0 apple, 1 banana, 2 orange
```

### for...of vs for...in

**for...of** (values):
```javascript
let arr = ["a", "b", "c"];
for (let value of arr) {
    console.log(value);  // "a", "b", "c"
}
```

**for...in** (keys/indices):
```javascript
let arr = ["a", "b", "c"];
for (let index in arr) {
    console.log(index);  // "0", "1", "2" (strings!)
}
```

### When to Use for...of

- ✅ Arrays
- ✅ Strings
- ✅ Other iterables (Maps, Sets, NodeLists)
- ✅ When you need values, not indices

### Practical Examples

**Process array items:**
```javascript
let numbers = [1, 2, 3, 4, 5];
let sum = 0;

for (let num of numbers) {
    sum += num;
}
console.log(sum);  // 15
```

**Find item:**
```javascript
let users = ["Alice", "Bob", "Charlie"];
let found = false;

for (let user of users) {
    if (user === "Bob") {
        found = true;
        break;
    }
}
```

---

## break Statement

The `break` statement exits a loop immediately.

### Basic Usage

```javascript
for (let i = 0; i < 10; i++) {
    if (i === 5) {
        break;  // Exit loop when i is 5
    }
    console.log(i);
}
// Output: 0, 1, 2, 3, 4
```

### Examples

**Find first match:**
```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let found = null;

for (let num of numbers) {
    if (num > 5) {
        found = num;
        break;  // Stop searching
    }
}
console.log(found);  // 6
```

**Exit on condition:**
```javascript
let count = 0;
while (true) {
    count++;
    if (count > 10) {
        break;  // Exit infinite loop
    }
    console.log(count);
}
```

**In switch (different context):**
```javascript
switch (day) {
    case "Monday":
        console.log("Start of week");
        break;  // Exit switch
    case "Friday":
        console.log("End of week");
        break;
}
```

---

## continue Statement

The `continue` statement skips the rest of the current iteration and continues with the next.

### Basic Usage

```javascript
for (let i = 0; i < 10; i++) {
    if (i % 2 === 0) {
        continue;  // Skip even numbers
    }
    console.log(i);
}
// Output: 1, 3, 5, 7, 9
```

### Examples

**Skip specific values:**
```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

for (let num of numbers) {
    if (num % 2 === 0) {
        continue;  // Skip even numbers
    }
    console.log(num);  // Only odd numbers
}
// Output: 1, 3, 5, 7, 9
```

**Process only valid items:**
```javascript
let data = [1, null, 3, undefined, 5, "", 7];

for (let item of data) {
    if (!item) {
        continue;  // Skip falsy values
    }
    console.log(item);
}
// Output: 1, 3, 5, 7
```

**Skip on condition:**
```javascript
for (let i = 0; i < 10; i++) {
    if (i < 3) {
        continue;  // Skip first 3 iterations
    }
    console.log(i);
}
// Output: 3, 4, 5, 6, 7, 8, 9
```

### break vs continue

**break** - exits the loop:
```javascript
for (let i = 0; i < 10; i++) {
    if (i === 5) {
        break;  // Loop stops here
    }
    console.log(i);
}
// Output: 0, 1, 2, 3, 4
```

**continue** - skips to next iteration:
```javascript
for (let i = 0; i < 10; i++) {
    if (i === 5) {
        continue;  // Skip 5, continue with 6
    }
    console.log(i);
}
// Output: 0, 1, 2, 3, 4, 6, 7, 8, 9
```

---

## Nested Loops

You can place loops inside other loops to create nested iterations.

### Basic Nested Structure

```javascript
for (let i = 0; i < 3; i++) {
    for (let j = 0; j < 3; j++) {
        console.log(i, j);
    }
}
// Output:
// 0 0, 0 1, 0 2
// 1 0, 1 1, 1 2
// 2 0, 2 1, 2 2
```

### Multiplication Table

```javascript
for (let i = 1; i <= 5; i++) {
    for (let j = 1; j <= 5; j++) {
        console.log(`${i} x ${j} = ${i * j}`);
    }
    console.log("---");
}
```

### 2D Array Processing

```javascript
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

for (let i = 0; i < matrix.length; i++) {
    for (let j = 0; j < matrix[i].length; j++) {
        console.log(matrix[i][j]);
    }
}
```

### Pattern Printing

```javascript
// Print triangle
for (let i = 1; i <= 5; i++) {
    let row = "";
    for (let j = 1; j <= i; j++) {
        row += "*";
    }
    console.log(row);
}
// Output:
// *
// **
// ***
// ****
// *****
```

### Performance Consideration

**⚠️ Nested loops can be slow:**
```javascript
// O(n²) complexity
for (let i = 0; i < 1000; i++) {
    for (let j = 0; j < 1000; j++) {
        // This runs 1,000,000 times!
    }
}
```

### break and continue in Nested Loops

**break** - exits only the innermost loop:
```javascript
for (let i = 0; i < 3; i++) {
    for (let j = 0; j < 3; j++) {
        if (j === 1) {
            break;  // Only breaks inner loop
        }
        console.log(i, j);
    }
}
// Output: 0 0, 1 0, 2 0
```

**Labeled break** - exits outer loop:
```javascript
outer: for (let i = 0; i < 3; i++) {
    for (let j = 0; j < 3; j++) {
        if (j === 1) {
            break outer;  // Breaks outer loop
        }
        console.log(i, j);
    }
}
// Output: 0 0
```

---

## Choosing the Right Loop

### When to Use Each Loop

**for loop:**
- Known number of iterations
- Iterating over arrays with index
- Counting

**while loop:**
- Unknown number of iterations
- Condition-based iteration
- Waiting for external condition

**do...while loop:**
- Need to execute at least once
- Menu systems
- Input validation

**for...in loop:**
- Iterating over object properties
- Need keys, not values

**for...of loop:**
- Iterating over arrays/iterables
- Need values, not indices
- Modern, clean syntax

### Comparison Table

| Loop | Use Case | Example |
|------|----------|---------|
| for | Known iterations | `for (let i = 0; i < 10; i++)` |
| while | Condition-based | `while (condition)` |
| do...while | At least once | `do { } while (condition)` |
| for...in | Object properties | `for (let key in obj)` |
| for...of | Iterables | `for (let item of array)` |

---

## Practice Exercise

### Exercise: Loop Practice

**Objective**: Write programs using different types of loops to solve various problems.

**Instructions**:

1. Create a file called `loop-practice.js`

2. Complete these tasks:
   - Count from 1 to 10 using for loop
   - Calculate sum of numbers 1-100 using for loop
   - Print multiplication table using nested loops
   - Iterate over an array using for...of
   - Iterate over an object using for...in
   - Use while loop to find first number > 100
   - Use break to exit loop early
   - Use continue to skip certain values
   - Print patterns using nested loops

**Example Solution**:

```javascript
// Loop Practice
console.log("=== For Loop: Count 1-10 ===");
for (let i = 1; i <= 10; i++) {
    console.log(i);
}
console.log();

console.log("=== For Loop: Sum 1-100 ===");
let sum = 0;
for (let i = 1; i <= 100; i++) {
    sum += i;
}
console.log(`Sum: ${sum}`);  // 5050
console.log();

console.log("=== Nested Loops: Multiplication Table ===");
for (let i = 1; i <= 5; i++) {
    let row = "";
    for (let j = 1; j <= 5; j++) {
        row += `${i * j}\\t`;
    }
    console.log(row);
}
console.log();

console.log("=== For...of: Array Iteration ===");
let fruits = ["apple", "banana", "orange", "grape"];
for (let fruit of fruits) {
    console.log(fruit);
}
console.log();

console.log("=== For...in: Object Iteration ===");
let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    occupation: "Developer"
};
for (let key in person) {
    console.log(`${key}: ${person[key]}`);
}
console.log();

console.log("=== While Loop: Find First > 100 ===");
let numbers = [45, 67, 89, 102, 134, 156];
let i = 0;
while (i < numbers.length) {
    if (numbers[i] > 100) {
        console.log(`First number > 100: ${numbers[i]}`);
        break;
    }
    i++;
}
console.log();

console.log("=== Break: Exit Early ===");
for (let i = 1; i <= 10; i++) {
    if (i === 6) {
        console.log("Stopping at 6");
        break;
    }
    console.log(i);
}
console.log();

console.log("=== Continue: Skip Even Numbers ===");
for (let i = 1; i <= 10; i++) {
    if (i % 2 === 0) {
        continue;  // Skip even numbers
    }
    console.log(i);
}
console.log();

console.log("=== Nested Loops: Pattern ===");
for (let i = 1; i <= 5; i++) {
    let pattern = "";
    for (let j = 1; j <= i; j++) {
        pattern += "*";
    }
    console.log(pattern);
}
console.log();

console.log("=== Do...While: At Least Once ===");
let count = 10;
do {
    console.log(`Count: ${count}`);
    count++;
} while (count < 5);  // Condition is false, but executes once
console.log();

console.log("=== Complex: Process 2D Array ===");
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];
let total = 0;
for (let row of matrix) {
    for (let cell of row) {
        total += cell;
    }
}
console.log(`Sum of all cells: ${total}`);  // 45
```

**Expected Output**:
```
=== For Loop: Count 1-10 ===
1
2
3
4
5
6
7
8
9
10

=== For Loop: Sum 1-100 ===
Sum: 5050

=== Nested Loops: Multiplication Table ===
1	2	3	4	5	
2	4	6	8	10	
3	6	9	12	15	
4	8	12	16	20	
5	10	15	20	25	

=== For...of: Array Iteration ===
apple
banana
orange
grape

=== For...in: Object Iteration ===
name: Alice
age: 25
city: New York
occupation: Developer

=== While Loop: Find First > 100 ===
First number > 100: 102

=== Break: Exit Early ===
1
2
3
4
5
Stopping at 6

=== Continue: Skip Even Numbers ===
1
3
5
7
9

=== Nested Loops: Pattern ===
*
**
***
****
*****

=== Do...While: At Least Once ===
Count: 10

=== Complex: Process 2D Array ===
Sum of all cells: 45
```

**Challenge (Optional)**:
- Create a number guessing game with loops
- Build a calendar generator
- Create a pattern generator (diamonds, triangles)
- Process nested data structures
- Optimize nested loops

---

## Common Mistakes

### 1. Infinite Loops

```javascript
// ❌ Infinite loop
let i = 0;
while (i < 5) {
    console.log(i);
    // Forgot to increment!
}

// ✅ Always increment
let i = 0;
while (i < 5) {
    console.log(i);
    i++;
}
```

### 2. Off-by-One Errors

```javascript
// ❌ Wrong range
for (let i = 0; i <= 5; i++) { }  // 0-5 (6 iterations)

// ✅ Correct range
for (let i = 0; i < 5; i++) { }   // 0-4 (5 iterations)
```

### 3. Modifying Array During Iteration

```javascript
// ⚠️ Can cause issues
let arr = [1, 2, 3, 4, 5];
for (let i = 0; i < arr.length; i++) {
    if (arr[i] === 2) {
        arr.splice(i, 1);  // Modifies array
    }
}

// ✅ Better: iterate backwards or use filter
```

### 4. Using for...in on Arrays

```javascript
// ⚠️ Not recommended
let arr = [1, 2, 3];
for (let index in arr) {
    console.log(typeof index);  // "string"!
}

// ✅ Use for...of
for (let value of arr) {
    console.log(value);
}
```

### 5. Confusing break and continue

```javascript
// break - exits loop
for (let i = 0; i < 10; i++) {
    if (i === 5) break;  // Loop stops at 5
}

// continue - skips iteration
for (let i = 0; i < 10; i++) {
    if (i === 5) continue;  // Skips 5, continues
}
```

---

## Key Takeaways

1. **for Loop**: Best for known iterations
2. **while Loop**: Best for condition-based iteration
3. **do...while**: Executes at least once
4. **for...in**: Iterates over object properties
5. **for...of**: Iterates over iterable values
6. **break**: Exits loop immediately
7. **continue**: Skips to next iteration
8. **Nested Loops**: Loops inside loops (watch performance)
9. **Choose Wisely**: Pick the right loop for the task

---

## Quiz: Loops

Test your understanding with these questions:

1. **How many times does this loop run? `for (let i = 0; i < 5; i++)`**
   - A) 4
   - B) 5
   - C) 6
   - D) Infinite

2. **What does `break` do in a loop?**
   - A) Skips current iteration
   - B) Exits the loop
   - C) Continues to next iteration
   - D) Restarts the loop

3. **Which loop executes at least once?**
   - A) for
   - B) while
   - C) do...while
   - D) for...of

4. **What does `continue` do?**
   - A) Exits the loop
   - B) Skips to next iteration
   - C) Restarts the loop
   - D) Breaks the loop

5. **Which is best for iterating over array values?**
   - A) for...in
   - B) for...of
   - C) while
   - D) do...while

6. **What is the output of: `for (let i = 0; i < 3; i++) { if (i === 1) continue; console.log(i); }`**
   - A) 0, 1, 2
   - B) 0, 2
   - C) 1, 2
   - D) 0, 1

7. **Which creates an infinite loop?**
   - A) `for (let i = 0; i < 5; i++)`
   - B) `while (true) { break; }`
   - C) `while (false) { }`
   - D) `while (true) { }` (no break)

**Answers**:
1. B) 5 (0, 1, 2, 3, 4)
2. B) Exits the loop
3. C) do...while
4. B) Skips to next iteration
5. B) for...of
6. B) 0, 2 (skips 1)
7. D) `while (true) { }` (no break)

---

## Next Steps

Congratulations! You''ve learned all about loops. You now know:
- How to use for, while, and do...while loops
- How to iterate with for...in and for...of
- How to control loops with break and continue
- How to create nested loops

**What''s Next?**
- Lesson 3.3: Error Handling
- Practice with different loop types
- Build programs using loops
- Optimize loop performance

---

## Additional Resources

- **MDN: for**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for)
- **MDN: while**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/while](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/while)
- **MDN: for...of**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)
- **MDN: for...in**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)
- **JavaScript.info: Loops**: [javascript.info/while-for](https://javascript.info/while-for)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:13:00', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use for loops to iterate a specific number of times
- Use while loops for condition-based iteration
- Use do...while loops for guaranteed execution
- Iterate over objects with for...in loops
- Iterate over iterables with for...of loops
- Control loop execution with break and continue
- Create and understand nested loops
- Choose the right loop for different scenarios');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (116, 43, 10, 'Error Handling', 'error-handling', '# Lesson 3.3: Error Handling

## Learning Objectives

By the end of this lesson, you will be able to:
- Use try-catch blocks to handle errors
- Throw custom errors with throw statements
- Use finally blocks for cleanup code
- Identify and handle common error types
- Write robust error handling code
- Understand error propagation
- Create custom error messages

---

## Introduction to Error Handling

Error handling allows your program to gracefully handle unexpected situations instead of crashing. It''s essential for building robust, production-ready applications.

### Why Error Handling?

- Prevents program crashes
- Provides user-friendly error messages
- Allows graceful recovery
- Helps with debugging
- Improves user experience

### Types of Errors

1. **Syntax Errors**: Code that violates JavaScript syntax
2. **Runtime Errors**: Errors that occur during execution
3. **Logical Errors**: Code runs but produces wrong results

---

## try-catch Blocks

The `try-catch` statement allows you to test a block of code for errors and handle them gracefully.

### Basic Syntax

```javascript
try {
    // Code that might throw an error
} catch (error) {
    // Code to handle the error
}
```

### Simple Example

```javascript
try {
    let result = 10 / 0;
    console.log(result);  // Infinity (not an error, but unexpected)
} catch (error) {
    console.log("An error occurred:", error.message);
}
```

### Catching Actual Errors

```javascript
try {
    let x = y + 5;  // y is not defined
} catch (error) {
    console.log("Error:", error.message);  // "y is not defined"
    console.log("Error name:", error.name);  // "ReferenceError"
}
```

### Real-World Example

```javascript
try {
    let userInput = getUserInput();
    let number = parseInt(userInput);
    
    if (isNaN(number)) {
        throw new Error("Invalid number");
    }
    
    console.log("Number:", number);
} catch (error) {
    console.log("Error:", error.message);
    // Handle error gracefully
}
```

### Accessing Error Information

```javascript
try {
    // Code that might error
    let result = someFunction();
} catch (error) {
    console.log("Error name:", error.name);
    console.log("Error message:", error.message);
    console.log("Error stack:", error.stack);
    console.log("Full error:", error);
}
```

---

## Common Error Types

JavaScript has several built-in error types.

### ReferenceError

Occurs when trying to access a variable that doesn''t exist.

```javascript
try {
    console.log(nonExistentVariable);
} catch (error) {
    console.log(error.name);  // "ReferenceError"
    console.log(error.message);  // "nonExistentVariable is not defined"
}
```

### TypeError

Occurs when a value is not of the expected type.

```javascript
try {
    let x = null;
    x.someMethod();  // Can''t call method on null
} catch (error) {
    console.log(error.name);  // "TypeError"
    console.log(error.message);  // "Cannot read property ''someMethod'' of null"
}
```

### SyntaxError

Occurs when code violates JavaScript syntax (usually caught at parse time).

```javascript
try {
    eval("let x = ;");  // Invalid syntax
} catch (error) {
    console.log(error.name);  // "SyntaxError"
}
```

### RangeError

Occurs when a value is outside the allowed range.

```javascript
try {
    let arr = new Array(-1);  // Invalid array length
} catch (error) {
    console.log(error.name);  // "RangeError"
}
```

### URIError

Occurs with incorrect use of URI handling functions.

```javascript
try {
    decodeURIComponent("%");  // Invalid URI
} catch (error) {
    console.log(error.name);  // "URIError"
}
```

### Handling Specific Error Types

```javascript
try {
    // Code that might error
    riskyOperation();
} catch (error) {
    if (error instanceof TypeError) {
        console.log("Type error:", error.message);
    } else if (error instanceof ReferenceError) {
        console.log("Reference error:", error.message);
    } else {
        console.log("Other error:", error.message);
    }
}
```

---

## throw Statement

The `throw` statement allows you to create and throw custom errors.

### Basic Syntax

```javascript
throw expression;
```

### Throwing Strings

```javascript
try {
    throw "Something went wrong";
} catch (error) {
    console.log(error);  // "Something went wrong"
}
```

### Throwing Error Objects

```javascript
try {
    throw new Error("Custom error message");
} catch (error) {
    console.log(error.message);  // "Custom error message"
    console.log(error.name);     // "Error"
}
```

### Throwing Specific Error Types

```javascript
// TypeError
throw new TypeError("Expected a number");

// ReferenceError
throw new ReferenceError("Variable not defined");

// Custom message
throw new Error("Invalid input: must be positive number");
```

### Practical Examples

**Input Validation:**
```javascript
function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero is not allowed");
    }
    return a / b;
}

try {
    let result = divide(10, 0);
} catch (error) {
    console.log("Error:", error.message);
}
```

**Type Checking:**
```javascript
function processNumber(num) {
    if (typeof num !== "number") {
        throw new TypeError("Expected a number");
    }
    if (num < 0) {
        throw new RangeError("Number must be positive");
    }
    return num * 2;
}

try {
    processNumber("hello");
} catch (error) {
    console.log(error.name + ":", error.message);
}
```

**Custom Validation:**
```javascript
function validateAge(age) {
    if (age < 0) {
        throw new Error("Age cannot be negative");
    }
    if (age > 150) {
        throw new Error("Age seems unrealistic");
    }
    if (!Number.isInteger(age)) {
        throw new Error("Age must be an integer");
    }
    return true;
}

try {
    validateAge(-5);
} catch (error) {
    console.log("Validation failed:", error.message);
}
```

---

## finally Block

The `finally` block executes code regardless of whether an error occurred or not. It''s useful for cleanup operations.

### Basic Syntax

```javascript
try {
    // Code that might error
} catch (error) {
    // Handle error
} finally {
    // Always executes
}
```

### Simple Example

```javascript
try {
    console.log("Try block");
    throw new Error("Test error");
} catch (error) {
    console.log("Catch block:", error.message);
} finally {
    console.log("Finally block - always runs");
}
// Output:
// Try block
// Catch block: Test error
// Finally block - always runs
```

### Without Error

```javascript
try {
    console.log("Try block - no error");
} catch (error) {
    console.log("Catch block");
} finally {
    console.log("Finally block - always runs");
}
// Output:
// Try block - no error
// Finally block - always runs
```

### Practical Use Cases

**Resource Cleanup:**
```javascript
let fileHandle = null;

try {
    fileHandle = openFile("data.txt");
    processFile(fileHandle);
} catch (error) {
    console.log("Error processing file:", error.message);
} finally {
    if (fileHandle) {
        closeFile(fileHandle);  // Always close, even on error
    }
}
```

**Database Connections:**
```javascript
let connection = null;

try {
    connection = connectToDatabase();
    executeQuery(connection);
} catch (error) {
    console.log("Database error:", error.message);
} finally {
    if (connection) {
        connection.close();  // Always close connection
    }
}
```

**Timer Cleanup:**
```javascript
let timer = null;

try {
    timer = setInterval(() => {
        // Do something
    }, 1000);
    // Some code that might error
} catch (error) {
    console.log("Error:", error.message);
} finally {
    if (timer) {
        clearInterval(timer);  // Always clear timer
    }
}
```

### finally with return

**Important**: `finally` executes even if there''s a return statement:

```javascript
function test() {
    try {
        return "from try";
    } catch (error) {
        return "from catch";
    } finally {
        console.log("Finally always runs");
    }
}

console.log(test());
// Output:
// Finally always runs
// from try
```

---

## Error Propagation

Errors propagate up the call stack until they''re caught or reach the top level.

### Uncaught Errors

```javascript
function level1() {
    level2();
}

function level2() {
    level3();
}

function level3() {
    throw new Error("Error in level3");
}

try {
    level1();
} catch (error) {
    console.log("Caught:", error.message);  // "Error in level3"
}
```

### Catching at Different Levels

```javascript
function level1() {
    try {
        level2();
    } catch (error) {
        console.log("Caught in level1:", error.message);
    }
}

function level2() {
    level3();
}

function level3() {
    throw new Error("Error in level3");
}

level1();  // Error caught in level1
```

### Re-throwing Errors

You can catch an error, handle it, and then re-throw it:

```javascript
function processData(data) {
    try {
        validateData(data);
    } catch (error) {
        console.log("Validation failed, logging error");
        throw error;  // Re-throw to caller
    }
}

try {
    processData(null);
} catch (error) {
    console.log("Caught by caller:", error.message);
}
```

---

## Best Practices

### 1. Be Specific with Error Messages

```javascript
// ❌ Vague
throw new Error("Error");

// ✅ Specific
throw new Error("Invalid email format: must contain @ symbol");
```

### 2. Handle Errors Appropriately

```javascript
// ✅ Good: Handle and recover
try {
    let data = fetchData();
} catch (error) {
    console.log("Using default data");
    data = getDefaultData();
}

// ❌ Bad: Swallow errors silently
try {
    riskyOperation();
} catch (error) {
    // Silent failure - bad!
}
```

### 3. Use finally for Cleanup

```javascript
// ✅ Good: Always cleanup
let resource = acquireResource();
try {
    useResource(resource);
} finally {
    releaseResource(resource);
}
```

### 4. Don''t Catch Everything Blindly

```javascript
// ⚠️ Too broad
try {
    // Lots of code
} catch (error) {
    // Catches everything - might hide bugs
}

// ✅ Better: Catch specific errors
try {
    // Code
} catch (error) {
    if (error instanceof TypeError) {
        // Handle type errors
    } else {
        throw error;  // Re-throw unexpected errors
    }
}
```

### 5. Provide Context

```javascript
// ✅ Good: Add context
try {
    processUser(userId);
} catch (error) {
    throw new Error(`Failed to process user ${userId}: ${error.message}`);
}
```

---

## Practice Exercise

### Exercise: Error Handling

**Objective**: Write a program that demonstrates error handling with try-catch, throw, and finally.

**Instructions**:

1. Create a file called `error-handling.js`

2. Create functions that might throw errors:
   - Divide function (throw on division by zero)
   - Validate age function (throw on invalid age)
   - Parse number function (throw on invalid input)
   - Access array element (might throw)

3. Use try-catch to handle errors:
   - Catch specific error types
   - Provide user-friendly messages
   - Handle different scenarios

4. Use finally blocks:
   - Clean up resources
   - Log completion status

5. Demonstrate:
   - Error propagation
   - Re-throwing errors
   - Multiple catch scenarios

**Example Solution**:

```javascript
// Error Handling Practice
console.log("=== Basic Try-Catch ===");
try {
    let result = 10 / 0;
    console.log("Result:", result);  // Infinity (not an error)
} catch (error) {
    console.log("Error:", error.message);
}

try {
    let x = undefinedVariable;
} catch (error) {
    console.log("Caught:", error.name, "-", error.message);
}
console.log();

console.log("=== Custom Error with Throw ===");
function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero is not allowed");
    }
    if (typeof a !== "number" || typeof b !== "number") {
        throw new TypeError("Both arguments must be numbers");
    }
    return a / b;
}

try {
    console.log(divide(10, 2));  // 5
} catch (error) {
    console.log("Error:", error.message);
}

try {
    console.log(divide(10, 0));  // Error
} catch (error) {
    console.log("Error:", error.message);
}

try {
    console.log(divide("10", 2));  // Error
} catch (error) {
    console.log("Error:", error.message);
}
console.log();

console.log("=== Validation Function ===");
function validateAge(age) {
    if (typeof age !== "number") {
        throw new TypeError("Age must be a number");
    }
    if (!Number.isInteger(age)) {
        throw new Error("Age must be an integer");
    }
    if (age < 0) {
        throw new RangeError("Age cannot be negative");
    }
    if (age > 150) {
        throw new RangeError("Age seems unrealistic");
    }
    return true;
}

let testAges = [25, -5, "thirty", 25.5, 200];

testAges.forEach(age => {
    try {
        validateAge(age);
        console.log(`Age ${age} is valid`);
    } catch (error) {
        console.log(`Age ${age}: ${error.name} - ${error.message}`);
    }
});
console.log();

console.log("=== Finally Block ===");
function processFile(filename) {
    let fileHandle = `handle_${filename}`;
    console.log(`Opening file: ${filename}`);
    
    try {
        if (filename === "error.txt") {
            throw new Error("File not found");
        }
        console.log(`Processing ${filename}...`);
        return "File processed successfully";
    } catch (error) {
        console.log(`Error processing ${filename}:`, error.message);
        throw error;  // Re-throw
    } finally {
        console.log(`Closing file handle: ${fileHandle}`);
    }
}

try {
    console.log(processFile("data.txt"));
} catch (error) {
    console.log("Caught by caller:", error.message);
}

try {
    console.log(processFile("error.txt"));
} catch (error) {
    console.log("Caught by caller:", error.message);
}
console.log();

console.log("=== Error Propagation ===");
function level1() {
    console.log("Level 1: calling level2");
    level2();
}

function level2() {
    console.log("Level 2: calling level3");
    level3();
}

function level3() {
    console.log("Level 3: throwing error");
    throw new Error("Error originated in level3");
}

try {
    level1();
} catch (error) {
    console.log("Caught at top level:", error.message);
    console.log("Stack trace:", error.stack.split("\\n")[0]);
}
console.log();

console.log("=== Handling Specific Error Types ===");
function riskyOperation(type) {
    if (type === "reference") {
        console.log(nonExistent);  // ReferenceError
    } else if (type === "type") {
        let x = null;
        x.method();  // TypeError
    } else if (type === "range") {
        let arr = new Array(-1);  // RangeError
    } else {
        throw new Error("Unknown operation type");
    }
}

let operations = ["reference", "type", "range", "unknown"];

operations.forEach(op => {
    try {
        riskyOperation(op);
    } catch (error) {
        if (error instanceof ReferenceError) {
            console.log(`ReferenceError: ${error.message}`);
        } else if (error instanceof TypeError) {
            console.log(`TypeError: ${error.message}`);
        } else if (error instanceof RangeError) {
            console.log(`RangeError: ${error.message}`);
        } else {
            console.log(`Other error: ${error.message}`);
        }
    }
});
console.log();

console.log("=== Safe Array Access ===");
function safeArrayAccess(arr, index) {
    try {
        if (!Array.isArray(arr)) {
            throw new TypeError("First argument must be an array");
        }
        if (typeof index !== "number") {
            throw new TypeError("Index must be a number");
        }
        if (index < 0 || index >= arr.length) {
            throw new RangeError(`Index ${index} is out of bounds`);
        }
        return arr[index];
    } catch (error) {
        console.log(`Error accessing array: ${error.message}`);
        return null;
    }
}

let numbers = [10, 20, 30, 40, 50];
console.log(safeArrayAccess(numbers, 2));    // 30
console.log(safeArrayAccess(numbers, 10));   // Error
console.log(safeArrayAccess(numbers, -1));   // Error
console.log(safeArrayAccess("not array", 0)); // Error
```

**Expected Output**:
```
=== Basic Try-Catch ===
Result: Infinity
Caught: ReferenceError - undefinedVariable is not defined

=== Custom Error with Throw ===
5
Error: Division by zero is not allowed
Error: Both arguments must be numbers

=== Validation Function ===
Age 25 is valid
Age -5: RangeError - Age cannot be negative
Age thirty: TypeError - Age must be a number
Age 25.5: Error - Age must be an integer
Age 200: RangeError - Age seems unrealistic

=== Finally Block ===
Opening file: data.txt
Processing data.txt...
Closing file handle: handle_data.txt
File processed successfully
Opening file: error.txt
Error processing error.txt: File not found
Closing file handle: handle_error.txt
Caught by caller: File not found

=== Error Propagation ===
Level 1: calling level2
Level 2: calling level3
Level 3: throwing error
Caught at top level: Error originated in level3
Stack trace: Error: Error originated in level3

=== Handling Specific Error Types ===
ReferenceError: nonExistent is not defined
TypeError: Cannot read property ''method'' of null
RangeError: Invalid array length
Other error: Unknown operation type

=== Safe Array Access ===
30
Error accessing array: Index 10 is out of bounds
Error accessing array: Index -1 is out of bounds
Error accessing array: First argument must be an array
```

**Challenge (Optional)**:
- Create a robust input validation system
- Build error logging functionality
- Create custom error classes
- Implement retry logic with error handling
- Build a safe API caller with error handling

---

## Common Mistakes

### 1. Swallowing Errors

```javascript
// ❌ Bad: Silent failure
try {
    riskyOperation();
} catch (error) {
    // Do nothing - hides bugs!
}

// ✅ Good: Log or handle
try {
    riskyOperation();
} catch (error) {
    console.error("Operation failed:", error);
    // Or handle appropriately
}
```

### 2. Catching Too Broadly

```javascript
// ⚠️ Catches everything
try {
    // Lots of code
} catch (error) {
    // Might hide unexpected errors
}

// ✅ Better: Be specific
try {
    // Code
} catch (error) {
    if (error instanceof ExpectedError) {
        // Handle expected error
    } else {
        throw error;  // Re-throw unexpected
    }
}
```

### 3. Not Using finally for Cleanup

```javascript
// ❌ Resource might not be cleaned up
let resource = acquire();
try {
    use(resource);
} catch (error) {
    handle(error);
}
// What if error occurs? Resource not cleaned up!

// ✅ Always cleanup
let resource = acquire();
try {
    use(resource);
} catch (error) {
    handle(error);
} finally {
    cleanup(resource);
}
```

### 4. Throwing Non-Error Values

```javascript
// ⚠️ Works but not ideal
throw "Error message";

// ✅ Better: Use Error object
throw new Error("Error message");
```

### 5. Not Providing Context

```javascript
// ❌ Vague
throw new Error("Error");

// ✅ Specific
throw new Error(`Failed to process user ${userId}: ${originalError.message}`);
```

---

## Key Takeaways

1. **try-catch**: Handle errors gracefully
2. **throw**: Create and throw custom errors
3. **finally**: Always executes, useful for cleanup
4. **Error Types**: ReferenceError, TypeError, RangeError, etc.
5. **Error Propagation**: Errors bubble up until caught
6. **Best Practices**: Be specific, handle appropriately, use finally
7. **Don''t Swallow**: Always log or handle errors

---

## Quiz: Error Handling

Test your understanding with these questions:

1. **What does a try-catch block do?**
   - A) Prevents all errors
   - B) Handles errors gracefully
   - C) Stops program execution
   - D) Nothing

2. **When does a finally block execute?**
   - A) Only if error occurs
   - B) Only if no error
   - C) Always
   - D) Never

3. **What is thrown when accessing undefined variable?**
   - A) TypeError
   - B) ReferenceError
   - C) SyntaxError
   - D) RangeError

4. **What does `throw` do?**
   - A) Catches errors
   - B) Creates and throws errors
   - C) Prevents errors
   - D) Logs errors

5. **What happens to uncaught errors?**
   - A) They''re ignored
   - B) They crash the program
   - C) They''re logged automatically
   - D) They''re converted to warnings

6. **Which is best practice?**
   - A) Catch all errors silently
   - B) Use specific error handling
   - C) Never use try-catch
   - D) Always throw errors

7. **What does `error.message` contain?**
   - A) Error name
   - B) Error description
   - C) Stack trace
   - D) Error type

**Answers**:
1. B) Handles errors gracefully
2. C) Always
3. B) ReferenceError
4. B) Creates and throws errors
5. B) They crash the program (in browser/Node.js)
6. B) Use specific error handling
7. B) Error description

---

## Next Steps

Congratulations! You''ve completed Module 3: Control Flow. You now know:
- Conditional statements (if, else, switch)
- All types of loops
- Error handling with try-catch

**What''s Next?**
- Module 4: Functions
- Lesson 4.1: Function Basics
- Practice combining control flow concepts
- Build more complex programs

---

## Additional Resources

- **MDN: try...catch**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/try...catch)
- **MDN: throw**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/throw](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/throw)
- **MDN: Error**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)
- **JavaScript.info: Error Handling**: [javascript.info/error-handling](https://javascript.info/error-handling)

---

*Lesson completed! You''ve finished Module 3: Control Flow. Ready for Module 4: Functions!*

', NULL, 3, '2026-01-03 09:13:00', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use try-catch blocks to handle errors
- Throw custom errors with throw statements
- Use finally blocks for cleanup code
- Identify and handle common error types
- Write robust error handling code
- Understand error propagation
- Create custom error messages');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (117, 44, 10, 'Function Basics', 'function-basics', '# Lesson 4.1: Function Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Declare functions using function declarations
- Create functions using function expressions
- Write arrow functions (ES6)
- Understand function parameters and arguments
- Use return statements effectively
- Call functions and pass arguments
- Write reusable, modular code

---

## Introduction to Functions

Functions are reusable blocks of code that perform specific tasks. They are fundamental to JavaScript and enable:
- Code reusability
- Modularity
- Abstraction
- Organization

### Why Use Functions?

- **Avoid Repetition**: Write once, use many times
- **Organization**: Break code into logical pieces
- **Maintainability**: Update in one place
- **Testing**: Test individual functions
- **Readability**: Clear, descriptive names

---

## Function Declarations

Function declarations define a function with a name. They are hoisted (can be called before they''re defined).

### Basic Syntax

```javascript
function functionName(parameters) {
    // Function body
    return value;
}
```

### Simple Example

```javascript
function greet() {
    console.log("Hello, World!");
}

greet();  // Call the function
// Output: "Hello, World!"
```

### Function with Parameters

```javascript
function greet(name) {
    console.log(`Hello, ${name}!`);
}

greet("Alice");  // "Hello, Alice!"
greet("Bob");    // "Hello, Bob!"
```

### Function with Return Value

```javascript
function add(a, b) {
    return a + b;
}

let result = add(5, 3);
console.log(result);  // 8
```

### Multiple Parameters

```javascript
function calculateTotal(price, quantity, tax) {
    let subtotal = price * quantity;
    let total = subtotal + (subtotal * tax);
    return total;
}

let total = calculateTotal(10, 3, 0.1);
console.log(total);  // 33
```

### Real-World Examples

```javascript
// Calculate area of rectangle
function calculateArea(width, height) {
    return width * height;
}

let area = calculateArea(10, 5);
console.log(area);  // 50

// Check if number is even
function isEven(number) {
    return number % 2 === 0;
}

console.log(isEven(4));   // true
console.log(isEven(7));   // false

// Get full name
function getFullName(firstName, lastName) {
    return `${firstName} ${lastName}`;
}

let name = getFullName("Alice", "Smith");
console.log(name);  // "Alice Smith"
```

### Function Hoisting

Function declarations are hoisted - you can call them before they''re defined:

```javascript
// Call before declaration
sayHello();

function sayHello() {
    console.log("Hello!");
}
// Works! Function is hoisted
```

---

## Function Expressions

Function expressions create functions and assign them to variables. They are not hoisted.

### Basic Syntax

```javascript
let functionName = function(parameters) {
    // Function body
    return value;
};
```

### Simple Example

```javascript
let greet = function() {
    console.log("Hello, World!");
};

greet();  // "Hello, World!"
```

### Function Expression with Parameters

```javascript
let add = function(a, b) {
    return a + b;
};

let result = add(5, 3);
console.log(result);  // 8
```

### Anonymous Functions

Function expressions are often anonymous (no name):

```javascript
let multiply = function(x, y) {
    return x * y;
};
```

### Named Function Expressions

You can give function expressions names (useful for debugging):

```javascript
let divide = function divideNumbers(a, b) {
    return a / b;
};
```

### No Hoisting

Function expressions are NOT hoisted:

```javascript
// ❌ Error: Cannot access before initialization
sayHello();

let sayHello = function() {
    console.log("Hello!");
};
```

### When to Use Function Expressions

- When you need a function as a value
- For callbacks
- When hoisting behavior matters
- For immediately invoked functions (IIFE)

---

## Arrow Functions (ES6)

Arrow functions provide a shorter syntax for writing functions. They have some differences from regular functions.

### Basic Syntax

```javascript
// Regular function
function add(a, b) {
    return a + b;
}

// Arrow function
let add = (a, b) => {
    return a + b;
};
```

### Single Expression (Implicit Return)

If the function body is a single expression, you can omit braces and return:

```javascript
// Regular function
function multiply(a, b) {
    return a * b;
}

// Arrow function (implicit return)
let multiply = (a, b) => a * b;
```

### Single Parameter

If there''s only one parameter, you can omit parentheses:

```javascript
// Regular function
function square(x) {
    return x * x;
}

// Arrow function
let square = x => x * x;
```

### No Parameters

If there are no parameters, use empty parentheses:

```javascript
// Regular function
function greet() {
    return "Hello!";
}

// Arrow function
let greet = () => "Hello!";
```

### Multiple Statements

For multiple statements, use braces and explicit return:

```javascript
let calculate = (a, b) => {
    let sum = a + b;
    let product = a * b;
    return sum + product;
};
```

### Examples

```javascript
// Simple calculation
let add = (a, b) => a + b;
console.log(add(5, 3));  // 8

// Check even
let isEven = num => num % 2 === 0;
console.log(isEven(4));  // true

// Get first character
let firstChar = str => str[0];
console.log(firstChar("Hello"));  // "H"

// Multiple statements
let process = (x, y) => {
    let sum = x + y;
    let diff = x - y;
    return { sum, diff };
};
```

### Arrow Functions vs Regular Functions

**Key Differences:**
- Arrow functions don''t have their own `this` (covered later)
- Arrow functions can''t be used as constructors
- Arrow functions don''t have `arguments` object
- Arrow functions are always anonymous

**When to Use Arrow Functions:**
- Short, simple functions
- Callbacks
- Array methods (map, filter, etc.)
- When you don''t need `this` binding

---

## Function Parameters and Arguments

### Parameters vs Arguments

- **Parameters**: Variables in the function definition
- **Arguments**: Values passed when calling the function

```javascript
// Parameters: a and b
function add(a, b) {
    return a + b;
}

// Arguments: 5 and 3
let result = add(5, 3);
```

### Multiple Parameters

```javascript
function introduce(name, age, city) {
    console.log(`I''m ${name}, ${age} years old, from ${city}`);
}

introduce("Alice", 25, "New York");
// Output: "I''m Alice, 25 years old, from New York"
```

### Parameter Order Matters

```javascript
function greet(greeting, name) {
    console.log(`${greeting}, ${name}!`);
}

greet("Hello", "Alice");  // "Hello, Alice!"
greet("Alice", "Hello");  // "Alice, Hello!" (wrong order!)
```

### Missing Arguments

If you call a function with fewer arguments than parameters, missing parameters are `undefined`:

```javascript
function greet(name, greeting) {
    console.log(`${greeting}, ${name}!`);
}

greet("Alice");  // "undefined, Alice!"
```

### Extra Arguments

Extra arguments are ignored:

```javascript
function add(a, b) {
    return a + b;
}

console.log(add(1, 2, 3, 4, 5));  // 3 (only uses first two)
```

### Arguments Object

Regular functions have access to an `arguments` object:

```javascript
function sum() {
    let total = 0;
    for (let i = 0; i < arguments.length; i++) {
        total += arguments[i];
    }
    return total;
}

console.log(sum(1, 2, 3, 4, 5));  // 15
```

**Note**: Arrow functions don''t have `arguments` object.

---

## Return Statements

The `return` statement specifies the value a function returns. Functions without `return` return `undefined`.

### Basic Return

```javascript
function add(a, b) {
    return a + b;
}

let result = add(5, 3);
console.log(result);  // 8
```

### Early Return

You can return early to exit a function:

```javascript
function checkAge(age) {
    if (age < 0) {
        return "Invalid age";
    }
    if (age < 18) {
        return "Minor";
    }
    return "Adult";
}

console.log(checkAge(25));  // "Adult"
console.log(checkAge(-5));   // "Invalid age"
```

### Multiple Return Points

```javascript
function getGrade(score) {
    if (score >= 90) return "A";
    if (score >= 80) return "B";
    if (score >= 70) return "C";
    if (score >= 60) return "D";
    return "F";
}

console.log(getGrade(85));  // "B"
```

### Returning Objects

```javascript
function createUser(name, age) {
    return {
        name: name,
        age: age,
        isAdult: age >= 18
    };
}

let user = createUser("Alice", 25);
console.log(user);  // { name: "Alice", age: 25, isAdult: true }
```

### Returning Arrays

```javascript
function getEvenNumbers(max) {
    let evens = [];
    for (let i = 2; i <= max; i += 2) {
        evens.push(i);
    }
    return evens;
}

let numbers = getEvenNumbers(10);
console.log(numbers);  // [2, 4, 6, 8, 10]
```

### No Return Statement

Functions without `return` return `undefined`:

```javascript
function doSomething() {
    console.log("Doing something");
    // No return statement
}

let result = doSomething();
console.log(result);  // undefined
```

### Return Stops Execution

After `return`, no code executes:

```javascript
function test() {
    console.log("Before return");
    return "Done";
    console.log("After return");  // Never executes
}

console.log(test());
// Output: "Before return", "Done"
```

---

## Calling Functions

### Basic Function Call

```javascript
function greet() {
    console.log("Hello!");
}

greet();  // Call the function
```

### Calling with Arguments

```javascript
function add(a, b) {
    return a + b;
}

let result = add(5, 3);  // Call with arguments
console.log(result);
```

### Storing Function in Variable

```javascript
function multiply(a, b) {
    return a * b;
}

let calc = multiply;  // Store function reference
console.log(calc(5, 3));  // 15
```

### Functions as Values

Functions are first-class citizens - they can be:
- Assigned to variables
- Passed as arguments
- Returned from functions
- Stored in data structures

```javascript
// Assign to variable
let myFunction = function() {
    return "Hello";
};

// Pass as argument
function callFunction(fn) {
    return fn();
}

console.log(callFunction(myFunction));  // "Hello"
```

---

## Practice Exercise

### Exercise: Writing Functions

**Objective**: Write various functions demonstrating different function types and concepts.

**Instructions**:

1. Create a file called `functions-practice.js`

2. Write functions using different styles:
   - Function declarations
   - Function expressions
   - Arrow functions

3. Create functions for:
   - Mathematical operations (add, subtract, multiply, divide)
   - String operations (reverse, capitalize, count words)
   - Validation (isEven, isPositive, isValidEmail)
   - Data transformation (convert temperature, format currency)

4. Test all functions with different inputs

**Example Solution**:

```javascript
// Functions Practice
console.log("=== Function Declarations ===");

// Math functions
function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
}

function multiply(a, b) {
    return a * b;
}

function divide(a, b) {
    if (b === 0) {
        return "Cannot divide by zero";
    }
    return a / b;
}

console.log("Add:", add(10, 5));           // 15
console.log("Subtract:", subtract(10, 5)); // 5
console.log("Multiply:", multiply(10, 5)); // 50
console.log("Divide:", divide(10, 5));     // 2
console.log("Divide by zero:", divide(10, 0));
console.log();

console.log("=== Function Expressions ===");

// String functions
let reverseString = function(str) {
    return str.split("").reverse().join("");
};

let capitalize = function(str) {
    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
};

let countWords = function(str) {
    return str.trim().split(/\\s+/).length;
};

console.log("Reverse:", reverseString("Hello"));      // "olleH"
console.log("Capitalize:", capitalize("hello"));      // "Hello"
console.log("Count words:", countWords("Hello world")); // 2
console.log();

console.log("=== Arrow Functions ===");

// Validation functions
let isEven = num => num % 2 === 0;
let isPositive = num => num > 0;
let isValidEmail = email => email.includes("@") && email.includes(".");

// Temperature conversion
let celsiusToFahrenheit = celsius => (celsius * 9/5) + 32;
let fahrenheitToCelsius = fahrenheit => (fahrenheit - 32) * 5/9;

// Currency formatting
let formatCurrency = (amount, currency = "$") => {
    return `${currency}${amount.toFixed(2)}`;
};

console.log("Is even:", isEven(4));                    // true
console.log("Is positive:", isPositive(-5));           // false
console.log("Valid email:", isValidEmail("test@email.com")); // true
console.log("C to F:", celsiusToFahrenheit(25));       // 77
console.log("F to C:", fahrenheitToCelsius(77));       // 25
console.log("Currency:", formatCurrency(1234.56));     // "$1234.56"
console.log();

console.log("=== Complex Functions ===");

// Function with multiple statements
function calculateTotal(items, taxRate) {
    let subtotal = 0;
    for (let item of items) {
        subtotal += item.price * item.quantity;
    }
    let tax = subtotal * taxRate;
    return {
        subtotal: subtotal,
        tax: tax,
        total: subtotal + tax
    };
}

let cart = [
    { price: 10, quantity: 2 },
    { price: 5, quantity: 3 }
];

let total = calculateTotal(cart, 0.1);
console.log("Cart total:", total);
// { subtotal: 35, tax: 3.5, total: 38.5 }
console.log();

console.log("=== Functions with Early Return ===");

function getGrade(score) {
    if (score < 0 || score > 100) {
        return "Invalid score";
    }
    if (score >= 90) return "A";
    if (score >= 80) return "B";
    if (score >= 70) return "C";
    if (score >= 60) return "D";
    return "F";
}

console.log("Grade (95):", getGrade(95));   // "A"
console.log("Grade (85):", getGrade(85));   // "B"
console.log("Grade (75):", getGrade(75));   // "C"
console.log("Grade (105):", getGrade(105)); // "Invalid score"
console.log();

console.log("=== Functions Returning Arrays ===");

function getMultiples(number, count) {
    let multiples = [];
    for (let i = 1; i <= count; i++) {
        multiples.push(number * i);
    }
    return multiples;
}

let multiples = getMultiples(5, 5);
console.log("Multiples of 5:", multiples);  // [5, 10, 15, 20, 25]
console.log();

console.log("=== Functions as Values ===");

let operations = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => a / b
};

function calculate(operation, a, b) {
    if (operations[operation]) {
        return operations[operation](a, b);
    }
    return "Unknown operation";
}

console.log("Calculate add:", calculate("add", 10, 5));        // 15
console.log("Calculate multiply:", calculate("multiply", 10, 5)); // 50
console.log("Calculate unknown:", calculate("power", 10, 5));   // "Unknown operation"
```

**Expected Output**:
```
=== Function Declarations ===
Add: 15
Subtract: 5
Multiply: 50
Divide: 2
Divide by zero: Cannot divide by zero

=== Function Expressions ===
Reverse: olleH
Capitalize: Hello
Count words: 2

=== Arrow Functions ===
Is even: true
Is positive: false
Valid email: true
C to F: 77
F to C: 25
Currency: $1234.56

=== Complex Functions ===
Cart total: { subtotal: 35, tax: 3.5, total: 38.5 }

=== Functions with Early Return ===
Grade (95): A
Grade (85): B
Grade (75): C
Grade (105): Invalid score

=== Functions Returning Arrays ===
Multiples of 5: [5, 10, 15, 20, 25]

=== Functions as Values ===
Calculate add: 15
Calculate multiply: 50
Calculate unknown: Unknown operation
```

**Challenge (Optional)**:
- Create a calculator with multiple operations
- Build a string manipulation library
- Create validation functions for forms
- Build utility functions for common tasks

---

## Common Mistakes

### 1. Forgetting Return Statement

```javascript
// ❌ Returns undefined
function add(a, b) {
    a + b;  // Missing return
}

// ✅ Correct
function add(a, b) {
    return a + b;
}
```

### 2. Calling Function Without Parentheses

```javascript
// ❌ Doesn''t call function
let result = add;  // Stores function, doesn''t call it

// ✅ Correct
let result = add(5, 3);  // Calls function
```

### 3. Parameter vs Argument Confusion

```javascript
// Parameters: a, b
function multiply(a, b) {
    return a * b;
}

// Arguments: 5, 3
multiply(5, 3);
```

### 4. Arrow Function Syntax

```javascript
// ❌ Wrong syntax
let add = a, b => a + b;

// ✅ Correct
let add = (a, b) => a + b;
```

### 5. Hoisting Confusion

```javascript
// ✅ Works (function declaration)
sayHello();
function sayHello() {
    console.log("Hello");
}

// ❌ Doesn''t work (function expression)
sayHello();
let sayHello = function() {
    console.log("Hello");
};
```

---

## Key Takeaways

1. **Function Declarations**: `function name() {}` - hoisted
2. **Function Expressions**: `let name = function() {}` - not hoisted
3. **Arrow Functions**: `() => {}` - shorter syntax, no `this` binding
4. **Parameters**: Variables in function definition
5. **Arguments**: Values passed when calling function
6. **Return**: Specifies function''s return value
7. **Functions are Values**: Can be assigned, passed, returned
8. **Choose Style**: Use appropriate function type for context

---

## Quiz: Functions Basics

Test your understanding with these questions:

1. **What is the output of: `function test() { } console.log(test())`?**
   - A) undefined
   - B) null
   - C) Error
   - D) "test"

2. **Which function type is hoisted?**
   - A) Function expression
   - B) Arrow function
   - C) Function declaration
   - D) None

3. **What does `return` do?**
   - A) Stops function execution
   - B) Returns a value
   - C) Both A and B
   - D) Nothing

4. **Arrow functions can omit braces when:**
   - A) Always
   - B) Single expression
   - C) No parameters
   - D) Never

5. **What are the variables in function definition called?**
   - A) Arguments
   - B) Parameters
   - C) Variables
   - D) Values

6. **Which is correct arrow function syntax?**
   - A) `let fn = a => a * 2`
   - B) `let fn = (a) => a * 2`
   - C) `let fn = a => { return a * 2 }`
   - D) All of the above

7. **Functions without return statement return:**
   - A) null
   - B) undefined
   - C) 0
   - D) Error

**Answers**:
1. A) undefined (no return statement)
2. C) Function declaration
3. C) Both A and B
4. B) Single expression
5. B) Parameters
6. D) All of the above (all are valid)
7. B) undefined

---

## Next Steps

Congratulations! You''ve learned function basics. You now know:
- How to declare functions
- Function expressions and arrow functions
- Parameters and arguments
- Return statements

**What''s Next?**
- Lesson 4.2: Function Scope and Hoisting
- Practice writing different function types
- Experiment with return values
- Build reusable functions

---

## Additional Resources

- **MDN: Functions**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions)
- **MDN: Arrow Functions**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions)
- **JavaScript.info: Functions**: [javascript.info/function-basics](https://javascript.info/function-basics)
- **JavaScript.info: Arrow Functions**: [javascript.info/arrow-functions-basics](https://javascript.info/arrow-functions-basics)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:31:17', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Declare functions using function declarations
- Create functions using function expressions
- Write arrow functions (ES6)
- Understand function parameters and arguments
- Use return statements effectively
- Call functions and pass arguments
- Write reusable, modular code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (118, 44, 10, 'Function Scope and Hoisting', 'function-scope-and-hoisting', '# Lesson 4.2: Function Scope and Hoisting

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand global scope vs local scope
- Work with block scope (let, const)
- Understand hoisting behavior in JavaScript
- Know how function hoisting works
- Understand variable hoisting
- Avoid common scope-related bugs
- Write code that uses scope effectively

---

## Introduction to Scope

Scope determines where variables and functions are accessible in your code. Understanding scope is crucial for writing correct JavaScript.

### What is Scope?

Scope is the context in which variables and functions are accessible. JavaScript has different types of scope:
- Global scope
- Function scope
- Block scope

---

## Global Scope

Variables declared outside any function are in the global scope and accessible everywhere.

### Global Variables

```javascript
// Global variable
let globalVar = "I''m global";

function test() {
    console.log(globalVar);  // Can access global variable
}

test();  // "I''m global"
console.log(globalVar);  // "I''m global"
```

### Global Functions

```javascript
// Global function
function globalFunction() {
    console.log("I''m global");
}

// Can call from anywhere
globalFunction();
```

### Problems with Global Scope

**⚠️ Avoid polluting global scope:**
```javascript
// ❌ Too many global variables
let userName = "Alice";
let userAge = 25;
let userCity = "NYC";
let userEmail = "alice@example.com";
// ... many more

// ✅ Better: Use objects
let user = {
    name: "Alice",
    age: 25,
    city: "NYC",
    email: "alice@example.com"
};
```

### window Object (Browser)

In browsers, global variables become properties of the `window` object:

```javascript
var globalVar = "Hello";
console.log(window.globalVar);  // "Hello"
console.log(globalVar);         // "Hello" (same thing)
```

**Note**: `let` and `const` don''t create properties on `window`.

---

## Local/Function Scope

Variables declared inside a function are in local scope and only accessible within that function.

### Function Scope

```javascript
function myFunction() {
    let localVar = "I''m local";
    console.log(localVar);  // Can access
}

myFunction();
// console.log(localVar);  // ❌ Error: localVar is not defined
```

### Multiple Functions

Each function has its own scope:

```javascript
function function1() {
    let x = 1;
    console.log(x);  // 1
}

function function2() {
    let x = 2;  // Different x
    console.log(x);  // 2
}

function1();  // 1
function2();  // 2
```

### Nested Functions

Inner functions can access outer function variables:

```javascript
function outer() {
    let outerVar = "outer";
    
    function inner() {
        console.log(outerVar);  // Can access outer variable
        let innerVar = "inner";
        console.log(innerVar);  // Can access own variable
    }
    
    inner();
    // console.log(innerVar);  // ❌ Error: innerVar not accessible
}

outer();
```

### Scope Chain

JavaScript looks up the scope chain to find variables:

```javascript
let global = "global";

function level1() {
    let level1Var = "level1";
    
    function level2() {
        let level2Var = "level2";
        
        function level3() {
            // Can access all outer scopes
            console.log(global);      // "global"
            console.log(level1Var);  // "level1"
            console.log(level2Var);  // "level2"
        }
        
        level3();
    }
    
    level2();
}

level1();
```

---

## Block Scope (let, const)

`let` and `const` create block-scoped variables (ES6). They''re only accessible within the block `{}` where they''re declared.

### Block Scope Basics

```javascript
if (true) {
    let blockVar = "I''m in a block";
    console.log(blockVar);  // Can access
}

// console.log(blockVar);  // ❌ Error: blockVar is not defined
```

### Block Scope in Loops

```javascript
for (let i = 0; i < 3; i++) {
    console.log(i);  // 0, 1, 2
}

// console.log(i);  // ❌ Error: i is not defined
```

### Block Scope vs Function Scope

**var (function scope):**
```javascript
function test() {
    if (true) {
        var x = 5;
    }
    console.log(x);  // 5 (accessible in function)
}

test();
```

**let/const (block scope):**
```javascript
function test() {
    if (true) {
        let x = 5;
    }
    // console.log(x);  // ❌ Error: x is not defined
}

test();
```

### Multiple Blocks

Each block creates its own scope:

```javascript
{
    let x = 1;
    console.log(x);  // 1
}

{
    let x = 2;  // Different x
    console.log(x);  // 2
}
```

### Block Scope in Functions

```javascript
function example() {
    let functionVar = "function";
    
    if (true) {
        let blockVar = "block";
        console.log(functionVar);  // ✅ Can access
        console.log(blockVar);     // ✅ Can access
    }
    
    console.log(functionVar);  // ✅ Can access
    // console.log(blockVar);  // ❌ Error: not accessible
}
```

---

## var vs let vs const Scope

### var (Function Scope)

```javascript
function test() {
    if (true) {
        var x = 5;
    }
    console.log(x);  // 5 (accessible in function)
}

// var is function-scoped, not block-scoped
for (var i = 0; i < 3; i++) {
    // i is accessible here
}
console.log(i);  // 3 (accessible outside loop!)
```

### let (Block Scope)

```javascript
function test() {
    if (true) {
        let x = 5;
    }
    // console.log(x);  // ❌ Error: not accessible
}

// let is block-scoped
for (let i = 0; i < 3; i++) {
    // i is only accessible here
}
// console.log(i);  // ❌ Error: not accessible
```

### const (Block Scope)

```javascript
function test() {
    if (true) {
        const x = 5;
    }
    // console.log(x);  // ❌ Error: not accessible
}

// const is block-scoped (same as let)
for (const i = 0; i < 3; i++) {
    // Each iteration has its own i
}
```

### Best Practice

**✅ Use `let` and `const` (block scope):**
```javascript
// Modern JavaScript
let count = 0;
const MAX = 100;

if (true) {
    let temp = 5;
    // temp only accessible here
}
```

**❌ Avoid `var` (legacy):**
```javascript
// Old style (avoid)
var count = 0;
```

---

## Hoisting

Hoisting is JavaScript''s behavior of moving declarations to the top of their scope before code execution.

### Function Hoisting

Function declarations are hoisted - you can call them before they''re defined:

```javascript
// Call before declaration
sayHello();

function sayHello() {
    console.log("Hello!");
}
// Works! Function is hoisted
```

### How Function Hoisting Works

JavaScript "moves" function declarations to the top:

```javascript
// What you write:
console.log(typeof myFunction);  // "function"
myFunction();  // Works

function myFunction() {
    console.log("Hello");
}

// What JavaScript "sees":
function myFunction() {
    console.log("Hello");
}

console.log(typeof myFunction);
myFunction();
```

### Function Expressions Are NOT Hoisted

```javascript
// ❌ Error: Cannot access before initialization
sayHello();

let sayHello = function() {
    console.log("Hello!");
};
```

### Arrow Functions Are NOT Hoisted

```javascript
// ❌ Error: Cannot access before initialization
sayHello();

let sayHello = () => {
    console.log("Hello!");
};
```

---

## Variable Hoisting

### var Hoisting

Variables declared with `var` are hoisted but initialized with `undefined`:

```javascript
console.log(x);  // undefined (not an error!)
var x = 5;
console.log(x);  // 5
```

**What JavaScript "sees":**
```javascript
var x;  // Declaration hoisted
console.log(x);  // undefined
x = 5;  // Assignment stays in place
console.log(x);  // 5
```

### let and const Hoisting

`let` and `const` are hoisted but not initialized (Temporal Dead Zone):

```javascript
// ❌ Error: Cannot access before initialization
console.log(x);
let x = 5;
```

**Temporal Dead Zone (TDZ):**
- Variables exist but can''t be accessed
- Period between start of scope and declaration
- Prevents using variable before declaration

### Hoisting Examples

**var:**
```javascript
console.log(a);  // undefined
var a = 5;
console.log(a);  // 5
```

**let:**
```javascript
// console.log(b);  // ❌ Error: Cannot access
let b = 5;
console.log(b);  // 5
```

**const:**
```javascript
// console.log(c);  // ❌ Error: Cannot access
const c = 5;
console.log(c);  // 5
```

### Function vs Variable Hoisting

Functions are hoisted first, then variables:

```javascript
console.log(typeof myFunc);  // "function" (function hoisted)
console.log(typeof myVar);   // "undefined" (var hoisted but undefined)

function myFunc() { }
var myVar = 5;
```

---

## Common Hoisting Scenarios

### Scenario 1: Function Declaration

```javascript
// ✅ Works
test();

function test() {
    console.log("Hello");
}
```

### Scenario 2: Function Expression

```javascript
// ❌ Error
test();

let test = function() {
    console.log("Hello");
};
```

### Scenario 3: var Variable

```javascript
// ⚠️ Works but x is undefined
console.log(x);  // undefined
var x = 5;
```

### Scenario 4: let Variable

```javascript
// ❌ Error
console.log(x);
let x = 5;
```

### Scenario 5: Function and Variable

```javascript
function example() {
    console.log(typeof myVar);  // "undefined" (not "function")
    var myVar = function() { };
}

example();
```

---

## Scope Best Practices

### 1. Use let and const

```javascript
// ✅ Good
let count = 0;
const MAX = 100;

// ❌ Avoid
var count = 0;
```

### 2. Declare Variables at Top

```javascript
// ✅ Good: Clear scope
function example() {
    let x = 5;
    let y = 10;
    // Use x and y
}

// ⚠️ Works but less clear
function example() {
    // Some code
    let x = 5;
    // More code
    let y = 10;
}
```

### 3. Avoid Global Variables

```javascript
// ❌ Bad: Global pollution
let userName = "Alice";
let userAge = 25;

// ✅ Good: Encapsulate
let user = {
    name: "Alice",
    age: 25
};
```

### 4. Use Block Scope

```javascript
// ✅ Good: Block scope
if (condition) {
    let temp = calculate();
    // Use temp
}
// temp is not accessible (good!)

// ⚠️ Less ideal: Function scope
if (condition) {
    var temp = calculate();
}
// temp still accessible (might be unwanted)
```

### 5. Understand Hoisting

```javascript
// ✅ Good: Declare before use
function example() {
    let x = 5;
    console.log(x);
}

// ⚠️ Works but confusing
function example() {
    console.log(x);  // undefined (hoisted)
    var x = 5;
}
```

---

## Practice Exercise

### Exercise: Scope Practice

**Objective**: Write code that demonstrates different scoping behaviors and hoisting.

**Instructions**:

1. Create a file called `scope-practice.js`

2. Demonstrate:
   - Global scope variables
   - Function scope variables
   - Block scope variables (let, const)
   - Function hoisting
   - Variable hoisting (var, let, const)
   - Nested scopes
   - Scope chain

3. Show common mistakes and correct patterns

**Example Solution**:

```javascript
// Scope Practice
console.log("=== Global Scope ===");
let globalVar = "I''m global";

function accessGlobal() {
    console.log("Inside function:", globalVar);
}

accessGlobal();
console.log("Outside function:", globalVar);
console.log();

console.log("=== Function Scope ===");
function function1() {
    let localVar = "Function 1 variable";
    console.log("Function 1:", localVar);
}

function function2() {
    let localVar = "Function 2 variable";  // Different variable
    console.log("Function 2:", localVar);
}

function1();
function2();
// console.log(localVar);  // ❌ Error: not accessible
console.log();

console.log("=== Block Scope (let/const) ===");
if (true) {
    let blockVar = "Block variable";
    const blockConst = "Block constant";
    console.log("Inside block:", blockVar, blockConst);
}
// console.log(blockVar);  // ❌ Error: not accessible
console.log();

console.log("=== var vs let Scope ===");
function varExample() {
    if (true) {
        var functionScoped = "Function scope";
    }
    console.log("var accessible:", functionScoped);  // Accessible
}

function letExample() {
    if (true) {
        let blockScoped = "Block scope";
        console.log("let inside block:", blockScoped);
    }
    // console.log(blockScoped);  // ❌ Error: not accessible
}

varExample();
letExample();
console.log();

console.log("=== Nested Scopes ===");
let outer = "outer";

function outerFunction() {
    let middle = "middle";
    console.log("Outer function:", outer, middle);
    
    function innerFunction() {
        let inner = "inner";
        console.log("Inner function:", outer, middle, inner);
    }
    
    innerFunction();
    // console.log(inner);  // ❌ Error: not accessible
}

outerFunction();
console.log();

console.log("=== Function Hoisting ===");
// Call before declaration
hoistedFunction();

function hoistedFunction() {
    console.log("I''m hoisted!");
}

// Function expression - NOT hoisted
// notHoisted();  // ❌ Error

let notHoisted = function() {
    console.log("I''m not hoisted");
};
console.log();

console.log("=== Variable Hoisting ===");
// var hoisting
console.log("var before declaration:", hoistedVar);  // undefined
var hoistedVar = "I''m hoisted";
console.log("var after declaration:", hoistedVar);

// let hoisting (Temporal Dead Zone)
// console.log(hoistedLet);  // ❌ Error: Cannot access
let hoistedLet = "I''m in TDZ";
console.log("let after declaration:", hoistedLet);
console.log();

console.log("=== Scope Chain ===");
let level0 = "Level 0";

function level1() {
    let level1Var = "Level 1";
    console.log("Level 1 can access:", level0, level1Var);
    
    function level2() {
        let level2Var = "Level 2";
        console.log("Level 2 can access:", level0, level1Var, level2Var);
        
        function level3() {
            let level3Var = "Level 3";
            console.log("Level 3 can access:", level0, level1Var, level2Var, level3Var);
        }
        
        level3();
    }
    
    level2();
}

level1();
console.log();

console.log("=== Block Scope in Loops ===");
console.log("Using let (block scope):");
for (let i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log("let i:", i);  // 0, 1, 2 (each iteration has own i)
    }, 100);
}

console.log("Using var (function scope):");
for (var j = 0; j < 3; j++) {
    setTimeout(() => {
        console.log("var j:", j);  // 3, 3, 3 (shared variable)
    }, 200);
}
console.log();

console.log("=== Best Practices ===");
// ✅ Good: Use let/const, declare at top
function goodExample() {
    let x = 5;
    let y = 10;
    
    if (x > 0) {
        let temp = x + y;
        console.log("Temp:", temp);
    }
    // temp not accessible (good!)
}

// ⚠️ Less ideal: var, scattered declarations
function lessIdealExample() {
    console.log(x);  // undefined (hoisted)
    var x = 5;
    
    if (x > 0) {
        var temp = x + 5;
    }
    console.log(temp);  // Still accessible (might be unwanted)
}

goodExample();
lessIdealExample();
```

**Expected Output**:
```
=== Global Scope ===
Inside function: I''m global
Outside function: I''m global

=== Function Scope ===
Function 1: Function 1 variable
Function 2: Function 2 variable

=== Block Scope (let/const) ===
Inside block: Block variable Block constant

=== var vs let Scope ===
var accessible: Function scope
let inside block: Block scope

=== Nested Scopes ===
Outer function: outer middle
Inner function: outer middle inner

=== Function Hoisting ===
I''m hoisted!

=== Variable Hoisting ===
var before declaration: undefined
var after declaration: I''m hoisted
let after declaration: I''m in TDZ

=== Scope Chain ===
Level 1 can access: Level 0 Level 1
Level 2 can access: Level 0 Level 1 Level 2
Level 3 can access: Level 0 Level 1 Level 2 Level 3

=== Block Scope in Loops ===
Using let (block scope):
Using var (function scope):
let i: 0
let i: 1
let i: 2
var j: 3
var j: 3
var j: 3

=== Best Practices ===
Temp: 15
undefined
15
```

**Challenge (Optional)**:
- Create examples showing closure behavior
- Demonstrate module pattern using scope
- Show IIFE (Immediately Invoked Function Expression)
- Create scope-related bugs and fixes

---

## Common Mistakes

### 1. Assuming Block Scope for var

```javascript
// ⚠️ var is function-scoped, not block-scoped
if (true) {
    var x = 5;
}
console.log(x);  // 5 (accessible!)

// ✅ Use let for block scope
if (true) {
    let y = 5;
}
// console.log(y);  // ❌ Error: not accessible
```

### 2. Hoisting Confusion

```javascript
// ⚠️ Confusing: x is undefined
console.log(x);  // undefined
var x = 5;

// ✅ Clear: declare first
let y = 5;
console.log(y);  // 5
```

### 3. Global Variable Pollution

```javascript
// ❌ Bad: Too many globals
let userName = "Alice";
let userAge = 25;
let userCity = "NYC";

// ✅ Good: Encapsulate
let user = {
    name: "Alice",
    age: 25,
    city: "NYC"
};
```

### 4. Loop Variable Scope

```javascript
// ⚠️ Problem with var
for (var i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i);  // 3, 3, 3 (all same!)
    }, 100);
}

// ✅ Solution: Use let
for (let i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i);  // 0, 1, 2 (correct!)
    }, 100);
}
```

### 5. Accessing Before Declaration

```javascript
// ❌ Error with let/const
console.log(x);
let x = 5;

// ✅ Declare first
let y = 5;
console.log(y);
```

---

## Key Takeaways

1. **Global Scope**: Variables outside functions, accessible everywhere
2. **Function Scope**: Variables inside functions, accessible only in function
3. **Block Scope**: Variables in `{}` blocks (let/const), accessible only in block
4. **Function Hoisting**: Function declarations can be called before definition
5. **Variable Hoisting**: var hoisted to undefined, let/const in TDZ
6. **Scope Chain**: Inner scopes can access outer scopes
7. **Best Practice**: Use let/const, avoid var, minimize globals

---

## Quiz: Scope and Hoisting

Test your understanding with these questions:

1. **What scope does `var` have?**
   - A) Block scope
   - B) Function scope
   - C) Global scope
   - D) No scope

2. **What is the output: `console.log(x); var x = 5;`?**
   - A) 5
   - B) undefined
   - C) Error
   - D) null

3. **Which is hoisted?**
   - A) Function expression
   - B) Arrow function
   - C) Function declaration
   - D) let variable

4. **What is Temporal Dead Zone?**
   - A) Error zone
   - B) Period before let/const initialization
   - C) Block scope
   - D) Function scope

5. **Inner functions can access:**
   - A) Only their own variables
   - B) Outer function variables
   - C) Global variables
   - D) All of the above

6. **What scope do `let` and `const` have?**
   - A) Function scope
   - B) Block scope
   - C) Global scope
   - D) No scope

7. **Function declarations are:**
   - A) Not hoisted
   - B) Hoisted
   - C) Block scoped
   - D) Always undefined

**Answers**:
1. B) Function scope
2. B) undefined (var is hoisted but undefined)
3. C) Function declaration
4. B) Period before let/const initialization
5. D) All of the above (scope chain)
6. B) Block scope
7. B) Hoisted

---

## Next Steps

Congratulations! You''ve learned about scope and hoisting. You now know:
- Global, function, and block scope
- How hoisting works
- Differences between var, let, and const
- Scope chain and nested scopes

**What''s Next?**
- Lesson 4.3: Advanced Function Concepts
- Practice with different scoping scenarios
- Understand closure (uses scope)
- Build functions with proper scope

---

## Additional Resources

- **MDN: Scope**: [developer.mozilla.org/en-US/docs/Glossary/Scope](https://developer.mozilla.org/en-US/docs/Glossary/Scope)
- **MDN: Hoisting**: [developer.mozilla.org/en-US/docs/Glossary/Hoisting](https://developer.mozilla.org/en-US/docs/Glossary/Hoisting)
- **JavaScript.info: Variable Scope**: [javascript.info/var](https://javascript.info/var)
- **JavaScript.info: Closure**: [javascript.info/closure](https://javascript.info/closure)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:31:17', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand global scope vs local scope
- Work with block scope (let, const)
- Understand hoisting behavior in JavaScript
- Know how function hoisting works
- Understand variable hoisting
- Avoid common scope-related bugs
- Write code that uses scope effectively');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (119, 44, 10, 'Advanced Function Concepts', 'advanced-function-concepts', '# Lesson 4.3: Advanced Function Concepts

## Learning Objectives

By the end of this lesson, you will be able to:
- Use default parameters in functions
- Work with rest parameters (...)
- Use the spread operator effectively
- Understand and create higher-order functions
- Use callback functions
- Combine these concepts in practical scenarios

---

## Introduction

Advanced function concepts make JavaScript functions more powerful and flexible. These features (mostly from ES6+) enable:
- More flexible function signatures
- Better handling of variable arguments
- Functional programming patterns
- Cleaner, more expressive code

---

## Default Parameters

Default parameters allow you to set default values for function parameters if no argument is provided.

### Basic Syntax

```javascript
function functionName(param1 = defaultValue1, param2 = defaultValue2) {
    // Function body
}
```

### Simple Example

```javascript
function greet(name = "Guest") {
    console.log(`Hello, ${name}!`);
}

greet("Alice");  // "Hello, Alice!"
greet();         // "Hello, Guest!"
```

### Multiple Default Parameters

```javascript
function createUser(name = "Anonymous", age = 0, city = "Unknown") {
    return {
        name: name,
        age: age,
        city: city
    };
}

console.log(createUser());                    // All defaults
console.log(createUser("Alice"));             // name only
console.log(createUser("Alice", 25));         // name and age
console.log(createUser("Alice", 25, "NYC"));  // All provided
```

### Default with Expressions

Default values can be expressions:

```javascript
function calculateTotal(price, quantity = 1, tax = price * 0.1) {
    return price * quantity + tax;
}

console.log(calculateTotal(100));      // 100 + 10 = 110
console.log(calculateTotal(100, 2));   // 200 + 10 = 210
```

### Default with Function Calls

```javascript
function getDefaultName() {
    return "Guest";
}

function greet(name = getDefaultName()) {
    console.log(`Hello, ${name}!`);
}

greet();           // "Hello, Guest!"
greet("Alice");    // "Hello, Alice!"
```

### Skipping Parameters

You can skip parameters by passing `undefined`:

```javascript
function greet(greeting = "Hello", name = "Guest") {
    console.log(`${greeting}, ${name}!`);
}

greet("Hi", "Alice");        // "Hi, Alice!"
greet(undefined, "Alice");   // "Hello, Alice!" (uses default for greeting)
greet("Hi");                 // "Hi, Guest!" (uses default for name)
```

### Practical Examples

```javascript
// Configuration with defaults
function createConfig(host = "localhost", port = 3000, ssl = false) {
    return {
        host: host,
        port: port,
        ssl: ssl
    };
}

// Math function with default
function power(base, exponent = 2) {
    return base ** exponent;
}

console.log(power(5));    // 25 (5^2)
console.log(power(5, 3)); // 125 (5^3)
```

---

## Rest Parameters (...)

Rest parameters allow you to represent an indefinite number of arguments as an array.

### Basic Syntax

```javascript
function functionName(...restParams) {
    // restParams is an array
}
```

### Simple Example

```javascript
function sum(...numbers) {
    let total = 0;
    for (let num of numbers) {
        total += num;
    }
    return total;
}

console.log(sum(1, 2, 3));        // 6
console.log(sum(1, 2, 3, 4, 5));  // 15
console.log(sum());                // 0
```

### Rest Must Be Last

Rest parameter must be the last parameter:

```javascript
// ✅ Correct
function example(a, b, ...rest) {
    console.log(a, b, rest);
}

// ❌ Error
// function example(...rest, a) { }
```

### Combining Regular and Rest Parameters

```javascript
function introduce(firstName, lastName, ...hobbies) {
    console.log(`Name: ${firstName} ${lastName}`);
    console.log(`Hobbies: ${hobbies.join(", ")}`);
}

introduce("Alice", "Smith", "reading", "coding", "traveling");
// Name: Alice Smith
// Hobbies: reading, coding, traveling
```

### Rest vs Arguments Object

**Rest parameters (modern):**
```javascript
function sum(...numbers) {
    return numbers.reduce((a, b) => a + b, 0);
}
```

**Arguments object (legacy):**
```javascript
function sum() {
    let total = 0;
    for (let i = 0; i < arguments.length; i++) {
        total += arguments[i];
    }
    return total;
}
```

**Benefits of rest parameters:**
- Real array (can use array methods)
- Clearer intent
- Works with arrow functions

### Practical Examples

```javascript
// Find maximum
function max(...numbers) {
    return Math.max(...numbers);
}

console.log(max(1, 5, 3, 9, 2));  // 9

// Collect all arguments
function logAll(...args) {
    args.forEach((arg, index) => {
        console.log(`Argument ${index}:`, arg);
    });
}

logAll("a", "b", "c");
```

---

## Spread Operator (...)

The spread operator expands an iterable (array, string) into individual elements.

### Basic Syntax

```javascript
...iterable
```

### Spreading Arrays

```javascript
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let combined = [...arr1, ...arr2];
console.log(combined);  // [1, 2, 3, 4, 5, 6]
```

### Function Arguments

Spread array elements as function arguments:

```javascript
function add(a, b, c) {
    return a + b + c;
}

let numbers = [1, 2, 3];
console.log(add(...numbers));  // 6
// Equivalent to: add(1, 2, 3)
```

### Copying Arrays

```javascript
let original = [1, 2, 3];
let copy = [...original];
copy.push(4);
console.log(original);  // [1, 2, 3] (unchanged)
console.log(copy);       // [1, 2, 3, 4]
```

### Combining Arrays

```javascript
let arr1 = [1, 2];
let arr2 = [3, 4];
let arr3 = [5, 6];

let combined = [...arr1, ...arr2, ...arr3];
console.log(combined);  // [1, 2, 3, 4, 5, 6]
```

### Spreading Objects (ES2018)

```javascript
let obj1 = { a: 1, b: 2 };
let obj2 = { c: 3, d: 4 };
let combined = { ...obj1, ...obj2 };
console.log(combined);  // { a: 1, b: 2, c: 3, d: 4 }
```

### Spreading Strings

```javascript
let str = "Hello";
let chars = [...str];
console.log(chars);  // ["H", "e", "l", "l", "o"]
```

### Practical Examples

```javascript
// Math operations
let numbers = [1, 5, 3, 9, 2];
console.log(Math.max(...numbers));  // 9
console.log(Math.min(...numbers));  // 1

// Array methods
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let all = [...arr1, ...arr2, 7, 8, 9];
console.log(all);  // [1, 2, 3, 4, 5, 6, 7, 8, 9]

// Function calls
function greet(greeting, name) {
    console.log(`${greeting}, ${name}!`);
}

let args = ["Hello", "Alice"];
greet(...args);  // "Hello, Alice!"
```

### Rest vs Spread

**Rest** (collects into array):
```javascript
function collect(...items) {
    console.log(items);  // Array
}
collect(1, 2, 3);  // [1, 2, 3]
```

**Spread** (expands array):
```javascript
let arr = [1, 2, 3];
console.log(...arr);  // 1 2 3 (individual elements)
```

---

## Higher-Order Functions

Higher-order functions are functions that:
- Take other functions as arguments, or
- Return functions as results

### Functions as Arguments

```javascript
function operate(a, b, operation) {
    return operation(a, b);
}

function add(x, y) {
    return x + y;
}

function multiply(x, y) {
    return x * y;
}

console.log(operate(5, 3, add));        // 8
console.log(operate(5, 3, multiply));   // 15
```

### Functions as Return Values

```javascript
function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);

console.log(double(5));   // 10
console.log(triple(5));   // 15
```

### Arrow Function Version

```javascript
function createMultiplier(factor) {
    return (number) => number * factor;
}

let double = createMultiplier(2);
console.log(double(5));  // 10
```

### Built-in Higher-Order Functions

JavaScript has many built-in higher-order functions:

**Array.map():**
```javascript
let numbers = [1, 2, 3, 4, 5];
let doubled = numbers.map(num => num * 2);
console.log(doubled);  // [2, 4, 6, 8, 10]
```

**Array.filter():**
```javascript
let numbers = [1, 2, 3, 4, 5, 6];
let evens = numbers.filter(num => num % 2 === 0);
console.log(evens);  // [2, 4, 6]
```

**Array.reduce():**
```javascript
let numbers = [1, 2, 3, 4, 5];
let sum = numbers.reduce((acc, num) => acc + num, 0);
console.log(sum);  // 15
```

### Custom Higher-Order Functions

```javascript
// Function that takes a function and calls it multiple times
function repeat(times, fn) {
    for (let i = 0; i < times; i++) {
        fn(i);
    }
}

repeat(3, (index) => {
    console.log(`Iteration ${index}`);
});
// Iteration 0
// Iteration 1
// Iteration 2
```

### Practical Example: Calculator

```javascript
function calculator(operation) {
    return function(a, b) {
        return operation(a, b);
    };
}

let add = calculator((a, b) => a + b);
let subtract = calculator((a, b) => a - b);
let multiply = calculator((a, b) => a * b);

console.log(add(5, 3));        // 8
console.log(subtract(5, 3));   // 2
console.log(multiply(5, 3));   // 15
```

---

## Callback Functions

A callback function is a function passed as an argument to another function and executed later.

### Basic Callback

```javascript
function greet(name, callback) {
    console.log(`Hello, ${name}!`);
    callback();
}

function sayGoodbye() {
    console.log("Goodbye!");
}

greet("Alice", sayGoodbye);
// Hello, Alice!
// Goodbye!
```

### Inline Callbacks

```javascript
function process(data, callback) {
    console.log("Processing:", data);
    callback(data);
}

process("test", function(result) {
    console.log("Callback received:", result);
});
```

### Arrow Function Callbacks

```javascript
function process(data, callback) {
    console.log("Processing:", data);
    callback(data);
}

process("test", (result) => {
    console.log("Callback received:", result);
});
```

### Common Use Cases

**Array Methods:**
```javascript
let numbers = [1, 2, 3, 4, 5];

// forEach callback
numbers.forEach(num => {
    console.log(num * 2);
});

// map callback
let doubled = numbers.map(num => num * 2);

// filter callback
let evens = numbers.filter(num => num % 2 === 0);
```

**Event Handlers:**
```javascript
// Simulated event handler
function onClick(callback) {
    // Simulate click
    callback("button clicked");
}

onClick((event) => {
    console.log("Event:", event);
});
```

**Async Operations:**
```javascript
function fetchData(callback) {
    // Simulate async operation
    setTimeout(() => {
        callback({ data: "result" });
    }, 1000);
}

fetchData((result) => {
    console.log("Received:", result);
});
```

### Error-First Callbacks

Common pattern in Node.js:

```javascript
function asyncOperation(callback) {
    // Simulate operation
    let success = Math.random() > 0.5;
    
    if (success) {
        callback(null, "Success!");
    } else {
        callback(new Error("Operation failed"), null);
    }
}

asyncOperation((error, result) => {
    if (error) {
        console.log("Error:", error.message);
    } else {
        console.log("Result:", result);
    }
});
```

### Callback Hell

Multiple nested callbacks can become hard to read:

```javascript
// ⚠️ Callback hell
operation1((result1) => {
    operation2(result1, (result2) => {
        operation3(result2, (result3) => {
            operation4(result3, (result4) => {
                console.log(result4);
            });
        });
    });
});
```

**Solution**: Use Promises or async/await (covered later).

---

## Combining Concepts

### Default Parameters + Rest

```javascript
function createUser(name = "Guest", ...hobbies) {
    return {
        name: name,
        hobbies: hobbies
    };
}

console.log(createUser("Alice", "reading", "coding"));
// { name: "Alice", hobbies: ["reading", "coding"] }
```

### Spread + Rest

```javascript
function combine(...arrays) {
    return [...arrays].flat();
}

let arr1 = [1, 2];
let arr2 = [3, 4];
let arr3 = [5, 6];

console.log(combine(arr1, arr2, arr3));  // [1, 2, 3, 4, 5, 6]
```

### Higher-Order + Callbacks

```javascript
function processArray(arr, callback) {
    return arr.map(callback);
}

let numbers = [1, 2, 3, 4, 5];
let doubled = processArray(numbers, num => num * 2);
console.log(doubled);  // [2, 4, 6, 8, 10]
```

### Complete Example

```javascript
function createCalculator(defaultOperation = "add") {
    const operations = {
        add: (a, b) => a + b,
        subtract: (a, b) => a - b,
        multiply: (a, b) => a * b
    };
    
    return function(...numbers) {
        const operation = operations[defaultOperation];
        return numbers.reduce(operation);
    };
}

let adder = createCalculator("add");
console.log(adder(1, 2, 3, 4));  // 10

let multiplier = createCalculator("multiply");
console.log(multiplier(2, 3, 4));  // 24
```

---

## Practice Exercise

### Exercise: Advanced Functions

**Objective**: Write functions using default parameters, rest parameters, spread operator, higher-order functions, and callbacks.

**Instructions**:

1. Create a file called `advanced-functions.js`

2. Create functions demonstrating:
   - Default parameters
   - Rest parameters
   - Spread operator
   - Higher-order functions
   - Callback functions

3. Combine multiple concepts in practical examples

**Example Solution**:

```javascript
// Advanced Functions Practice
console.log("=== Default Parameters ===");

function greet(name = "Guest", greeting = "Hello") {
    console.log(`${greeting}, ${name}!`);
}

greet("Alice");              // "Hello, Alice!"
greet("Bob", "Hi");          // "Hi, Bob!"
greet();                     // "Hello, Guest!"

function createProduct(name, price = 0, discount = 0) {
    return {
        name: name,
        price: price,
        discount: discount,
        finalPrice: price * (1 - discount)
    };
}

console.log(createProduct("Laptop", 1000, 0.1));
// { name: "Laptop", price: 1000, discount: 0.1, finalPrice: 900 }
console.log();

console.log("=== Rest Parameters ===");

function sum(...numbers) {
    return numbers.reduce((acc, num) => acc + num, 0);
}

console.log("Sum:", sum(1, 2, 3, 4, 5));  // 15

function collectInfo(name, age, ...hobbies) {
    return {
        name: name,
        age: age,
        hobbies: hobbies
    };
}

let info = collectInfo("Alice", 25, "reading", "coding", "traveling");
console.log(info);
console.log();

console.log("=== Spread Operator ===");

// Spreading arrays
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let combined = [...arr1, ...arr2];
console.log("Combined:", combined);  // [1, 2, 3, 4, 5, 6]

// Function arguments
function add(a, b, c) {
    return a + b + c;
}

let numbers = [1, 2, 3];
console.log("Add:", add(...numbers));  // 6

// Math operations
let values = [5, 10, 15, 20, 25];
console.log("Max:", Math.max(...values));  // 25
console.log("Min:", Math.min(...values));  // 5
console.log();

console.log("=== Higher-Order Functions ===");

// Function that takes function as argument
function applyOperation(a, b, operation) {
    return operation(a, b);
}

let add = (x, y) => x + y;
let multiply = (x, y) => x * y;

console.log("Add:", applyOperation(5, 3, add));        // 8
console.log("Multiply:", applyOperation(5, 3, multiply)); // 15

// Function that returns function
function createMultiplier(factor) {
    return (number) => number * factor;
}

let double = createMultiplier(2);
let triple = createMultiplier(3);

console.log("Double 5:", double(5));   // 10
console.log("Triple 5:", triple(5));   // 15

// Custom higher-order function
function repeat(times, callback) {
    for (let i = 0; i < times; i++) {
        callback(i);
    }
}

repeat(3, (index) => {
    console.log(`Iteration ${index}`);
});
console.log();

console.log("=== Callback Functions ===");

// Simple callback
function processData(data, callback) {
    console.log("Processing:", data);
    let result = data.toUpperCase();
    callback(result);
}

processData("hello", (result) => {
    console.log("Result:", result);
});

// Array callbacks
let numbers = [1, 2, 3, 4, 5];

let doubled = numbers.map(num => num * 2);
console.log("Doubled:", doubled);  // [2, 4, 6, 8, 10]

let evens = numbers.filter(num => num % 2 === 0);
console.log("Evens:", evens);  // [2, 4]

let sum = numbers.reduce((acc, num) => acc + num, 0);
console.log("Sum:", sum);  // 15
console.log();

console.log("=== Combining Concepts ===");

// Default + Rest + Spread
function createUser(name = "Guest", age = 0, ...tags) {
    return {
        name: name,
        age: age,
        tags: tags
    };
}

let user1 = createUser("Alice", 25, "developer", "blogger");
console.log("User 1:", user1);

let user2 = createUser("Bob");
console.log("User 2:", user2);

// Higher-order + Callback + Spread
function processNumbers(operation, ...numbers) {
    return numbers.reduce(operation);
}

let total = processNumbers((a, b) => a + b, 1, 2, 3, 4, 5);
console.log("Total:", total);  // 15

let product = processNumbers((a, b) => a * b, 2, 3, 4);
console.log("Product:", product);  // 24

// Complex example
function createValidator(rules) {
    return function(data) {
        return rules.every(rule => rule(data));
    };
}

let isPositive = x => x > 0;
let isInteger = x => Number.isInteger(x);
let isLessThan100 = x => x < 100;

let validate = createValidator([isPositive, isInteger, isLessThan100]);

console.log("Validate 50:", validate(50));    // true
console.log("Validate -5:", validate(-5));    // false
console.log("Validate 150:", validate(150));  // false
```

**Expected Output**:
```
=== Default Parameters ===
Hello, Alice!
Hi, Bob!
Hello, Guest!
{ name: "Laptop", price: 1000, discount: 0.1, finalPrice: 900 }

=== Rest Parameters ===
Sum: 15
{ name: "Alice", age: 25, hobbies: ["reading", "coding", "traveling"] }

=== Spread Operator ===
Combined: [1, 2, 3, 4, 5, 6]
Add: 6
Max: 25
Min: 5

=== Higher-Order Functions ===
Add: 8
Multiply: 15
Double 5: 10
Triple 5: 15
Iteration 0
Iteration 1
Iteration 2

=== Callback Functions ===
Processing: hello
Result: HELLO
Doubled: [2, 4, 6, 8, 10]
Evens: [2, 4]
Sum: 15

=== Combining Concepts ===
User 1: { name: "Alice", age: 25, tags: ["developer", "blogger"] }
User 2: { name: "Guest", age: 0, tags: [] }
Total: 15
Product: 24
Validate 50: true
Validate -5: false
Validate 150: false
```

**Challenge (Optional)**:
- Create a function builder using higher-order functions
- Build a validation system with callbacks
- Create utility functions using all concepts
- Build a functional programming library

---

## Common Mistakes

### 1. Rest Parameter Position

```javascript
// ❌ Error: Rest must be last
// function example(...rest, a) { }

// ✅ Correct
function example(a, ...rest) { }
```

### 2. Confusing Rest and Spread

```javascript
// Rest: collects into array
function collect(...items) {
    console.log(items);  // Array
}

// Spread: expands array
let arr = [1, 2, 3];
console.log(...arr);  // Individual elements
```

### 3. Default Parameter Order

```javascript
// ⚠️ Can be confusing
function example(a = 1, b) {
    // If you want b default, must pass undefined for a
}

// ✅ Better: Put defaults last
function example(a, b = 1) {
}
```

### 4. Callback Not Function

```javascript
// ❌ Error if callback is not function
function process(callback) {
    callback();  // Error if callback is not function
}

// ✅ Check first
function process(callback) {
    if (typeof callback === "function") {
        callback();
    }
}
```

### 5. Forgetting Return in Callback

```javascript
// ⚠️ No return value
let doubled = numbers.map(num => {
    num * 2;  // Missing return
});

// ✅ With return
let doubled = numbers.map(num => {
    return num * 2;
});

// ✅ Or implicit return
let doubled = numbers.map(num => num * 2);
```

---

## Key Takeaways

1. **Default Parameters**: Set default values for parameters
2. **Rest Parameters**: Collect remaining arguments into array
3. **Spread Operator**: Expand arrays/objects into individual elements
4. **Higher-Order Functions**: Functions that take/return functions
5. **Callbacks**: Functions passed as arguments
6. **Combine Concepts**: Use together for powerful patterns
7. **Best Practice**: Use modern features (default, rest, spread) over legacy patterns

---

## Quiz: Advanced Functions

Test your understanding with these questions:

1. **What is the output: `function test(a = 1, b) { return a + b; } test(undefined, 2)`?**
   - A) 3
   - B) undefined2
   - C) Error
   - D) NaN

2. **Rest parameter must be:**
   - A) First parameter
   - B) Last parameter
   - C) Middle parameter
   - D) Anywhere

3. **What does spread operator do?**
   - A) Collects into array
   - B) Expands array/object
   - C) Creates function
   - D) Nothing

4. **Higher-order function:**
   - A) Takes function as argument
   - B) Returns function
   - C) Both A and B
   - D) Neither

5. **What is a callback?**
   - A) Function passed as argument
   - B) Function that returns value
   - C) Default parameter
   - D) Rest parameter

6. **What is `...args` in function definition?**
   - A) Spread operator
   - B) Rest parameter
   - C) Default parameter
   - D) Error

7. **Arrow functions can use:**
   - A) Rest parameters
   - B) Default parameters
   - C) Spread operator
   - D) All of the above

**Answers**:
1. A) 3 (a uses default 1, b is 2)
2. B) Last parameter
3. B) Expands array/object
4. C) Both A and B
5. A) Function passed as argument
6. B) Rest parameter (collects)
7. D) All of the above

---

## Next Steps

Congratulations! You''ve completed Module 4: Functions. You now know:
- Function basics (declarations, expressions, arrows)
- Scope and hoisting
- Advanced concepts (defaults, rest, spread, callbacks)

**What''s Next?**
- Module 5: Objects and Arrays
- Lesson 5.1: Objects
- Practice combining function concepts
- Build reusable function libraries

---

## Additional Resources

- **MDN: Default Parameters**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)
- **MDN: Rest Parameters**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/rest_parameters)
- **MDN: Spread Syntax**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax)
- **JavaScript.info: Advanced Functions**: [javascript.info/advanced-functions](https://javascript.info/advanced-functions)

---

*Lesson completed! You''ve finished Module 4: Functions. Ready for Module 5: Objects and Arrays!*

', NULL, 3, '2026-01-03 09:31:17', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use default parameters in functions
- Work with rest parameters (...)
- Use the spread operator effectively
- Understand and create higher-order functions
- Use callback functions
- Combine these concepts in practical scenarios');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (120, 45, 10, 'Objects', 'objects', '# Lesson 5.1: Objects

## Learning Objectives

By the end of this lesson, you will be able to:
- Create objects using object literals
- Access object properties using dot and bracket notation
- Add, modify, and delete object properties
- Create and use object methods
- Understand the `this` keyword
- Work with nested objects
- Iterate over object properties

---

## Introduction to Objects

Objects are collections of key-value pairs. They''re fundamental to JavaScript and used to represent real-world entities, organize data, and structure code.

### What are Objects?

Objects store data as properties (keys) with associated values. They''re similar to dictionaries in other languages.

```javascript
// Simple object
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};
```

### Why Use Objects?

- Organize related data
- Represent real-world entities
- Group functionality (methods)
- Create complex data structures
- Enable object-oriented programming

---

## Object Literals

Object literals are the most common way to create objects in JavaScript.

### Basic Syntax

```javascript
let objectName = {
    key1: value1,
    key2: value2,
    key3: value3
};
```

### Simple Example

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};
```

### Different Value Types

Objects can contain any type of value:

```javascript
let person = {
    name: "Alice",           // String
    age: 25,                  // Number
    isActive: true,           // Boolean
    hobbies: ["reading", "coding"],  // Array
    address: {                // Nested object
        street: "123 Main St",
        city: "New York"
    },
    greet: function() {        // Function
        return "Hello!";
    }
};
```

### Empty Object

```javascript
let emptyObj = {};
let person = {};  // Start empty, add properties later
```

### Shorthand Property Names (ES6)

If variable name matches property name:

```javascript
let name = "Alice";
let age = 25;

// Old way
let person = {
    name: name,
    age: age
};

// ES6 shorthand
let person = {
    name,
    age
};
```

---

## Accessing Properties

### Dot Notation

Use dot notation for simple property access:

```javascript
let person = {
    name: "Alice",
    age: 25
};

console.log(person.name);  // "Alice"
console.log(person.age);   // 25
```

### Bracket Notation

Use bracket notation for dynamic property access or when property names contain special characters:

```javascript
let person = {
    name: "Alice",
    age: 25,
    "first name": "Alice"  // Property with space
};

console.log(person["name"]);        // "Alice"
console.log(person["age"]);        // 25
console.log(person["first name"]); // "Alice" (required for spaces)
```

### When to Use Each

**Dot notation** (preferred):
- Simple property names
- Known at coding time
- Cleaner syntax

**Bracket notation** (required when):
- Property name has spaces or special characters
- Property name is stored in a variable
- Property name is computed dynamically

```javascript
let person = {
    name: "Alice",
    "first name": "Alice"
};

// Dot notation
console.log(person.name);  // "Alice"

// Bracket notation (required for space)
console.log(person["first name"]);  // "Alice"

// Dynamic access
let prop = "name";
console.log(person[prop]);  // "Alice" (must use brackets)
```

### Accessing Nested Properties

```javascript
let person = {
    name: "Alice",
    address: {
        street: "123 Main St",
        city: "New York",
        country: {
            name: "USA",
            code: "US"
        }
    }
};

console.log(person.address.city);                    // "New York"
console.log(person.address.country.name);            // "USA"
console.log(person["address"]["city"]);             // "New York"
console.log(person.address["country"]["name"]);     // "USA"
```

### Safe Property Access

Check if property exists before accessing:

```javascript
let person = {
    name: "Alice"
};

// Check before access
if (person.age !== undefined) {
    console.log(person.age);
}

// Or use optional chaining (ES2020)
console.log(person?.age);  // undefined (no error)
```

---

## Adding and Modifying Properties

### Adding Properties

You can add properties to objects at any time:

```javascript
let person = {
    name: "Alice"
};

// Add new property
person.age = 25;
person.city = "New York";

console.log(person);  // { name: "Alice", age: 25, city: "New York" }
```

### Modifying Properties

Change existing property values:

```javascript
let person = {
    name: "Alice",
    age: 25
};

// Modify property
person.age = 26;
person.name = "Alice Smith";

console.log(person);  // { name: "Alice Smith", age: 26 }
```

### Using Bracket Notation

```javascript
let person = {};

// Add with bracket notation
person["name"] = "Alice";
person["age"] = 25;

// Modify with bracket notation
person["age"] = 26;
```

### Dynamic Property Names

```javascript
let person = {};
let propertyName = "email";
let propertyValue = "alice@example.com";

person[propertyName] = propertyValue;
console.log(person.email);  // "alice@example.com"
```

### Computed Property Names (ES6)

```javascript
let prefix = "user";
let person = {
    [prefix + "Name"]: "Alice",
    [prefix + "Age"]: 25
};

console.log(person.userName);  // "Alice"
console.log(person.userAge);   // 25
```

---

## Deleting Properties

Use the `delete` operator to remove properties from objects.

### Basic Deletion

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

delete person.city;
console.log(person);  // { name: "Alice", age: 25 }
```

### Delete with Dot Notation

```javascript
let person = {
    name: "Alice",
    age: 25
};

delete person.age;
console.log(person.age);  // undefined
```

### Delete with Bracket Notation

```javascript
let person = {
    name: "Alice",
    age: 25
};

delete person["age"];
console.log(person);  // { name: "Alice" }
```

### Checking if Property Exists

```javascript
let person = {
    name: "Alice"
};

// Check before deleting
if ("age" in person) {
    delete person.age;
}

// Or check after
delete person.age;
if (!("age" in person)) {
    console.log("Age property deleted");
}
```

### Cannot Delete Variables

```javascript
// ❌ Cannot delete variables
let x = 5;
delete x;  // false (doesn''t work)

// ✅ Can delete object properties
let obj = { x: 5 };
delete obj.x;  // true (works)
```

---

## Object Methods

Methods are functions stored as object properties.

### Creating Methods

```javascript
let person = {
    name: "Alice",
    age: 25,
    greet: function() {
        return `Hello, I''m ${this.name}`;
    }
};

console.log(person.greet());  // "Hello, I''m Alice"
```

### Method Shorthand (ES6)

```javascript
// Old way
let person = {
    greet: function() {
        return "Hello!";
    }
};

// ES6 shorthand
let person = {
    greet() {
        return "Hello!";
    }
};
```

### Multiple Methods

```javascript
let calculator = {
    add(a, b) {
        return a + b;
    },
    subtract(a, b) {
        return a - b;
    },
    multiply(a, b) {
        return a * b;
    },
    divide(a, b) {
        return a / b;
    }
};

console.log(calculator.add(5, 3));        // 8
console.log(calculator.multiply(5, 3));  // 15
```

### Methods Accessing Properties

```javascript
let person = {
    firstName: "Alice",
    lastName: "Smith",
    getFullName() {
        return `${this.firstName} ${this.lastName}`;
    },
    setAge(age) {
        this.age = age;
    }
};

console.log(person.getFullName());  // "Alice Smith"
person.setAge(25);
console.log(person.age);            // 25
```

---

## this Keyword

The `this` keyword refers to the object that owns the method.

### Understanding this

```javascript
let person = {
    name: "Alice",
    greet() {
        console.log(`Hello, I''m ${this.name}`);
    }
};

person.greet();  // "Hello, I''m Alice"
// this refers to person object
```

### this in Methods

```javascript
let person = {
    name: "Alice",
    age: 25,
    introduce() {
        return `I''m ${this.name}, ${this.age} years old`;
    },
    haveBirthday() {
        this.age++;
        return `Happy birthday! Now I''m ${this.age}`;
    }
};

console.log(person.introduce());     // "I''m Alice, 25 years old"
console.log(person.haveBirthday());  // "Happy birthday! Now I''m 26"
console.log(person.introduce());     // "I''m Alice, 26 years old"
```

### this Context

`this` depends on how the function is called:

```javascript
let person = {
    name: "Alice",
    greet() {
        console.log(this.name);
    }
};

person.greet();  // "Alice" (this = person)

let greetFunc = person.greet;
greetFunc();     // undefined (this = global/window)
```

### Arrow Functions and this

Arrow functions don''t have their own `this` - they inherit from surrounding scope:

```javascript
let person = {
    name: "Alice",
    regular: function() {
        console.log(this.name);  // "Alice"
    },
    arrow: () => {
        console.log(this.name);  // undefined (no this binding)
    }
};

person.regular();  // "Alice"
person.arrow();    // undefined
```

**Best Practice**: Use regular functions for object methods that need `this`.

---

## Nested Objects

Objects can contain other objects, creating nested structures.

### Simple Nesting

```javascript
let person = {
    name: "Alice",
    address: {
        street: "123 Main St",
        city: "New York",
        zipCode: "10001"
    }
};

console.log(person.address.city);  // "New York"
```

### Deep Nesting

```javascript
let company = {
    name: "Tech Corp",
    location: {
        address: {
            street: "123 Tech St",
            city: "San Francisco",
            country: {
                name: "USA",
                code: "US"
            }
        }
    }
};

console.log(company.location.address.country.name);  // "USA"
```

### Modifying Nested Objects

```javascript
let person = {
    name: "Alice",
    address: {
        city: "New York"
    }
};

// Modify nested property
person.address.city = "Boston";
person.address.street = "456 Oak Ave";

// Add nested property
person.address.zipCode = "02101";

console.log(person.address);
// { city: "Boston", street: "456 Oak Ave", zipCode: "02101" }
```

---

## Iterating Over Objects

### for...in Loop

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

for (let key in person) {
    console.log(key + ": " + person[key]);
}
// name: Alice
// age: 25
// city: New York
```

### Object.keys()

Get array of property names:

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let keys = Object.keys(person);
console.log(keys);  // ["name", "age", "city"]

keys.forEach(key => {
    console.log(key, person[key]);
});
```

### Object.values()

Get array of property values:

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let values = Object.values(person);
console.log(values);  // ["Alice", 25, "New York"]
```

### Object.entries()

Get array of [key, value] pairs:

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let entries = Object.entries(person);
console.log(entries);
// [["name", "Alice"], ["age", 25], ["city", "New York"]]

entries.forEach(([key, value]) => {
    console.log(key, value);
});
```

---

## Practice Exercise

### Exercise: Object Manipulation

**Objective**: Create and manipulate objects using various techniques.

**Instructions**:

1. Create a file called `objects-practice.js`

2. Create objects for:
   - A person with properties and methods
   - A product with nested properties
   - A calculator with methods

3. Practice:
   - Creating objects with literals
   - Accessing properties (dot and bracket)
   - Adding and modifying properties
   - Deleting properties
   - Creating and using methods
   - Using `this` keyword
   - Iterating over objects

**Example Solution**:

```javascript
// Objects Practice
console.log("=== Creating Objects ===");

// Person object
let person = {
    firstName: "Alice",
    lastName: "Smith",
    age: 25,
    city: "New York",
    isActive: true
};

console.log("Person:", person);
console.log();

console.log("=== Accessing Properties ===");
// Dot notation
console.log("Name (dot):", person.firstName);
console.log("Age (dot):", person.age);

// Bracket notation
console.log("Name (bracket):", person["firstName"]);
console.log("Age (bracket):", person["age"]);

// Dynamic access
let property = "city";
console.log("City (dynamic):", person[property]);
console.log();

console.log("=== Adding Properties ===");
person.email = "alice@example.com";
person["phone"] = "555-1234";
person.hobbies = ["reading", "coding"];

console.log("After adding:", person);
console.log();

console.log("=== Modifying Properties ===");
person.age = 26;
person["city"] = "Boston";
person.hobbies.push("traveling");

console.log("After modifying:", person);
console.log();

console.log("=== Deleting Properties ===");
delete person.phone;
delete person["isActive"];

console.log("After deleting:", person);
console.log();

console.log("=== Object Methods ===");
let calculator = {
    result: 0,
    add(num) {
        this.result += num;
        return this;
    },
    subtract(num) {
        this.result -= num;
        return this;
    },
    multiply(num) {
        this.result *= num;
        return this;
    },
    divide(num) {
        this.result /= num;
        return this;
    },
    getResult() {
        return this.result;
    },
    reset() {
        this.result = 0;
        return this;
    }
};

calculator.add(10).multiply(2).subtract(5);
console.log("Calculator result:", calculator.getResult());  // 15
calculator.reset();
console.log("After reset:", calculator.getResult());  // 0
console.log();

console.log("=== Using this Keyword ===");
let user = {
    name: "Bob",
    age: 30,
    introduce() {
        return `Hi, I''m ${this.name} and I''m ${this.age} years old`;
    },
    haveBirthday() {
        this.age++;
        return `Happy birthday! Now I''m ${this.age}`;
    },
    getInfo() {
        return {
            name: this.name,
            age: this.age
        };
    }
};

console.log(user.introduce());     // "Hi, I''m Bob and I''m 30 years old"
console.log(user.haveBirthday());  // "Happy birthday! Now I''m 31"
console.log(user.getInfo());       // { name: "Bob", age: 31 }
console.log();

console.log("=== Nested Objects ===");
let product = {
    name: "Laptop",
    price: 999.99,
    specifications: {
        brand: "TechBrand",
        model: "TB-2024",
        processor: {
            type: "Intel",
            speed: "3.5GHz",
            cores: 8
        },
        memory: {
            ram: "16GB",
            storage: "512GB SSD"
        }
    },
    getFullSpecs() {
        return `${this.name} - ${this.specifications.brand} ${this.specifications.model}`;
    }
};

console.log("Product:", product.name);
console.log("Brand:", product.specifications.brand);
console.log("Processor:", product.specifications.processor.type);
console.log("RAM:", product.specifications.memory.ram);
console.log("Full specs:", product.getFullSpecs());
console.log();

console.log("=== Iterating Over Objects ===");
let student = {
    name: "Charlie",
    age: 20,
    grade: "A",
    subjects: ["Math", "Science", "English"]
};

// for...in
console.log("Using for...in:");
for (let key in student) {
    console.log(`${key}: ${student[key]}`);
}

// Object.keys()
console.log("\\nUsing Object.keys():");
Object.keys(student).forEach(key => {
    console.log(`${key}: ${student[key]}`);
});

// Object.values()
console.log("\\nUsing Object.values():");
Object.values(student).forEach(value => {
    console.log(value);
});

// Object.entries()
console.log("\\nUsing Object.entries():");
Object.entries(student).forEach(([key, value]) => {
    console.log(`${key}: ${value}`);
});
console.log();

console.log("=== Computed Property Names ===");
let prefix = "user";
let dynamicObj = {
    [prefix + "Id"]: 123,
    [prefix + "Name"]: "Alice",
    [prefix + "Email"]: "alice@example.com"
};

console.log("Dynamic object:", dynamicObj);
console.log("User ID:", dynamicObj.userId);
console.log();

console.log("=== Object Methods with Parameters ===");
let bankAccount = {
    balance: 1000,
    deposit(amount) {
        this.balance += amount;
        return `Deposited $${amount}. New balance: $${this.balance}`;
    },
    withdraw(amount) {
        if (amount > this.balance) {
            return "Insufficient funds";
        }
        this.balance -= amount;
        return `Withdrew $${amount}. New balance: $${this.balance}`;
    },
    getBalance() {
        return `Current balance: $${this.balance}`;
    }
};

console.log(bankAccount.getBalance());        // "Current balance: $1000"
console.log(bankAccount.deposit(500));        // "Deposited $500. New balance: $1500"
console.log(bankAccount.withdraw(200));       // "Withdrew $200. New balance: $1300"
console.log(bankAccount.withdraw(2000));      // "Insufficient funds"
console.log(bankAccount.getBalance());        // "Current balance: $1300"
```

**Expected Output**:
```
=== Creating Objects ===
Person: { firstName: "Alice", lastName: "Smith", age: 25, city: "New York", isActive: true }

=== Accessing Properties ===
Name (dot): Alice
Age (dot): 25
Name (bracket): Alice
Age (bracket): 25
City (dynamic): New York

=== Adding Properties ===
After adding: { firstName: "Alice", lastName: "Smith", age: 25, city: "New York", isActive: true, email: "alice@example.com", phone: "555-1234", hobbies: ["reading", "coding"] }

=== Modifying Properties ===
After modifying: { firstName: "Alice", lastName: "Smith", age: 26, city: "Boston", isActive: true, email: "alice@example.com", phone: "555-1234", hobbies: ["reading", "coding", "traveling"] }

=== Deleting Properties ===
After deleting: { firstName: "Alice", lastName: "Smith", age: 26, city: "Boston", email: "alice@example.com", hobbies: ["reading", "coding", "traveling"] }

=== Object Methods ===
Calculator result: 15
After reset: 0

=== Using this Keyword ===
Hi, I''m Bob and I''m 30 years old
Happy birthday! Now I''m 31
{ name: "Bob", age: 31 }

=== Nested Objects ===
Product: Laptop
Brand: TechBrand
Processor: Intel
RAM: 16GB
Full specs: Laptop - TechBrand TB-2024

=== Iterating Over Objects ===
Using for...in:
name: Charlie
age: 20
grade: A
subjects: Math,Science,English

Using Object.keys():
name: Charlie
age: 20
grade: A
subjects: Math,Science,English

Using Object.values():
Charlie
20
A
[ "Math", "Science", "English" ]

Using Object.entries():
name: Charlie
age: 20
grade: A
subjects: Math,Science,English

=== Computed Property Names ===
Dynamic object: { userId: 123, userName: "Alice", userEmail: "alice@example.com" }
User ID: 123

=== Object Methods with Parameters ===
Current balance: $1000
Deposited $500. New balance: $1500
Withdrew $200. New balance: $1300
Insufficient funds
Current balance: $1300
```

**Challenge (Optional)**:
- Create a library management system with objects
- Build a shopping cart with object methods
- Create a user profile system
- Build a game character system

---

## Common Mistakes

### 1. Accessing Non-existent Properties

```javascript
// ⚠️ Returns undefined, not error
let person = { name: "Alice" };
console.log(person.age);  // undefined

// ✅ Check first
if (person.age !== undefined) {
    console.log(person.age);
}
```

### 2. Wrong this Context

```javascript
let person = {
    name: "Alice",
    greet() {
        console.log(this.name);
    }
};

// ⚠️ Loses this context
let greetFunc = person.greet;
greetFunc();  // undefined

// ✅ Keep context
person.greet();  // "Alice"
```

### 3. Forgetting Quotes for Special Keys

```javascript
// ❌ Error: Invalid syntax
// let obj = { first name: "Alice" };

// ✅ Use quotes
let obj = { "first name": "Alice" };
console.log(obj["first name"]);  // Must use brackets
```

### 4. Confusing Dot and Bracket

```javascript
let person = { name: "Alice" };
let prop = "name";

// ❌ Wrong
console.log(person.prop);  // undefined

// ✅ Correct
console.log(person[prop]);  // "Alice"
```

### 5. Modifying const Objects

```javascript
const person = { name: "Alice" };

// ✅ Can modify properties
person.age = 25;  // Works

// ❌ Cannot reassign object
// person = { name: "Bob" };  // Error
```

---

## Key Takeaways

1. **Object Literals**: `{ key: value }` - most common way to create objects
2. **Property Access**: Dot notation (simple) or bracket notation (dynamic)
3. **Adding/Modifying**: Assign to property (creates or updates)
4. **Deleting**: Use `delete` operator
5. **Methods**: Functions as object properties
6. **this Keyword**: Refers to object owning the method
7. **Nested Objects**: Objects can contain other objects
8. **Iteration**: Use `for...in`, `Object.keys()`, `Object.values()`, `Object.entries()`

---

## Quiz: Objects

Test your understanding with these questions:

1. **How do you access property `name` in object `person`?**
   - A) `person[name]`
   - B) `person.name` or `person["name"]`
   - C) `person->name`
   - D) `person::name`

2. **What does `delete person.age` do?**
   - A) Sets age to null
   - B) Sets age to undefined
   - C) Removes age property
   - D) Nothing

3. **What does `this` refer to in an object method?**
   - A) The function
   - B) The object
   - C) Global object
   - D) undefined

4. **Which creates an object method?**
   - A) `method: function() {}`
   - B) `method() {}`
   - C) Both A and B
   - D) Neither

5. **How do you iterate over object properties?**
   - A) `for...in`
   - B) `Object.keys()`
   - C) `Object.entries()`
   - D) All of the above

6. **What is the output: `let obj = {}; obj.x = 5; console.log(obj.x)`?**
   - A) undefined
   - B) 5
   - C) Error
   - D) null

7. **Arrow functions in object methods:**
   - A) Have their own `this`
   - B) Don''t have `this` binding
   - C) Always undefined
   - D) Error

**Answers**:
1. B) `person.name` or `person["name"]`
2. C) Removes age property
3. B) The object
4. C) Both A and B (both valid)
5. D) All of the above
6. B) 5
7. B) Don''t have `this` binding

---

## Next Steps

Congratulations! You''ve learned about objects. You now know:
- How to create and access objects
- How to add, modify, and delete properties
- How to create methods and use `this`
- How to work with nested objects

**What''s Next?**
- Lesson 5.2: Arrays
- Practice combining objects and arrays
- Learn about object methods
- Build more complex data structures

---

## Additional Resources

- **MDN: Objects**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Working_with_Objects)
- **MDN: this**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/this)
- **JavaScript.info: Objects**: [javascript.info/object](https://javascript.info/object)
- **JavaScript.info: Object Methods**: [javascript.info/object-methods](https://javascript.info/object-methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:33:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create objects using object literals
- Access object properties using dot and bracket notation
- Add, modify, and delete object properties
- Create and use object methods
- Understand the `this` keyword
- Work with nested objects
- Iterate over object properties');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (121, 45, 10, 'Arrays', 'arrays', '# Lesson 5.2: Arrays

## Learning Objectives

By the end of this lesson, you will be able to:
- Create arrays using different methods
- Access and modify array elements
- Use array modification methods (push, pop, shift, unshift, splice, slice)
- Iterate over arrays (forEach, map, filter, reduce)
- Search arrays (indexOf, find, includes)
- Understand array immutability vs mutability
- Work with array methods effectively

---

## Introduction to Arrays

Arrays are ordered collections of values. They''re one of the most important data structures in JavaScript.

### What are Arrays?

Arrays store multiple values in a single variable, accessible by index (position).

```javascript
let fruits = ["apple", "banana", "orange"];
```

### Why Use Arrays?

- Store multiple related values
- Maintain order
- Easy iteration
- Powerful built-in methods
- Common data structure

---

## Creating Arrays

### Array Literal (Most Common)

```javascript
let fruits = ["apple", "banana", "orange"];
let numbers = [1, 2, 3, 4, 5];
let mixed = ["hello", 42, true, null];
```

### Array Constructor

```javascript
let fruits = new Array("apple", "banana", "orange");
let numbers = new Array(5);  // Creates array with 5 empty slots
```

**Note**: Array literal `[]` is preferred over constructor.

### Empty Array

```javascript
let empty = [];
let alsoEmpty = new Array();
```

### Array with Initial Values

```javascript
let numbers = [1, 2, 3, 4, 5];
let names = ["Alice", "Bob", "Charlie"];
let booleans = [true, false, true];
```

---

## Accessing Array Elements

### Index-Based Access

Arrays are zero-indexed (first element is at index 0):

```javascript
let fruits = ["apple", "banana", "orange"];

console.log(fruits[0]);  // "apple" (first element)
console.log(fruits[1]);  // "banana" (second element)
console.log(fruits[2]);  // "orange" (third element)
```

### Getting Array Length

```javascript
let fruits = ["apple", "banana", "orange"];
console.log(fruits.length);  // 3
```

### Accessing Last Element

```javascript
let fruits = ["apple", "banana", "orange"];
let last = fruits[fruits.length - 1];
console.log(last);  // "orange"
```

### Out of Bounds Access

```javascript
let fruits = ["apple", "banana"];

console.log(fruits[2]);     // undefined (doesn''t exist)
console.log(fruits[-1]);    // undefined (negative index doesn''t work)
console.log(fruits[100]);   // undefined
```

### Modifying Elements

```javascript
let fruits = ["apple", "banana", "orange"];
fruits[1] = "grape";
console.log(fruits);  // ["apple", "grape", "orange"]
```

---

## Array Methods: Adding and Removing

### push() - Add to End

Adds one or more elements to the end of an array:

```javascript
let fruits = ["apple", "banana"];
fruits.push("orange");
console.log(fruits);  // ["apple", "banana", "orange"]

fruits.push("grape", "mango");
console.log(fruits);  // ["apple", "banana", "orange", "grape", "mango"]
```

**Returns**: New length of array

### pop() - Remove from End

Removes and returns the last element:

```javascript
let fruits = ["apple", "banana", "orange"];
let last = fruits.pop();
console.log(last);    // "orange"
console.log(fruits);  // ["apple", "banana"]
```

**Returns**: Removed element (or undefined if array is empty)

### unshift() - Add to Beginning

Adds one or more elements to the beginning:

```javascript
let fruits = ["banana", "orange"];
fruits.unshift("apple");
console.log(fruits);  // ["apple", "banana", "orange"]

fruits.unshift("grape", "mango");
console.log(fruits);  // ["grape", "mango", "apple", "banana", "orange"]
```

**Returns**: New length of array

### shift() - Remove from Beginning

Removes and returns the first element:

```javascript
let fruits = ["apple", "banana", "orange"];
let first = fruits.shift();
console.log(first);   // "apple"
console.log(fruits);  // ["banana", "orange"]
```

**Returns**: Removed element (or undefined if array is empty)

### Comparison

| Method | Adds/Removes | Location | Returns |
|--------|--------------|----------|---------|
| `push()` | Adds | End | Length |
| `pop()` | Removes | End | Element |
| `unshift()` | Adds | Beginning | Length |
| `shift()` | Removes | Beginning | Element |

---

## splice() - Add/Remove Anywhere

`splice()` can add or remove elements at any position.

### Basic Syntax

```javascript
array.splice(start, deleteCount, item1, item2, ...)
```

### Removing Elements

```javascript
let fruits = ["apple", "banana", "orange", "grape"];

// Remove 2 elements starting at index 1
fruits.splice(1, 2);
console.log(fruits);  // ["apple", "grape"]
```

### Adding Elements

```javascript
let fruits = ["apple", "orange"];

// Add at index 1 (don''t delete any)
fruits.splice(1, 0, "banana");
console.log(fruits);  // ["apple", "banana", "orange"]
```

### Replacing Elements

```javascript
let fruits = ["apple", "banana", "orange"];

// Replace 1 element at index 1
fruits.splice(1, 1, "grape");
console.log(fruits);  // ["apple", "grape", "orange"]
```

### Returns Removed Elements

```javascript
let fruits = ["apple", "banana", "orange"];
let removed = fruits.splice(1, 2);
console.log(removed);  // ["banana", "orange"]
console.log(fruits);   // ["apple"]
```

---

## slice() - Copy Array Portion

`slice()` creates a copy of a portion of an array (doesn''t modify original).

### Basic Syntax

```javascript
array.slice(start, end)
```

### Copy Entire Array

```javascript
let fruits = ["apple", "banana", "orange"];
let copy = fruits.slice();
console.log(copy);  // ["apple", "banana", "orange"]
```

### Copy Portion

```javascript
let fruits = ["apple", "banana", "orange", "grape"];

let portion = fruits.slice(1, 3);
console.log(portion);  // ["banana", "orange"]
console.log(fruits);   // ["apple", "banana", "orange", "grape"] (unchanged)
```

### Negative Indices

```javascript
let fruits = ["apple", "banana", "orange", "grape"];

let lastTwo = fruits.slice(-2);
console.log(lastTwo);  // ["orange", "grape"]
```

### slice() vs splice()

- **slice()**: Doesn''t modify original, returns new array
- **splice()**: Modifies original, returns removed elements

---

## Array Iteration Methods

### forEach()

Executes a function for each array element:

```javascript
let fruits = ["apple", "banana", "orange"];

fruits.forEach(function(fruit) {
    console.log(fruit);
});
// apple
// banana
// orange
```

**Arrow function:**
```javascript
fruits.forEach(fruit => console.log(fruit));
```

**With index:**
```javascript
fruits.forEach((fruit, index) => {
    console.log(`${index}: ${fruit}`);
});
```

### map()

Creates a new array by transforming each element:

```javascript
let numbers = [1, 2, 3, 4, 5];
let doubled = numbers.map(num => num * 2);
console.log(doubled);  // [2, 4, 6, 8, 10]
```

**Doesn''t modify original:**
```javascript
let numbers = [1, 2, 3];
let squared = numbers.map(n => n * n);
console.log(numbers);  // [1, 2, 3] (unchanged)
console.log(squared);  // [1, 4, 9]
```

**Transform objects:**
```javascript
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 }
];

let names = users.map(user => user.name);
console.log(names);  // ["Alice", "Bob"]
```

### filter()

Creates a new array with elements that pass a test:

```javascript
let numbers = [1, 2, 3, 4, 5, 6];
let evens = numbers.filter(num => num % 2 === 0);
console.log(evens);  // [2, 4, 6]
```

**Filter objects:**
```javascript
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 17 },
    { name: "Charlie", age: 30 }
];

let adults = users.filter(user => user.age >= 18);
console.log(adults);  // [{ name: "Alice", age: 25 }, { name: "Charlie", age: 30 }]
```

### reduce()

Reduces array to a single value:

```javascript
let numbers = [1, 2, 3, 4, 5];
let sum = numbers.reduce((accumulator, current) => {
    return accumulator + current;
}, 0);
console.log(sum);  // 15
```

**Shorter syntax:**
```javascript
let sum = numbers.reduce((acc, curr) => acc + curr, 0);
```

**Find maximum:**
```javascript
let numbers = [5, 2, 8, 1, 9];
let max = numbers.reduce((acc, curr) => {
    return curr > acc ? curr : acc;
}, numbers[0]);
console.log(max);  // 9
```

**Count occurrences:**
```javascript
let fruits = ["apple", "banana", "apple", "orange", "banana"];
let count = fruits.reduce((acc, fruit) => {
    acc[fruit] = (acc[fruit] || 0) + 1;
    return acc;
}, {});
console.log(count);  // { apple: 2, banana: 2, orange: 1 }
```

---

## Array Searching Methods

### indexOf()

Returns the first index where element is found:

```javascript
let fruits = ["apple", "banana", "orange", "banana"];
console.log(fruits.indexOf("banana"));  // 1
console.log(fruits.indexOf("grape"));    // -1 (not found)
```

**With start index:**
```javascript
let fruits = ["apple", "banana", "orange", "banana"];
console.log(fruits.indexOf("banana", 2));  // 3 (starts searching from index 2)
```

### lastIndexOf()

Returns the last index where element is found:

```javascript
let fruits = ["apple", "banana", "orange", "banana"];
console.log(fruits.lastIndexOf("banana"));  // 3
```

### includes()

Checks if array contains an element:

```javascript
let fruits = ["apple", "banana", "orange"];
console.log(fruits.includes("banana"));  // true
console.log(fruits.includes("grape"));   // false
```

### find()

Returns the first element that passes a test:

```javascript
let numbers = [1, 5, 3, 8, 2];
let found = numbers.find(num => num > 5);
console.log(found);  // 8
```

**With objects:**
```javascript
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 },
    { name: "Charlie", age: 20 }
];

let user = users.find(u => u.age > 25);
console.log(user);  // { name: "Bob", age: 30 }
```

### findIndex()

Returns the index of the first element that passes a test:

```javascript
let numbers = [1, 5, 3, 8, 2];
let index = numbers.findIndex(num => num > 5);
console.log(index);  // 3
```

---

## Practice Exercise

### Exercise: Array Operations

**Objective**: Practice using various array methods and operations.

**Instructions**:

1. Create a file called `arrays-practice.js`

2. Create arrays and practice:
   - Creating arrays
   - Accessing and modifying elements
   - Using push, pop, shift, unshift
   - Using splice and slice
   - Iterating with forEach, map, filter, reduce
   - Searching with indexOf, find, includes

3. Build practical examples:
   - Shopping cart
   - Student grades
   - User list operations

**Example Solution**:

```javascript
// Arrays Practice
console.log("=== Creating Arrays ===");
let fruits = ["apple", "banana", "orange"];
let numbers = [1, 2, 3, 4, 5];
let empty = [];

console.log("Fruits:", fruits);
console.log("Numbers:", numbers);
console.log("Empty:", empty);
console.log();

console.log("=== Accessing Elements ===");
console.log("First fruit:", fruits[0]);           // "apple"
console.log("Last fruit:", fruits[fruits.length - 1]);  // "orange"
console.log("Array length:", fruits.length);      // 3
console.log();

console.log("=== push() and pop() ===");
let stack = [];
stack.push(1);
stack.push(2);
stack.push(3);
console.log("After push:", stack);  // [1, 2, 3]

let last = stack.pop();
console.log("Popped:", last);        // 3
console.log("After pop:", stack);    // [1, 2]
console.log();

console.log("=== unshift() and shift() ===");
let queue = [];
queue.unshift(1);
queue.unshift(2);
queue.unshift(3);
console.log("After unshift:", queue);  // [3, 2, 1]

let first = queue.shift();
console.log("Shifted:", first);        // 3
console.log("After shift:", queue);    // [2, 1]
console.log();

console.log("=== splice() ===");
let items = ["a", "b", "c", "d", "e"];

// Remove elements
let removed = items.splice(1, 2);
console.log("Removed:", removed);      // ["b", "c"]
console.log("After remove:", items);   // ["a", "d", "e"]

// Add elements
items.splice(1, 0, "x", "y");
console.log("After add:", items);      // ["a", "x", "y", "d", "e"]

// Replace
items.splice(2, 1, "z");
console.log("After replace:", items);  // ["a", "x", "z", "d", "e"]
console.log();

console.log("=== slice() ===");
let original = [1, 2, 3, 4, 5];
let copy = original.slice();
let portion = original.slice(1, 4);
let lastTwo = original.slice(-2);

console.log("Original:", original);    // [1, 2, 3, 4, 5]
console.log("Copy:", copy);            // [1, 2, 3, 4, 5]
console.log("Portion:", portion);      // [2, 3, 4]
console.log("Last two:", lastTwo);     // [4, 5]
console.log();

console.log("=== forEach() ===");
let numbers2 = [1, 2, 3, 4, 5];
numbers2.forEach((num, index) => {
    console.log(`Index ${index}: ${num}`);
});
console.log();

console.log("=== map() ===");
let numbers3 = [1, 2, 3, 4, 5];
let doubled = numbers3.map(n => n * 2);
let squared = numbers3.map(n => n * n);

console.log("Original:", numbers3);   // [1, 2, 3, 4, 5]
console.log("Doubled:", doubled);      // [2, 4, 6, 8, 10]
console.log("Squared:", squared);     // [1, 4, 9, 16, 25]
console.log();

console.log("=== filter() ===");
let numbers4 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let evens = numbers4.filter(n => n % 2 === 0);
let greaterThan5 = numbers4.filter(n => n > 5);

console.log("Evens:", evens);              // [2, 4, 6, 8, 10]
console.log("Greater than 5:", greaterThan5); // [6, 7, 8, 9, 10]
console.log();

console.log("=== reduce() ===");
let numbers5 = [1, 2, 3, 4, 5];
let sum = numbers5.reduce((acc, curr) => acc + curr, 0);
let product = numbers5.reduce((acc, curr) => acc * curr, 1);
let max = numbers5.reduce((acc, curr) => curr > acc ? curr : acc, numbers5[0]);

console.log("Sum:", sum);        // 15
console.log("Product:", product); // 120
console.log("Max:", max);        // 5
console.log();

console.log("=== Searching ===");
let fruits2 = ["apple", "banana", "orange", "banana"];

console.log("indexOf banana:", fruits2.indexOf("banana"));        // 1
console.log("lastIndexOf banana:", fruits2.lastIndexOf("banana")); // 3
console.log("includes apple:", fruits2.includes("apple"));        // true
console.log("includes grape:", fruits2.includes("grape"));       // false

let numbers6 = [1, 5, 3, 8, 2];
let found = numbers6.find(n => n > 5);
let foundIndex = numbers6.findIndex(n => n > 5);

console.log("Find > 5:", found);        // 8
console.log("FindIndex > 5:", foundIndex); // 3
console.log();

console.log("=== Practical Example: Shopping Cart ===");
let cart = [];

// Add items
cart.push({ name: "Apple", price: 1.50, quantity: 3 });
cart.push({ name: "Banana", price: 0.75, quantity: 5 });
cart.push({ name: "Orange", price: 2.00, quantity: 2 });

console.log("Cart items:", cart.length);

// Calculate total
let total = cart.reduce((sum, item) => {
    return sum + (item.price * item.quantity);
}, 0);
console.log("Cart total: $" + total.toFixed(2));

// Remove item
let bananaIndex = cart.findIndex(item => item.name === "Banana");
if (bananaIndex !== -1) {
    cart.splice(bananaIndex, 1);
}
console.log("After removing banana:", cart.length);

// Update quantity
let apple = cart.find(item => item.name === "Apple");
if (apple) {
    apple.quantity = 5;
}
console.log("Updated cart:", cart);
console.log();

console.log("=== Practical Example: Student Grades ===");
let students = [
    { name: "Alice", grade: 85 },
    { name: "Bob", grade: 92 },
    { name: "Charlie", grade: 78 },
    { name: "Diana", grade: 95 }
];

// Get all names
let names = students.map(s => s.name);
console.log("Student names:", names);

// Get passing grades (>= 80)
let passing = students.filter(s => s.grade >= 80);
console.log("Passing students:", passing.length);

// Calculate average
let average = students.reduce((sum, s) => sum + s.grade, 0) / students.length;
console.log("Average grade:", average.toFixed(2));

// Find highest grade
let topStudent = students.reduce((top, curr) => {
    return curr.grade > top.grade ? curr : top;
}, students[0]);
console.log("Top student:", topStudent.name, "-", topStudent.grade);
```

**Expected Output**:
```
=== Creating Arrays ===
Fruits: [ "apple", "banana", "orange" ]
Numbers: [ 1, 2, 3, 4, 5 ]
Empty: []

=== Accessing Elements ===
First fruit: apple
Last fruit: orange
Array length: 3

=== push() and pop() ===
After push: [ 1, 2, 3 ]
Popped: 3
After pop: [ 1, 2 ]

=== unshift() and shift() ===
After unshift: [ 3, 2, 1 ]
Shifted: 3
After shift: [ 2, 1 ]

=== splice() ===
Removed: [ "b", "c" ]
After remove: [ "a", "d", "e" ]
After add: [ "a", "x", "y", "d", "e" ]
After replace: [ "a", "x", "z", "d", "e" ]

=== slice() ===
Original: [ 1, 2, 3, 4, 5 ]
Copy: [ 1, 2, 3, 4, 5 ]
Portion: [ 2, 3, 4 ]
Last two: [ 4, 5 ]

=== forEach() ===
Index 0: 1
Index 1: 2
Index 2: 3
Index 3: 4
Index 4: 5

=== map() ===
Original: [ 1, 2, 3, 4, 5 ]
Doubled: [ 2, 4, 6, 8, 10 ]
Squared: [ 1, 4, 9, 16, 25 ]

=== filter() ===
Evens: [ 2, 4, 6, 8, 10 ]
Greater than 5: [ 6, 7, 8, 9, 10 ]

=== reduce() ===
Sum: 15
Product: 120
Max: 5

=== Searching ===
indexOf banana: 1
lastIndexOf banana: 3
includes apple: true
includes grape: false
Find > 5: 8
FindIndex > 5: 3

=== Practical Example: Shopping Cart ===
Cart items: 3
Cart total: $13.00
After removing banana: 2
Updated cart: [ { name: "Apple", price: 1.5, quantity: 5 }, { name: "Orange", price: 2, quantity: 2 } ]

=== Practical Example: Student Grades ===
Student names: [ "Alice", "Bob", "Charlie", "Diana" ]
Passing students: 4
Average grade: 87.50
Top student: Diana - 95
```

**Challenge (Optional)**:
- Build a todo list application
- Create a data processing pipeline
- Build a search and filter system
- Create array manipulation utilities

---

## Common Mistakes

### 1. Confusing splice() and slice()

```javascript
let arr = [1, 2, 3, 4, 5];

// splice() modifies original
let removed = arr.splice(1, 2);
console.log(arr);  // [1, 4, 5] (modified!)

// slice() doesn''t modify
let arr2 = [1, 2, 3, 4, 5];
let portion = arr2.slice(1, 3);
console.log(arr2);  // [1, 2, 3, 4, 5] (unchanged)
```

### 2. Modifying During Iteration

```javascript
// ⚠️ Can cause issues
let arr = [1, 2, 3, 4, 5];
arr.forEach((item, index) => {
    if (item === 3) {
        arr.splice(index, 1);  // Modifying while iterating
    }
});

// ✅ Better: Create new array
let filtered = arr.filter(item => item !== 3);
```

### 3. Forgetting map() Returns New Array

```javascript
// ⚠️ map() doesn''t modify original
let numbers = [1, 2, 3];
numbers.map(n => n * 2);
console.log(numbers);  // [1, 2, 3] (unchanged!)

// ✅ Assign result
let doubled = numbers.map(n => n * 2);
console.log(doubled);  // [2, 4, 6]
```

### 4. Wrong reduce() Initial Value

```javascript
// ⚠️ For sum, start with 0
let sum = [1, 2, 3].reduce((acc, curr) => acc + curr);  // Works but...

// ✅ Explicit initial value
let sum = [1, 2, 3].reduce((acc, curr) => acc + curr, 0);
```

### 5. indexOf() with Objects

```javascript
// ⚠️ Doesn''t work with objects
let arr = [{ id: 1 }, { id: 2 }];
console.log(arr.indexOf({ id: 1 }));  // -1 (different objects)

// ✅ Use findIndex()
let index = arr.findIndex(item => item.id === 1);  // 0
```

---

## Key Takeaways

1. **Creating Arrays**: Use `[]` literal (preferred)
2. **Accessing**: Zero-indexed, use `[index]`
3. **Modifying Methods**: `push()`, `pop()`, `shift()`, `unshift()`, `splice()`
4. **Copying Methods**: `slice()` (doesn''t modify original)
5. **Iteration**: `forEach()`, `map()`, `filter()`, `reduce()`
6. **Searching**: `indexOf()`, `find()`, `includes()`
7. **Immutability**: `map()`, `filter()`, `slice()` don''t modify original
8. **Mutability**: `push()`, `pop()`, `splice()` modify original

---

## Quiz: Arrays

Test your understanding with these questions:

1. **What is the index of the first element in an array?**
   - A) 1
   - B) 0
   - C) -1
   - D) undefined

2. **What does `push()` return?**
   - A) The added element
   - B) The new length
   - C) The array
   - D) undefined

3. **Which method doesn''t modify the original array?**
   - A) push()
   - B) splice()
   - C) slice()
   - D) pop()

4. **What does `map()` do?**
   - A) Filters elements
   - B) Transforms each element
   - C) Reduces to single value
   - D) Modifies original array

5. **What does `indexOf()` return if element not found?**
   - A) undefined
   - B) -1
   - C) 0
   - D) null

6. **Which finds first element matching condition?**
   - A) filter()
   - B) find()
   - C) indexOf()
   - D) includes()

7. **What does `reduce()` do?**
   - A) Filters array
   - B) Maps array
   - C) Reduces to single value
   - D) Iterates array

**Answers**:
1. B) 0
2. B) The new length
3. C) slice()
4. B) Transforms each element
5. B) -1
6. B) find()
7. C) Reduces to single value

---

## Next Steps

Congratulations! You''ve learned about arrays. You now know:
- How to create and access arrays
- Array modification methods
- Array iteration methods
- Array searching methods

**What''s Next?**
- Lesson 5.3: Advanced Array Operations
- Practice combining array methods
- Build data processing pipelines
- Work with complex array operations

---

## Additional Resources

- **MDN: Array**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)
- **MDN: Array Methods**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#instance_methods](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#instance_methods)
- **JavaScript.info: Arrays**: [javascript.info/array](https://javascript.info/array)
- **JavaScript.info: Array Methods**: [javascript.info/array-methods](https://javascript.info/array-methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:33:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create arrays using different methods
- Access and modify array elements
- Use array modification methods (push, pop, shift, unshift, splice, slice)
- Iterate over arrays (forEach, map, filter, reduce)
- Search arrays (indexOf, find, includes)
- Understand array immutability vs mutability
- Work with array methods effectively');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (122, 45, 10, 'Advanced Array Operations', 'advanced-array-operations', '# Lesson 5.3: Advanced Array Operations

## Learning Objectives

By the end of this lesson, you will be able to:
- Use array testing methods (some, every)
- Sort and reverse arrays
- Destructure arrays to extract values
- Use spread operator with arrays effectively
- Work with multidimensional arrays
- Combine advanced array techniques
- Write efficient array manipulation code

---

## Introduction

Advanced array operations enable powerful data manipulation. These techniques make arrays more versatile and your code more expressive.

---

## Array Testing Methods

### some()

Tests if at least one element passes a test. Returns `true` if any element passes, `false` otherwise.

```javascript
let numbers = [1, 2, 3, 4, 5];
let hasEven = numbers.some(num => num % 2 === 0);
console.log(hasEven);  // true (has at least one even number)
```

**Examples:**
```javascript
// Check if any number is greater than 10
let numbers = [1, 5, 8, 12, 3];
let hasLarge = numbers.some(n => n > 10);
console.log(hasLarge);  // true

// Check if any user is admin
let users = [
    { name: "Alice", role: "user" },
    { name: "Bob", role: "admin" },
    { name: "Charlie", role: "user" }
];
let hasAdmin = users.some(u => u.role === "admin");
console.log(hasAdmin);  // true
```

### every()

Tests if all elements pass a test. Returns `true` only if all elements pass.

```javascript
let numbers = [2, 4, 6, 8, 10];
let allEven = numbers.every(num => num % 2 === 0);
console.log(allEven);  // true (all are even)
```

**Examples:**
```javascript
// Check if all numbers are positive
let numbers = [1, 5, 8, 12, 3];
let allPositive = numbers.every(n => n > 0);
console.log(allPositive);  // true

// Check if all users are adults
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 },
    { name: "Charlie", age: 17 }
];
let allAdults = users.every(u => u.age >= 18);
console.log(allAdults);  // false (Charlie is 17)
```

### some() vs every()

```javascript
let numbers = [1, 2, 3, 4, 5];

// some: at least one
console.log(numbers.some(n => n > 3));  // true (4, 5)

// every: all
console.log(numbers.every(n => n > 3)); // false (1, 2, 3 don''t pass)
```

---

## Sorting Arrays

### sort()

Sorts array elements. **Modifies the original array.**

### String Sorting (Default)

```javascript
let fruits = ["banana", "apple", "orange"];
fruits.sort();
console.log(fruits);  // ["apple", "banana", "orange"]
```

### Number Sorting

**⚠️ Default sort converts to strings:**
```javascript
let numbers = [10, 2, 5, 1, 20];
numbers.sort();
console.log(numbers);  // [1, 10, 2, 20, 5] (wrong! string sort)
```

**✅ Correct number sorting:**
```javascript
let numbers = [10, 2, 5, 1, 20];

// Ascending
numbers.sort((a, b) => a - b);
console.log(numbers);  // [1, 2, 5, 10, 20]

// Descending
numbers.sort((a, b) => b - a);
console.log(numbers);  // [20, 10, 5, 2, 1]
```

### Sort Comparison Function

The comparison function should return:
- Negative: `a` comes before `b`
- Zero: `a` and `b` are equal
- Positive: `a` comes after `b`

```javascript
// Ascending: a - b
[10, 2, 5].sort((a, b) => a - b);  // [2, 5, 10]

// Descending: b - a
[10, 2, 5].sort((a, b) => b - a);  // [10, 5, 2]
```

### Sorting Objects

```javascript
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 },
    { name: "Charlie", age: 20 }
];

// Sort by age (ascending)
users.sort((a, b) => a.age - b.age);
console.log(users);
// [{ name: "Charlie", age: 20 }, { name: "Alice", age: 25 }, { name: "Bob", age: 30 }]

// Sort by name (alphabetical)
users.sort((a, b) => {
    if (a.name < b.name) return -1;
    if (a.name > b.name) return 1;
    return 0;
});
```

### reverse()

Reverses the order of array elements. **Modifies the original array.**

```javascript
let numbers = [1, 2, 3, 4, 5];
numbers.reverse();
console.log(numbers);  // [5, 4, 3, 2, 1]
```

**Combining sort and reverse:**
```javascript
let numbers = [3, 1, 4, 2, 5];
numbers.sort((a, b) => a - b).reverse();
console.log(numbers);  // [5, 4, 3, 2, 1] (sorted descending)
```

---

## Array Destructuring

Array destructuring allows you to extract values from arrays into variables.

### Basic Destructuring

```javascript
let numbers = [1, 2, 3];
let [a, b, c] = numbers;
console.log(a, b, c);  // 1, 2, 3
```

### Skipping Elements

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, , third, , fifth] = numbers;
console.log(first, third, fifth);  // 1, 3, 5
```

### Default Values

```javascript
let numbers = [1, 2];
let [a, b, c = 10] = numbers;
console.log(a, b, c);  // 1, 2, 10 (c uses default)
```

### Rest in Destructuring

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, second, ...rest] = numbers;
console.log(first);   // 1
console.log(second);  // 2
console.log(rest);    // [3, 4, 5]
```

### Swapping Variables

```javascript
let a = 5;
let b = 10;
[a, b] = [b, a];
console.log(a, b);  // 10, 5
```

### Function Return Values

```javascript
function getNumbers() {
    return [1, 2, 3];
}

let [x, y, z] = getNumbers();
console.log(x, y, z);  // 1, 2, 3
```

### Nested Destructuring

```javascript
let numbers = [1, [2, 3], 4];
let [a, [b, c], d] = numbers;
console.log(a, b, c, d);  // 1, 2, 3, 4
```

### Practical Examples

```javascript
// Extract first and last
let names = ["Alice", "Bob", "Charlie", "Diana"];
let [first, ...middle, last] = names;  // ⚠️ Rest must be last
// Better:
let [first] = names;
let last = names[names.length - 1];

// Function parameters
function process([first, second]) {
    console.log(first, second);
}
process([1, 2]);  // 1, 2
```

---

## Spread Operator with Arrays

The spread operator (`...`) expands arrays into individual elements.

### Copying Arrays

```javascript
let original = [1, 2, 3];
let copy = [...original];
copy.push(4);
console.log(original);  // [1, 2, 3] (unchanged)
console.log(copy);     // [1, 2, 3, 4]
```

### Combining Arrays

```javascript
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let combined = [...arr1, ...arr2];
console.log(combined);  // [1, 2, 3, 4, 5, 6]
```

### Adding Elements

```javascript
let numbers = [2, 3, 4];
let withFirst = [1, ...numbers];
let withLast = [...numbers, 5];
let withBoth = [1, ...numbers, 5];
console.log(withBoth);  // [1, 2, 3, 4, 5]
```

### Function Arguments

```javascript
function add(a, b, c) {
    return a + b + c;
}

let numbers = [1, 2, 3];
console.log(add(...numbers));  // 6
```

### Math Operations

```javascript
let numbers = [5, 10, 15, 20, 25];
console.log(Math.max(...numbers));  // 25
console.log(Math.min(...numbers));  // 5
```

### Converting String to Array

```javascript
let str = "Hello";
let chars = [...str];
console.log(chars);  // ["H", "e", "l", "l", "o"]
```

### Removing Duplicates

```javascript
let numbers = [1, 2, 2, 3, 3, 4];
let unique = [...new Set(numbers)];
console.log(unique);  // [1, 2, 3, 4]
```

---

## Multidimensional Arrays

Arrays can contain other arrays, creating multidimensional structures.

### 2D Arrays (Matrix)

```javascript
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

console.log(matrix[0][0]);  // 1 (first row, first column)
console.log(matrix[1][2]);  // 6 (second row, third column)
```

### Accessing Elements

```javascript
let matrix = [
    [1, 2, 3],
    [4, 5, 6]
];

// Access row
console.log(matrix[0]);  // [1, 2, 3]

// Access element
console.log(matrix[0][1]);  // 2
```

### Iterating 2D Arrays

```javascript
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

// Nested loops
for (let i = 0; i < matrix.length; i++) {
    for (let j = 0; j < matrix[i].length; j++) {
        console.log(matrix[i][j]);
    }
}

// for...of
for (let row of matrix) {
    for (let cell of row) {
        console.log(cell);
    }
}

// forEach
matrix.forEach(row => {
    row.forEach(cell => {
        console.log(cell);
    });
});
```

### Creating 2D Arrays

```javascript
// Empty 3x3 matrix
let matrix = [];
for (let i = 0; i < 3; i++) {
    matrix[i] = [];
    for (let j = 0; j < 3; j++) {
        matrix[i][j] = 0;
    }
}
console.log(matrix);
// [[0, 0, 0], [0, 0, 0], [0, 0, 0]]
```

### 3D Arrays

```javascript
let cube = [
    [
        [1, 2],
        [3, 4]
    ],
    [
        [5, 6],
        [7, 8]
    ]
];

console.log(cube[0][0][0]);  // 1
console.log(cube[1][1][1]);  // 8
```

### Practical Example: Tic-Tac-Toe

```javascript
let board = [
    ["X", "O", "X"],
    ["O", "X", "O"],
    ["X", "O", "X"]
];

function printBoard(board) {
    board.forEach(row => {
        console.log(row.join(" | "));
    });
}

printBoard(board);
// X | O | X
// O | X | O
// X | O | X
```

---

## Combining Advanced Techniques

### Destructuring + Spread

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, ...rest] = numbers;
let doubled = rest.map(n => n * 2);
let result = [first, ...doubled];
console.log(result);  // [1, 4, 6, 8, 10]
```

### Sort + Destructure

```javascript
let users = [
    { name: "Alice", age: 25 },
    { name: "Bob", age: 30 },
    { name: "Charlie", age: 20 }
];

users.sort((a, b) => b.age - a.age);  // Sort by age descending
let [oldest, ...others] = users;
console.log(oldest.name);  // "Bob"
```

### Filter + Map + Spread

```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let evens = numbers.filter(n => n % 2 === 0);
let doubled = evens.map(n => n * 2);
let result = [0, ...doubled, 20];
console.log(result);  // [0, 4, 8, 12, 16, 20]
```

---

## Practice Exercise

### Exercise: Advanced Array Manipulation

**Objective**: Practice advanced array operations including some, every, sort, destructuring, spread, and multidimensional arrays.

**Instructions**:

1. Create a file called `advanced-arrays.js`

2. Practice:
   - Using some() and every()
   - Sorting arrays (numbers, objects, strings)
   - Array destructuring
   - Spread operator with arrays
   - Working with 2D arrays

3. Build practical examples:
   - Data validation
   - Matrix operations
   - Data transformation

**Example Solution**:

```javascript
// Advanced Arrays Practice
console.log("=== some() and every() ===");

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

let hasEven = numbers.some(n => n % 2 === 0);
let allPositive = numbers.every(n => n > 0);
let allEven = numbers.every(n => n % 2 === 0);

console.log("Has even:", hasEven);        // true
console.log("All positive:", allPositive); // true
console.log("All even:", allEven);        // false

let users = [
    { name: "Alice", age: 25, active: true },
    { name: "Bob", age: 30, active: true },
    { name: "Charlie", age: 20, active: false }
];

let hasInactive = users.some(u => !u.active);
let allAdults = users.every(u => u.age >= 18);
let allActive = users.every(u => u.active);

console.log("Has inactive:", hasInactive);  // true
console.log("All adults:", allAdults);       // true
console.log("All active:", allActive);       // false
console.log();

console.log("=== Sorting ===");

// Number sorting
let numbers2 = [10, 2, 5, 1, 20, 3];
numbers2.sort((a, b) => a - b);
console.log("Ascending:", numbers2);  // [1, 2, 3, 5, 10, 20]

numbers2.sort((a, b) => b - a);
console.log("Descending:", numbers2); // [20, 10, 5, 3, 2, 1]

// String sorting
let fruits = ["banana", "apple", "orange", "grape"];
fruits.sort();
console.log("Fruits sorted:", fruits);  // ["apple", "banana", "grape", "orange"]

// Object sorting
let students = [
    { name: "Alice", grade: 85 },
    { name: "Bob", grade: 92 },
    { name: "Charlie", grade: 78 },
    { name: "Diana", grade: 95 }
];

students.sort((a, b) => b.grade - a.grade);  // Sort by grade descending
console.log("Students by grade:");
students.forEach(s => {
    console.log(`${s.name}: ${s.grade}`);
});
console.log();

console.log("=== reverse() ===");
let numbers3 = [1, 2, 3, 4, 5];
numbers3.reverse();
console.log("Reversed:", numbers3);  // [5, 4, 3, 2, 1]

// Sort then reverse
let numbers4 = [3, 1, 4, 2, 5];
numbers4.sort((a, b) => a - b).reverse();
console.log("Sorted descending:", numbers4);  // [5, 4, 3, 2, 1]
console.log();

console.log("=== Array Destructuring ===");

// Basic
let numbers5 = [1, 2, 3];
let [a, b, c] = numbers5;
console.log("Destructured:", a, b, c);  // 1, 2, 3

// Skipping
let numbers6 = [1, 2, 3, 4, 5];
let [first, , third, , fifth] = numbers6;
console.log("Skipped:", first, third, fifth);  // 1, 3, 5

// Default values
let numbers7 = [1, 2];
let [x, y, z = 10] = numbers7;
console.log("With default:", x, y, z);  // 1, 2, 10

// Rest
let numbers8 = [1, 2, 3, 4, 5];
let [first2, ...rest] = numbers8;
console.log("First:", first2);    // 1
console.log("Rest:", rest);        // [2, 3, 4, 5]

// Swapping
let p = 5;
let q = 10;
[p, q] = [q, p];
console.log("Swapped:", p, q);  // 10, 5

// Function return
function getCoords() {
    return [10, 20];
}
let [xCoord, yCoord] = getCoords();
console.log("Coords:", xCoord, yCoord);  // 10, 20
console.log();

console.log("=== Spread Operator ===");

// Copying
let original = [1, 2, 3];
let copy = [...original];
copy.push(4);
console.log("Original:", original);  // [1, 2, 3]
console.log("Copy:", copy);          // [1, 2, 3, 4]

// Combining
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
let combined = [...arr1, ...arr2];
console.log("Combined:", combined);  // [1, 2, 3, 4, 5, 6]

// Adding elements
let numbers9 = [2, 3, 4];
let withBoth = [1, ...numbers9, 5];
console.log("With both:", withBoth);  // [1, 2, 3, 4, 5]

// Math operations
let numbers10 = [5, 10, 15, 20, 25];
console.log("Max:", Math.max(...numbers10));  // 25
console.log("Min:", Math.min(...numbers10));  // 5

// Removing duplicates
let duplicates = [1, 2, 2, 3, 3, 4, 4, 5];
let unique = [...new Set(duplicates)];
console.log("Unique:", unique);  // [1, 2, 3, 4, 5]
console.log();

console.log("=== Multidimensional Arrays ===");

// 2D Array
let matrix = [
    [1, 2, 3],
    [4, 5, 6],
    [7, 8, 9]
];

console.log("Matrix:");
matrix.forEach(row => {
    console.log(row);
});

console.log("Element [1][2]:", matrix[1][2]);  // 6

// Sum all elements
let sum = 0;
matrix.forEach(row => {
    row.forEach(cell => {
        sum += cell;
    });
});
console.log("Sum of all:", sum);  // 45

// Transpose matrix
function transpose(matrix) {
    return matrix[0].map((_, colIndex) => {
        return matrix.map(row => row[colIndex]);
    });
}

let transposed = transpose(matrix);
console.log("Transposed:");
transposed.forEach(row => {
    console.log(row);
});
console.log();

console.log("=== Combining Techniques ===");

// Sort + Destructure + Spread
let users2 = [
    { name: "Alice", score: 85 },
    { name: "Bob", score: 92 },
    { name: "Charlie", score: 78 }
];

users2.sort((a, b) => b.score - a.score);
let [top, ...others] = users2;
let topScores = [top, ...others.filter(u => u.score >= 80)];

console.log("Top scorer:", top.name);
console.log("Top scores:", topScores.map(u => u.name));

// Filter + Map + Spread
let numbers11 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let processed = [
    0,
    ...numbers11.filter(n => n % 2 === 0).map(n => n * 2),
    100
];
console.log("Processed:", processed);  // [0, 4, 8, 12, 16, 20, 100]

// Destructure + Spread in function
function processData([first, ...rest]) {
    return [first * 2, ...rest.map(n => n + 1)];
}

let result = processData([1, 2, 3, 4]);
console.log("Processed data:", result);  // [2, 3, 4, 5]
```

**Expected Output**:
```
=== some() and every() ===
Has even: true
All positive: true
All even: false
Has inactive: true
All adults: true
All active: false

=== Sorting ===
Ascending: [1, 2, 3, 5, 10, 20]
Descending: [20, 10, 5, 3, 2, 1]
Fruits sorted: ["apple", "banana", "grape", "orange"]
Students by grade:
Diana: 95
Bob: 92
Alice: 85
Charlie: 78

=== reverse() ===
Reversed: [5, 4, 3, 2, 1]
Sorted descending: [5, 4, 3, 2, 1]

=== Array Destructuring ===
Destructured: 1, 2, 3
Skipped: 1, 3, 5
With default: 1, 2, 10
First: 1
Rest: [2, 3, 4, 5]
Swapped: 10, 5
Coords: 10, 20

=== Spread Operator ===
Original: [1, 2, 3]
Copy: [1, 2, 3, 4]
Combined: [1, 2, 3, 4, 5, 6]
With both: [1, 2, 3, 4, 5]
Max: 25
Min: 5
Unique: [1, 2, 3, 4, 5]

=== Multidimensional Arrays ===
Matrix:
[1, 2, 3]
[4, 5, 6]
[7, 8, 9]
Element [1][2]: 6
Sum of all: 45
Transposed:
[1, 4, 7]
[2, 5, 8]
[3, 6, 9]

=== Combining Techniques ===
Top scorer: Bob
Top scores: ["Bob", "Alice"]
Processed: [0, 4, 8, 12, 16, 20, 100]
Processed data: [2, 3, 4, 5]
```

**Challenge (Optional)**:
- Build a matrix calculator
- Create a data processing pipeline
- Build a sorting and filtering system
- Create array utility functions

---

## Common Mistakes

### 1. Forgetting sort() Modifies Original

```javascript
// ⚠️ Original is modified
let numbers = [3, 1, 2];
let sorted = numbers.sort();
console.log(numbers);  // [1, 2, 3] (modified!)

// ✅ Copy first
let numbers2 = [3, 1, 2];
let sorted2 = [...numbers2].sort();
console.log(numbers2);  // [3, 1, 2] (unchanged)
```

### 2. Wrong Number Sort

```javascript
// ❌ Wrong: String sort
let numbers = [10, 2, 5];
numbers.sort();
console.log(numbers);  // [10, 2, 5] (wrong!)

// ✅ Correct: Number sort
numbers.sort((a, b) => a - b);
console.log(numbers);  // [2, 5, 10]
```

### 3. Destructuring Rest Position

```javascript
// ❌ Error: Rest must be last
// let [first, ...middle, last] = [1, 2, 3, 4];

// ✅ Correct
let [first, ...rest] = [1, 2, 3, 4];
let last = rest[rest.length - 1];
```

### 4. Confusing some() and every()

```javascript
let numbers = [1, 2, 3, 4, 5];

// some: at least one
console.log(numbers.some(n => n > 3));  // true

// every: all
console.log(numbers.every(n => n > 3)); // false
```

### 5. Multidimensional Array Access

```javascript
let matrix = [[1, 2], [3, 4]];

// ✅ Correct
console.log(matrix[0][1]);  // 2

// ❌ Wrong
// console.log(matrix[0, 1]);  // Doesn''t work
```

---

## Key Takeaways

1. **some()**: Returns true if at least one element passes test
2. **every()**: Returns true only if all elements pass test
3. **sort()**: Sorts array (modifies original), use comparison function for numbers
4. **reverse()**: Reverses array order (modifies original)
5. **Destructuring**: Extract values from arrays into variables
6. **Spread**: Expand arrays into individual elements
7. **Multidimensional**: Arrays containing arrays
8. **Combine**: Use techniques together for powerful operations

---

## Quiz: Advanced Arrays

Test your understanding with these questions:

1. **What does `some()` return if no elements pass?**
   - A) true
   - B) false
   - C) undefined
   - D) []

2. **What does `every()` return if all elements pass?**
   - A) true
   - B) false
   - C) undefined
   - D) []

3. **What does `sort()` do by default?**
   - A) Sorts numbers correctly
   - B) Sorts as strings
   - C) Doesn''t sort
   - D) Random order

4. **What does `[...arr]` do?**
   - A) Modifies arr
   - B) Creates copy of arr
   - C) Deletes arr
   - D) Nothing

5. **In destructuring, rest must be:**
   - A) First
   - B) Last
   - C) Middle
   - D) Anywhere

6. **What is `matrix[1][2]` accessing?**
   - A) First row, second column
   - B) Second row, third column
   - C) Third row, second column
   - D) Error

7. **Which modifies the original array?**
   - A) slice()
   - B) map()
   - C) sort()
   - D) filter()

**Answers**:
1. B) false
2. A) true
3. B) Sorts as strings
4. B) Creates copy of arr
5. B) Last
6. B) Second row, third column
7. C) sort()

---

## Next Steps

Congratulations! You''ve completed Module 5: Objects and Arrays. You now know:
- How to work with objects
- Array basics and methods
- Advanced array operations

**What''s Next?**
- Module 6: Object-Oriented Programming
- Lesson 6.1: Object-Oriented Basics
- Practice combining objects and arrays
- Build complex data structures

---

## Additional Resources

- **MDN: Array Methods**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)
- **MDN: Destructuring**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)
- **JavaScript.info: Array Methods**: [javascript.info/array-methods](https://javascript.info/array-methods)
- **JavaScript.info: Destructuring**: [javascript.info/destructuring-assignment](https://javascript.info/destructuring-assignment)

---

*Lesson completed! You''ve finished Module 5: Objects and Arrays. Ready for Module 6: Object-Oriented Programming!*

', NULL, 3, '2026-01-03 09:33:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use array testing methods (some, every)
- Sort and reverse arrays
- Destructure arrays to extract values
- Use spread operator with arrays effectively
- Work with multidimensional arrays
- Combine advanced array techniques
- Write efficient array manipulation code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (123, 46, 10, 'Object-Oriented Basics', 'object-oriented-basics', '# Lesson 6.1: Object-Oriented Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Create objects using constructor functions
- Understand prototypes and the prototype chain
- Use the instanceof operator to check object types
- Add methods to prototypes
- Understand how JavaScript implements inheritance
- Work with constructor patterns

---

## Introduction to Object-Oriented Programming

Object-Oriented Programming (OOP) is a programming paradigm that organizes code around objects and classes. JavaScript uses prototypes for OOP, which is different from class-based languages but equally powerful.

### Key OOP Concepts

- **Encapsulation**: Bundling data and methods together
- **Inheritance**: Objects can inherit properties and methods
- **Polymorphism**: Different objects can respond to the same method
- **Abstraction**: Hiding complex implementation details

---

## Constructor Functions

Constructor functions are used to create multiple objects with the same structure. They''re like blueprints for creating objects.

### Basic Constructor

```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;
}

let person1 = new Person("Alice", 25);
let person2 = new Person("Bob", 30);

console.log(person1);  // Person { name: "Alice", age: 25 }
console.log(person2);  // Person { name: "Bob", age: 30 }
```

### The `new` Keyword

The `new` keyword does several things:
1. Creates a new empty object
2. Sets `this` to point to the new object
3. Executes the constructor function
4. Returns the new object (unless constructor returns something else)

```javascript
function Person(name) {
    this.name = name;
}

let person = new Person("Alice");
// What happens:
// 1. New object created: {}
// 2. this = {}
// 3. this.name = "Alice"
// 4. Return { name: "Alice" }
```

### Constructor Naming Convention

Constructor functions are typically named with PascalCase (first letter uppercase):

```javascript
// ✅ Good: PascalCase
function Person(name) { }
function Car(brand) { }
function User(email) { }

// ❌ Avoid: camelCase (confusing)
function person(name) { }
```

### Adding Methods

You can add methods inside the constructor:

```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;
    
    this.greet = function() {
        return `Hello, I''m ${this.name}`;
    };
    
    this.haveBirthday = function() {
        this.age++;
        return `Happy birthday! Now I''m ${this.age}`;
    };
}

let person = new Person("Alice", 25);
console.log(person.greet());        // "Hello, I''m Alice"
console.log(person.haveBirthday()); // "Happy birthday! Now I''m 26"
```

**⚠️ Problem**: Each instance gets its own copy of methods (memory inefficient).

**✅ Better**: Add methods to prototype (covered next).

### Constructor Examples

```javascript
// Car constructor
function Car(brand, model, year) {
    this.brand = brand;
    this.model = model;
    this.year = year;
    this.isRunning = false;
    
    this.start = function() {
        this.isRunning = true;
        return `${this.brand} ${this.model} started`;
    };
    
    this.stop = function() {
        this.isRunning = false;
        return `${this.brand} ${this.model} stopped`;
    };
}

let car1 = new Car("Toyota", "Camry", 2020);
let car2 = new Car("Honda", "Civic", 2021);

console.log(car1.start());  // "Toyota Camry started"
console.log(car2.start());  // "Honda Civic started"
```

### Constructor Return Value

If constructor returns an object, that object is used instead:

```javascript
function Person(name) {
    this.name = name;
    return { custom: "object" };  // Returns this instead
}

let person = new Person("Alice");
console.log(person);  // { custom: "object" } (not Person instance)
```

**Best Practice**: Don''t return values from constructors (except `this`).

---

## Prototypes

Every JavaScript object has a prototype. The prototype is an object that other objects can inherit properties and methods from.

### Understanding Prototypes

```javascript
function Person(name) {
    this.name = name;
}

let person = new Person("Alice");
console.log(person.__proto__);  // Person.prototype
```

### Adding Methods to Prototype

This is more memory-efficient - all instances share the same method:

```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;
}

// Add method to prototype
Person.prototype.greet = function() {
    return `Hello, I''m ${this.name}`;
};

Person.prototype.haveBirthday = function() {
    this.age++;
    return `Happy birthday! Now I''m ${this.age}`;
};

let person1 = new Person("Alice", 25);
let person2 = new Person("Bob", 30);

console.log(person1.greet());  // "Hello, I''m Alice"
console.log(person2.greet());  // "Hello, I''m Bob"

// Both instances share the same method (memory efficient)
console.log(person1.greet === person2.greet);  // true
```

### Prototype Properties

You can also add properties to prototype:

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";

let person = new Person("Alice");
console.log(person.species);  // "Homo sapiens"
```

### Accessing Prototype

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.greet = function() {
    return `Hello, I''m ${this.name}`;
};

let person = new Person("Alice");

// Access prototype
console.log(Person.prototype);
console.log(Object.getPrototypeOf(person));
console.log(person.__proto__);  // Deprecated but works
```

### Prototype Methods vs Instance Methods

**Instance methods** (in constructor):
```javascript
function Person(name) {
    this.name = name;
    this.greet = function() {
        return `Hello, I''m ${this.name}`;
    };
}
// Each instance has its own copy
```

**Prototype methods** (on prototype):
```javascript
function Person(name) {
    this.name = name;
}
Person.prototype.greet = function() {
    return `Hello, I''m ${this.name}`;
};
// All instances share the same method
```

**Best Practice**: Use prototype methods for shared functionality.

---

## Prototype Chain

The prototype chain is how JavaScript implements inheritance. When you access a property, JavaScript looks up the chain until it finds it.

### How Prototype Chain Works

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";

let person = new Person("Alice");

// JavaScript looks for ''species'':
// 1. Check person object → not found
// 2. Check Person.prototype → found! "Homo sapiens"
console.log(person.species);  // "Homo sapiens"
```

### Chain Visualization

```
person
  ├─ name: "Alice" (own property)
  └─ __proto__ → Person.prototype
       ├─ species: "Homo sapiens"
       ├─ greet: function()
       └─ __proto__ → Object.prototype
            ├─ toString: function()
            ├─ valueOf: function()
            └─ __proto__ → null
```

### Property Lookup

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";
Object.prototype.planet = "Earth";

let person = new Person("Alice");

console.log(person.name);    // "Alice" (own property)
console.log(person.species); // "Homo sapiens" (from Person.prototype)
console.log(person.planet);  // "Earth" (from Object.prototype)
console.log(person.toString); // function (from Object.prototype)
```

### hasOwnProperty()

Check if property belongs to object itself (not prototype):

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";

let person = new Person("Alice");

console.log(person.hasOwnProperty("name"));    // true (own property)
console.log(person.hasOwnProperty("species")); // false (from prototype)
```

### Checking Prototype Chain

```javascript
function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";

let person = new Person("Alice");

// Check if property exists (anywhere in chain)
console.log("name" in person);     // true
console.log("species" in person);  // true
console.log("toString" in person); // true

// Check if own property
console.log(person.hasOwnProperty("name"));     // true
console.log(person.hasOwnProperty("species"));   // false
console.log(person.hasOwnProperty("toString"));  // false
```

---

## instanceof Operator

The `instanceof` operator checks if an object is an instance of a constructor function.

### Basic Usage

```javascript
function Person(name) {
    this.name = name;
}

let person = new Person("Alice");

console.log(person instanceof Person);  // true
console.log(person instanceof Object);   // true (all objects inherit from Object)
```

### How instanceof Works

`instanceof` checks the prototype chain:

```javascript
function Person(name) {
    this.name = name;
}

let person = new Person("Alice");

// Checks if Person.prototype is in person''s prototype chain
console.log(person instanceof Person);  // true
```

### Examples

```javascript
function Car(brand) {
    this.brand = brand;
}

function Truck(brand) {
    this.brand = brand;
}

let car = new Car("Toyota");
let truck = new Truck("Ford");

console.log(car instanceof Car);     // true
console.log(car instanceof Truck);   // false
console.log(car instanceof Object);  // true
```

### Arrays and instanceof

```javascript
let arr = [1, 2, 3];

console.log(arr instanceof Array);   // true
console.log(arr instanceof Object);  // true
```

### Functions and instanceof

```javascript
function myFunction() { }

console.log(myFunction instanceof Function);  // true
console.log(myFunction instanceof Object);   // true
```

### Using instanceof for Type Checking

```javascript
function processVehicle(vehicle) {
    if (vehicle instanceof Car) {
        console.log("Processing car");
    } else if (vehicle instanceof Truck) {
        console.log("Processing truck");
    } else {
        console.log("Unknown vehicle type");
    }
}
```

---

## Complete Example

### Person Constructor with Prototype

```javascript
// Constructor
function Person(firstName, lastName, age) {
    this.firstName = firstName;
    this.lastName = lastName;
    this.age = age;
}

// Prototype methods
Person.prototype.getFullName = function() {
    return `${this.firstName} ${this.lastName}`;
};

Person.prototype.haveBirthday = function() {
    this.age++;
    return `Happy birthday! Now I''m ${this.age}`;
};

Person.prototype.introduce = function() {
    return `Hi, I''m ${this.getFullName()} and I''m ${this.age} years old`;
};

// Prototype property
Person.prototype.species = "Homo sapiens";

// Usage
let person1 = new Person("Alice", "Smith", 25);
let person2 = new Person("Bob", "Jones", 30);

console.log(person1.getFullName());     // "Alice Smith"
console.log(person1.introduce());        // "Hi, I''m Alice Smith and I''m 25 years old"
console.log(person2.introduce());        // "Hi, I''m Bob Jones and I''m 30 years old"
console.log(person1.species);            // "Homo sapiens"
console.log(person1 instanceof Person);  // true
```

### Car Constructor Example

```javascript
function Car(brand, model, year) {
    this.brand = brand;
    this.model = model;
    this.year = year;
    this.speed = 0;
    this.isRunning = false;
}

Car.prototype.start = function() {
    this.isRunning = true;
    return `${this.brand} ${this.model} started`;
};

Car.prototype.stop = function() {
    this.isRunning = false;
    this.speed = 0;
    return `${this.brand} ${this.model} stopped`;
};

Car.prototype.accelerate = function(amount) {
    if (this.isRunning) {
        this.speed += amount;
        return `Speed: ${this.speed} mph`;
    }
    return "Car is not running";
};

Car.prototype.getInfo = function() {
    return `${this.year} ${this.brand} ${this.model}`;
};

// Usage
let car = new Car("Toyota", "Camry", 2020);
console.log(car.start());           // "Toyota Camry started"
console.log(car.accelerate(30));    // "Speed: 30 mph"
console.log(car.accelerate(20));    // "Speed: 50 mph"
console.log(car.getInfo());         // "2020 Toyota Camry"
console.log(car.stop());            // "Toyota Camry stopped"
```

---

## Practice Exercise

### Exercise: Creating Objects with Constructors

**Objective**: Create constructor functions and use prototypes to build object-oriented code.

**Instructions**:

1. Create a file called `oop-basics.js`

2. Create constructor functions for:
   - Book (title, author, year, pages)
   - BankAccount (accountNumber, balance)
   - Student (name, age, grade)

3. Add prototype methods for each:
   - Book: getInfo(), isLong() (pages > 300)
   - BankAccount: deposit(), withdraw(), getBalance()
   - Student: introduce(), promote() (increase grade)

4. Test with instanceof operator

5. Demonstrate prototype chain

**Example Solution**:

```javascript
// OOP Basics Practice
console.log("=== Book Constructor ===");

function Book(title, author, year, pages) {
    this.title = title;
    this.author = author;
    this.year = year;
    this.pages = pages;
}

Book.prototype.getInfo = function() {
    return `${this.title} by ${this.author} (${this.year})`;
};

Book.prototype.isLong = function() {
    return this.pages > 300;
};

Book.prototype.getSummary = function() {
    return `${this.title} is a ${this.pages}-page book written by ${this.author} in ${this.year}`;
};

let book1 = new Book("1984", "George Orwell", 1949, 328);
let book2 = new Book("The Great Gatsby", "F. Scott Fitzgerald", 1925, 180);

console.log(book1.getInfo());        // "1984 by George Orwell (1949)"
console.log(book1.isLong());         // true
console.log(book2.isLong());         // false
console.log(book1.getSummary());
console.log("Instanceof Book:", book1 instanceof Book);  // true
console.log();

console.log("=== BankAccount Constructor ===");

function BankAccount(accountNumber, initialBalance = 0) {
    this.accountNumber = accountNumber;
    this.balance = initialBalance;
    this.transactions = [];
}

BankAccount.prototype.deposit = function(amount) {
    if (amount > 0) {
        this.balance += amount;
        this.transactions.push({ type: "deposit", amount, balance: this.balance });
        return `Deposited $${amount}. New balance: $${this.balance}`;
    }
    return "Invalid deposit amount";
};

BankAccount.prototype.withdraw = function(amount) {
    if (amount > 0 && amount <= this.balance) {
        this.balance -= amount;
        this.transactions.push({ type: "withdraw", amount, balance: this.balance });
        return `Withdrew $${amount}. New balance: $${this.balance}`;
    }
    return amount > this.balance ? "Insufficient funds" : "Invalid withdrawal amount";
};

BankAccount.prototype.getBalance = function() {
    return `Account ${this.accountNumber}: $${this.balance}`;
};

BankAccount.prototype.getTransactionHistory = function() {
    return this.transactions;
};

let account1 = new BankAccount("ACC001", 1000);
let account2 = new BankAccount("ACC002", 500);

console.log(account1.getBalance());        // "Account ACC001: $1000"
console.log(account1.deposit(500));        // "Deposited $500. New balance: $1500"
console.log(account1.withdraw(200));       // "Withdrew $200. New balance: $1300"
console.log(account1.withdraw(2000));      // "Insufficient funds"
console.log("Instanceof BankAccount:", account1 instanceof BankAccount);  // true
console.log();

console.log("=== Student Constructor ===");

function Student(name, age, grade) {
    this.name = name;
    this.age = age;
    this.grade = grade;
    this.subjects = [];
}

Student.prototype.introduce = function() {
    return `Hi, I''m ${this.name}, ${this.age} years old, in grade ${this.grade}`;
};

Student.prototype.promote = function() {
    this.grade++;
    return `Promoted to grade ${this.grade}`;
};

Student.prototype.addSubject = function(subject) {
    this.subjects.push(subject);
    return `Added ${subject} to subjects`;
};

Student.prototype.getSubjects = function() {
    return this.subjects.length > 0 
        ? `${this.name}''s subjects: ${this.subjects.join(", ")}`
        : `${this.name} has no subjects yet`;
};

let student1 = new Student("Alice", 15, 9);
let student2 = new Student("Bob", 16, 10);

console.log(student1.introduce());         // "Hi, I''m Alice, 15 years old, in grade 9"
console.log(student1.promote());          // "Promoted to grade 10"
student1.addSubject("Math");
student1.addSubject("Science");
console.log(student1.getSubjects());       // "Alice''s subjects: Math, Science"
console.log("Instanceof Student:", student1 instanceof Student);  // true
console.log();

console.log("=== Prototype Chain Demonstration ===");

function Person(name) {
    this.name = name;
}

Person.prototype.species = "Homo sapiens";
Object.prototype.planet = "Earth";

let person = new Person("Alice");

console.log("Own property ''name'':", person.hasOwnProperty("name"));        // true
console.log("Own property ''species'':", person.hasOwnProperty("species"));   // false
console.log("Own property ''planet'':", person.hasOwnProperty("planet"));    // false
console.log("Own property ''toString'':", person.hasOwnProperty("toString")); // false

console.log("''name'' in person:", "name" in person);         // true
console.log("''species'' in person:", "species" in person);     // true
console.log("''planet'' in person:", "planet" in person);      // true
console.log("''toString'' in person:", "toString" in person);   // true

console.log("person.name:", person.name);           // "Alice"
console.log("person.species:", person.species);     // "Homo sapiens"
console.log("person.planet:", person.planet);       // "Earth"
console.log();

console.log("=== instanceof Examples ===");

let book = new Book("Test", "Author", 2020, 100);
let account = new BankAccount("ACC003", 100);
let student = new Student("Charlie", 14, 8);

console.log("book instanceof Book:", book instanceof Book);           // true
console.log("book instanceof Object:", book instanceof Object);      // true
console.log("account instanceof BankAccount:", account instanceof BankAccount); // true
console.log("student instanceof Student:", student instanceof Student);         // true
console.log("student instanceof Object:", student instanceof Object);          // true

// All objects are instances of Object
console.log("All are Object instances:");
console.log(book instanceof Object);     // true
console.log(account instanceof Object);  // true
console.log(student instanceof Object);   // true
```

**Expected Output**:
```
=== Book Constructor ===
1984 by George Orwell (1949)
true
false
1984 is a 328-page book written by George Orwell in 1949
Instanceof Book: true

=== BankAccount Constructor ===
Account ACC001: $1000
Deposited $500. New balance: $1500
Withdrew $200. New balance: $1300
Insufficient funds
Instanceof BankAccount: true

=== Student Constructor ===
Hi, I''m Alice, 15 years old, in grade 9
Promoted to grade 10
Alice''s subjects: Math, Science
Instanceof Student: true

=== Prototype Chain Demonstration ===
Own property ''name'': true
Own property ''species'': false
Own property ''planet'': false
Own property ''toString'': false
''name'' in person: true
''species'' in person: true
''planet'' in person: true
''toString'' in person: true
person.name: Alice
person.species: Homo sapiens
person.planet: Earth

=== instanceof Examples ===
book instanceof Book: true
book instanceof Object: true
account instanceof BankAccount: true
student instanceof Student: true
student instanceof Object: true
All are Object instances:
true
true
true
```

**Challenge (Optional)**:
- Create a library management system
- Build a game with multiple character types
- Create a shape hierarchy (Circle, Rectangle, etc.)
- Build a vehicle system (Car, Truck, Motorcycle)

---

## Common Mistakes

### 1. Forgetting `new` Keyword

```javascript
// ❌ Wrong: this refers to global/window
function Person(name) {
    this.name = name;
}
let person = Person("Alice");  // No ''new''
console.log(person);  // undefined
console.log(name);    // "Alice" (global variable!)

// ✅ Correct
let person = new Person("Alice");
```

### 2. Methods in Constructor (Memory Inefficient)

```javascript
// ⚠️ Each instance gets its own copy
function Person(name) {
    this.name = name;
    this.greet = function() { };  // New function for each instance
}

// ✅ Better: Use prototype
function Person(name) {
    this.name = name;
}
Person.prototype.greet = function() { };  // Shared method
```

### 3. Modifying Prototype After Creation

```javascript
function Person(name) {
    this.name = name;
}

let person = new Person("Alice");

// Adding to prototype after creation still works
Person.prototype.greet = function() {
    return "Hello!";
};

console.log(person.greet());  // "Hello!" (works!)
```

### 4. Confusing hasOwnProperty and `in`

```javascript
function Person(name) {
    this.name = name;
}
Person.prototype.species = "Homo sapiens";

let person = new Person("Alice");

console.log("name" in person);     // true (anywhere in chain)
console.log("species" in person);  // true (anywhere in chain)

console.log(person.hasOwnProperty("name"));     // true (own property)
console.log(person.hasOwnProperty("species"));  // false (from prototype)
```

### 5. Prototype vs __proto__

```javascript
// __proto__ is deprecated but works
let person = new Person("Alice");
console.log(person.__proto__);  // Person.prototype

// ✅ Better: Use Object.getPrototypeOf()
console.log(Object.getPrototypeOf(person));  // Person.prototype
```

---

## Key Takeaways

1. **Constructor Functions**: Create objects with `new` keyword
2. **Prototypes**: Shared object for methods and properties
3. **Prototype Chain**: JavaScript looks up properties through chain
4. **instanceof**: Checks if object is instance of constructor
5. **hasOwnProperty()**: Checks if property is own (not from prototype)
6. **Best Practice**: Use prototype methods for shared functionality
7. **Memory Efficiency**: Prototype methods are shared, constructor methods are not

---

## Quiz: OOP Basics

Test your understanding with these questions:

1. **What does `new` keyword do?**
   - A) Creates new function
   - B) Creates new object and sets this
   - C) Deletes object
   - D) Nothing

2. **Where should shared methods be placed?**
   - A) In constructor
   - B) On prototype
   - C) Outside function
   - D) Doesn''t matter

3. **What does `instanceof` check?**
   - A) Property existence
   - B) Prototype chain
   - C) Value type
   - D) Object equality

4. **What does `hasOwnProperty()` check?**
   - A) If property exists in prototype chain
   - B) If property is own property
   - C) If property is a function
   - D) If property is undefined

5. **Prototype chain ends at:**
   - A) Object.prototype
   - B) null
   - C) Function.prototype
   - D) Array.prototype

6. **What happens if you forget `new`?**
   - A) Error
   - B) `this` refers to global
   - C) Returns undefined
   - D) Both B and C

7. **All objects inherit from:**
   - A) Function
   - B) Array
   - C) Object
   - D) String

**Answers**:
1. B) Creates new object and sets this
2. B) On prototype
3. B) Prototype chain
4. B) If property is own property
5. B) null (Object.prototype.__proto__ is null)
6. D) Both B and C
7. C) Object

---

## Next Steps

Congratulations! You''ve learned object-oriented basics. You now know:
- How to create constructor functions
- How prototypes work
- How the prototype chain functions
- How to use instanceof

**What''s Next?**
- Lesson 6.2: Classes (ES6)
- Practice with constructor patterns
- Understand prototype inheritance
- Build more complex object hierarchies

---

## Additional Resources

- **MDN: Object-oriented JavaScript**: [developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object-oriented_JS](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Object-oriented_JS)
- **MDN: instanceof**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof)
- **JavaScript.info: Prototypes**: [javascript.info/prototype-inheritance](https://javascript.info/prototype-inheritance)
- **JavaScript.info: Constructor Functions**: [javascript.info/constructor-new](https://javascript.info/constructor-new)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:36:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create objects using constructor functions
- Understand prototypes and the prototype chain
- Use the instanceof operator to check object types
- Add methods to prototypes
- Understand how JavaScript implements inheritance
- Work with constructor patterns');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (124, 46, 10, 'Classes and Constructors', 'classes-and-constructors', '# Lesson 6.2: Classes (ES6)

## Learning Objectives

By the end of this lesson, you will be able to:
- Use ES6 class syntax to create classes
- Understand constructor methods
- Create instance methods
- Use static methods
- Work with class fields
- Understand how classes relate to prototypes
- Write clean, modern object-oriented code

---

## Introduction to ES6 Classes

ES6 introduced the `class` keyword, providing a cleaner syntax for creating objects and handling inheritance. Under the hood, classes are still based on prototypes, but the syntax is more familiar to developers from class-based languages.

### Why Classes?

- Cleaner syntax than constructor functions
- More familiar to developers from other languages
- Better organization
- Built-in support for inheritance
- Still uses prototypes (no performance difference)

---

## Class Syntax

### Basic Class Declaration

```javascript
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
}

let person = new Person("Alice", 25);
console.log(person);  // Person { name: "Alice", age: 25 }
```

### Class vs Constructor Function

**Constructor Function (old way):**
```javascript
function Person(name, age) {
    this.name = name;
    this.age = age;
}
```

**Class (ES6 way):**
```javascript
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
}
```

Both create the same result, but class syntax is cleaner.

---

## Constructor Methods

The `constructor` method is a special method that runs when a new instance is created.

### Basic Constructor

```javascript
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
}

let person = new Person("Alice", 25);
```

### Constructor with Default Values

```javascript
class Person {
    constructor(name, age = 0) {
        this.name = name;
        this.age = age;
    }
}

let person1 = new Person("Alice", 25);
let person2 = new Person("Bob");  // age defaults to 0
```

### Constructor Validation

```javascript
class Person {
    constructor(name, age) {
        if (typeof name !== "string" || name.length === 0) {
            throw new Error("Name must be a non-empty string");
        }
        if (age < 0) {
            throw new Error("Age cannot be negative");
        }
        this.name = name;
        this.age = age;
    }
}
```

### No Constructor

If you don''t define a constructor, JavaScript provides an empty one:

```javascript
class Person {
    // No constructor defined
}

let person = new Person();  // Works! Empty object
```

---

## Instance Methods

Instance methods are available on all instances of the class.

### Basic Instance Methods

```javascript
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    greet() {
        return `Hello, I''m ${this.name}`;
    }
    
    haveBirthday() {
        this.age++;
        return `Happy birthday! Now I''m ${this.age}`;
    }
    
    introduce() {
        return `Hi, I''m ${this.name} and I''m ${this.age} years old`;
    }
}

let person = new Person("Alice", 25);
console.log(person.greet());        // "Hello, I''m Alice"
console.log(person.haveBirthday()); // "Happy birthday! Now I''m 26"
console.log(person.introduce());     // "Hi, I''m Alice and I''m 26 years old"
```

### Methods Accessing Properties

```javascript
class Rectangle {
    constructor(width, height) {
        this.width = width;
        this.height = height;
    }
    
    getArea() {
        return this.width * this.height;
    }
    
    getPerimeter() {
        return 2 * (this.width + this.height);
    }
    
    isSquare() {
        return this.width === this.height;
    }
}

let rect = new Rectangle(10, 5);
console.log(rect.getArea());      // 50
console.log(rect.getPerimeter()); // 30
console.log(rect.isSquare());     // false
```

### Methods Modifying State

```javascript
class BankAccount {
    constructor(accountNumber, balance = 0) {
        this.accountNumber = accountNumber;
        this.balance = balance;
    }
    
    deposit(amount) {
        if (amount > 0) {
            this.balance += amount;
            return `Deposited $${amount}. New balance: $${this.balance}`;
        }
        return "Invalid deposit amount";
    }
    
    withdraw(amount) {
        if (amount > 0 && amount <= this.balance) {
            this.balance -= amount;
            return `Withdrew $${amount}. New balance: $${this.balance}`;
        }
        return "Insufficient funds or invalid amount";
    }
    
    getBalance() {
        return this.balance;
    }
}
```

---

## Static Methods

Static methods belong to the class itself, not to instances. They''re called on the class, not on instances.

### Basic Static Method

```javascript
class MathUtils {
    static add(a, b) {
        return a + b;
    }
    
    static multiply(a, b) {
        return a * b;
    }
}

// Call on class, not instance
console.log(MathUtils.add(5, 3));        // 8
console.log(MathUtils.multiply(5, 3));   // 15

// ❌ Cannot call on instance
let utils = new MathUtils();
// utils.add(5, 3);  // Error: utils.add is not a function
```

### Static Methods for Utilities

```javascript
class Person {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    // Static method to create from object
    static fromObject(obj) {
        return new Person(obj.name, obj.age);
    }
    
    // Static method to compare ages
    static compareAge(person1, person2) {
        return person1.age - person2.age;
    }
    
    // Static method to validate age
    static isValidAge(age) {
        return typeof age === "number" && age >= 0 && age <= 150;
    }
}

let person1 = Person.fromObject({ name: "Alice", age: 25 });
let person2 = Person.fromObject({ name: "Bob", age: 30 });

console.log(Person.compareAge(person1, person2));  // -5 (Alice is younger)
console.log(Person.isValidAge(25));                 // true
console.log(Person.isValidAge(200));                // false
```

### When to Use Static Methods

- Utility functions related to the class
- Factory methods (create instances in special ways)
- Validation methods
- Methods that don''t need instance data

---

## Class Fields

Class fields allow you to define properties directly in the class body (ES2022).

### Instance Fields

```javascript
class Person {
    // Instance fields
    name = "Unknown";
    age = 0;
    
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
}

let person = new Person("Alice", 25);
console.log(person.name);  // "Alice"
```

### Private Fields (ES2022)

Private fields are only accessible within the class:

```javascript
class BankAccount {
    // Private field (starts with #)
    #balance = 0;
    
    constructor(accountNumber) {
        this.accountNumber = accountNumber;
    }
    
    deposit(amount) {
        this.#balance += amount;
    }
    
    getBalance() {
        return this.#balance;
    }
}

let account = new BankAccount("ACC001");
account.deposit(100);
console.log(account.getBalance());  // 100
// console.log(account.#balance);   // ❌ Error: Private field
```

### Static Fields

```javascript
class Person {
    // Static field
    static species = "Homo sapiens";
    static count = 0;
    
    constructor(name) {
        this.name = name;
        Person.count++;  // Increment static counter
    }
    
    static getCount() {
        return Person.count;
    }
}

console.log(Person.species);  // "Homo sapiens"

let person1 = new Person("Alice");
let person2 = new Person("Bob");

console.log(Person.getCount());  // 2
```

### Field Initialization

```javascript
class Counter {
    count = 0;  // Instance field with initial value
    
    increment() {
        this.count++;
    }
    
    getCount() {
        return this.count;
    }
}

let counter = new Counter();
console.log(counter.getCount());  // 0
counter.increment();
console.log(counter.getCount());  // 1
```

---

## Getters and Setters

Getters and setters allow you to define computed properties.

### Getters

```javascript
class Rectangle {
    constructor(width, height) {
        this.width = width;
        this.height = height;
    }
    
    get area() {
        return this.width * this.height;
    }
    
    get perimeter() {
        return 2 * (this.width + this.height);
    }
}

let rect = new Rectangle(10, 5);
console.log(rect.area);       // 50 (accessed like property)
console.log(rect.perimeter);   // 30
```

### Setters

```javascript
class Person {
    constructor(firstName, lastName) {
        this.firstName = firstName;
        this.lastName = lastName;
    }
    
    get fullName() {
        return `${this.firstName} ${this.lastName}`;
    }
    
    set fullName(name) {
        const parts = name.split(" ");
        this.firstName = parts[0] || "";
        this.lastName = parts.slice(1).join(" ") || "";
    }
}

let person = new Person("Alice", "Smith");
console.log(person.fullName);  // "Alice Smith"

person.fullName = "Bob Jones";
console.log(person.firstName);  // "Bob"
console.log(person.lastName);   // "Jones"
```

### Practical Example

```javascript
class Temperature {
    constructor(celsius) {
        this._celsius = celsius;
    }
    
    get celsius() {
        return this._celsius;
    }
    
    set celsius(value) {
        if (value < -273.15) {
            throw new Error("Temperature cannot be below absolute zero");
        }
        this._celsius = value;
    }
    
    get fahrenheit() {
        return (this._celsius * 9/5) + 32;
    }
    
    set fahrenheit(value) {
        this._celsius = (value - 32) * 5/9;
    }
}

let temp = new Temperature(25);
console.log(temp.celsius);     // 25
console.log(temp.fahrenheit);  // 77

temp.fahrenheit = 100;
console.log(temp.celsius);     // 37.777...
```

---

## Complete Class Example

### Car Class

```javascript
class Car {
    // Static field
    static totalCars = 0;
    
    // Constructor
    constructor(brand, model, year) {
        this.brand = brand;
        this.model = model;
        this.year = year;
        this.speed = 0;
        this.isRunning = false;
        
        Car.totalCars++;
    }
    
    // Instance methods
    start() {
        this.isRunning = true;
        return `${this.brand} ${this.model} started`;
    }
    
    stop() {
        this.isRunning = false;
        this.speed = 0;
        return `${this.brand} ${this.model} stopped`;
    }
    
    accelerate(amount) {
        if (this.isRunning) {
            this.speed += amount;
            return `Speed: ${this.speed} mph`;
        }
        return "Car is not running";
    }
    
    brake(amount) {
        if (this.speed > 0) {
            this.speed = Math.max(0, this.speed - amount);
            return `Speed: ${this.speed} mph`;
        }
        return "Car is already stopped";
    }
    
    // Getter
    get info() {
        return `${this.year} ${this.brand} ${this.model}`;
    }
    
    // Static method
    static getTotalCars() {
        return Car.totalCars;
    }
    
    static compareYear(car1, car2) {
        return car1.year - car2.year;
    }
}

// Usage
let car1 = new Car("Toyota", "Camry", 2020);
let car2 = new Car("Honda", "Civic", 2021);

console.log(car1.start());           // "Toyota Camry started"
console.log(car1.accelerate(30));    // "Speed: 30 mph"
console.log(car1.info);              // "2020 Toyota Camry"
console.log(Car.getTotalCars());     // 2
console.log(Car.compareYear(car1, car2));  // -1 (car1 is older)
```

---

## Classes vs Constructor Functions

### Similarities

Both create the same result:

```javascript
// Constructor function
function Person(name) {
    this.name = name;
}
Person.prototype.greet = function() {
    return `Hello, ${this.name}`;
};

// Class
class Person {
    constructor(name) {
        this.name = name;
    }
    greet() {
        return `Hello, ${this.name}`;
    }
}
```

### Differences

**Classes:**
- ✅ Cleaner syntax
- ✅ Built-in support for inheritance
- ✅ Cannot be called without `new`
- ✅ Methods are non-enumerable
- ✅ Always in strict mode

**Constructor Functions:**
- ⚠️ Can be called without `new` (creates bugs)
- ⚠️ More verbose
- ✅ More flexible (can return different objects)

### Class Hoisting

Classes are NOT hoisted (unlike function declarations):

```javascript
// ❌ Error: Cannot access before initialization
let person = new Person("Alice");

class Person {
    constructor(name) {
        this.name = name;
    }
}
```

---

## Practice Exercise

### Exercise: Building Classes

**Objective**: Create classes using ES6 class syntax with constructors, instance methods, static methods, and class fields.

**Instructions**:

1. Create a file called `classes-practice.js`

2. Create classes for:
   - Product (name, price, quantity)
   - Circle (radius)
   - Library (books management)

3. Include:
   - Constructors with validation
   - Instance methods
   - Static methods
   - Getters and setters
   - Class fields

**Example Solution**:

```javascript
// Classes Practice
console.log("=== Product Class ===");

class Product {
    // Static field
    static totalProducts = 0;
    
    constructor(name, price, quantity = 0) {
        if (!name || typeof name !== "string") {
            throw new Error("Product name must be a non-empty string");
        }
        if (price < 0) {
            throw new Error("Price cannot be negative");
        }
        if (quantity < 0) {
            throw new Error("Quantity cannot be negative");
        }
        
        this.name = name;
        this.price = price;
        this.quantity = quantity;
        
        Product.totalProducts++;
    }
    
    // Instance methods
    getTotalValue() {
        return this.price * this.quantity;
    }
    
    addStock(amount) {
        if (amount > 0) {
            this.quantity += amount;
            return `Added ${amount} units. New quantity: ${this.quantity}`;
        }
        return "Invalid amount";
    }
    
    sell(amount) {
        if (amount > 0 && amount <= this.quantity) {
            this.quantity -= amount;
            return `Sold ${amount} units. Remaining: ${this.quantity}`;
        }
        return "Invalid sale or insufficient stock";
    }
    
    // Getter
    get isInStock() {
        return this.quantity > 0;
    }
    
    get info() {
        return `${this.name}: $${this.price} (${this.quantity} in stock)`;
    }
    
    // Static methods
    static getTotalProducts() {
        return Product.totalProducts;
    }
    
    static comparePrice(product1, product2) {
        return product1.price - product2.price;
    }
    
    static findCheapest(products) {
        return products.reduce((cheapest, current) => {
            return current.price < cheapest.price ? current : cheapest;
        });
    }
}

let product1 = new Product("Laptop", 999.99, 10);
let product2 = new Product("Mouse", 29.99, 50);
let product3 = new Product("Keyboard", 79.99, 25);

console.log(product1.info);                    // "Laptop: $999.99 (10 in stock)"
console.log(product1.getTotalValue());         // 9999.9
console.log(product1.isInStock);              // true
console.log(product1.sell(3));                // "Sold 3 units. Remaining: 7"
console.log(Product.getTotalProducts());        // 3
console.log(Product.comparePrice(product2, product3));  // -50 (mouse is cheaper)
console.log();

console.log("=== Circle Class ===");

class Circle {
    constructor(radius) {
        if (radius < 0) {
            throw new Error("Radius cannot be negative");
        }
        this.radius = radius;
    }
    
    // Getters
    get diameter() {
        return this.radius * 2;
    }
    
    get area() {
        return Math.PI * this.radius ** 2;
    }
    
    get circumference() {
        return 2 * Math.PI * this.radius;
    }
    
    // Setters
    set diameter(value) {
        this.radius = value / 2;
    }
    
    set area(value) {
        this.radius = Math.sqrt(value / Math.PI);
    }
    
    // Instance methods
    scale(factor) {
        if (factor > 0) {
            this.radius *= factor;
            return `Scaled by ${factor}. New radius: ${this.radius}`;
        }
        return "Invalid scale factor";
    }
    
    // Static methods
    static fromDiameter(diameter) {
        return new Circle(diameter / 2);
    }
    
    static fromArea(area) {
        return new Circle(Math.sqrt(area / Math.PI));
    }
    
    static compareArea(circle1, circle2) {
        return circle1.area - circle2.area;
    }
}

let circle1 = new Circle(5);
console.log("Radius:", circle1.radius);           // 5
console.log("Diameter:", circle1.diameter);       // 10
console.log("Area:", circle1.area.toFixed(2));    // 78.54
console.log("Circumference:", circle1.circumference.toFixed(2));  // 31.42

circle1.diameter = 20;
console.log("New radius:", circle1.radius);      // 10

let circle2 = Circle.fromDiameter(14);
console.log("Circle from diameter:", circle2.radius);  // 7

let circle3 = Circle.fromArea(100);
console.log("Circle from area:", circle3.radius.toFixed(2));  // 5.64
console.log();

console.log("=== Library Class ===");

class Library {
    constructor(name) {
        this.name = name;
        this.books = [];
    }
    
    // Instance methods
    addBook(book) {
        this.books.push(book);
        return `Added "${book.title}" to library`;
    }
    
    removeBook(title) {
        const index = this.books.findIndex(book => book.title === title);
        if (index !== -1) {
            this.books.splice(index, 1);
            return `Removed "${title}" from library`;
        }
        return `Book "${title}" not found`;
    }
    
    findBook(title) {
        return this.books.find(book => book.title === title);
    }
    
    getTotalBooks() {
        return this.books.length;
    }
    
    // Getter
    get bookTitles() {
        return this.books.map(book => book.title);
    }
    
    get totalValue() {
        return this.books.reduce((sum, book) => sum + (book.price || 0), 0);
    }
    
    // Static method
    static mergeLibraries(lib1, lib2) {
        const merged = new Library(`${lib1.name} & ${lib2.name}`);
        merged.books = [...lib1.books, ...lib2.books];
        return merged;
    }
}

class Book {
    constructor(title, author, year, price = 0) {
        this.title = title;
        this.author = author;
        this.year = year;
        this.price = price;
    }
    
    get info() {
        return `${this.title} by ${this.author} (${this.year})`;
    }
}

let library = new Library("City Library");
let book1 = new Book("1984", "George Orwell", 1949, 15.99);
let book2 = new Book("The Great Gatsby", "F. Scott Fitzgerald", 1925, 12.99);
let book3 = new Book("To Kill a Mockingbird", "Harper Lee", 1960, 14.99);

library.addBook(book1);
library.addBook(book2);
library.addBook(book3);

console.log("Total books:", library.getTotalBooks());  // 3
console.log("Book titles:", library.bookTitles);
console.log("Total value: $" + library.totalValue.toFixed(2));  // $43.97
console.log("Found book:", library.findBook("1984")?.info);
console.log(library.removeBook("The Great Gatsby"));
console.log("After removal:", library.getTotalBooks());  // 2
```

**Expected Output**:
```
=== Product Class ===
Laptop: $999.99 (10 in stock)
9999.9
true
Sold 3 units. Remaining: 7
3
-50

=== Circle Class ===
Radius: 5
Diameter: 10
Area: 78.54
Circumference: 31.42
New radius: 10
Circle from diameter: 7
Circle from area: 5.64

=== Library Class ===
Total books: 3
Book titles: [ "1984", "The Great Gatsby", "To Kill a Mockingbird" ]
Total value: $43.97
Found book: 1984 by George Orwell (1949)
Removed "The Great Gatsby" from library
After removal: 2
```

**Challenge (Optional)**:
- Create a game character class system
- Build a shape hierarchy (Circle, Rectangle, Triangle)
- Create a vehicle management system
- Build a user management system with validation

---

## Common Mistakes

### 1. Forgetting `new` with Classes

```javascript
// ❌ Error: Class constructor cannot be invoked without ''new''
class Person {
    constructor(name) {
        this.name = name;
    }
}

let person = Person("Alice");  // TypeError
```

### 2. Methods as Arrow Functions

```javascript
// ⚠️ Arrow functions don''t have their own `this`
class Person {
    constructor(name) {
        this.name = name;
    }
    
    greet = () => {
        console.log(this.name);  // Works, but different behavior
    }
}

// ✅ Better: Regular method
class Person {
    constructor(name) {
        this.name = name;
    }
    
    greet() {
        console.log(this.name);
    }
}
```

### 3. Static Method Access

```javascript
class Person {
    static getCount() {
        return 5;
    }
}

let person = new Person();
// person.getCount();  // ❌ Error: Not a function

Person.getCount();  // ✅ Correct
```

### 4. Class Hoisting

```javascript
// ❌ Error: Cannot access before initialization
let person = new Person("Alice");

class Person {
    constructor(name) {
        this.name = name;
    }
}
```

### 5. Private Field Access

```javascript
class BankAccount {
    #balance = 0;
}

let account = new BankAccount();
// console.log(account.#balance);  // ❌ Error: Private field
```

---

## Key Takeaways

1. **Class Syntax**: Cleaner than constructor functions
2. **Constructor**: Special method that runs on instantiation
3. **Instance Methods**: Available on all instances
4. **Static Methods**: Called on class, not instances
5. **Class Fields**: Define properties in class body
6. **Getters/Setters**: Computed properties
7. **Still Prototypes**: Classes are syntactic sugar over prototypes
8. **No Hoisting**: Classes must be defined before use

---

## Quiz: Classes

Test your understanding with these questions:

1. **What is the special method called when creating an instance?**
   - A) init()
   - B) constructor()
   - C) create()
   - D) new()

2. **Static methods are called on:**
   - A) Instances
   - B) The class
   - C) Prototype
   - D) Both A and B

3. **Classes are:**
   - A) Hoisted
   - B) Not hoisted
   - C) Sometimes hoisted
   - D) Always undefined

4. **Private fields start with:**
   - A) _
   - B) #
   - C) private
   - D) $

5. **Getters are accessed like:**
   - A) Methods
   - B) Properties
   - C) Functions
   - D) Variables

6. **What happens if you call a class without `new`?**
   - A) Works fine
   - B) Error
   - C) Returns undefined
   - D) Creates global variable

7. **Classes are:**
   - A) Completely new feature
   - B) Syntactic sugar over prototypes
   - C) Different from constructors
   - D) Slower than constructors

**Answers**:
1. B) constructor()
2. B) The class
3. B) Not hoisted
4. B) #
5. B) Properties
6. B) Error
7. B) Syntactic sugar over prototypes

---

## Next Steps

Congratulations! You''ve learned ES6 classes. You now know:
- How to create classes
- Constructor, instance, and static methods
- Class fields and getters/setters
- How classes relate to prototypes

**What''s Next?**
- Lesson 6.3: Inheritance
- Practice building class hierarchies
- Learn about extends and super
- Build more complex OOP structures

---

## Additional Resources

- **MDN: Classes**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes)
- **MDN: Static**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static)
- **JavaScript.info: Classes**: [javascript.info/class](https://javascript.info/class)
- **JavaScript.info: Class Fields**: [javascript.info/class](https://javascript.info/class)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:36:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use ES6 class syntax to create classes
- Understand constructor methods
- Create instance methods
- Use static methods
- Work with class fields
- Understand how classes relate to prototypes
- Write clean, modern object-oriented code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (125, 46, 10, 'Inheritance and Prototypes', 'inheritance-and-prototypes', '# Lesson 6.3: Inheritance

## Learning Objectives

By the end of this lesson, you will be able to:
- Use the `extends` keyword to create class inheritance
- Use the `super` keyword to call parent class methods
- Override methods in child classes
- Understand prototypal inheritance
- Create class hierarchies
- Build complex object-oriented structures

---

## Introduction to Inheritance

Inheritance allows one class to inherit properties and methods from another class. This promotes code reuse and creates hierarchical relationships.

### Benefits of Inheritance

- **Code Reuse**: Share common functionality
- **Hierarchy**: Model real-world relationships
- **Polymorphism**: Different classes can respond to same methods
- **Maintainability**: Update parent class affects all children

---

## extends Keyword

The `extends` keyword creates a child class that inherits from a parent class.

### Basic Inheritance

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    speak() {
        return `${this.name} makes a sound`;
    }
}

class Dog extends Animal {
    // Inherits name and speak() from Animal
}

let dog = new Dog("Buddy");
console.log(dog.name);        // "Buddy"
console.log(dog.speak());     // "Buddy makes a sound"
```

### Adding Child-Specific Properties

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    speak() {
        return `${this.name} makes a sound`;
    }
}

class Dog extends Animal {
    constructor(name, breed) {
        super(name);  // Call parent constructor
        this.breed = breed;
    }
}

let dog = new Dog("Buddy", "Golden Retriever");
console.log(dog.name);   // "Buddy"
console.log(dog.breed);  // "Golden Retriever"
```

### Inheritance Chain

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
}

class Mammal extends Animal {
    constructor(name, hasFur) {
        super(name);
        this.hasFur = hasFur;
    }
}

class Dog extends Mammal {
    constructor(name, hasFur, breed) {
        super(name, hasFur);
        this.breed = breed;
    }
}

let dog = new Dog("Buddy", true, "Golden Retriever");
console.log(dog.name);    // "Buddy" (from Animal)
console.log(dog.hasFur);  // true (from Mammal)
console.log(dog.breed);   // "Golden Retriever" (from Dog)
```

---

## super Keyword

The `super` keyword is used to call methods and access properties of the parent class.

### super in Constructor

Must call `super()` before using `this` in child constructor:

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
}

class Dog extends Animal {
    constructor(name, breed) {
        super(name);  // Must call super first
        this.breed = breed;  // Now can use this
    }
}
```

### super for Methods

Call parent class methods:

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    speak() {
        return `${this.name} makes a sound`;
    }
}

class Dog extends Animal {
    constructor(name, breed) {
        super(name);
        this.breed = breed;
    }
    
    speak() {
        return super.speak() + " - Woof!";
    }
}

let dog = new Dog("Buddy", "Golden Retriever");
console.log(dog.speak());  // "Buddy makes a sound - Woof!"
```

### super Examples

```javascript
class Shape {
    constructor(color) {
        this.color = color;
    }
    
    getInfo() {
        return `Shape with color ${this.color}`;
    }
}

class Circle extends Shape {
    constructor(color, radius) {
        super(color);
        this.radius = radius;
    }
    
    getInfo() {
        return super.getInfo() + ` and radius ${this.radius}`;
    }
}

let circle = new Circle("red", 5);
console.log(circle.getInfo());  // "Shape with color red and radius 5"
```

---

## Method Overriding

Child classes can override parent class methods to provide their own implementation.

### Basic Override

```javascript
class Animal {
    speak() {
        return "Some sound";
    }
}

class Dog extends Animal {
    speak() {
        return "Woof!";
    }
}

class Cat extends Animal {
    speak() {
        return "Meow!";
    }
}

let dog = new Dog();
let cat = new Cat();

console.log(dog.speak());  // "Woof!"
console.log(cat.speak());  // "Meow!"
```

### Override with super

You can override but still call the parent method:

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
    
    introduce() {
        return `I''m ${this.name}`;
    }
}

class Dog extends Animal {
    introduce() {
        return super.introduce() + " and I''m a dog";
    }
}

let dog = new Dog("Buddy");
console.log(dog.introduce());  // "I''m Buddy and I''m a dog"
```

### Complete Override Example

```javascript
class Vehicle {
    constructor(brand, model) {
        this.brand = brand;
        this.model = model;
        this.speed = 0;
    }
    
    accelerate(amount) {
        this.speed += amount;
        return `Speed: ${this.speed} mph`;
    }
    
    getInfo() {
        return `${this.brand} ${this.model}`;
    }
}

class Car extends Vehicle {
    constructor(brand, model, doors) {
        super(brand, model);
        this.doors = doors;
    }
    
    // Override getInfo
    getInfo() {
        return `${super.getInfo()} with ${this.doors} doors`;
    }
}

class Truck extends Vehicle {
    constructor(brand, model, capacity) {
        super(brand, model);
        this.capacity = capacity;
    }
    
    // Override accelerate (trucks accelerate slower)
    accelerate(amount) {
        this.speed += amount * 0.5;  // Half the acceleration
        return `Speed: ${this.speed} mph (truck mode)`;
    }
    
    // Override getInfo
    getInfo() {
        return `${super.getInfo()} with ${this.capacity} ton capacity`;
    }
}

let car = new Car("Toyota", "Camry", 4);
let truck = new Truck("Ford", "F-150", 2);

console.log(car.getInfo());        // "Toyota Camry with 4 doors"
console.log(car.accelerate(30));   // "Speed: 30 mph"
console.log(truck.getInfo());      // "Ford F-150 with 2 ton capacity"
console.log(truck.accelerate(30)); // "Speed: 15 mph (truck mode)"
```

---

## Prototypal Inheritance

Under the hood, JavaScript uses prototypal inheritance. Classes are syntactic sugar over this system.

### How Inheritance Works

```javascript
class Animal {
    constructor(name) {
        this.name = name;
    }
}

class Dog extends Animal {
    constructor(name, breed) {
        super(name);
        this.breed = breed;
    }
}

let dog = new Dog("Buddy", "Golden Retriever");

// Prototype chain:
// dog → Dog.prototype → Animal.prototype → Object.prototype → null

console.log(dog instanceof Dog);     // true
console.log(dog instanceof Animal);  // true
console.log(dog instanceof Object);  // true
```

### Prototype Chain Visualization

```
dog instance
  ├─ name: "Buddy" (own property)
  ├─ breed: "Golden Retriever" (own property)
  └─ __proto__ → Dog.prototype
       └─ __proto__ → Animal.prototype
            └─ __proto__ → Object.prototype
                 └─ __proto__ → null
```

### Checking Inheritance

```javascript
class Animal { }
class Dog extends Animal { }
class Puppy extends Dog { }

let puppy = new Puppy();

console.log(puppy instanceof Puppy);  // true
console.log(puppy instanceof Dog);  // true
console.log(puppy instanceof Animal); // true
console.log(puppy instanceof Object); // true
```

### Accessing Parent Prototype

```javascript
class Animal {
    speak() {
        return "Some sound";
    }
}

class Dog extends Animal {
    speak() {
        return "Woof!";
    }
}

let dog = new Dog();

// Access parent method through prototype
console.log(Animal.prototype.speak.call(dog));  // "Some sound"
console.log(dog.speak());                        // "Woof!" (overridden)
```

---

## Multiple Levels of Inheritance

You can create inheritance chains with multiple levels.

### Three-Level Inheritance

```javascript
class Vehicle {
    constructor(brand) {
        this.brand = brand;
        this.isRunning = false;
    }
    
    start() {
        this.isRunning = true;
        return "Vehicle started";
    }
}

class Car extends Vehicle {
    constructor(brand, doors) {
        super(brand);
        this.doors = doors;
    }
    
    openTrunk() {
        return "Trunk opened";
    }
}

class SportsCar extends Car {
    constructor(brand, doors, topSpeed) {
        super(brand, doors);
        this.topSpeed = topSpeed;
    }
    
    race() {
        if (this.isRunning) {
            return `Racing at up to ${this.topSpeed} mph!`;
        }
        return "Start the car first";
    }
}

let sportsCar = new SportsCar("Ferrari", 2, 200);
console.log(sportsCar.start());      // "Vehicle started" (from Vehicle)
console.log(sportsCar.openTrunk());  // "Trunk opened" (from Car)
console.log(sportsCar.race());       // "Racing at up to 200 mph!" (from SportsCar)
```

### Method Resolution

When a method is called, JavaScript looks up the prototype chain:

```javascript
class Animal {
    eat() {
        return "Eating food";
    }
}

class Dog extends Animal {
    bark() {
        return "Woof!";
    }
}

let dog = new Dog();

// JavaScript looks for eat():
// 1. dog object → not found
// 2. Dog.prototype → not found
// 3. Animal.prototype → found! "Eating food"
console.log(dog.eat());  // "Eating food"
```

---

## Complete Inheritance Example

### Shape Hierarchy

```javascript
class Shape {
    constructor(color) {
        this.color = color;
    }
    
    getArea() {
        throw new Error("getArea() must be implemented by subclass");
    }
    
    getInfo() {
        return `Shape with color ${this.color}`;
    }
}

class Circle extends Shape {
    constructor(color, radius) {
        super(color);
        this.radius = radius;
    }
    
    getArea() {
        return Math.PI * this.radius ** 2;
    }
    
    getInfo() {
        return `${super.getInfo()}, radius ${this.radius}`;
    }
}

class Rectangle extends Shape {
    constructor(color, width, height) {
        super(color);
        this.width = width;
        this.height = height;
    }
    
    getArea() {
        return this.width * this.height;
    }
    
    getInfo() {
        return `${super.getInfo()}, ${this.width}x${this.height}`;
    }
}

class Square extends Rectangle {
    constructor(color, side) {
        super(color, side, side);
        this.side = side;
    }
    
    getInfo() {
        return `${super.getInfo()} (square)`;
    }
}

// Usage
let circle = new Circle("red", 5);
let rectangle = new Rectangle("blue", 10, 5);
let square = new Square("green", 4);

console.log(circle.getInfo());     // "Shape with color red, radius 5"
console.log(circle.getArea());     // 78.54...

console.log(rectangle.getInfo());  // "Shape with color blue, 10x5"
console.log(rectangle.getArea());  // 50

console.log(square.getInfo());     // "Shape with color green, 4x4 (square)"
console.log(square.getArea());     // 16
```

---

## Practice Exercise

### Exercise: Inheritance Practice

**Objective**: Create class hierarchies using inheritance, super, and method overriding.

**Instructions**:

1. Create a file called `inheritance-practice.js`

2. Create class hierarchies:
   - Animal → Dog, Cat
   - Vehicle → Car, Truck, Motorcycle
   - Employee → Manager, Developer

3. Practice:
   - Using extends
   - Calling super()
   - Method overriding
   - Accessing parent methods
   - Creating multi-level inheritance

**Example Solution**:

```javascript
// Inheritance Practice
console.log("=== Animal Hierarchy ===");

class Animal {
    constructor(name, age) {
        this.name = name;
        this.age = age;
    }
    
    speak() {
        return `${this.name} makes a sound`;
    }
    
    getInfo() {
        return `${this.name} is ${this.age} years old`;
    }
}

class Dog extends Animal {
    constructor(name, age, breed) {
        super(name, age);
        this.breed = breed;
    }
    
    speak() {
        return `${this.name} says Woof!`;
    }
    
    fetch() {
        return `${this.name} fetches the ball`;
    }
    
    getInfo() {
        return `${super.getInfo()} and is a ${this.breed}`;
    }
}

class Cat extends Animal {
    constructor(name, age, color) {
        super(name, age);
        this.color = color;
    }
    
    speak() {
        return `${this.name} says Meow!`;
    }
    
    purr() {
        return `${this.name} purrs contentedly`;
    }
    
    getInfo() {
        return `${super.getInfo()} and is ${this.color}`;
    }
}

let dog = new Dog("Buddy", 3, "Golden Retriever");
let cat = new Cat("Whiskers", 2, "orange");

console.log(dog.speak());      // "Buddy says Woof!"
console.log(dog.fetch());      // "Buddy fetches the ball"
console.log(dog.getInfo());    // "Buddy is 3 years old and is a Golden Retriever"

console.log(cat.speak());      // "Whiskers says Meow!"
console.log(cat.purr());       // "Whiskers purrs contentedly"
console.log(cat.getInfo());    // "Whiskers is 2 years old and is orange"
console.log();

console.log("=== Vehicle Hierarchy ===");

class Vehicle {
    constructor(brand, model, year) {
        this.brand = brand;
        this.model = model;
        this.year = year;
        this.speed = 0;
        this.isRunning = false;
    }
    
    start() {
        this.isRunning = true;
        return `${this.brand} ${this.model} started`;
    }
    
    stop() {
        this.isRunning = false;
        this.speed = 0;
        return `${this.brand} ${this.model} stopped`;
    }
    
    accelerate(amount) {
        if (this.isRunning) {
            this.speed += amount;
            return `Speed: ${this.speed} mph`;
        }
        return "Vehicle is not running";
    }
    
    getInfo() {
        return `${this.year} ${this.brand} ${this.model}`;
    }
}

class Car extends Vehicle {
    constructor(brand, model, year, doors) {
        super(brand, model, year);
        this.doors = doors;
    }
    
    openTrunk() {
        return "Trunk opened";
    }
    
    getInfo() {
        return `${super.getInfo()} with ${this.doors} doors`;
    }
}

class Truck extends Vehicle {
    constructor(brand, model, year, capacity) {
        super(brand, model, year);
        this.capacity = capacity;
    }
    
    accelerate(amount) {
        if (this.isRunning) {
            this.speed += amount * 0.7;  // Trucks accelerate slower
            return `Speed: ${this.speed} mph (truck)`;
        }
        return "Truck is not running";
    }
    
    loadCargo(weight) {
        if (weight <= this.capacity) {
            return `Loaded ${weight} tons of cargo`;
        }
        return `Cannot load ${weight} tons (max: ${this.capacity})`;
    }
    
    getInfo() {
        return `${super.getInfo()} with ${this.capacity} ton capacity`;
    }
}

class Motorcycle extends Vehicle {
    constructor(brand, model, year, engineSize) {
        super(brand, model, year);
        this.engineSize = engineSize;
    }
    
    accelerate(amount) {
        if (this.isRunning) {
            this.speed += amount * 1.5;  // Motorcycles accelerate faster
            return `Speed: ${this.speed} mph (motorcycle)`;
        }
        return "Motorcycle is not running";
    }
    
    wheelie() {
        if (this.isRunning && this.speed > 20) {
            return "Doing a wheelie!";
        }
        return "Need more speed for wheelie";
    }
    
    getInfo() {
        return `${super.getInfo()} with ${this.engineSize}cc engine`;
    }
}

let car = new Car("Toyota", "Camry", 2020, 4);
let truck = new Truck("Ford", "F-150", 2021, 2);
let motorcycle = new Motorcycle("Honda", "CBR", 2022, 600);

console.log(car.getInfo());           // "2020 Toyota Camry with 4 doors"
console.log(car.start());             // "Toyota Camry started"
console.log(car.accelerate(30));       // "Speed: 30 mph"
console.log(car.openTrunk());         // "Trunk opened"

console.log(truck.getInfo());         // "2021 Ford F-150 with 2 ton capacity"
console.log(truck.start());           // "Ford F-150 started"
console.log(truck.accelerate(30));    // "Speed: 21 mph (truck)"
console.log(truck.loadCargo(1.5));    // "Loaded 1.5 tons of cargo"

console.log(motorcycle.getInfo());    // "2022 Honda CBR with 600cc engine"
console.log(motorcycle.start());      // "Honda CBR started"
console.log(motorcycle.accelerate(30)); // "Speed: 45 mph (motorcycle)"
console.log(motorcycle.wheelie());    // "Doing a wheelie!"
console.log();

console.log("=== Employee Hierarchy ===");

class Employee {
    constructor(name, id, salary) {
        this.name = name;
        this.id = id;
        this.salary = salary;
    }
    
    work() {
        return `${this.name} is working`;
    }
    
    getSalary() {
        return `Salary: $${this.salary}`;
    }
    
    getInfo() {
        return `${this.name} (ID: ${this.id})`;
    }
}

class Manager extends Employee {
    constructor(name, id, salary, department) {
        super(name, id, salary);
        this.department = department;
        this.team = [];
    }
    
    addTeamMember(employee) {
        this.team.push(employee);
        return `Added ${employee.name} to team`;
    }
    
    work() {
        return `${this.name} is managing the ${this.department} department`;
    }
    
    getTeamSize() {
        return this.team.length;
    }
    
    getInfo() {
        return `${super.getInfo()} - Manager of ${this.department}`;
    }
}

class Developer extends Employee {
    constructor(name, id, salary, language) {
        super(name, id, salary);
        this.language = language;
    }
    
    work() {
        return `${this.name} is coding in ${this.language}`;
    }
    
    debug() {
        return `${this.name} is debugging code`;
    }
    
    getInfo() {
        return `${super.getInfo()} - Developer (${this.language})`;
    }
}

let manager = new Manager("Alice", "M001", 80000, "Engineering");
let dev1 = new Developer("Bob", "D001", 70000, "JavaScript");
let dev2 = new Developer("Charlie", "D002", 75000, "Python");

console.log(manager.getInfo());        // "Alice (ID: M001) - Manager of Engineering"
console.log(manager.work());           // "Alice is managing the Engineering department"
console.log(manager.addTeamMember(dev1)); // "Added Bob to team"
console.log(manager.addTeamMember(dev2)); // "Added Charlie to team"
console.log("Team size:", manager.getTeamSize()); // 2

console.log(dev1.getInfo());           // "Bob (ID: D001) - Developer (JavaScript)"
console.log(dev1.work());              // "Bob is coding in JavaScript"
console.log(dev1.debug());             // "Bob is debugging code"
console.log();

console.log("=== instanceof Checks ===");
console.log("dog instanceof Dog:", dog instanceof Dog);           // true
console.log("dog instanceof Animal:", dog instanceof Animal);     // true
console.log("car instanceof Car:", car instanceof Car);           // true
console.log("car instanceof Vehicle:", car instanceof Vehicle);    // true
console.log("manager instanceof Manager:", manager instanceof Manager); // true
console.log("manager instanceof Employee:", manager instanceof Employee); // true
```

**Expected Output**:
```
=== Animal Hierarchy ===
Buddy says Woof!
Buddy fetches the ball
Buddy is 3 years old and is a Golden Retriever
Whiskers says Meow!
Whiskers purrs contentedly
Whiskers is 2 years old and is orange

=== Vehicle Hierarchy ===
2020 Toyota Camry with 4 doors
Toyota Camry started
Speed: 30 mph
Trunk opened
2021 Ford F-150 with 2 ton capacity
Ford F-150 started
Speed: 21 mph (truck)
Loaded 1.5 tons of cargo
2022 Honda CBR with 600cc engine
Honda CBR started
Speed: 45 mph (motorcycle)
Doing a wheelie!

=== Employee Hierarchy ===
Alice (ID: M001) - Manager of Engineering
Alice is managing the Engineering department
Added Bob to team
Added Charlie to team
Team size: 2
Bob (ID: D001) - Developer (JavaScript)
Bob is coding in JavaScript
Bob is debugging code

=== instanceof Checks ===
dog instanceof Dog: true
dog instanceof Animal: true
car instanceof Car: true
car instanceof Vehicle: true
manager instanceof Manager: true
manager instanceof Employee: true
```

**Challenge (Optional)**:
- Create a game character hierarchy
- Build a shape system with multiple levels
- Create a file system hierarchy
- Build a UI component system

---

## Common Mistakes

### 1. Forgetting super() in Constructor

```javascript
// ❌ Error: Must call super before accessing this
class Dog extends Animal {
    constructor(name, breed) {
        this.breed = breed;  // Error!
        super(name);
    }
}

// ✅ Correct
class Dog extends Animal {
    constructor(name, breed) {
        super(name);
        this.breed = breed;
    }
}
```

### 2. Calling super() After return

```javascript
// ❌ Error: super() must be called before return
class Dog extends Animal {
    constructor(name) {
        return {};
        super(name);  // Never reached
    }
}
```

### 3. Overriding Without super

```javascript
// ⚠️ Loses parent functionality
class Dog extends Animal {
    getInfo() {
        return `Dog: ${this.name}`;  // Doesn''t use parent''s getInfo
    }
}

// ✅ Better: Use super
class Dog extends Animal {
    getInfo() {
        return `Dog: ${super.getInfo()}`;
    }
}
```

### 4. Wrong super Usage

```javascript
// ❌ super is not a variable
class Dog extends Animal {
    method() {
        let parent = super;  // Error: super is a keyword
    }
}

// ✅ Correct: Call super methods
class Dog extends Animal {
    method() {
        return super.method();
    }
}
```

### 5. Extending Non-Constructor

```javascript
// ❌ Cannot extend non-constructor
class Dog extends "Animal" { }  // Error

// ✅ Must extend a class or constructor
class Dog extends Animal { }  // Correct
```

---

## Key Takeaways

1. **extends**: Creates inheritance relationship
2. **super**: Calls parent class constructor/methods
3. **Method Overriding**: Child classes can override parent methods
4. **super()**: Must be called before `this` in child constructor
5. **Prototypal Inheritance**: Classes use prototype chain under the hood
6. **instanceof**: Works with inheritance (checks prototype chain)
7. **Multi-level**: Can have multiple levels of inheritance
8. **Best Practice**: Use super to extend parent functionality

---

## Quiz: Inheritance

Test your understanding with these questions:

1. **What keyword creates inheritance?**
   - A) inherits
   - B) extends
   - C) super
   - D) parent

2. **When must super() be called?**
   - A) After using this
   - B) Before using this
   - C) Never
   - D) Anytime

3. **What does super refer to?**
   - A) Current class
   - B) Parent class
   - C) Child class
   - D) Global object

4. **Can child classes override parent methods?**
   - A) No
   - B) Yes
   - C) Sometimes
   - D) Only static methods

5. **What does instanceof check with inheritance?**
   - A) Only direct class
   - B) Prototype chain
   - C) Property names
   - D) Method names

6. **How many classes can a class extend?**
   - A) 0
   - B) 1
   - C) Multiple
   - D) Unlimited

7. **Inheritance uses:**
   - A) Copying
   - B) Prototype chain
   - C) Cloning
   - D) Duplication

**Answers**:
1. B) extends
2. B) Before using this
3. B) Parent class
4. B) Yes
5. B) Prototype chain
6. B) 1 (single inheritance)
7. B) Prototype chain

---

## Next Steps

Congratulations! You''ve completed Module 6: Object-Oriented Programming. You now know:
- Constructor functions and prototypes
- ES6 class syntax
- Inheritance with extends and super
- Method overriding

**What''s Next?**
- Course 2: Intermediate JavaScript
- Module 7: ES6+ Features
- Practice building class hierarchies
- Create more complex OOP structures

---

## Additional Resources

- **MDN: Inheritance**: [developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Inheritance](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Objects/Inheritance)
- **MDN: extends**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/extends](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/extends)
- **MDN: super**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/super](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/super)
- **JavaScript.info: Class Inheritance**: [javascript.info/class-inheritance](https://javascript.info/class-inheritance)

---

*Lesson completed! You''ve finished Module 6: Object-Oriented Programming. Ready for Course 2: Intermediate JavaScript!*

', NULL, 3, '2026-01-03 09:36:30', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use the `extends` keyword to create class inheritance
- Use the `super` keyword to call parent class methods
- Override methods in child classes
- Understand prototypal inheritance
- Create class hierarchies
- Build complex object-oriented structures');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (126, 47, 11, 'Let, Const, and Block Scope', 'let-const-and-block-scope', '# Lesson 7.1: Let, Const, and Block Scope

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the differences between `let`, `const`, and `var`
- Use `let` for block-scoped variables
- Use `const` for constants
- Understand the Temporal Dead Zone (TDZ)
- Work with block scope effectively
- Avoid common scoping pitfalls
- Write modern JavaScript code

---

## Introduction to Modern Variable Declarations

ES6 (ES2015) introduced `let` and `const` as alternatives to `var`. These new declarations provide better scoping rules and help prevent common bugs.

### Why New Declarations?

- **Block Scope**: Better than function scope
- **Temporal Dead Zone**: Prevents using variables before declaration
- **No Hoisting Issues**: Clearer behavior
- **Constants**: `const` prevents accidental reassignment
- **Modern Standard**: Recommended for all new code

---

## var vs let vs const

### Quick Comparison

| Feature | var | let | const |
|---------|-----|-----|-------|
| Scope | Function | Block | Block |
| Hoisting | Yes (undefined) | Yes (TDZ) | Yes (TDZ) |
| Reassignment | Yes | Yes | No |
| Redeclaration | Yes | No | No |
| Initialization | Optional | Optional | Required |

### When to Use Each

- **const**: Default choice for values that won''t change
- **let**: Use when you need to reassign
- **var**: Avoid (legacy code only)

---

## let vs var

### Scope Difference

**var (function scope):**
```javascript
function example() {
    if (true) {
        var x = 5;
    }
    console.log(x);  // 5 (accessible in function)
}

example();
```

**let (block scope):**
```javascript
function example() {
    if (true) {
        let x = 5;
    }
    // console.log(x);  // ❌ Error: x is not defined
}

example();
```

### Loop Example

**var in loops (problematic):**
```javascript
for (var i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i);  // 3, 3, 3 (all same!)
    }, 100);
}
```

**let in loops (correct):**
```javascript
for (let i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log(i);  // 0, 1, 2 (correct!)
    }, 100);
}
```

### Redeclaration

**var allows redeclaration:**
```javascript
var x = 5;
var x = 10;  // ✅ Works (but confusing)
console.log(x);  // 10
```

**let prevents redeclaration:**
```javascript
let x = 5;
// let x = 10;  // ❌ Error: Identifier ''x'' has already been declared
```

### Hoisting Behavior

**var hoisting:**
```javascript
console.log(x);  // undefined (not an error)
var x = 5;
```

**let hoisting (Temporal Dead Zone):**
```javascript
// console.log(x);  // ❌ Error: Cannot access before initialization
let x = 5;
```

---

## const for Constants

`const` creates constants that cannot be reassigned.

### Basic Usage

```javascript
const PI = 3.14159;
const MAX_SIZE = 100;
const API_URL = "https://api.example.com";

// PI = 3.14;  // ❌ Error: Assignment to constant variable
```

### const Must Be Initialized

```javascript
// ❌ Error: Missing initializer
// const x;

// ✅ Correct
const x = 5;
```

### const and Objects

`const` prevents reassignment, not mutation:

```javascript
const person = {
    name: "Alice",
    age: 25
};

// ✅ Can modify properties
person.age = 26;
person.city = "New York";

// ❌ Cannot reassign object
// person = { name: "Bob" };  // Error
```

### const and Arrays

```javascript
const numbers = [1, 2, 3];

// ✅ Can modify array
numbers.push(4);
numbers[0] = 10;

// ❌ Cannot reassign array
// numbers = [5, 6, 7];  // Error
```

### When to Use const

**Use const for:**
- Values that shouldn''t change
- Object and array references
- Function declarations
- Imported modules
- Configuration values

**Use let for:**
- Loop counters
- Variables that will be reassigned
- Conditional assignments

---

## Temporal Dead Zone (TDZ)

The Temporal Dead Zone is the period between the start of a scope and the variable declaration where the variable exists but cannot be accessed.

### Understanding TDZ

```javascript
// TDZ starts here
console.log(x);  // ❌ Error: Cannot access ''x'' before initialization
// TDZ continues...
let x = 5;       // TDZ ends here
```

### TDZ Examples

```javascript
// ❌ Error: TDZ
console.log(myVar);
let myVar = 10;

// ✅ Works: Variable is declared first
let myVar = 10;
console.log(myVar);
```

### TDZ with Functions

```javascript
// ❌ Error: TDZ
function test() {
    console.log(x);  // Error
    let x = 5;
}

// ✅ Works
function test() {
    let x = 5;
    console.log(x);  // 5
}
```

### Why TDZ Exists

TDZ prevents:
- Using variables before declaration
- Confusing behavior from hoisting
- Accidental bugs

---

## Block Scope

Block scope means variables are only accessible within the block `{}` where they''re declared.

### Basic Block Scope

```javascript
{
    let x = 5;
    console.log(x);  // 5
}
// console.log(x);  // ❌ Error: x is not defined
```

### Block Scope in Conditionals

```javascript
if (true) {
    let message = "Hello";
    console.log(message);  // "Hello"
}
// console.log(message);  // ❌ Error: message is not defined
```

### Block Scope in Loops

```javascript
for (let i = 0; i < 3; i++) {
    console.log(i);  // 0, 1, 2
}
// console.log(i);  // ❌ Error: i is not defined
```

### Multiple Blocks

Each block creates its own scope:

```javascript
{
    let x = 1;
    console.log(x);  // 1
}

{
    let x = 2;  // Different x
    console.log(x);  // 2
}
```

### Nested Blocks

```javascript
let outer = "outer";

{
    let middle = "middle";
    
    {
        let inner = "inner";
        console.log(outer);   // ✅ Can access
        console.log(middle);   // ✅ Can access
        console.log(inner);    // ✅ Can access
    }
    
    console.log(outer);   // ✅ Can access
    console.log(middle);   // ✅ Can access
    // console.log(inner);  // ❌ Error: inner not accessible
}

// console.log(middle);  // ❌ Error: middle not accessible
// console.log(inner);   // ❌ Error: inner not accessible
```

---

## Practical Examples

### Example 1: Loop Variables

```javascript
// ✅ Good: let in loops
for (let i = 0; i < 5; i++) {
    setTimeout(() => {
        console.log(i);  // 0, 1, 2, 3, 4
    }, 100);
}

// ⚠️ Problem: var in loops
for (var j = 0; j < 5; j++) {
    setTimeout(() => {
        console.log(j);  // 5, 5, 5, 5, 5 (all same!)
    }, 100);
}
```

### Example 2: Conditional Scope

```javascript
let user = getUser();

if (user) {
    let userId = user.id;
    let userName = user.name;
    processUser(userId, userName);
}
// userId and userName not accessible here (good!)
```

### Example 3: Constants

```javascript
// Configuration
const API_BASE_URL = "https://api.example.com";
const MAX_RETRIES = 3;
const TIMEOUT = 5000;

// Object reference
const config = {
    apiUrl: API_BASE_URL,
    retries: MAX_RETRIES
};

// Can modify properties
config.timeout = TIMEOUT;

// Cannot reassign
// config = {};  // Error
```

### Example 4: Block Scope Benefits

```javascript
function processData(data) {
    if (data) {
        let processed = transform(data);
        let validated = validate(processed);
        return validated;
    }
    // processed and validated not accessible here (clean scope)
    return null;
}
```

---

## Best Practices

### 1. Use const by Default

```javascript
// ✅ Good: const by default
const name = "Alice";
const age = 25;
const user = { name, age };

// Use let only when needed
let counter = 0;
counter++;  // Need to reassign
```

### 2. Declare at Top of Block

```javascript
// ✅ Good: Clear scope
function example() {
    let x = 5;
    let y = 10;
    // Use x and y
}

// ⚠️ Less clear: Scattered declarations
function example() {
    // Some code
    let x = 5;
    // More code
    let y = 10;
}
```

### 3. Avoid var

```javascript
// ❌ Old style
var x = 5;

// ✅ Modern style
let x = 5;      // If reassigning
const x = 5;    // If constant
```

### 4. Use Meaningful Names

```javascript
// ✅ Good
const MAX_USERS = 100;
const API_TIMEOUT = 5000;

// ❌ Avoid
const m = 100;
const t = 5000;
```

### 5. Block Scope for Temporary Variables

```javascript
// ✅ Good: Block scope for temporary variables
if (condition) {
    let temp = calculate();
    process(temp);
}
// temp not accessible (good!)

// ⚠️ Less ideal: Function scope
if (condition) {
    var temp = calculate();
    process(temp);
}
// temp still accessible (might be unwanted)
```

---

## Practice Exercise

### Exercise: Block Scope Practice

**Objective**: Practice using `let` and `const` with block scope in various scenarios.

**Instructions**:

1. Create a file called `block-scope-practice.js`

2. Demonstrate:
   - `let` vs `var` in different scopes
   - `const` for constants
   - Block scope in conditionals and loops
   - Temporal Dead Zone
   - Nested scopes
   - Best practices

**Example Solution**:

```javascript
// Block Scope Practice
console.log("=== let vs var Scope ===");

// var: Function scope
function varExample() {
    if (true) {
        var x = 5;
    }
    console.log("var x:", x);  // 5 (accessible)
}

// let: Block scope
function letExample() {
    if (true) {
        let y = 5;
    }
    // console.log("let y:", y);  // ❌ Error: not accessible
}

varExample();
letExample();
console.log();

console.log("=== Loop Scope ===");

// var in loop (problem)
console.log("Using var:");
for (var i = 0; i < 3; i++) {
    setTimeout(() => {
        console.log("var i:", i);  // 3, 3, 3
    }, 10);
}

// let in loop (correct)
setTimeout(() => {
    console.log("Using let:");
    for (let j = 0; j < 3; j++) {
        setTimeout(() => {
            console.log("let j:", j);  // 0, 1, 2
        }, 20);
    }
}, 50);
console.log();

console.log("=== const Usage ===");

// Constants
const PI = 3.14159;
const MAX_SIZE = 100;
const API_URL = "https://api.example.com";

console.log("PI:", PI);
console.log("MAX_SIZE:", MAX_SIZE);
console.log("API_URL:", API_URL);

// const with objects
const person = {
    name: "Alice",
    age: 25
};

person.age = 26;  // ✅ Can modify
person.city = "NYC";  // ✅ Can add
console.log("Modified person:", person);

// const with arrays
const numbers = [1, 2, 3];
numbers.push(4);  // ✅ Can modify
numbers[0] = 10;  // ✅ Can modify
console.log("Modified array:", numbers);
console.log();

console.log("=== Block Scope Examples ===");

// Basic block
{
    let blockVar = "I''m in a block";
    console.log("Inside block:", blockVar);
}
// console.log(blockVar);  // ❌ Error

// Conditional blocks
let condition = true;
if (condition) {
    let ifVar = "Inside if";
    console.log("If block:", ifVar);
}
// console.log(ifVar);  // ❌ Error

// Loop blocks
for (let i = 0; i < 3; i++) {
    let loopVar = `Iteration ${i}`;
    console.log("Loop:", loopVar);
}
// console.log(loopVar);  // ❌ Error
// console.log(i);  // ❌ Error
console.log();

console.log("=== Nested Scopes ===");

let global = "global";

{
    let level1 = "level1";
    console.log("Level 1:", global, level1);
    
    {
        let level2 = "level2";
        console.log("Level 2:", global, level1, level2);
        
        {
            let level3 = "level3";
            console.log("Level 3:", global, level1, level2, level3);
        }
        
        // console.log(level3);  // ❌ Error
    }
    
    // console.log(level2);  // ❌ Error
    // console.log(level3);  // ❌ Error
}
console.log();

console.log("=== Temporal Dead Zone ===");

// TDZ demonstration
function tdzExample() {
    // console.log(tdzVar);  // ❌ Error: Cannot access before initialization
    let tdzVar = "I''m in TDZ";
    console.log("After declaration:", tdzVar);  // ✅ Works
}

tdzExample();

// var vs let hoisting
console.log("var hoisting:");
console.log("varX:", typeof varX);  // "undefined" (hoisted)
var varX = 5;

// console.log("letX:", typeof letX);  // ❌ Error: TDZ
let letX = 5;
console.log();

console.log("=== Best Practices ===");

// ✅ Good: const by default
const userName = "Alice";
const userAge = 25;
const userConfig = {
    theme: "dark",
    language: "en"
};

// ✅ Good: let when reassigning
let counter = 0;
counter++;
counter += 5;

// ✅ Good: Block scope for temporary variables
function processData(data) {
    if (data && data.length > 0) {
        let processed = data.map(item => item * 2);
        let filtered = processed.filter(item => item > 10);
        return filtered;
    }
    // processed and filtered not accessible (good!)
    return [];
}

let result = processData([1, 2, 3, 4, 5, 6, 7, 8, 9, 10]);
console.log("Processed data:", result);  // [12, 14, 16, 18, 20]
console.log();

console.log("=== Real-World Example ===");

// Configuration with const
const CONFIG = {
    apiUrl: "https://api.example.com",
    timeout: 5000,
    retries: 3
};

// Function with block scope
function makeRequest(endpoint) {
    const url = `${CONFIG.apiUrl}${endpoint}`;
    
    for (let attempt = 1; attempt <= CONFIG.retries; attempt++) {
        let response = simulateRequest(url);
        
        if (response.success) {
            return response;
        }
        
        if (attempt < CONFIG.retries) {
            console.log(`Attempt ${attempt} failed, retrying...`);
        }
    }
    
    throw new Error("All retry attempts failed");
}

function simulateRequest(url) {
    return { success: Math.random() > 0.5 };
}

try {
    let response = makeRequest("/users");
    console.log("Request successful!");
} catch (error) {
    console.log("Request failed:", error.message);
}
```

**Expected Output**:
```
=== let vs var Scope ===
var x: 5

=== Loop Scope ===
Using var:
Using let:
var i: 3
var i: 3
var i: 3
let j: 0
let j: 1
let j: 2

=== const Usage ===
PI: 3.14159
MAX_SIZE: 100
API_URL: https://api.example.com
Modified person: { name: "Alice", age: 26, city: "NYC" }
Modified array: [10, 2, 3, 4]

=== Block Scope Examples ===
Inside block: I''m in a block
If block: Inside if
Loop: Iteration 0
Loop: Iteration 1
Loop: Iteration 2

=== Nested Scopes ===
Level 1: global level1
Level 2: global level1 level2
Level 3: global level1 level2 level3

=== Temporal Dead Zone ===
After declaration: I''m in TDZ
var hoisting:
varX: undefined

=== Best Practices ===
Processed data: [12, 14, 16, 18, 20]

=== Real-World Example ===
Attempt 1 failed, retrying...
Request successful!
```

**Challenge (Optional)**:
- Refactor code from var to let/const
- Create scope-based utilities
- Build configuration systems with const
- Practice TDZ scenarios

---

## Common Mistakes

### 1. Using var Instead of let/const

```javascript
// ❌ Old style
var x = 5;

// ✅ Modern style
let x = 5;      // If reassigning
const x = 5;    // If constant
```

### 2. Trying to Reassign const

```javascript
// ❌ Error
const x = 5;
x = 10;  // Error

// ✅ Use let if reassigning
let x = 5;
x = 10;  // Works
```

### 3. Accessing Before Declaration

```javascript
// ❌ Error: TDZ
console.log(x);
let x = 5;

// ✅ Declare first
let x = 5;
console.log(x);
```

### 4. Forgetting const Initialization

```javascript
// ❌ Error: Missing initializer
// const x;

// ✅ Must initialize
const x = 5;
```

### 5. Confusing const Immutability

```javascript
// ⚠️ const prevents reassignment, not mutation
const obj = { x: 1 };
obj.x = 2;      // ✅ Works (mutation)
// obj = {};    // ❌ Error (reassignment)
```

---

## Key Takeaways

1. **let**: Block-scoped, can reassign, no redeclaration
2. **const**: Block-scoped, cannot reassign, must initialize
3. **var**: Function-scoped, avoid in modern code
4. **Block Scope**: Variables only accessible in their block
5. **Temporal Dead Zone**: Period before declaration where variable can''t be accessed
6. **Best Practice**: Use `const` by default, `let` when reassigning
7. **Loop Variables**: Always use `let` in loops
8. **Constants**: Use `const` for values that shouldn''t change

---

## Quiz: Modern Variable Declarations

Test your understanding with these questions:

1. **What scope does `let` have?**
   - A) Function scope
   - B) Block scope
   - C) Global scope
   - D) No scope

2. **Can you reassign a `const` variable?**
   - A) Yes
   - B) No
   - C) Sometimes
   - D) Only in functions

3. **What is the Temporal Dead Zone?**
   - A) Error zone
   - B) Period before declaration
   - C) Block scope
   - D) Function scope

4. **Which is hoisted to undefined?**
   - A) let
   - B) const
   - C) var
   - D) All of them

5. **What happens: `console.log(x); let x = 5;`?**
   - A) undefined
   - B) 5
   - C) Error
   - D) null

6. **Can you modify a const object''s properties?**
   - A) Yes
   - B) No
   - C) Only in functions
   - D) Only arrays

7. **Which should you use by default?**
   - A) var
   - B) let
   - C) const
   - D) Doesn''t matter

**Answers**:
1. B) Block scope
2. B) No
3. B) Period before declaration
4. C) var
5. C) Error (TDZ)
6. A) Yes (const prevents reassignment, not mutation)
7. C) const

---

## Next Steps

Congratulations! You''ve learned modern variable declarations. You now know:
- Differences between let, const, and var
- Block scope and its benefits
- Temporal Dead Zone
- When to use each declaration

**What''s Next?**
- Lesson 7.2: Destructuring
- Practice refactoring var to let/const
- Understand scope better
- Build more modern JavaScript code

---

## Additional Resources

- **MDN: let**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let)
- **MDN: const**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/const)
- **JavaScript.info: Variables**: [javascript.info/variables](https://javascript.info/variables)
- **JavaScript.info: Closure**: [javascript.info/closure](https://javascript.info/closure)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:40:36', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the differences between `let`, `const`, and `var`
- Use `let` for block-scoped variables
- Use `const` for constants
- Understand the Temporal Dead Zone (TDZ)
- Work with block scope effectively
- Avoid common scoping pitfalls
- Write modern JavaScript code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (127, 47, 11, 'Destructuring', 'destructuring', '# Lesson 7.2: Destructuring

## Learning Objectives

By the end of this lesson, you will be able to:
- Destructure arrays to extract values
- Destructure objects to extract properties
- Use default values in destructuring
- Perform nested destructuring
- Use rest in destructuring
- Apply destructuring in function parameters
- Write cleaner, more readable code

---

## Introduction to Destructuring

Destructuring is a convenient way to extract values from arrays and objects into variables. It''s one of the most useful ES6 features.

### Benefits of Destructuring

- **Cleaner Code**: Less verbose than traditional assignment
- **Readability**: Clear intent
- **Convenience**: Extract multiple values at once
- **Default Values**: Handle missing values easily
- **Swapping**: Easy variable swapping

---

## Array Destructuring

### Basic Array Destructuring

```javascript
let numbers = [1, 2, 3];
let [a, b, c] = numbers;

console.log(a);  // 1
console.log(b);  // 2
console.log(c);  // 3
```

### Skipping Elements

Use empty slots to skip elements:

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, , third, , fifth] = numbers;

console.log(first);   // 1
console.log(third);   // 3
console.log(fifth);   // 5
```

### Default Values

Provide default values for missing elements:

```javascript
let numbers = [1, 2];
let [a, b, c = 10] = numbers;

console.log(a);  // 1
console.log(b);  // 2
console.log(c);  // 10 (default)
```

### Rest in Array Destructuring

Collect remaining elements:

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, second, ...rest] = numbers;

console.log(first);   // 1
console.log(second);  // 2
console.log(rest);    // [3, 4, 5]
```

### Swapping Variables

Easy variable swapping:

```javascript
let a = 5;
let b = 10;

[a, b] = [b, a];

console.log(a);  // 10
console.log(b);  // 5
```

### Function Return Values

Destructure function return values:

```javascript
function getNumbers() {
    return [1, 2, 3];
}

let [x, y, z] = getNumbers();
console.log(x, y, z);  // 1, 2, 3
```

### Nested Array Destructuring

```javascript
let numbers = [1, [2, 3], 4];
let [a, [b, c], d] = numbers;

console.log(a);  // 1
console.log(b);  // 2
console.log(c);  // 3
console.log(d);  // 4
```

### Ignoring Values

```javascript
let numbers = [1, 2, 3, 4, 5];
let [first, , , fourth] = numbers;

console.log(first);   // 1
console.log(fourth);  // 4
```

---

## Object Destructuring

### Basic Object Destructuring

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let { name, age, city } = person;

console.log(name);  // "Alice"
console.log(age);   // 25
console.log(city);  // "New York"
```

### Different Variable Names

Assign to different variable names:

```javascript
let person = {
    name: "Alice",
    age: 25
};

let { name: userName, age: userAge } = person;

console.log(userName);  // "Alice"
console.log(userAge);   // 25
// console.log(name);   // ❌ Error: name is not defined
```

### Default Values

```javascript
let person = {
    name: "Alice"
};

let { name, age = 0, city = "Unknown" } = person;

console.log(name);  // "Alice"
console.log(age);   // 0 (default)
console.log(city);  // "Unknown" (default)
```

### Combining Renaming and Defaults

```javascript
let person = {
    name: "Alice"
};

let { name: userName, age: userAge = 0 } = person;

console.log(userName);  // "Alice"
console.log(userAge);   // 0
```

### Nested Object Destructuring

```javascript
let user = {
    name: "Alice",
    address: {
        street: "123 Main St",
        city: "New York",
        country: {
            name: "USA",
            code: "US"
        }
    }
};

let {
    name,
    address: {
        street,
        city,
        country: { name: countryName }
    }
} = user;

console.log(name);        // "Alice"
console.log(street);      // "123 Main St"
console.log(city);        // "New York"
console.log(countryName); // "USA"
```

### Rest in Object Destructuring

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    country: "USA"
};

let { name, ...rest } = person;

console.log(name);  // "Alice"
console.log(rest);  // { age: 25, city: "New York", country: "USA" }
```

### Destructuring Existing Variables

```javascript
let name, age;

({ name, age } = { name: "Alice", age: 25 });

console.log(name);  // "Alice"
console.log(age);   // 25
```

**Note**: Parentheses required when destructuring into existing variables.

---

## Destructuring in Function Parameters

### Array Parameters

```javascript
function processCoordinates([x, y]) {
    console.log(`X: ${x}, Y: ${y}`);
}

processCoordinates([10, 20]);  // "X: 10, Y: 20"
```

### Object Parameters

```javascript
function greet({ name, age }) {
    console.log(`Hello, ${name}! You are ${age} years old.`);
}

greet({ name: "Alice", age: 25 });  // "Hello, Alice! You are 25 years old."
```

### Default Parameters with Destructuring

```javascript
function createUser({ name, age = 0, city = "Unknown" }) {
    return {
        name: name,
        age: age,
        city: city
    };
}

let user1 = createUser({ name: "Alice", age: 25 });
let user2 = createUser({ name: "Bob" });  // Uses defaults
```

### Nested Destructuring in Parameters

```javascript
function processUser({
    name,
    address: { city, country }
}) {
    console.log(`${name} lives in ${city}, ${country}`);
}

processUser({
    name: "Alice",
    address: {
        city: "New York",
        country: "USA"
    }
});
```

---

## Practical Examples

### Example 1: API Response

```javascript
// Simulated API response
let apiResponse = {
    status: "success",
    data: {
        user: {
            id: 1,
            name: "Alice",
            email: "alice@example.com"
        }
    }
};

let {
    status,
    data: {
        user: { id, name, email }
    }
} = apiResponse;

console.log(`User ${name} (${email}) - Status: ${status}`);
```

### Example 2: Configuration

```javascript
let config = {
    host: "localhost",
    port: 3000,
    database: {
        name: "mydb",
        user: "admin"
    }
};

let {
    host,
    port,
    database: { name: dbName, user: dbUser }
} = config;

console.log(`Connecting to ${host}:${port} with database ${dbName}`);
```

### Example 3: Array Methods

```javascript
let points = [
    [10, 20],
    [30, 40],
    [50, 60]
];

points.forEach(([x, y]) => {
    console.log(`Point: (${x}, ${y})`);
});
```

### Example 4: Function Returns

```javascript
function getMinMax(numbers) {
    return [Math.min(...numbers), Math.max(...numbers)];
}

let [min, max] = getMinMax([5, 2, 8, 1, 9]);
console.log(`Min: ${min}, Max: ${max}`);  // "Min: 1, Max: 9"
```

---

## Practice Exercise

### Exercise: Destructuring Practice

**Objective**: Practice array and object destructuring in various scenarios.

**Instructions**:

1. Create a file called `destructuring-practice.js`

2. Practice:
   - Array destructuring (basic, skipping, defaults, rest)
   - Object destructuring (basic, renaming, defaults, nested)
   - Function parameters with destructuring
   - Real-world examples (API responses, configs)

**Example Solution**:

```javascript
// Destructuring Practice
console.log("=== Array Destructuring ===");

// Basic
let numbers = [1, 2, 3, 4, 5];
let [a, b, c] = numbers;
console.log("Basic:", a, b, c);  // 1, 2, 3

// Skipping
let [first, , third, , fifth] = numbers;
console.log("Skipped:", first, third, fifth);  // 1, 3, 5

// Default values
let numbers2 = [1, 2];
let [x, y, z = 10] = numbers2;
console.log("With default:", x, y, z);  // 1, 2, 10

// Rest
let [first2, second, ...rest] = numbers;
console.log("First:", first2);    // 1
console.log("Second:", second);   // 2
console.log("Rest:", rest);       // [3, 4, 5]

// Swapping
let p = 5;
let q = 10;
[p, q] = [q, p];
console.log("Swapped:", p, q);  // 10, 5

// Nested
let nested = [1, [2, 3], 4];
let [a2, [b2, c2], d] = nested;
console.log("Nested:", a2, b2, c2, d);  // 1, 2, 3, 4
console.log();

console.log("=== Object Destructuring ===");

// Basic
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let { name, age, city } = person;
console.log("Basic:", name, age, city);  // Alice, 25, New York

// Renaming
let { name: userName, age: userAge } = person;
console.log("Renamed:", userName, userAge);  // Alice, 25

// Default values
let person2 = { name: "Bob" };
let { name: name2, age: age2 = 0, city: city2 = "Unknown" } = person2;
console.log("With defaults:", name2, age2, city2);  // Bob, 0, Unknown

// Rest
let { name: name3, ...rest2 } = person;
console.log("Name:", name3);  // Alice
console.log("Rest:", rest2);  // { age: 25, city: "New York" }

// Nested
let user = {
    name: "Alice",
    address: {
        street: "123 Main St",
        city: "New York",
        zip: "10001"
    }
};

let {
    name: userName2,
    address: { street, city: userCity, zip }
} = user;

console.log("Nested:", userName2, street, userCity, zip);
// Alice, 123 Main St, New York, 10001
console.log();

console.log("=== Function Parameters ===");

// Array parameter
function processArray([first, second, third]) {
    console.log(`Processing: ${first}, ${second}, ${third}`);
}
processArray([10, 20, 30]);  // "Processing: 10, 20, 30"

// Object parameter
function greetUser({ name, age = 0 }) {
    console.log(`Hello, ${name}! Age: ${age}`);
}
greetUser({ name: "Alice", age: 25 });  // "Hello, Alice! Age: 25"
greetUser({ name: "Bob" });             // "Hello, Bob! Age: 0"

// Nested parameter
function processConfig({
    server: { host, port },
    database: { name: dbName }
}) {
    console.log(`Server: ${host}:${port}, DB: ${dbName}`);
}

processConfig({
    server: { host: "localhost", port: 3000 },
    database: { name: "mydb" }
});
// "Server: localhost:3000, DB: mydb"
console.log();

console.log("=== Real-World Examples ===");

// API Response
let apiResponse = {
    status: "success",
    data: {
        users: [
            { id: 1, name: "Alice" },
            { id: 2, name: "Bob" }
        ],
        total: 2
    }
};

let {
    status,
    data: {
        users,
        total
    }
} = apiResponse;

console.log("API Status:", status);
console.log("Total users:", total);
users.forEach(({ id, name }) => {
    console.log(`User ${id}: ${name}`);
console.log();

// Function returns
function getStats(numbers) {
    return {
        min: Math.min(...numbers),
        max: Math.max(...numbers),
        sum: numbers.reduce((a, b) => a + b, 0),
        count: numbers.length
    };
}

let { min, max, sum, count } = getStats([5, 10, 15, 20, 25]);
console.log(`Stats: min=${min}, max=${max}, sum=${sum}, count=${count}`);
// "Stats: min=5, max=25, sum=75, count=5"
console.log();

// Configuration
let appConfig = {
    app: {
        name: "MyApp",
        version: "1.0.0"
    },
    api: {
        baseUrl: "https://api.example.com",
        timeout: 5000
    },
    features: {
        darkMode: true,
        notifications: false
    }
};

let {
    app: { name: appName, version },
    api: { baseUrl, timeout },
    features: { darkMode, notifications }
} = appConfig;

console.log(`App: ${appName} v${version}`);
console.log(`API: ${baseUrl} (timeout: ${timeout}ms)`);
console.log(`Features: darkMode=${darkMode}, notifications=${notifications}`);
console.log();

// Array methods with destructuring
let coordinates = [
    [10, 20],
    [30, 40],
    [50, 60]
];

console.log("Coordinates:");
coordinates.forEach(([x, y], index) => {
    console.log(`Point ${index + 1}: (${x}, ${y})`);
});

// Map with destructuring
let users2 = [
    { firstName: "Alice", lastName: "Smith" },
    { firstName: "Bob", lastName: "Jones" }
];

let fullNames = users2.map(({ firstName, lastName }) => {
    return `${firstName} ${lastName}`;
});
console.log("Full names:", fullNames);  // ["Alice Smith", "Bob Jones"]
```

**Expected Output**:
```
=== Array Destructuring ===
Basic: 1, 2, 3
Skipped: 1, 3, 5
With default: 1, 2, 10
First: 1
Second: 2
Rest: [3, 4, 5]
Swapped: 10, 5
Nested: 1, 2, 3, 4

=== Object Destructuring ===
Basic: Alice, 25, New York
Renamed: Alice, 25
With defaults: Bob, 0, Unknown
Name: Alice
Rest: { age: 25, city: "New York" }
Nested: Alice, 123 Main St, New York, 10001

=== Function Parameters ===
Processing: 10, 20, 30
Hello, Alice! Age: 25
Hello, Bob! Age: 0
Server: localhost:3000, DB: mydb

=== Real-World Examples ===
API Status: success
Total users: 2
User 1: Alice
User 2: Bob

Stats: min=5, max=25, sum=75, count=5

App: MyApp v1.0.0
API: https://api.example.com (timeout: 5000ms)
Features: darkMode=true, notifications=false

Coordinates:
Point 1: (10, 20)
Point 2: (30, 40)
Point 3: (50, 60)
Full names: ["Alice Smith", "Bob Jones"]
```

**Challenge (Optional)**:
- Refactor code to use destructuring
- Create utility functions with destructuring
- Build data processing pipelines
- Practice complex nested destructuring

---

## Common Mistakes

### 1. Destructuring Undefined/Null

```javascript
// ⚠️ Error if value is undefined/null
let { name } = undefined;  // Error

// ✅ Check first or use default
let { name = "Unknown" } = user || {};
```

### 2. Rest Must Be Last

```javascript
// ❌ Error: Rest element must be last
// let [first, ...middle, last] = [1, 2, 3, 4];

// ✅ Correct
let [first, ...rest] = [1, 2, 3, 4];
let last = rest[rest.length - 1];
```

### 3. Missing Parentheses

```javascript
let name, age;

// ❌ Error: Unexpected token
// { name, age } = { name: "Alice", age: 25 };

// ✅ Correct: Need parentheses
({ name, age } = { name: "Alice", age: 25 });
```

### 4. Wrong Syntax

```javascript
// ❌ Wrong
let { name: } = person;  // Missing variable name

// ✅ Correct
let { name: userName } = person;
```

### 5. Confusing Array/Object Syntax

```javascript
// Array: []
let [a, b] = [1, 2];

// Object: {}
let { a, b } = { a: 1, b: 2 };
```

---

## Key Takeaways

1. **Array Destructuring**: Extract values from arrays `[a, b] = array`
2. **Object Destructuring**: Extract properties from objects `{a, b} = object`
3. **Default Values**: Provide fallbacks for missing values
4. **Renaming**: Assign to different variable names
5. **Rest**: Collect remaining values
6. **Nested**: Destructure nested structures
7. **Function Parameters**: Use destructuring in parameters
8. **Best Practice**: Use destructuring for cleaner, more readable code

---

## Quiz: Destructuring

Test your understanding with these questions:

1. **What is the result: `let [a, b] = [1, 2, 3]; console.log(a, b)`?**
   - A) 1, 2
   - B) 1, 2, 3
   - C) Error
   - D) undefined, undefined

2. **Rest in destructuring must be:**
   - A) First
   - B) Last
   - C) Middle
   - D) Anywhere

3. **What does `let {name: userName} = person` do?**
   - A) Creates userName from person.name
   - B) Creates name from person.userName
   - C) Error
   - D) Nothing

4. **Default values in destructuring use:**
   - A) =
   - B) :
   - C) =>
   - D) ==

5. **What is the result: `let [a, , c] = [1, 2, 3]; console.log(c)`?**
   - A) 1
   - B) 2
   - C) 3
   - D) undefined

6. **Can you destructure function parameters?**
   - A) No
   - B) Yes
   - C) Only arrays
   - D) Only objects

7. **What does `let {a, ...rest} = {a: 1, b: 2, c: 3}` make rest?**
   - A) [2, 3]
   - B) {b: 2, c: 3}
   - C) Error
   - D) undefined

**Answers**:
1. A) 1, 2
2. B) Last
3. A) Creates userName from person.name
4. A) =
5. C) 3
6. B) Yes
7. B) {b: 2, c: 3}

---

## Next Steps

Congratulations! You''ve learned destructuring. You now know:
- How to destructure arrays and objects
- Using default values and renaming
- Nested destructuring
- Destructuring in function parameters

**What''s Next?**
- Lesson 7.3: Template Literals and Symbols
- Practice using destructuring in real code
- Refactor existing code with destructuring
- Combine destructuring with other ES6 features

---

## Additional Resources

- **MDN: Destructuring Assignment**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment)
- **JavaScript.info: Destructuring**: [javascript.info/destructuring-assignment](https://javascript.info/destructuring-assignment)
- **ES6 Destructuring Guide**: Comprehensive examples and patterns

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:40:36', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Destructure arrays to extract values
- Destructure objects to extract properties
- Use default values in destructuring
- Perform nested destructuring
- Use rest in destructuring
- Apply destructuring in function parameters
- Write cleaner, more readable code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (128, 47, 11, 'Template Literals and Symbols', 'template-literals-and-symbols', '# Lesson 7.3: Template Literals and Symbols

## Learning Objectives

By the end of this lesson, you will be able to:
- Use template literals for string interpolation
- Create multiline strings easily
- Use tagged templates for advanced string processing
- Understand Symbols and their use cases
- Create unique identifiers with Symbols
- Use Symbol properties
- Write modern, clean string code

---

## Introduction to Template Literals

Template literals (template strings) are a new way to create strings in JavaScript. They use backticks (`` ` ``) instead of quotes and provide powerful features like interpolation and multiline strings.

### Benefits of Template Literals

- **String Interpolation**: Embed expressions easily
- **Multiline Strings**: No need for concatenation
- **Tagged Templates**: Advanced string processing
- **Readability**: Cleaner than string concatenation

---

## Template Literals Basics

### Basic Syntax

Use backticks (`` ` ``) instead of quotes:

```javascript
let name = "Alice";
let greeting = `Hello, ${name}!`;
console.log(greeting);  // "Hello, Alice!"
```

### String Interpolation

Embed expressions using `${expression}`:

```javascript
let name = "Alice";
let age = 25;
let message = `Hello, I''m ${name} and I''m ${age} years old`;
console.log(message);  // "Hello, I''m Alice and I''m 25 years old"
```

### Expressions in Template Literals

Any valid JavaScript expression can be used:

```javascript
let a = 5;
let b = 10;
let result = `The sum of ${a} and ${b} is ${a + b}`;
console.log(result);  // "The sum of 5 and 10 is 15"
```

### Function Calls

```javascript
function getName() {
    return "Alice";
}

let message = `Hello, ${getName()}!`;
console.log(message);  // "Hello, Alice!"
```

### Object Properties

```javascript
let person = {
    name: "Alice",
    age: 25
};

let info = `Name: ${person.name}, Age: ${person.age}`;
console.log(info);  // "Name: Alice, Age: 25"
```

---

## Multiline Strings

### Traditional Way (Concatenation)

```javascript
// Old way: Concatenation
let multiline = "Line 1\\n" +
                "Line 2\\n" +
                "Line 3";
```

### Template Literal Way

```javascript
// New way: Template literal
let multiline = `Line 1
Line 2
Line 3`;
```

### Preserving Formatting

Template literals preserve whitespace and line breaks:

```javascript
let html = `
<div>
    <h1>Title</h1>
    <p>Content</p>
</div>
`;
```

### Practical Example

```javascript
let email = `
Dear ${recipient},

Thank you for your order.

Order Details:
- Item: ${itemName}
- Price: $${price}
- Quantity: ${quantity}

Total: $${price * quantity}

Best regards,
${senderName}
`;
```

---

## Advanced Template Literal Features

### Nested Template Literals

```javascript
let items = ["apple", "banana", "orange"];
let list = `
Shopping List:
${items.map(item => `- ${item}`).join("\\n")}
`;
console.log(list);
```

### Conditional Expressions

```javascript
let user = { name: "Alice", isAdmin: true };
let message = `
Welcome, ${user.name}!
${user.isAdmin ? "You have admin privileges." : "You are a regular user."}
`;
```

### Ternary Operators

```javascript
let score = 85;
let result = `Your score is ${score}. ${score >= 70 ? "Passed!" : "Failed!"}`;
console.log(result);  // "Your score is 85. Passed!"
```

### Template Literals in Functions

```javascript
function createGreeting(name, age) {
    return `Hello, ${name}! You are ${age} years old.`;
}

console.log(createGreeting("Alice", 25));
```

---

## Tagged Templates

Tagged templates allow you to process template literals with a function.

### Basic Tagged Template

```javascript
function myTag(strings, ...values) {
    console.log("Strings:", strings);
    console.log("Values:", values);
    return "Processed";
}

let name = "Alice";
let age = 25;
let result = myTag`Hello, ${name}! You are ${age} years old.`;
// Strings: ["Hello, ", "! You are ", " years old."]
// Values: ["Alice", 25]
```

### How Tagged Templates Work

The tag function receives:
1. **strings**: Array of string literals
2. **values**: Array of interpolated values

```javascript
function tag(strings, ...values) {
    let result = "";
    for (let i = 0; i < strings.length; i++) {
        result += strings[i];
        if (i < values.length) {
            result += values[i];
        }
    }
    return result;
}

let name = "Alice";
let message = tag`Hello, ${name}!`;
console.log(message);  // "Hello, Alice!"
```

### Practical Example: HTML Escaping

```javascript
function htmlEscape(strings, ...values) {
    let result = strings[0];
    for (let i = 0; i < values.length; i++) {
        let escaped = String(values[i])
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/''/g, "&#39;");
        result += escaped + strings[i + 1];
    }
    return result;
}

let userInput = "<script>alert(''XSS'')</script>";
let safe = htmlEscape`<div>${userInput}</div>`;
console.log(safe);  // "<div>&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</div>"
```

### Example: String Formatting

```javascript
function format(strings, ...values) {
    return strings.reduce((result, str, i) => {
        let value = values[i];
        if (typeof value === "number") {
            value = value.toFixed(2);
        }
        return result + str + (value || "");
    }, "");
}

let price = 19.99;
let quantity = 3;
let total = format`Price: $${price}, Quantity: ${quantity}, Total: $${price * quantity}`;
console.log(total);  // "Price: $19.99, Quantity: 3, Total: $59.97"
```

### Example: Translation

```javascript
const translations = {
    en: { greeting: "Hello", farewell: "Goodbye" },
    es: { greeting: "Hola", farewell: "Adiós" }
};

function translate(lang) {
    return function(strings, ...values) {
        let result = strings[0];
        for (let i = 0; i < values.length; i++) {
            let key = values[i];
            let translated = translations[lang][key] || key;
            result += translated + strings[i + 1];
        }
        return result;
    };
}

let t = translate("es");
let message = t`${"greeting"}, ${"farewell"}`;
console.log(message);  // "Hola, Adiós"
```

---

## Symbols

Symbols are a primitive data type introduced in ES6. They create unique, immutable identifiers.

### What are Symbols?

- **Unique**: Every symbol is unique
- **Immutable**: Cannot be changed
- **Primitive**: Not objects
- **Use Cases**: Private properties, constants, metadata

### Creating Symbols

```javascript
let sym1 = Symbol();
let sym2 = Symbol();
console.log(sym1 === sym2);  // false (each is unique)
```

### Symbol with Description

```javascript
let sym1 = Symbol("description");
let sym2 = Symbol("description");
console.log(sym1 === sym2);  // false (still unique, description is just a label)
```

### Symbol.for() - Global Registry

`Symbol.for()` creates or retrieves symbols from a global registry:

```javascript
let sym1 = Symbol.for("key");
let sym2 = Symbol.for("key");
console.log(sym1 === sym2);  // true (same symbol from registry)
```

### Symbol.keyFor()

Get the key for a symbol from the global registry:

```javascript
let sym = Symbol.for("myKey");
console.log(Symbol.keyFor(sym));  // "myKey"

let sym2 = Symbol("notInRegistry");
console.log(Symbol.keyFor(sym2));  // undefined
```

---

## Using Symbols

### Symbols as Property Keys

```javascript
let id = Symbol("id");
let person = {
    name: "Alice",
    [id]: 123  // Symbol as property key
};

console.log(person[id]);  // 123
console.log(person.name); // "Alice"
```

### Symbols are Hidden

Symbol properties don''t appear in normal iteration:

```javascript
let id = Symbol("id");
let person = {
    name: "Alice",
    [id]: 123
};

// Normal iteration doesn''t show symbols
for (let key in person) {
    console.log(key);  // Only "name"
}

console.log(Object.keys(person));  // ["name"]
console.log(Object.getOwnPropertyNames(person));  // ["name"]
```

### Accessing Symbol Properties

```javascript
let id = Symbol("id");
let person = {
    name: "Alice",
    [id]: 123
};

// Get symbol properties
let symbols = Object.getOwnPropertySymbols(person);
console.log(symbols);  // [Symbol(id)]
console.log(person[symbols[0]]);  // 123
```

### Private Properties Pattern

```javascript
let _name = Symbol("name");
let _age = Symbol("age");

class Person {
    constructor(name, age) {
        this[_name] = name;
        this[_age] = age;
    }
    
    getName() {
        return this[_name];
    }
    
    getAge() {
        return this[_age];
    }
}

let person = new Person("Alice", 25);
console.log(person.getName());  // "Alice"
console.log(person[_name]);     // "Alice" (but requires symbol reference)
```

### Well-Known Symbols

JavaScript has built-in well-known symbols:

```javascript
// Symbol.iterator - for iteration
let arr = [1, 2, 3];
let iterator = arr[Symbol.iterator]();
console.log(iterator.next());  // { value: 1, done: false }

// Symbol.toStringTag - for toString
class MyClass {
    get [Symbol.toStringTag]() {
        return "MyClass";
    }
}
let obj = new MyClass();
console.log(obj.toString());  // "[object MyClass]"
```

---

## Practical Examples

### Example 1: Template Literals for HTML

```javascript
function createCard(title, content, author) {
    return `
        <div class="card">
            <h2>${title}</h2>
            <p>${content}</p>
            <footer>By ${author}</footer>
        </div>
    `;
}

let html = createCard("My Title", "My content", "Alice");
console.log(html);
```

### Example 2: SQL Query Builder

```javascript
function buildQuery(table, conditions) {
    let query = `SELECT * FROM ${table}`;
    if (conditions.length > 0) {
        query += ` WHERE ${conditions.join(" AND ")}`;
    }
    return query;
}

let conditions = ["age > 18", "status = ''active''"];
let sql = buildQuery("users", conditions);
console.log(sql);  // "SELECT * FROM users WHERE age > 18 AND status = ''active''"
```

### Example 3: Constants with Symbols

```javascript
const STATUS = {
    PENDING: Symbol("pending"),
    APPROVED: Symbol("approved"),
    REJECTED: Symbol("rejected")
};

function processRequest(status) {
    if (status === STATUS.PENDING) {
        return "Request is pending";
    } else if (status === STATUS.APPROVED) {
        return "Request approved";
    } else if (status === STATUS.REJECTED) {
        return "Request rejected";
    }
}

console.log(processRequest(STATUS.PENDING));  // "Request is pending"
```

### Example 4: Metadata with Symbols

```javascript
const METADATA = Symbol("metadata");

class Document {
    constructor(title, content) {
        this.title = title;
        this.content = content;
        this[METADATA] = {
            createdAt: new Date(),
            version: 1
        };
    }
    
    getMetadata() {
        return this[METADATA];
    }
    
    updateMetadata(updates) {
        Object.assign(this[METADATA], updates);
    }
}

let doc = new Document("My Doc", "Content");
console.log(doc.getMetadata());
doc.updateMetadata({ version: 2 });
console.log(doc.getMetadata());
```

---

## Practice Exercise

### Exercise: Template Literals and Symbols

**Objective**: Practice using template literals and symbols in various scenarios.

**Instructions**:

1. Create a file called `template-literals-symbols.js`

2. Practice:
   - Template literals for string interpolation
   - Multiline strings
   - Tagged templates
   - Creating and using symbols
   - Symbol properties
   - Real-world examples

**Example Solution**:

```javascript
// Template Literals and Symbols Practice
console.log("=== Template Literals Basics ===");

let name = "Alice";
let age = 25;
let city = "New York";

// Basic interpolation
let greeting = `Hello, ${name}!`;
console.log("Greeting:", greeting);  // "Hello, Alice!"

// Multiple variables
let info = `Name: ${name}, Age: ${age}, City: ${city}`;
console.log("Info:", info);

// Expressions
let sum = `The sum of 5 and 10 is ${5 + 10}`;
console.log("Sum:", sum);  // "The sum of 5 and 10 is 15"

// Function calls
function getCurrentYear() {
    return new Date().getFullYear();
}
let yearMessage = `Current year: ${getCurrentYear()}`;
console.log("Year:", yearMessage);
console.log();

console.log("=== Multiline Strings ===");

// Traditional way
let oldWay = "Line 1\\n" +
             "Line 2\\n" +
             "Line 3";
console.log("Old way:", oldWay);

// Template literal way
let newWay = `Line 1
Line 2
Line 3`;
console.log("New way:", newWay);

// HTML example
let html = `
<div class="container">
    <h1>${name}</h1>
    <p>Age: ${age}</p>
    <p>City: ${city}</p>
</div>
`;
console.log("HTML:", html);
console.log();

console.log("=== Advanced Template Literals ===");

// Nested template literals
let items = ["apple", "banana", "orange"];
let list = `
Shopping List:
${items.map(item => `  - ${item}`).join("\\n")}
`;
console.log("List:", list);

// Conditional
let user = { name: "Alice", isAdmin: true };
let accessMessage = `
Welcome, ${user.name}!
${user.isAdmin ? "You have admin access." : "You are a regular user."}
`;
console.log("Access:", accessMessage);

// Ternary
let score = 85;
let result = `Score: ${score}. ${score >= 70 ? "Passed!" : "Failed!"}`;
console.log("Result:", result);
console.log();

console.log("=== Tagged Templates ===");

// Basic tagged template
function myTag(strings, ...values) {
    console.log("Strings:", strings);
    console.log("Values:", values);
    return "Processed";
}

let result2 = myTag`Hello, ${name}! You are ${age} years old.`;

// HTML escaping
function htmlEscape(strings, ...values) {
    let result = strings[0];
    for (let i = 0; i < values.length; i++) {
        let escaped = String(values[i])
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;");
        result += escaped + strings[i + 1];
    }
    return result;
}

let userInput = "<script>alert(''XSS'')</script>";
let safe = htmlEscape`<div>${userInput}</div>`;
console.log("Safe HTML:", safe);

// Formatting
function format(strings, ...values) {
    return strings.reduce((result, str, i) => {
        let value = values[i];
        if (typeof value === "number") {
            value = value.toFixed(2);
        }
        return result + str + (value || "");
    }, "");
}

let price = 19.99;
let quantity = 3;
let total = format`Price: $${price}, Qty: ${quantity}, Total: $${price * quantity}`;
console.log("Formatted:", total);
console.log();

console.log("=== Symbols Basics ===");

// Creating symbols
let sym1 = Symbol();
let sym2 = Symbol();
console.log("sym1 === sym2:", sym1 === sym2);  // false

// With description
let sym3 = Symbol("id");
let sym4 = Symbol("id");
console.log("sym3 === sym4:", sym3 === sym4);  // false

// Symbol.for (global registry)
let sym5 = Symbol.for("key");
let sym6 = Symbol.for("key");
console.log("sym5 === sym6:", sym5 === sym6);  // true

// Symbol.keyFor
console.log("Key for sym5:", Symbol.keyFor(sym5));  // "key"
console.log();

console.log("=== Symbols as Properties ===");

// Symbol property
let id = Symbol("id");
let person = {
    name: "Alice",
    [id]: 123
};

console.log("person[id]:", person[id]);  // 123
console.log("person.name:", person.name); // "Alice"

// Symbols are hidden
console.log("Object.keys:", Object.keys(person));  // ["name"]
console.log("for...in:");
for (let key in person) {
    console.log("  ", key);  // Only "name"
}

// Get symbol properties
let symbols = Object.getOwnPropertySymbols(person);
console.log("Symbols:", symbols);
console.log("Symbol value:", person[symbols[0]]);
console.log();

console.log("=== Private Properties Pattern ===");

let _name = Symbol("name");
let _age = Symbol("age");

class Person {
    constructor(name, age) {
        this[_name] = name;
        this[_age] = age;
    }
    
    getName() {
        return this[_name];
    }
    
    getAge() {
        return this[_age];
    }
}

let person2 = new Person("Bob", 30);
console.log("Name:", person2.getName());  // "Bob"
console.log("Age:", person2.getAge());     // 30
console.log("Direct access:", person2[_name]);  // "Bob" (but requires symbol)
console.log();

console.log("=== Constants with Symbols ===");

const STATUS = {
    PENDING: Symbol("pending"),
    APPROVED: Symbol("approved"),
    REJECTED: Symbol("rejected")
};

function processRequest(status) {
    if (status === STATUS.PENDING) {
        return "Request is pending";
    } else if (status === STATUS.APPROVED) {
        return "Request approved";
    } else if (status === STATUS.REJECTED) {
        return "Request rejected";
    }
}

console.log("Status:", processRequest(STATUS.PENDING));  // "Request is pending"
console.log();

console.log("=== Real-World Examples ===");

// Email template
function createEmail(to, subject, body) {
    return `
To: ${to}
Subject: ${subject}

${body}

---
This is an automated message.
`;
}

let email = createEmail("user@example.com", "Welcome", "Thank you for joining!");
console.log("Email:", email);

// Configuration with symbols
const CONFIG_KEY = Symbol("config");

class App {
    constructor() {
        this[CONFIG_KEY] = {
            apiUrl: "https://api.example.com",
            timeout: 5000
        };
    }
    
    getConfig() {
        return this[CONFIG_KEY];
    }
}

let app = new App();
console.log("Config:", app.getConfig());
```

**Expected Output**:
```
=== Template Literals Basics ===
Greeting: Hello, Alice!
Info: Name: Alice, Age: 25, City: New York
Sum: The sum of 5 and 10 is 15
Year: Current year: 2024

=== Multiline Strings ===
Old way: Line 1
Line 2
Line 3
New way: Line 1
Line 2
Line 3
HTML: 
<div class="container">
    <h1>Alice</h1>
    <p>Age: 25</p>
    <p>City: New York</p>
</div>

=== Advanced Template Literals ===
List: 
Shopping List:
  - apple
  - banana
  - orange
Access: 
Welcome, Alice!
You have admin access.
Result: Score: 85. Passed!

=== Tagged Templates ===
Strings: [ "Hello, ", "! You are ", " years old." ]
Values: [ "Alice", 25 ]
Safe HTML: <div>&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;</div>
Formatted: Price: $19.99, Qty: 3, Total: $59.97

=== Symbols Basics ===
sym1 === sym2: false
sym3 === sym4: false
sym5 === sym6: true
Key for sym5: key

=== Symbols as Properties ===
person[id]: 123
person.name: Alice
Object.keys: [ "name" ]
for...in:
   name
Symbols: [ Symbol(id) ]
Symbol value: 123

=== Private Properties Pattern ===
Name: Bob
Age: 30
Direct access: Bob

=== Constants with Symbols ===
Status: Request is pending

=== Real-World Examples ===
Email: 
To: user@example.com
Subject: Welcome

Thank you for joining!

---
This is an automated message.

Config: { apiUrl: "https://api.example.com", timeout: 5000 }
```

**Challenge (Optional)**:
- Build a template engine with tagged templates
- Create a symbol-based event system
- Build HTML generators with template literals
- Create private property systems with symbols

---

## Common Mistakes

### 1. Using Quotes Instead of Backticks

```javascript
// ❌ Wrong: No interpolation
let name = "Alice";
let message = "Hello, ${name}!";  // Literal "${name}"

// ✅ Correct: Use backticks
let message = `Hello, ${name}!`;  // "Hello, Alice!"
```

### 2. Forgetting ${} for Expressions

```javascript
// ❌ Wrong
let message = `Hello, name!`;  // Literal "name"

// ✅ Correct
let message = `Hello, ${name}!`;  // Interpolated
```

### 3. Confusing Symbol Uniqueness

```javascript
// ⚠️ Each Symbol() call creates unique symbol
let sym1 = Symbol("id");
let sym2 = Symbol("id");
console.log(sym1 === sym2);  // false

// ✅ Use Symbol.for() for shared symbols
let sym3 = Symbol.for("id");
let sym4 = Symbol.for("id");
console.log(sym3 === sym4);  // true
```

### 4. Symbols Not in Iteration

```javascript
let id = Symbol("id");
let obj = { name: "Alice", [id]: 123 };

// ⚠️ Symbols don''t appear in normal iteration
for (let key in obj) {
    console.log(key);  // Only "name"
}

// ✅ Use Object.getOwnPropertySymbols()
let symbols = Object.getOwnPropertySymbols(obj);
```

---

## Key Takeaways

1. **Template Literals**: Use backticks for strings with interpolation
2. **Interpolation**: `${expression}` embeds values
3. **Multiline**: Template literals preserve line breaks
4. **Tagged Templates**: Functions that process template literals
5. **Symbols**: Unique, immutable identifiers
6. **Symbol Properties**: Hidden from normal iteration
7. **Use Cases**: Private properties, constants, metadata
8. **Best Practice**: Use template literals for all string creation

---

## Quiz: Template Literals and Symbols

Test your understanding with these questions:

1. **What character is used for template literals?**
   - A) "
   - B) ''
   - C) `
   - D) {

2. **What syntax embeds expressions?**
   - A) ${}
   - B) {}
   - C) $()
   - D) {{}}

3. **Are symbols unique?**
   - A) Yes, always
   - B) No
   - C) Only with Symbol.for()
   - D) Sometimes

4. **Do symbol properties appear in for...in loops?**
   - A) Yes
   - B) No
   - C) Sometimes
   - D) Only if public

5. **What does Symbol.for() do?**
   - A) Creates unique symbol
   - B) Gets/creates from global registry
   - C) Deletes symbol
   - D) Nothing

6. **Template literals preserve:**
   - A) Only text
   - B) Whitespace and line breaks
   - C) Nothing
   - D) Only expressions

7. **Tagged templates receive:**
   - A) Just strings
   - B) Strings and values
   - C) Just values
   - D) Nothing

**Answers**:
1. C) `
2. A) ${}
3. A) Yes, always (each Symbol() call is unique)
4. B) No
5. B) Gets/creates from global registry
6. B) Whitespace and line breaks
7. B) Strings and values

---

## Next Steps

Congratulations! You''ve completed Module 7: ES6+ Features. You now know:
- Modern variable declarations (let, const)
- Destructuring arrays and objects
- Template literals and string interpolation
- Symbols and their use cases

**What''s Next?**
- Module 8: Advanced Functions
- Practice combining ES6+ features
- Build more modern JavaScript applications
- Continue learning advanced JavaScript

---

## Additional Resources

- **MDN: Template Literals**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)
- **MDN: Symbol**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol)
- **JavaScript.info: Template Literals**: [javascript.info/string](https://javascript.info/string)
- **JavaScript.info: Symbol**: [javascript.info/symbol](https://javascript.info/symbol)

---

*Lesson completed! You''ve finished Module 7: ES6+ Features. Ready for Module 8: Advanced Functions!*

', NULL, 3, '2026-01-03 09:40:36', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use template literals for string interpolation
- Create multiline strings easily
- Use tagged templates for advanced string processing
- Understand Symbols and their use cases
- Create unique identifiers with Symbols
- Use Symbol properties
- Write modern, clean string code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (129, 48, 11, 'Closures', 'closures', '# Lesson 8.1: Closures

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what closures are and how they work
- Create and use closures effectively
- Recognize common closure patterns
- Understand closure memory considerations
- Use closures for data privacy
- Build powerful function patterns with closures

---

## Introduction to Closures

A closure is a function that has access to variables in its outer (enclosing) lexical scope, even after the outer function has returned. Closures are a fundamental and powerful feature of JavaScript.

### What is a Closure?

A closure is created when:
1. A function is defined inside another function
2. The inner function accesses variables from the outer function''s scope
3. The inner function is returned or passed to another function

### Simple Example

```javascript
function outer() {
    let outerVar = "I''m outside!";
    
    function inner() {
        console.log(outerVar);  // Accesses outerVar from outer scope
    }
    
    return inner;
}

let closureFunc = outer();
closureFunc();  // "I''m outside!" - still has access to outerVar
```

---

## Understanding Closures

### Basic Closure

```javascript
function createCounter() {
    let count = 0;  // Private variable
    
    return function() {
        count++;  // Accesses count from outer scope
        return count;
    };
}

let counter = createCounter();
console.log(counter());  // 1
console.log(counter());  // 2
console.log(counter());  // 3
```

### How Closures Work

1. **Outer function executes**: `createCounter()` runs
2. **Inner function created**: The returned function is created
3. **Closure formed**: Inner function "closes over" outer variables
4. **Outer function returns**: But variables remain accessible
5. **Inner function retains access**: Can still access outer variables

### Multiple Closures

Each closure has its own independent scope:

```javascript
function createCounter() {
    let count = 0;
    return function() {
        return ++count;
    };
}

let counter1 = createCounter();
let counter2 = createCounter();

console.log(counter1());  // 1
console.log(counter1());  // 2
console.log(counter2());  // 1 (independent)
console.log(counter1());  // 3
```

---

## Closure Examples

### Example 1: Counter with Increment/Decrement

```javascript
function createCounter(initialValue = 0) {
    let count = initialValue;
    
    return {
        increment() {
            return ++count;
        },
        decrement() {
            return --count;
        },
        getValue() {
            return count;
        },
        reset() {
            count = initialValue;
            return count;
        }
    };
}

let counter = createCounter(10);
console.log(counter.getValue());   // 10
console.log(counter.increment());  // 11
console.log(counter.increment());  // 12
console.log(counter.decrement());  // 11
console.log(counter.reset());      // 10
```

### Example 2: Private Variables

```javascript
function createBankAccount(initialBalance) {
    let balance = initialBalance;  // Private variable
    
    return {
        deposit(amount) {
            if (amount > 0) {
                balance += amount;
                return balance;
            }
            return "Invalid amount";
        },
        withdraw(amount) {
            if (amount > 0 && amount <= balance) {
                balance -= amount;
                return balance;
            }
            return "Insufficient funds";
        },
        getBalance() {
            return balance;
        }
    };
}

let account = createBankAccount(1000);
console.log(account.getBalance());  // 1000
account.deposit(500);
console.log(account.getBalance());  // 1500
account.withdraw(200);
console.log(account.getBalance());  // 1300
// console.log(balance);  // ❌ Error: balance is not accessible
```

### Example 3: Function Factory

```javascript
function createMultiplier(multiplier) {
    return function(number) {
        return number * multiplier;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);
let quadruple = createMultiplier(4);

console.log(double(5));    // 10
console.log(triple(5));    // 15
console.log(quadruple(5)); // 20
```

### Example 4: Memoization

```javascript
function createMemoizedFunction(fn) {
    let cache = {};  // Private cache
    
    return function(...args) {
        let key = JSON.stringify(args);
        
        if (cache[key]) {
            console.log("Cache hit!");
            return cache[key];
        }
        
        console.log("Computing...");
        let result = fn(...args);
        cache[key] = result;
        return result;
    };
}

function expensiveOperation(n) {
    // Simulate expensive computation
    return n * n;
}

let memoized = createMemoizedFunction(expensiveOperation);
console.log(memoized(5));  // Computing... 25
console.log(memoized(5));  // Cache hit! 25
console.log(memoized(10)); // Computing... 100
console.log(memoized(10)); // Cache hit! 100
```

### Example 5: Event Handlers

```javascript
function setupButton(buttonId, clickCount) {
    let count = clickCount;
    let button = document.getElementById(buttonId);
    
    button.addEventListener("click", function() {
        count++;
        console.log(`Button clicked ${count} times`);
    });
}

// Each button has its own independent counter
setupButton("btn1", 0);
setupButton("btn2", 0);
```

---

## Common Closure Patterns

### Pattern 1: Module Pattern

```javascript
let calculator = (function() {
    let result = 0;  // Private
    
    return {
        add(x) {
            result += x;
            return this;
        },
        subtract(x) {
            result -= x;
            return this;
        },
        multiply(x) {
            result *= x;
            return this;
        },
        getResult() {
            return result;
        },
        reset() {
            result = 0;
            return this;
        }
    };
})();

calculator.add(10).multiply(2).subtract(5);
console.log(calculator.getResult());  // 15
```

### Pattern 2: Partial Application

```javascript
function add(a, b, c) {
    return a + b + c;
}

function partial(fn, ...fixedArgs) {
    return function(...remainingArgs) {
        return fn(...fixedArgs, ...remainingArgs);
    };
}

let add5and10 = partial(add, 5, 10);
console.log(add5and10(15));  // 30 (5 + 10 + 15)
```

### Pattern 3: Debouncing

```javascript
function debounce(func, delay) {
    let timeoutId;
    
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func(...args);
        }, delay);
    };
}

// Usage: Only call function after user stops typing
let debouncedSearch = debounce(function(query) {
    console.log("Searching for:", query);
}, 300);

// debouncedSearch will only execute 300ms after last call
```

### Pattern 4: Throttling

```javascript
function throttle(func, limit) {
    let inThrottle;
    
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}

// Usage: Limit function calls to once per limit period
let throttledScroll = throttle(function() {
    console.log("Scrolling...");
}, 1000);
```

### Pattern 5: Currying

```javascript
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn(...args);
        } else {
            return function(...nextArgs) {
                return curried(...args, ...nextArgs);
            };
        }
    };
}

function add(a, b, c) {
    return a + b + c;
}

let curriedAdd = curry(add);
console.log(curriedAdd(1)(2)(3));      // 6
console.log(curriedAdd(1, 2)(3));     // 6
console.log(curriedAdd(1)(2, 3));     // 6
console.log(curriedAdd(1, 2, 3));     // 6
```

---

## Memory Considerations

### Closures Keep References Alive

Closures keep the entire scope chain alive, which can lead to memory leaks if not careful:

```javascript
function createHandler() {
    let largeData = new Array(1000000).fill("data");  // Large array
    
    return function() {
        console.log("Handler called");
        // largeData is kept in memory even if not used
    };
}

let handler = createHandler();
// largeData stays in memory as long as handler exists
```

### Solution: Clear Unnecessary References

```javascript
function createHandler() {
    let largeData = new Array(1000000).fill("data");
    
    return function() {
        console.log("Handler called");
        // Use largeData
        // ...
        largeData = null;  // Clear reference when done
    };
}
```

### Loop Variables and Closures

**Common Problem:**
```javascript
// ⚠️ Problem: All functions reference same i
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i);  // 3, 3, 3 (all same!)
    }, 100);
}
```

**Solution 1: Use let**
```javascript
// ✅ Solution: let creates new scope for each iteration
for (let i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i);  // 0, 1, 2 (correct!)
    }, 100);
}
```

**Solution 2: IIFE**
```javascript
// ✅ Solution: IIFE creates closure for each iteration
for (var i = 0; i < 3; i++) {
    (function(index) {
        setTimeout(function() {
            console.log(index);  // 0, 1, 2
        }, 100);
    })(i);
}
```

**Solution 3: bind()**
```javascript
// ✅ Solution: bind creates new function with bound value
for (var i = 0; i < 3; i++) {
    setTimeout(function(index) {
        console.log(index);  // 0, 1, 2
    }.bind(null, i), 100);
}
```

---

## Practice Exercise

### Exercise: Closure Practice

**Objective**: Practice creating and using closures in various scenarios.

**Instructions**:

1. Create a file called `closures-practice.js`

2. Create closures for:
   - Counter with multiple methods
   - Private data storage
   - Function factories
   - Event handlers
   - Utility functions (debounce, throttle)

3. Demonstrate:
   - Multiple independent closures
   - Data privacy
   - Memory considerations
   - Common patterns

**Example Solution**:

```javascript
// Closures Practice
console.log("=== Basic Closure ===");

function outer() {
    let outerVar = "I''m from outer!";
    
    function inner() {
        console.log(outerVar);
    }
    
    return inner;
}

let closureFunc = outer();
closureFunc();  // "I''m from outer!"
console.log();

console.log("=== Counter Closure ===");

function createCounter(initialValue = 0) {
    let count = initialValue;
    
    return {
        increment() {
            return ++count;
        },
        decrement() {
            return --count;
        },
        getValue() {
            return count;
        },
        reset() {
            count = initialValue;
            return count;
        }
    };
}

let counter1 = createCounter(10);
let counter2 = createCounter(5);

console.log("Counter 1:", counter1.getValue());  // 10
console.log("Counter 2:", counter2.getValue());  // 5
console.log("Counter 1 increment:", counter1.increment());  // 11
console.log("Counter 2 increment:", counter2.increment());  // 6
console.log("Counter 1:", counter1.getValue());  // 11
console.log("Counter 2:", counter2.getValue());  // 6
console.log();

console.log("=== Private Variables ===");

function createBankAccount(initialBalance) {
    let balance = initialBalance;
    let transactions = [];
    
    return {
        deposit(amount) {
            if (amount > 0) {
                balance += amount;
                transactions.push({ type: "deposit", amount, balance });
                return balance;
            }
            return "Invalid amount";
        },
        withdraw(amount) {
            if (amount > 0 && amount <= balance) {
                balance -= amount;
                transactions.push({ type: "withdraw", amount, balance });
                return balance;
            }
            return "Insufficient funds";
        },
        getBalance() {
            return balance;
        },
        getTransactions() {
            return [...transactions];  // Return copy
        }
    };
}

let account = createBankAccount(1000);
console.log("Initial balance:", account.getBalance());  // 1000
account.deposit(500);
console.log("After deposit:", account.getBalance());  // 1500
account.withdraw(200);
console.log("After withdraw:", account.getBalance());  // 1300
console.log("Transactions:", account.getTransactions());
console.log();

console.log("=== Function Factory ===");

function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);
let quadruple = createMultiplier(4);

console.log("Double 5:", double(5));      // 10
console.log("Triple 5:", triple(5));      // 15
console.log("Quadruple 5:", quadruple(5)); // 20
console.log();

console.log("=== Memoization ===");

function createMemoizedFunction(fn) {
    let cache = {};
    
    return function(...args) {
        let key = JSON.stringify(args);
        
        if (cache[key]) {
            console.log("  Cache hit!");
            return cache[key];
        }
        
        console.log("  Computing...");
        let result = fn(...args);
        cache[key] = result;
        return result;
    };
}

function expensiveOperation(n) {
    return n * n;
}

let memoized = createMemoizedFunction(expensiveOperation);
console.log("memoized(5):", memoized(5));   // Computing... 25
console.log("memoized(5):", memoized(5));   // Cache hit! 25
console.log("memoized(10):", memoized(10)); // Computing... 100
console.log("memoized(10):", memoized(10)); // Cache hit! 100
console.log();

console.log("=== Module Pattern ===");

let calculator = (function() {
    let result = 0;
    
    return {
        add(x) {
            result += x;
            return this;
        },
        subtract(x) {
            result -= x;
            return this;
        },
        multiply(x) {
            result *= x;
            return this;
        },
        divide(x) {
            result /= x;
            return this;
        },
        getResult() {
            return result;
        },
        reset() {
            result = 0;
            return this;
        }
    };
})();

calculator.add(10).multiply(2).subtract(5);
console.log("Calculator result:", calculator.getResult());  // 15
calculator.reset();
console.log("After reset:", calculator.getResult());  // 0
console.log();

console.log("=== Debouncing ===");

function debounce(func, delay) {
    let timeoutId;
    
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func(...args);
        }, delay);
    };
}

let debouncedLog = debounce(function(message) {
    console.log("Debounced:", message);
}, 300);

console.log("Calling debounced function multiple times:");
debouncedLog("Call 1");
debouncedLog("Call 2");
debouncedLog("Call 3");
// Only last call executes after 300ms
console.log();

console.log("=== Throttling ===");

function throttle(func, limit) {
    let inThrottle;
    
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}

let throttledLog = throttle(function(message) {
    console.log("Throttled:", message);
}, 1000);

console.log("Calling throttled function multiple times:");
throttledLog("Call 1");  // Executes
throttledLog("Call 2");  // Ignored
throttledLog("Call 3");  // Ignored
// After 1 second, next call will execute
console.log();

console.log("=== Partial Application ===");

function add(a, b, c) {
    return a + b + c;
}

function partial(fn, ...fixedArgs) {
    return function(...remainingArgs) {
        return fn(...fixedArgs, ...remainingArgs);
    };
}

let add5and10 = partial(add, 5, 10);
console.log("add5and10(15):", add5and10(15));  // 30
console.log();

console.log("=== Loop Variables Fix ===");

// Problem with var
console.log("Using var (problem):");
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log("  var i:", i);  // 3, 3, 3
    }, 10);
}

// Solution with let
setTimeout(() => {
    console.log("Using let (solution):");
    for (let j = 0; j < 3; j++) {
        setTimeout(function() {
            console.log("  let j:", j);  // 0, 1, 2
        }, 20);
    }
}, 50);

// Solution with IIFE
setTimeout(() => {
    console.log("Using IIFE (solution):");
    for (var k = 0; k < 3; k++) {
        (function(index) {
            setTimeout(function() {
                console.log("  IIFE k:", index);  // 0, 1, 2
            }, 30);
        })(k);
    }
}, 100);
```

**Expected Output**:
```
=== Basic Closure ===
I''m from outer!

=== Counter Closure ===
Counter 1: 10
Counter 2: 5
Counter 1 increment: 11
Counter 2 increment: 6
Counter 1: 11
Counter 2: 6

=== Private Variables ===
Initial balance: 1000
After deposit: 1500
After withdraw: 1300
Transactions: [ { type: "deposit", amount: 500, balance: 1500 }, { type: "withdraw", amount: 200, balance: 1300 } ]

=== Function Factory ===
Double 5: 10
Triple 5: 15
Quadruple 5: 20

=== Memoization ===
  Computing...
memoized(5): 25
  Cache hit!
memoized(5): 25
  Computing...
memoized(10): 100
  Cache hit!
memoized(10): 100

=== Module Pattern ===
Calculator result: 15
After reset: 0

=== Debouncing ===
Calling debounced function multiple times:

=== Throttling ===
Calling throttled function multiple times:
Throttled: Call 1

=== Partial Application ===
add5and10(15): 30

=== Loop Variables Fix ===
Using var (problem):
  var i: 3
  var i: 3
  var i: 3
Using let (solution):
  let j: 0
  let j: 1
  let j: 2
Using IIFE (solution):
  IIFE k: 0
  IIFE k: 1
  IIFE k: 2
```

**Challenge (Optional)**:
- Build a closure-based state management system
- Create a closure-based event emitter
- Build a closure-based validation system
- Create advanced closure patterns

---

## Common Mistakes

### 1. Forgetting Closure Scope

```javascript
// ⚠️ Problem: All closures share same variable
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i);  // 3, 3, 3
    }, 100);
}

// ✅ Solution: Use let or IIFE
for (let i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i);  // 0, 1, 2
    }, 100);
}
```

### 2. Memory Leaks

```javascript
// ⚠️ Problem: Large data kept in memory
function createHandler() {
    let largeData = new Array(1000000).fill("data");
    return function() {
        // largeData stays in memory
    };
}

// ✅ Solution: Clear when done
function createHandler() {
    let largeData = new Array(1000000).fill("data");
    return function() {
        // Use largeData
        largeData = null;  // Clear reference
    };
}
```

### 3. Not Understanding Closure Persistence

```javascript
// ⚠️ Misunderstanding: Thinking variables reset
function createCounter() {
    let count = 0;
    return function() {
        return count++;
    };
}

let counter = createCounter();
console.log(counter());  // 0
console.log(counter());  // 1 (not 0 again!)
```

---

## Key Takeaways

1. **Closures**: Functions that access outer scope variables
2. **Data Privacy**: Closures enable private variables
3. **Function Factories**: Create specialized functions
4. **Memory**: Closures keep scope chain alive
5. **Common Patterns**: Module, memoization, debouncing, throttling
6. **Loop Variables**: Use `let` or IIFE to fix closure issues
7. **Best Practice**: Understand when closures are created and what they capture

---

## Quiz: Closures

Test your understanding with these questions:

1. **What is a closure?**
   - A) A function
   - B) Function with access to outer scope
   - C) A variable
   - D) An object

2. **When is a closure created?**
   - A) When function is called
   - B) When function is defined
   - C) When variable is declared
   - D) Never

3. **Do closures keep outer variables alive?**
   - A) No
   - B) Yes
   - C) Sometimes
   - D) Only in loops

4. **What''s the problem with var in loops?**
   - A) All closures share same variable
   - B) Variables are undefined
   - C) No problem
   - D) Performance issue

5. **Can closures access outer function parameters?**
   - A) No
   - B) Yes
   - C) Sometimes
   - D) Only if returned

6. **What pattern uses closures for private data?**
   - A) Factory pattern
   - B) Module pattern
   - C) Singleton pattern
   - D) Observer pattern

7. **Multiple closures from same function:**
   - A) Share same variables
   - B) Have independent variables
   - C) Can''t be created
   - D) Cause errors

**Answers**:
1. B) Function with access to outer scope
2. B) When function is defined
3. B) Yes
4. A) All closures share same variable
5. B) Yes
6. B) Module pattern
7. B) Have independent variables

---

## Next Steps

Congratulations! You''ve learned closures. You now know:
- What closures are and how they work
- How to create and use closures
- Common closure patterns
- Memory considerations

**What''s Next?**
- Lesson 8.2: IIFE (Immediately Invoked Function Expressions)
- Practice creating closure-based utilities
- Understand module patterns
- Build more advanced function patterns

---

## Additional Resources

- **MDN: Closures**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Closures](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)
- **JavaScript.info: Closures**: [javascript.info/closure](https://javascript.info/closure)
- **Understanding Closures in JavaScript**: Comprehensive guide

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:46:18', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what closures are and how they work
- Create and use closures effectively
- Recognize common closure patterns
- Understand closure memory considerations
- Use closures for data privacy
- Build powerful function patterns with closures');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (130, 48, 11, 'IIFE (Immediately Invoked Function Expressions)', 'iife', '# Lesson 8.2: IIFE (Immediately Invoked Function Expressions)

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what IIFE is and why it''s useful
- Write IIFE syntax correctly
- Use IIFEs to create private scope
- Implement the module pattern with IIFEs
- Avoid global namespace pollution
- Use IIFEs in modern JavaScript development

---

## Introduction to IIFE

IIFE stands for **Immediately Invoked Function Expression**. It''s a function that is defined and executed immediately after creation.

### What is an IIFE?

An IIFE is a function expression that is invoked immediately:

```javascript
(function() {
    console.log("I run immediately!");
})();
```

### Why Use IIFEs?

- **Private Scope**: Create isolated scope
- **Avoid Global Pollution**: Don''t pollute global namespace
- **Module Pattern**: Create modules before ES6
- **Variable Isolation**: Prevent variable conflicts
- **Initialization**: Run code once on load

---

## IIFE Syntax

### Basic Syntax

```javascript
// Syntax 1: Parentheses around function
(function() {
    console.log("IIFE");
})();

// Syntax 2: Parentheses around entire expression
(function() {
    console.log("IIFE");
}());

// Both are equivalent
```

### With Parameters

```javascript
(function(name) {
    console.log(`Hello, ${name}!`);
})("Alice");  // "Hello, Alice!"
```

### Arrow Function IIFE

```javascript
(() => {
    console.log("Arrow function IIFE");
})();
```

### Named IIFE

```javascript
(function myIIFE() {
    console.log("Named IIFE");
})();
```

---

## Creating Private Scope

### Problem: Global Variables

```javascript
// ⚠️ Problem: Pollutes global scope
var count = 0;
var name = "Alice";

function increment() {
    count++;
}

// All variables are global
```

### Solution: IIFE

```javascript
// ✅ Solution: Private scope
(function() {
    var count = 0;
    var name = "Alice";
    
    function increment() {
        count++;
    }
    
    // Variables are private, not global
})();

// count and name are not accessible here
```

### Example: Calculator

```javascript
(function() {
    let result = 0;
    
    function add(x) {
        result += x;
    }
    
    function subtract(x) {
        result -= x;
    }
    
    function getResult() {
        return result;
    }
    
    // Expose only what''s needed
    window.calculator = {
        add: add,
        subtract: subtract,
        getResult: getResult
    };
})();

calculator.add(10);
calculator.subtract(3);
console.log(calculator.getResult());  // 7
// result is not accessible globally
```

---

## Module Pattern

The Module Pattern uses IIFE to create modules with private and public APIs.

### Basic Module Pattern

```javascript
let myModule = (function() {
    // Private variables
    let privateVar = "I''m private";
    
    // Private function
    function privateFunction() {
        return privateVar;
    }
    
    // Public API
    return {
        publicMethod: function() {
            return privateFunction();
        },
        publicVar: "I''m public"
    };
})();

console.log(myModule.publicMethod());  // "I''m private"
console.log(myModule.publicVar);      // "I''m public"
// console.log(myModule.privateVar);  // undefined
```

### Module Pattern with Parameters

```javascript
let calculator = (function(initialValue) {
    let result = initialValue || 0;
    
    return {
        add: function(x) {
            result += x;
            return this;
        },
        subtract: function(x) {
            result -= x;
            return this;
        },
        getResult: function() {
            return result;
        },
        reset: function() {
            result = initialValue || 0;
            return this;
        }
    };
})(10);

calculator.add(5).subtract(3);
console.log(calculator.getResult());  // 12
```

### Revealing Module Pattern

```javascript
let myModule = (function() {
    let privateVar = "private";
    
    function privateFunction() {
        return privateVar;
    }
    
    function publicFunction() {
        return privateFunction();
    }
    
    // Reveal only what you want public
    return {
        publicFunction: publicFunction
    };
})();
```

### Module Pattern with Dependencies

```javascript
let myModule = (function(dependency1, dependency2) {
    // Use dependencies
    dependency1.doSomething();
    dependency2.doSomethingElse();
    
    return {
        // Public API
    };
})(dependency1, dependency2);
```

---

## Use Cases

### Use Case 1: Avoiding Global Pollution

```javascript
// Before: Global variables
var userName = "Alice";
var userAge = 25;
var userCity = "NYC";

// After: IIFE
(function() {
    var userName = "Alice";
    var userAge = 25;
    var userCity = "NYC";
    
    // Use variables here
    console.log(`${userName} is ${userAge} years old`);
})();
// Variables don''t pollute global scope
```

### Use Case 2: Loop Variable Fix

```javascript
// Problem: All closures share same i
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log(i);  // 3, 3, 3
    }, 100);
}

// Solution: IIFE creates new scope for each iteration
for (var i = 0; i < 3; i++) {
    (function(index) {
        setTimeout(function() {
            console.log(index);  // 0, 1, 2
        }, 100);
    })(i);
}
```

### Use Case 3: Initialization Code

```javascript
// Run initialization code immediately
(function() {
    // Setup code
    initializeApp();
    setupEventListeners();
    loadInitialData();
})();
```

### Use Case 4: Library Wrapper

```javascript
// Wrap library code in IIFE
(function(window) {
    let myLibrary = {
        version: "1.0.0",
        doSomething: function() {
            console.log("Doing something");
        }
    };
    
    // Expose to global scope
    window.MyLibrary = myLibrary;
})(window);
```

### Use Case 5: Configuration

```javascript
let app = (function(config) {
    let settings = {
        apiUrl: config.apiUrl || "https://api.example.com",
        timeout: config.timeout || 5000,
        retries: config.retries || 3
    };
    
    return {
        getSetting: function(key) {
            return settings[key];
        },
        updateSetting: function(key, value) {
            if (settings.hasOwnProperty(key)) {
                settings[key] = value;
            }
        }
    };
})({
    apiUrl: "https://api.custom.com",
    timeout: 10000
});
```

---

## Modern Alternatives

### ES6 Modules (Modern Alternative)

```javascript
// ES6 Module (preferred in modern code)
// math.js
let result = 0;

export function add(x) {
    result += x;
}

export function getResult() {
    return result;
}

// main.js
import { add, getResult } from ''./math.js'';
```

### Block Scope (let/const)

```javascript
// Modern: Use block scope instead of IIFE
{
    let privateVar = "private";
    // Variables are scoped to block
}
```

### When to Use IIFE

- **Legacy Code**: Supporting older browsers
- **Script Tags**: Inline scripts without module system
- **Quick Isolation**: Temporary scope isolation
- **Library Wrappers**: Wrapping third-party code

---

## Practice Exercise

### Exercise: IIFE Practice

**Objective**: Practice creating and using IIFEs for various scenarios.

**Instructions**:

1. Create a file called `iife-practice.js`

2. Create IIFEs for:
   - Private scope isolation
   - Module pattern
   - Loop variable fixes
   - Library wrappers
   - Configuration modules

3. Demonstrate:
   - Basic IIFE syntax
   - Module pattern
   - Avoiding global pollution
   - Modern alternatives

**Example Solution**:

```javascript
// IIFE Practice
console.log("=== Basic IIFE ===");

(function() {
    console.log("I run immediately!");
})();

(function(name) {
    console.log(`Hello, ${name}!`);
})("Alice");

(() => {
    console.log("Arrow function IIFE");
})();
console.log();

console.log("=== Private Scope ===");

// Without IIFE: Global pollution
var globalCount = 0;
var globalName = "Global";

// With IIFE: Private scope
(function() {
    var privateCount = 0;
    var privateName = "Private";
    
    function increment() {
        privateCount++;
        console.log(`Count: ${privateCount}`);
    }
    
    increment();  // Count: 1
    increment();  // Count: 2
})();

// privateCount and privateName are not accessible here
console.log();

console.log("=== Module Pattern ===");

let calculator = (function(initialValue) {
    let result = initialValue || 0;
    
    return {
        add: function(x) {
            result += x;
            return this;
        },
        subtract: function(x) {
            result -= x;
            return this;
        },
        multiply: function(x) {
            result *= x;
            return this;
        },
        getResult: function() {
            return result;
        },
        reset: function() {
            result = initialValue || 0;
            return this;
        }
    };
})(10);

calculator.add(5).multiply(2).subtract(3);
console.log("Calculator result:", calculator.getResult());  // 27
calculator.reset();
console.log("After reset:", calculator.getResult());  // 10
console.log();

console.log("=== Revealing Module Pattern ===");

let myModule = (function() {
    let privateVar = "I''m private";
    let publicVar = "I''m public";
    
    function privateFunction() {
        return privateVar;
    }
    
    function publicFunction() {
        return privateFunction() + " but accessible";
    }
    
    return {
        publicFunction: publicFunction,
        publicVar: publicVar
    };
})();

console.log("Public function:", myModule.publicFunction());
console.log("Public var:", myModule.publicVar);
// console.log(myModule.privateVar);  // undefined
console.log();

console.log("=== Loop Variable Fix ===");

// Problem: var in loop
console.log("Problem with var:");
for (var i = 0; i < 3; i++) {
    setTimeout(function() {
        console.log("  var i:", i);  // 3, 3, 3
    }, 10);
}

// Solution: IIFE
setTimeout(() => {
    console.log("Solution with IIFE:");
    for (var j = 0; j < 3; j++) {
        (function(index) {
            setTimeout(function() {
                console.log("  IIFE j:", index);  // 0, 1, 2
            }, 20);
        })(j);
    }
}, 50);
console.log();

console.log("=== Library Wrapper ===");

(function(window) {
    let MyLibrary = {
        version: "1.0.0",
        
        config: {
            apiUrl: "https://api.example.com",
            timeout: 5000
        },
        
        init: function(config) {
            Object.assign(this.config, config);
        },
        
        doSomething: function() {
            console.log("Doing something with", this.config.apiUrl);
        }
    };
    
    window.MyLibrary = MyLibrary;
})(window);

MyLibrary.doSomething();
MyLibrary.init({ apiUrl: "https://api.custom.com" });
MyLibrary.doSomething();
console.log();

console.log("=== Configuration Module ===");

let app = (function(config) {
    let settings = {
        apiUrl: config.apiUrl || "https://api.example.com",
        timeout: config.timeout || 5000,
        retries: config.retries || 3,
        debug: config.debug || false
    };
    
    return {
        getSetting: function(key) {
            return settings[key];
        },
        updateSetting: function(key, value) {
            if (settings.hasOwnProperty(key)) {
                settings[key] = value;
                console.log(`Updated ${key} to ${value}`);
            }
        },
        getAllSettings: function() {
            return { ...settings };  // Return copy
        }
    };
})({
    apiUrl: "https://api.custom.com",
    timeout: 10000,
    debug: true
});

console.log("API URL:", app.getSetting("apiUrl"));
console.log("Timeout:", app.getSetting("timeout"));
console.log("All settings:", app.getAllSettings());
app.updateSetting("timeout", 15000);
console.log("Updated timeout:", app.getSetting("timeout"));
console.log();

console.log("=== Multiple Modules ===");

let module1 = (function() {
    let private = "Module 1 private";
    return {
        public: "Module 1 public",
        getPrivate: function() {
            return private;
        }
    };
})();

let module2 = (function() {
    let private = "Module 2 private";
    return {
        public: "Module 2 public",
        getPrivate: function() {
            return private;
        }
    };
})();

console.log("Module 1:", module1.public, module1.getPrivate());
console.log("Module 2:", module2.public, module2.getPrivate());
// Each module has its own private scope
console.log();

console.log("=== Module with Dependencies ===");

let dependency = {
    doSomething: function() {
        return "Dependency did something";
    }
};

let dependentModule = (function(dep) {
    let result = dep.doSomething();
    
    return {
        getResult: function() {
            return result;
        },
        doMore: function() {
            return result + " and more";
        }
    };
})(dependency);

console.log("Dependent module:", dependentModule.getResult());
console.log("Do more:", dependentModule.doMore());
```

**Expected Output**:
```
=== Basic IIFE ===
I run immediately!
Hello, Alice!
Arrow function IIFE

=== Private Scope ===
Count: 1
Count: 2

=== Module Pattern ===
Calculator result: 27
After reset: 10

=== Revealing Module Pattern ===
Public function: I''m private but accessible
Public var: I''m public

=== Loop Variable Fix ===
Problem with var:
  var i: 3
  var i: 3
  var i: 3
Solution with IIFE:
  IIFE j: 0
  IIFE j: 1
  IIFE j: 2

=== Library Wrapper ===
Doing something with https://api.example.com
Doing something with https://api.custom.com

=== Configuration Module ===
API URL: https://api.custom.com
Timeout: 10000
All settings: { apiUrl: "https://api.custom.com", timeout: 10000, retries: 3, debug: true }
Updated timeout to 15000
Updated timeout: 15000

=== Multiple Modules ===
Module 1: Module 1 public Module 1 private
Module 2: Module 2 public Module 2 private

=== Module with Dependencies ===
Dependent module: Dependency did something
Do more: Dependency did something and more
```

**Challenge (Optional)**:
- Build a complete module system with IIFEs
- Create a plugin architecture
- Build a configuration management system
- Create reusable module patterns

---

## Common Mistakes

### 1. Missing Parentheses

```javascript
// ❌ Error: Function declaration, not expression
function() {
    console.log("Error");
}();

// ✅ Correct: Wrap in parentheses
(function() {
    console.log("Works");
})();
```

### 2. Semicolon Before IIFE

```javascript
// ⚠️ Problem: Missing semicolon can cause issues
var x = 5
(function() {
    console.log("IIFE");
})();

// ✅ Correct: Add semicolon
var x = 5;
(function() {
    console.log("IIFE");
})();
```

### 3. Forgetting Return Statement

```javascript
// ⚠️ Problem: Nothing returned
let module = (function() {
    let private = "private";
    // No return
})();
console.log(module);  // undefined

// ✅ Correct: Return public API
let module = (function() {
    let private = "private";
    return {
        public: "public"
    };
})();
```

### 4. Global Variable Leakage

```javascript
// ⚠️ Problem: Forgot var/let/const
(function() {
    count = 0;  // Creates global variable!
})();

// ✅ Correct: Use var/let/const
(function() {
    let count = 0;  // Private variable
})();
```

---

## Key Takeaways

1. **IIFE**: Immediately Invoked Function Expression
2. **Syntax**: `(function() { })()` or `(function() { }())`
3. **Private Scope**: Creates isolated scope
4. **Module Pattern**: Common use case for IIFEs
5. **Global Pollution**: Prevents polluting global namespace
6. **Loop Variables**: Fixes closure issues in loops
7. **Modern Alternative**: ES6 modules preferred in modern code
8. **Best Practice**: Use when you need immediate execution and private scope

---

## Quiz: IIFE

Test your understanding with these questions:

1. **What does IIFE stand for?**
   - A) Immediately Invoked Function Expression
   - B) Internal Invoked Function Expression
   - C) Instant Invoked Function Expression
   - D) Inline Invoked Function Expression

2. **IIFE creates:**
   - A) Global scope
   - B) Private scope
   - C) Block scope
   - D) No scope

3. **What''s the correct IIFE syntax?**
   - A) `function() { }()`
   - B) `(function() { })()`
   - C) `function() { }()`
   - D) `(function() { }`

4. **Module pattern uses IIFE to:**
   - A) Create global variables
   - B) Create private and public APIs
   - C) Create functions
   - D) Nothing

5. **IIFE helps with:**
   - A) Global namespace pollution
   - B) Loop variable issues
   - C) Module creation
   - D) All of the above

6. **Modern alternative to IIFE:**
   - A) var
   - B) let/const
   - C) ES6 modules
   - D) Functions

7. **IIFE executes:**
   - A) When called
   - B) Immediately
   - C) Never
   - D) On load

**Answers**:
1. A) Immediately Invoked Function Expression
2. B) Private scope
3. B) `(function() { })()`
4. B) Create private and public APIs
5. D) All of the above
6. C) ES6 modules
7. B) Immediately

---

## Next Steps

Congratulations! You''ve learned IIFEs. You now know:
- What IIFEs are and how to use them
- Module pattern implementation
- How to avoid global pollution
- When to use IIFEs vs modern alternatives

**What''s Next?**
- Lesson 8.3: Bind, Call, and Apply
- Practice creating modules
- Understand method binding
- Learn advanced function techniques

---

## Additional Resources

- **MDN: Functions**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions)
- **JavaScript.info: Functions**: [javascript.info/function-basics](https://javascript.info/function-basics)
- **IIFE Pattern Guide**: Comprehensive examples

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:46:18', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what IIFE is and why it''s useful
- Write IIFE syntax correctly
- Use IIFEs to create private scope
- Implement the module pattern with IIFEs
- Avoid global namespace pollution
- Use IIFEs in modern JavaScript development');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (131, 48, 11, 'Bind, Call, and Apply', 'bind-call-and-apply', '# Lesson 8.3: Bind, Call, and Apply

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the `this` binding problem
- Use `call()` to invoke functions with specific `this`
- Use `apply()` to invoke functions with arrays
- Use `bind()` to create bound functions
- Understand when to use each method
- Fix `this` context issues
- Write more flexible function code

---

## Introduction to Method Binding

JavaScript functions have methods (`call`, `apply`, `bind`) that allow you to control the `this` context and how functions are invoked.

### The `this` Problem

```javascript
let person = {
    name: "Alice",
    greet: function() {
        return `Hello, I''m ${this.name}`;
    }
};

console.log(person.greet());  // "Hello, I''m Alice"

let greetFunc = person.greet;
console.log(greetFunc());    // "Hello, I''m undefined" (lost context)
```

### Solution: call(), apply(), bind()

These methods help control `this` context:
- **call()**: Invoke function with specific `this` and arguments
- **apply()**: Invoke function with specific `this` and array of arguments
- **bind()**: Create new function with bound `this` and arguments

---

## call() Method

The `call()` method invokes a function with a specified `this` value and arguments provided individually.

### Basic Syntax

```javascript
function.call(thisArg, arg1, arg2, ...)
```

### Basic call() Example

```javascript
function greet(greeting, punctuation) {
    return `${greeting}, I''m ${this.name}${punctuation}`;
}

let person = { name: "Alice" };

console.log(greet.call(person, "Hello", "!"));  // "Hello, I''m Alice!"
```

### call() with Methods

```javascript
let person1 = {
    name: "Alice",
    age: 25
};

let person2 = {
    name: "Bob",
    age: 30
};

function introduce() {
    return `Hi, I''m ${this.name} and I''m ${this.age} years old`;
}

console.log(introduce.call(person1));  // "Hi, I''m Alice and I''m 25 years old"
console.log(introduce.call(person2));  // "Hi, I''m Bob and I''m 30 years old"
```

### call() for Method Borrowing

```javascript
let person = {
    firstName: "Alice",
    lastName: "Smith"
};

let person2 = {
    firstName: "Bob",
    lastName: "Jones"
};

function getFullName() {
    return `${this.firstName} ${this.lastName}`;
}

console.log(getFullName.call(person));   // "Alice Smith"
console.log(getFullName.call(person2));  // "Bob Jones"
```

### call() with Arguments

```javascript
function add(a, b, c) {
    return a + b + c;
}

let numbers = [1, 2, 3];
console.log(add.call(null, 1, 2, 3));  // 6
```

---

## apply() Method

The `apply()` method is similar to `call()`, but arguments are provided as an array.

### Basic Syntax

```javascript
function.apply(thisArg, [arg1, arg2, ...])
```

### Basic apply() Example

```javascript
function greet(greeting, punctuation) {
    return `${greeting}, I''m ${this.name}${punctuation}`;
}

let person = { name: "Alice" };
let args = ["Hello", "!"];

console.log(greet.apply(person, args));  // "Hello, I''m Alice!"
```

### apply() vs call()

```javascript
function introduce(greeting, name, age) {
    return `${greeting}, I''m ${name} and I''m ${age} years old`;
}

let person = { name: "Alice" };

// call(): Arguments individually
console.log(introduce.call(person, "Hi", "Alice", 25));

// apply(): Arguments as array
console.log(introduce.apply(person, ["Hi", "Alice", 25]));
```

### apply() with Math Methods

```javascript
let numbers = [5, 10, 15, 20, 25];

// Find maximum
let max = Math.max.apply(null, numbers);
console.log(max);  // 25

// Find minimum
let min = Math.min.apply(null, numbers);
console.log(min);  // 5

// Note: ES6 spread operator is preferred now
let max2 = Math.max(...numbers);  // Modern way
```

### apply() for Array Methods

```javascript
let numbers = [1, 2, 3];
let moreNumbers = [4, 5, 6];

// Push multiple items
numbers.push.apply(numbers, moreNumbers);
console.log(numbers);  // [1, 2, 3, 4, 5, 6]

// Modern way: spread operator
let numbers2 = [1, 2, 3];
numbers2.push(...moreNumbers);
console.log(numbers2);  // [1, 2, 3, 4, 5, 6]
```

---

## bind() Method

The `bind()` method creates a new function with a bound `this` value and optionally pre-filled arguments.

### Basic Syntax

```javascript
function.bind(thisArg, arg1, arg2, ...)
```

### Basic bind() Example

```javascript
let person = {
    name: "Alice",
    greet: function() {
        return `Hello, I''m ${this.name}`;
    }
};

let boundGreet = person.greet.bind(person);
console.log(boundGreet());  // "Hello, I''m Alice"

// Works even when called differently
let greetFunc = boundGreet;
console.log(greetFunc());  // "Hello, I''m Alice" (context preserved)
```

### bind() Preserves Context

```javascript
let person = {
    name: "Alice",
    greet: function() {
        return `Hello, I''m ${this.name}`;
    }
};

// Without bind: loses context
let greetFunc1 = person.greet;
console.log(greetFunc1());  // "Hello, I''m undefined"

// With bind: preserves context
let greetFunc2 = person.greet.bind(person);
console.log(greetFunc2());  // "Hello, I''m Alice"
```

### bind() with Arguments (Partial Application)

```javascript
function multiply(a, b, c) {
    return a * b * c;
}

// Bind first argument
let multiplyBy2 = multiply.bind(null, 2);
console.log(multiplyBy2(3, 4));  // 24 (2 * 3 * 4)

// Bind first two arguments
let multiplyBy2And3 = multiply.bind(null, 2, 3);
console.log(multiplyBy2And3(4));  // 24 (2 * 3 * 4)
```

### bind() in Event Handlers

```javascript
class Button {
    constructor(name) {
        this.name = name;
    }
    
    click() {
        console.log(`Button ${this.name} clicked`);
    }
    
    setup() {
        // Without bind: this is lost
        // button.addEventListener("click", this.click);  // Wrong
        
        // With bind: this is preserved
        button.addEventListener("click", this.click.bind(this));
    }
}
```

### bind() vs call() vs apply()

```javascript
function greet(greeting, name) {
    return `${greeting}, ${name}! I''m ${this.personName}`;
}

let context = { personName: "Alice" };

// call(): Invoke immediately
console.log(greet.call(context, "Hello", "Bob"));  // "Hello, Bob! I''m Alice"

// apply(): Invoke immediately with array
console.log(greet.apply(context, ["Hello", "Bob"]));  // "Hello, Bob! I''m Alice"

// bind(): Create new function, don''t invoke
let boundGreet = greet.bind(context, "Hello");
console.log(boundGreet("Bob"));  // "Hello, Bob! I''m Alice"
```

---

## Practical Examples

### Example 1: Method Borrowing

```javascript
let calculator = {
    numbers: [1, 2, 3, 4, 5],
    sum: function() {
        return this.numbers.reduce((a, b) => a + b, 0);
    }
};

let calculator2 = {
    numbers: [10, 20, 30]
};

// Borrow method from calculator
let sum = calculator.sum.call(calculator2);
console.log(sum);  // 60
```

### Example 2: Array-like Objects

```javascript
// Array-like object
let arrayLike = {
    0: "a",
    1: "b",
    2: "c",
    length: 3
};

// Convert to real array
let realArray = Array.prototype.slice.call(arrayLike);
console.log(realArray);  // ["a", "b", "c"]

// Modern way
let realArray2 = Array.from(arrayLike);
```

### Example 3: Function Currying with bind()

```javascript
function add(a, b, c) {
    return a + b + c;
}

// Create curried functions
let add5 = add.bind(null, 5);
let add5And10 = add5.bind(null, 10);

console.log(add5And10(15));  // 30 (5 + 10 + 15)
```

### Example 4: setTimeout with Context

```javascript
let person = {
    name: "Alice",
    sayHello: function() {
        console.log(`Hello from ${this.name}`);
    }
};

// Without bind: this is lost
setTimeout(person.sayHello, 1000);  // "Hello from undefined"

// With bind: this is preserved
setTimeout(person.sayHello.bind(person), 1000);  // "Hello from Alice"
```

### Example 5: Callback Functions

```javascript
let dataProcessor = {
    data: [1, 2, 3, 4, 5],
    multiplier: 2,
    process: function(item) {
        return item * this.multiplier;
    },
    processAll: function() {
        return this.data.map(this.process.bind(this));
    }
};

console.log(dataProcessor.processAll());  // [2, 4, 6, 8, 10]
```

---

## Comparison Table

| Method | Invokes Function? | Arguments Format | Returns |
|--------|------------------|------------------|---------|
| **call()** | Yes (immediately) | Individual arguments | Function result |
| **apply()** | Yes (immediately) | Array of arguments | Function result |
| **bind()** | No (creates function) | Individual arguments | New function |

### When to Use Each

- **call()**: When you know arguments and want to invoke immediately
- **apply()**: When arguments are in an array
- **bind()**: When you want to create a function with preset context/arguments

---

## Practice Exercise

### Exercise: Method Binding

**Objective**: Practice using call(), apply(), and bind() in various scenarios.

**Instructions**:

1. Create a file called `binding-practice.js`

2. Practice:
   - Using call() to set this context
   - Using apply() with arrays
   - Using bind() to create bound functions
   - Method borrowing
   - Event handlers
   - Callback functions

**Example Solution**:

```javascript
// Binding Practice
console.log("=== call() Method ===");

function introduce(greeting, punctuation) {
    return `${greeting}, I''m ${this.name}${punctuation}`;
}

let person1 = { name: "Alice" };
let person2 = { name: "Bob" };

console.log(introduce.call(person1, "Hello", "!"));  // "Hello, I''m Alice!"
console.log(introduce.call(person2, "Hi", "."));      // "Hi, I''m Bob."
console.log();

console.log("=== apply() Method ===");

function add(a, b, c) {
    return a + b + c;
}

let numbers = [1, 2, 3];
console.log(add.apply(null, numbers));  // 6

// Math operations
let values = [5, 10, 15, 20, 25];
let max = Math.max.apply(null, values);
let min = Math.min.apply(null, values);
console.log("Max:", max);  // 25
console.log("Min:", min);  // 5
console.log();

console.log("=== bind() Method ===");

let person = {
    name: "Alice",
    greet: function() {
        return `Hello, I''m ${this.name}`;
    }
};

// Without bind: loses context
let greetFunc1 = person.greet;
console.log("Without bind:", greetFunc1());  // "Hello, I''m undefined"

// With bind: preserves context
let greetFunc2 = person.greet.bind(person);
console.log("With bind:", greetFunc2());  // "Hello, I''m Alice"
console.log();

console.log("=== Partial Application with bind() ===");

function multiply(a, b, c) {
    return a * b * c;
}

// Bind first argument
let multiplyBy2 = multiply.bind(null, 2);
console.log("multiplyBy2(3, 4):", multiplyBy2(3, 4));  // 24

// Bind first two arguments
let multiplyBy2And3 = multiply.bind(null, 2, 3);
console.log("multiplyBy2And3(4):", multiplyBy2And3(4));  // 24

// Bind all arguments
let multiply2By3By4 = multiply.bind(null, 2, 3, 4);
console.log("multiply2By3By4():", multiply2By3By4());  // 24
console.log();

console.log("=== Method Borrowing ===");

let calculator1 = {
    numbers: [1, 2, 3, 4, 5],
    sum: function() {
        return this.numbers.reduce((a, b) => a + b, 0);
    }
};

let calculator2 = {
    numbers: [10, 20, 30]
};

// Borrow sum method
let sum1 = calculator1.sum.call(calculator1);
let sum2 = calculator1.sum.call(calculator2);
console.log("Calculator 1 sum:", sum1);  // 15
console.log("Calculator 2 sum:", sum2);  // 60
console.log();

console.log("=== Array-like Objects ===");

let arrayLike = {
    0: "a",
    1: "b",
    2: "c",
    length: 3
};

// Convert to array using call
let realArray = Array.prototype.slice.call(arrayLike);
console.log("Real array:", realArray);  // ["a", "b", "c"]
console.log();

console.log("=== setTimeout with Context ===");

let timer = {
    name: "Timer",
    start: function() {
        console.log(`${this.name} started`);
    }
};

// Without bind: loses context
setTimeout(timer.start, 100);  // "undefined started"

// With bind: preserves context
setTimeout(timer.start.bind(timer), 200);  // "Timer started"
console.log();

console.log("=== Callback Functions ===");

let processor = {
    multiplier: 5,
    process: function(item) {
        return item * this.multiplier;
    },
    processArray: function(arr) {
        return arr.map(this.process.bind(this));
    }
};

let numbers2 = [1, 2, 3, 4, 5];
let processed = processor.processArray(numbers2);
console.log("Processed:", processed);  // [5, 10, 15, 20, 25]
console.log();

console.log("=== Function Currying ===");

function add(a, b, c) {
    return a + b + c;
}

// Create curried functions
let add5 = add.bind(null, 5);
let add5And10 = add5.bind(null, 10);

console.log("add5(10, 15):", add5(10, 15));        // 30
console.log("add5And10(15):", add5And10(15));      // 30
console.log();

console.log("=== Comparison: call vs apply vs bind ===");

function greet(greeting, name) {
    return `${greeting}, ${name}! I''m ${this.personName}`;
}

let context = { personName: "Alice" };

// call: immediate invocation
let result1 = greet.call(context, "Hello", "Bob");
console.log("call():", result1);  // "Hello, Bob! I''m Alice"

// apply: immediate invocation with array
let result2 = greet.apply(context, ["Hello", "Bob"]);
console.log("apply():", result2);  // "Hello, Bob! I''m Alice"

// bind: create function, don''t invoke
let boundGreet = greet.bind(context, "Hello");
let result3 = boundGreet("Bob");
console.log("bind():", result3);  // "Hello, Bob! I''m Alice"
console.log();

console.log("=== Real-World Example: Event Handler ===");

class Button {
    constructor(label) {
        this.label = label;
    }
    
    handleClick() {
        console.log(`Button "${this.label}" was clicked`);
    }
    
    // Simulate adding event listener
    attachHandler() {
        // Simulate: button.addEventListener("click", this.handleClick.bind(this));
        let boundHandler = this.handleClick.bind(this);
        boundHandler();  // Simulate click
    }
}

let button = new Button("Submit");
button.attachHandler();  // "Button "Submit" was clicked"
```

**Expected Output**:
```
=== call() Method ===
Hello, I''m Alice!
Hi, I''m Bob.

=== apply() Method ===
6
Max: 25
Min: 5

=== bind() Method ===
Without bind: Hello, I''m undefined
With bind: Hello, I''m Alice

=== Partial Application with bind() ===
multiplyBy2(3, 4): 24
multiplyBy2And3(4): 24
multiply2By3By4(): 24

=== Method Borrowing ===
Calculator 1 sum: 15
Calculator 2 sum: 60

=== Array-like Objects ===
Real array: [ "a", "b", "c" ]

=== setTimeout with Context ===
undefined started
Timer started

=== Callback Functions ===
Processed: [5, 10, 15, 20, 25]

=== Function Currying ===
add5(10, 15): 30
add5And10(15): 30

=== Comparison: call vs apply vs bind ===
call(): Hello, Bob! I''m Alice
apply(): Hello, Bob! I''m Alice
bind(): Hello, Bob! I''m Alice

=== Real-World Example: Event Handler ===
Button "Submit" was clicked
```

**Challenge (Optional)**:
- Build a method borrowing utility
- Create a function currying system
- Build event handler management
- Create callback wrappers

---

## Common Mistakes

### 1. Forgetting bind() in Callbacks

```javascript
// ⚠️ Problem: Loses context
let obj = {
    name: "Alice",
    method: function() {
        console.log(this.name);
    }
};
setTimeout(obj.method, 100);  // undefined

// ✅ Solution: Use bind()
setTimeout(obj.method.bind(obj), 100);  // "Alice"
```

### 2. Confusing call() and bind()

```javascript
// call(): Invokes immediately
greet.call(context, "Hello");  // Returns result

// bind(): Creates function
let bound = greet.bind(context, "Hello");  // Returns function
bound();  // Now invoke
```

### 3. Wrong Arguments Format

```javascript
// ⚠️ apply() needs array
greet.apply(context, "Hello");  // Error

// ✅ Correct
greet.apply(context, ["Hello"]);
```

### 4. Arrow Functions Don''t Work

```javascript
// ⚠️ Arrow functions don''t have their own this
let obj = {
    name: "Alice",
    method: () => {
        console.log(this.name);  // undefined (this is from outer scope)
    }
};

// bind() won''t help with arrow functions
let bound = obj.method.bind(obj);
bound();  // Still undefined
```

---

## Key Takeaways

1. **call()**: Invoke function with specific `this` and individual arguments
2. **apply()**: Invoke function with specific `this` and array of arguments
3. **bind()**: Create new function with bound `this` and arguments
4. **Method Borrowing**: Use call/apply to borrow methods
5. **Context Preservation**: Use bind() to preserve `this` in callbacks
6. **Partial Application**: Use bind() to pre-fill arguments
7. **Best Practice**: Use bind() for event handlers and callbacks
8. **Modern Alternative**: Arrow functions for simpler cases

---

## Quiz: Binding Methods

Test your understanding with these questions:

1. **What does call() do?**
   - A) Creates function
   - B) Invokes function immediately
   - C) Binds this
   - D) Nothing

2. **apply() takes arguments as:**
   - A) Individual arguments
   - B) Array
   - C) Object
   - D) String

3. **bind() returns:**
   - A) Function result
   - B) New function
   - C) undefined
   - D) this

4. **Which preserves context in callbacks?**
   - A) call()
   - B) apply()
   - C) bind()
   - D) All of them

5. **Which is used for method borrowing?**
   - A) call() and apply()
   - B) bind()
   - C) call() only
   - D) apply() only

6. **bind() with arguments creates:**
   - A) Curried function
   - B) Error
   - C) Nothing
   - D) Array

7. **Arrow functions with bind():**
   - A) Work perfectly
   - B) Don''t work (no own this)
   - C) Sometimes work
   - D) Cause errors

**Answers**:
1. B) Invokes function immediately
2. B) Array
3. B) New function
4. C) bind()
5. A) call() and apply()
6. A) Curried function
7. B) Don''t work (no own this)

---

## Next Steps

Congratulations! You''ve completed Module 8: Advanced Functions. You now know:
- How closures work
- How to use IIFEs
- How to control `this` with call, apply, and bind

**What''s Next?**
- Module 9: Asynchronous JavaScript
- Lesson 9.1: Callbacks
- Practice combining advanced function techniques
- Build more complex applications

---

## Additional Resources

- **MDN: call()**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/call)
- **MDN: apply()**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)
- **MDN: bind()**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind)
- **JavaScript.info: Function Methods**: [javascript.info/function-basics](https://javascript.info/function-basics)

---

*Lesson completed! You''ve finished Module 8: Advanced Functions. Ready for Module 9: Asynchronous JavaScript!*

', NULL, 3, '2026-01-03 09:46:18', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the `this` binding problem
- Use `call()` to invoke functions with specific `this`
- Use `apply()` to invoke functions with arrays
- Use `bind()` to create bound functions
- Understand when to use each method
- Fix `this` context issues
- Write more flexible function code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (132, 49, 11, 'Callbacks', 'callbacks', '# Lesson 9.1: Callbacks

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand synchronous vs asynchronous code
- Create and use callback functions
- Handle asynchronous operations with callbacks
- Recognize and avoid callback hell
- Use common callback patterns
- Write clean asynchronous code

---

## Introduction to Asynchronous JavaScript

JavaScript is single-threaded, but it can handle asynchronous operations through callbacks, promises, and async/await. Understanding asynchronous code is crucial for modern JavaScript development.

### Why Asynchronous?

- **Non-blocking**: Don''t freeze the UI
- **Efficiency**: Handle multiple operations
- **User Experience**: Keep applications responsive
- **Network Operations**: Fetch data without blocking

---

## Synchronous vs Asynchronous Code

### Synchronous Code

Synchronous code executes line by line, blocking until each operation completes:

```javascript
console.log("1");
console.log("2");
console.log("3");
// Output: 1, 2, 3 (in order)
```

### Asynchronous Code

Asynchronous code doesn''t block. Operations can complete out of order:

```javascript
console.log("1");

setTimeout(() => {
    console.log("2");
}, 100);

console.log("3");
// Output: 1, 3, 2 (2 comes after 3)
```

### Example: Synchronous vs Asynchronous

```javascript
// Synchronous: Blocks
function syncOperation() {
    let result = 0;
    for (let i = 0; i < 1000000000; i++) {
        result += i;
    }
    return result;
}

console.log("Start");
let result = syncOperation();  // Blocks here
console.log("End");  // Waits for syncOperation

// Asynchronous: Non-blocking
console.log("Start");
setTimeout(() => {
    console.log("Async operation complete");
}, 1000);
console.log("End");  // Doesn''t wait
// Output: Start, End, Async operation complete
```

---

## Callback Functions

A callback is a function passed as an argument to another function and executed later.

### Basic Callback

```javascript
function greet(name, callback) {
    console.log(`Hello, ${name}!`);
    callback();
}

function sayGoodbye() {
    console.log("Goodbye!");
}

greet("Alice", sayGoodbye);
// "Hello, Alice!"
// "Goodbye!"
```

### Inline Callbacks

```javascript
function processData(data, callback) {
    console.log("Processing:", data);
    callback(data);
}

processData("test", function(result) {
    console.log("Callback received:", result);
});
```

### Arrow Function Callbacks

```javascript
processData("test", (result) => {
    console.log("Callback received:", result);
});
```

---

## Asynchronous Callbacks

### setTimeout

```javascript
function delayedGreeting(name, callback) {
    setTimeout(() => {
        console.log(`Hello, ${name}!`);
        callback();
    }, 1000);
}

delayedGreeting("Alice", () => {
    console.log("Greeting complete");
});
```

### setInterval

```javascript
let count = 0;
let intervalId = setInterval(() => {
    count++;
    console.log(`Count: ${count}`);
    
    if (count >= 5) {
        clearInterval(intervalId);
        console.log("Interval stopped");
    }
}, 1000);
```

### Event Listeners

```javascript
button.addEventListener("click", function(event) {
    console.log("Button clicked!", event);
});
```

### Array Methods with Callbacks

```javascript
let numbers = [1, 2, 3, 4, 5];

// forEach
numbers.forEach((num) => {
    console.log(num);
});

// map
let doubled = numbers.map((num) => num * 2);

// filter
let evens = numbers.filter((num) => num % 2 === 0);
```

---

## Common Callback Patterns

### Pattern 1: Error-First Callbacks

Standard Node.js pattern: first parameter is error, second is result.

```javascript
function asyncOperation(callback) {
    setTimeout(() => {
        let success = Math.random() > 0.5;
        
        if (success) {
            callback(null, "Success!");
        } else {
            callback(new Error("Operation failed"), null);
        }
    }, 1000);
}

asyncOperation((error, result) => {
    if (error) {
        console.log("Error:", error.message);
    } else {
        console.log("Result:", result);
    }
});
```

### Pattern 2: Success/Error Callbacks

```javascript
function asyncOperation(onSuccess, onError) {
    setTimeout(() => {
        let success = Math.random() > 0.5;
        
        if (success) {
            onSuccess("Success!");
        } else {
            onError(new Error("Operation failed"));
        }
    }, 1000);
}

asyncOperation(
    (result) => {
        console.log("Success:", result);
    },
    (error) => {
        console.log("Error:", error.message);
    }
);
```

### Pattern 3: Callback with Options

```javascript
function fetchData(options, callback) {
    setTimeout(() => {
        let data = {
            url: options.url,
            method: options.method || "GET",
            data: "Response data"
        };
        callback(null, data);
    }, 1000);
}

fetchData(
    { url: "/api/users", method: "GET" },
    (error, data) => {
        if (error) {
            console.log("Error:", error);
        } else {
            console.log("Data:", data);
        }
    }
);
```

---

## Callback Hell

Callback hell occurs when callbacks are nested deeply, making code hard to read and maintain.

### Example of Callback Hell

```javascript
// ⚠️ Callback Hell
getData(function(a) {
    getMoreData(a, function(b) {
        getMoreData(b, function(c) {
            getMoreData(c, function(d) {
                getMoreData(d, function(e) {
                    console.log(e);
                });
            });
        });
    });
});
```

### Problems with Callback Hell

- **Hard to Read**: Deeply nested code
- **Hard to Maintain**: Difficult to modify
- **Error Handling**: Complex error handling
- **Debugging**: Hard to debug

### Solutions

**1. Named Functions**

```javascript
function handleA(a) {
    getMoreData(a, handleB);
}

function handleB(b) {
    getMoreData(b, handleC);
}

function handleC(c) {
    getMoreData(c, handleD);
}

function handleD(d) {
    getMoreData(d, handleE);
}

function handleE(e) {
    console.log(e);
}

getData(handleA);
```

**2. Promises (covered in next lesson)**

```javascript
getData()
    .then(getMoreData)
    .then(getMoreData)
    .then(getMoreData)
    .then(getMoreData)
    .then(console.log);
```

**3. Async/Await (covered later)**

```javascript
async function process() {
    let a = await getData();
    let b = await getMoreData(a);
    let c = await getMoreData(b);
    let d = await getMoreData(c);
    let e = await getMoreData(d);
    console.log(e);
}
```

---

## Practical Examples

### Example 1: File Reading Simulation

```javascript
function readFile(filename, callback) {
    setTimeout(() => {
        let content = `Content of ${filename}`;
        callback(null, content);
    }, 1000);
}

readFile("data.txt", (error, content) => {
    if (error) {
        console.log("Error:", error);
    } else {
        console.log("File content:", content);
    }
});
```

### Example 2: API Request Simulation

```javascript
function fetchUser(userId, callback) {
    setTimeout(() => {
        if (userId > 0) {
            callback(null, {
                id: userId,
                name: "Alice",
                email: "alice@example.com"
            });
        } else {
            callback(new Error("Invalid user ID"), null);
        }
    }, 1000);
}

fetchUser(1, (error, user) => {
    if (error) {
        console.log("Error:", error.message);
    } else {
        console.log("User:", user);
    }
});
```

### Example 3: Sequential Operations

```javascript
function step1(callback) {
    setTimeout(() => {
        console.log("Step 1 complete");
        callback(null, "Step 1 result");
    }, 1000);
}

function step2(data, callback) {
    setTimeout(() => {
        console.log("Step 2 complete with:", data);
        callback(null, "Step 2 result");
    }, 1000);
}

function step3(data, callback) {
    setTimeout(() => {
        console.log("Step 3 complete with:", data);
        callback(null, "Final result");
    }, 1000);
}

// Sequential execution
step1((error, result1) => {
    if (error) {
        console.log("Error in step1:", error);
        return;
    }
    
    step2(result1, (error, result2) => {
        if (error) {
            console.log("Error in step2:", error);
            return;
        }
        
        step3(result2, (error, result3) => {
            if (error) {
                console.log("Error in step3:", error);
                return;
            }
            
            console.log("All steps complete:", result3);
        });
    });
});
```

### Example 4: Parallel Operations

```javascript
function fetchUser(userId, callback) {
    setTimeout(() => {
        callback(null, { id: userId, name: `User ${userId}` });
    }, Math.random() * 1000);
}

function fetchPost(postId, callback) {
    setTimeout(() => {
        callback(null, { id: postId, title: `Post ${postId}` });
    }, Math.random() * 1000);
}

let results = {};
let completed = 0;
let total = 2;

function checkComplete() {
    completed++;
    if (completed === total) {
        console.log("All operations complete:", results);
    }
}

fetchUser(1, (error, user) => {
    if (!error) {
        results.user = user;
    }
    checkComplete();
});

fetchPost(1, (error, post) => {
    if (!error) {
        results.post = post;
    }
    checkComplete();
});
```

---

## Practice Exercise

### Exercise: Callback Practice

**Objective**: Practice creating and using callbacks for asynchronous operations.

**Instructions**:

1. Create a file called `callbacks-practice.js`

2. Practice:
   - Creating callback functions
   - Using setTimeout and setInterval
   - Error-first callbacks
   - Sequential operations
   - Parallel operations
   - Avoiding callback hell

**Example Solution**:

```javascript
// Callbacks Practice
console.log("=== Synchronous vs Asynchronous ===");

console.log("1. Synchronous");
console.log("2. Synchronous");
console.log("3. Synchronous");

console.log("1. Asynchronous");
setTimeout(() => {
    console.log("2. Asynchronous (delayed)");
}, 100);
console.log("3. Asynchronous");
console.log();

console.log("=== Basic Callbacks ===");

function greet(name, callback) {
    console.log(`Hello, ${name}!`);
    callback();
}

greet("Alice", () => {
    console.log("Callback executed");
});
console.log();

console.log("=== Asynchronous Callbacks ===");

function delayedOperation(message, delay, callback) {
    setTimeout(() => {
        console.log(message);
        callback();
    }, delay);
}

delayedOperation("Operation 1", 100, () => {
    console.log("Operation 1 callback");
});

delayedOperation("Operation 2", 50, () => {
    console.log("Operation 2 callback");
});
console.log();

console.log("=== Error-First Callbacks ===");

function asyncOperation(shouldSucceed, callback) {
    setTimeout(() => {
        if (shouldSucceed) {
            callback(null, "Success!");
        } else {
            callback(new Error("Operation failed"), null);
        }
    }, 500);
}

asyncOperation(true, (error, result) => {
    if (error) {
        console.log("Error:", error.message);
    } else {
        console.log("Result:", result);
    }
});

asyncOperation(false, (error, result) => {
    if (error) {
        console.log("Error:", error.message);
    } else {
        console.log("Result:", result);
    }
});
console.log();

console.log("=== Sequential Operations ===");

function step1(callback) {
    setTimeout(() => {
        console.log("Step 1: Fetching user data...");
        callback(null, { userId: 1, name: "Alice" });
    }, 1000);
}

function step2(userData, callback) {
    setTimeout(() => {
        console.log("Step 2: Processing user data...");
        callback(null, { ...userData, processed: true });
    }, 1000);
}

function step3(processedData, callback) {
    setTimeout(() => {
        console.log("Step 3: Saving data...");
        callback(null, { ...processedData, saved: true });
    }, 1000);
}

step1((error, userData) => {
    if (error) {
        console.log("Error in step1:", error);
        return;
    }
    
    step2(userData, (error, processedData) => {
        if (error) {
            console.log("Error in step2:", error);
            return;
        }
        
        step3(processedData, (error, finalData) => {
            if (error) {
                console.log("Error in step3:", error);
                return;
            }
            
            console.log("All steps complete:", finalData);
        });
    });
});
console.log();

console.log("=== Parallel Operations ===");

function fetchUser(userId, callback) {
    let delay = Math.random() * 1000;
    setTimeout(() => {
        callback(null, { id: userId, name: `User ${userId}` });
    }, delay);
}

function fetchPosts(userId, callback) {
    let delay = Math.random() * 1000;
    setTimeout(() => {
        callback(null, [
            { id: 1, title: "Post 1" },
            { id: 2, title: "Post 2" }
        ]);
    }, delay);
}

let results = {};
let completed = 0;
let total = 2;

function checkComplete() {
    completed++;
    if (completed === total) {
        console.log("All parallel operations complete:", results);
    }
}

fetchUser(1, (error, user) => {
    if (!error) {
        results.user = user;
        console.log("User fetched:", user);
    }
    checkComplete();
});

fetchPosts(1, (error, posts) => {
    if (!error) {
        results.posts = posts;
        console.log("Posts fetched:", posts);
    }
    checkComplete();
});
console.log();

console.log("=== Avoiding Callback Hell ===");

// Named functions instead of nested callbacks
function handleUserData(userData) {
    console.log("Processing user:", userData);
    step2(userData, handleProcessedData);
}

function handleProcessedData(error, processedData) {
    if (error) {
        console.log("Error:", error);
        return;
    }
    console.log("Data processed:", processedData);
    step3(processedData, handleFinalData);
}

function handleFinalData(error, finalData) {
    if (error) {
        console.log("Error:", error);
        return;
    }
    console.log("Final data:", finalData);
}

// Cleaner sequential execution
setTimeout(() => {
    step1(handleUserData);
}, 4000);
console.log();

console.log("=== Array Methods with Callbacks ===");

let numbers = [1, 2, 3, 4, 5];

numbers.forEach((num, index) => {
    console.log(`Index ${index}: ${num}`);
});

let doubled = numbers.map((num) => num * 2);
console.log("Doubled:", doubled);

let evens = numbers.filter((num) => num % 2 === 0);
console.log("Evens:", evens);

let sum = numbers.reduce((acc, num) => acc + num, 0);
console.log("Sum:", sum);
```

**Expected Output**:
```
=== Synchronous vs Asynchronous ===
1. Synchronous
2. Synchronous
3. Synchronous
1. Asynchronous
3. Asynchronous
2. Asynchronous (delayed)

=== Basic Callbacks ===
Hello, Alice!
Callback executed

=== Asynchronous Callbacks ===
Operation 2 callback
Operation 1 callback

=== Error-First Callbacks ===
Result: Success!
Error: Operation failed

=== Sequential Operations ===
Step 1: Fetching user data...
Step 2: Processing user data...
Step 3: Saving data...
All steps complete: { userId: 1, name: "Alice", processed: true, saved: true }

=== Parallel Operations ===
Posts fetched: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]
User fetched: { id: 1, name: "User 1" }
All parallel operations complete: { user: { id: 1, name: "User 1" }, posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ] }

=== Avoiding Callback Hell ===
[After 4 seconds]
Processing user: { userId: 1, name: "Alice" }
Step 2: Processing user data...
Data processed: { userId: 1, name: "Alice", processed: true }
Step 3: Saving data...
Final data: { userId: 1, name: "Alice", processed: true, saved: true }

=== Array Methods with Callbacks ===
Index 0: 1
Index 1: 2
Index 2: 3
Index 3: 4
Index 4: 5
Doubled: [2, 4, 6, 8, 10]
Evens: [2, 4]
Sum: 15
```

**Challenge (Optional)**:
- Build a callback-based API wrapper
- Create a sequential task runner
- Build a parallel operation manager
- Refactor callback hell to named functions

---

## Common Mistakes

### 1. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
asyncOperation((result) => {
    console.log(result);  // What if error?
});

// ✅ Solution: Always handle errors
asyncOperation((error, result) => {
    if (error) {
        console.log("Error:", error);
        return;
    }
    console.log("Result:", result);
});
```

### 2. Callback Hell

```javascript
// ⚠️ Problem: Deep nesting
operation1((result1) => {
    operation2(result1, (result2) => {
        operation3(result2, (result3) => {
            // Too nested!
        });
    });
});

// ✅ Solution: Named functions or Promises
function handleResult3(result3) {
    // Handle result
}

function handleResult2(result2) {
    operation3(result2, handleResult3);
}

function handleResult1(result1) {
    operation2(result1, handleResult2);
}

operation1(handleResult1);
```

### 3. Calling Callback Multiple Times

```javascript
// ⚠️ Problem: Callback called multiple times
function badOperation(callback) {
    callback("Result 1");
    callback("Result 2");  // Called twice!
}

// ✅ Solution: Call only once
function goodOperation(callback) {
    let called = false;
    return function(...args) {
        if (!called) {
            called = true;
            callback(...args);
        }
    };
}
```

### 4. Forgetting to Call Callback

```javascript
// ⚠️ Problem: Callback never called
function operation(callback) {
    if (condition) {
        // Forgot to call callback!
        return;
    }
    callback("Result");
}

// ✅ Solution: Always call callback
function operation(callback) {
    if (condition) {
        callback(null, "Result");
        return;
    }
    callback(null, "Other result");
}
```

---

## Key Takeaways

1. **Synchronous**: Executes line by line, blocking
2. **Asynchronous**: Non-blocking, operations can complete out of order
3. **Callbacks**: Functions passed as arguments, executed later
4. **Error-First**: Standard pattern: `callback(error, result)`
5. **Callback Hell**: Deep nesting, hard to read and maintain
6. **Solutions**: Named functions, Promises, async/await
7. **Best Practice**: Always handle errors, avoid deep nesting
8. **Modern Approach**: Prefer Promises or async/await over callbacks

---

## Quiz: Callbacks

Test your understanding with these questions:

1. **What is a callback?**
   - A) A variable
   - B) Function passed as argument
   - C) An object
   - D) A string

2. **Asynchronous code:**
   - A) Blocks execution
   - B) Doesn''t block
   - C) Always errors
   - D) Never completes

3. **Error-first callback pattern:**
   - A) Error is first parameter
   - B) Error is last parameter
   - C) No error parameter
   - D) Error is in object

4. **Callback hell is:**
   - A) Good practice
   - B) Deeply nested callbacks
   - C) Fast execution
   - D) Error handling

5. **setTimeout is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Blocking
   - D) Never executes

6. **Which solves callback hell?**
   - A) More nesting
   - B) Named functions
   - C) Ignoring errors
   - D) No callbacks

7. **Callbacks should be called:**
   - A) Multiple times
   - B) Once
   - C) Never
   - D) Sometimes

**Answers**:
1. B) Function passed as argument
2. B) Doesn''t block
3. A) Error is first parameter
4. B) Deeply nested callbacks
5. B) Asynchronous
6. B) Named functions
7. B) Once

---

## Next Steps

Congratulations! You''ve learned callbacks. You now know:
- Synchronous vs asynchronous code
- How to create and use callbacks
- Common callback patterns
- How to avoid callback hell

**What''s Next?**
- Lesson 9.2: Promises
- Learn modern asynchronous patterns
- Understand Promise-based code
- Build better async applications

---

## Additional Resources

- **MDN: Asynchronous JavaScript**: [developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Asynchronous)
- **JavaScript.info: Callbacks**: [javascript.info/callbacks](https://javascript.info/callbacks)
- **Node.js Callback Pattern**: Error-first callback conventions

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:47:33', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand synchronous vs asynchronous code
- Create and use callback functions
- Handle asynchronous operations with callbacks
- Recognize and avoid callback hell
- Use common callback patterns
- Write clean asynchronous code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (133, 49, 11, 'Promises', 'promises', '# Lesson 9.2: Promises

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what Promises are and why they''re useful
- Create Promises
- Use `then()` and `catch()` to handle results
- Chain Promises together
- Use `Promise.all()` and `Promise.race()`
- Handle errors in Promises
- Write clean asynchronous code with Promises

---

## Introduction to Promises

A Promise is an object representing the eventual completion (or failure) of an asynchronous operation. Promises provide a cleaner alternative to callbacks.

### Why Promises?

- **Better than Callbacks**: Avoid callback hell
- **Chainable**: Easy to chain operations
- **Error Handling**: Built-in error handling
- **Readable**: More readable than nested callbacks
- **Modern Standard**: Used in modern JavaScript

### Promise States

A Promise has three states:
1. **Pending**: Initial state, not fulfilled or rejected
2. **Fulfilled**: Operation completed successfully
3. **Rejected**: Operation failed

---

## Creating Promises

### Basic Promise Syntax

```javascript
let promise = new Promise((resolve, reject) => {
    // Asynchronous operation
    if (success) {
        resolve(value);  // Fulfill promise
    } else {
        reject(error);   // Reject promise
    }
});
```

### Simple Promise Example

```javascript
let promise = new Promise((resolve, reject) => {
    setTimeout(() => {
        resolve("Success!");
    }, 1000);
});

promise.then((result) => {
    console.log(result);  // "Success!" (after 1 second)
});
```

### Promise with Rejection

```javascript
let promise = new Promise((resolve, reject) => {
    setTimeout(() => {
        let success = Math.random() > 0.5;
        
        if (success) {
            resolve("Success!");
        } else {
            reject(new Error("Failed!"));
        }
    }, 1000);
});
```

### Promise Constructor

```javascript
function createPromise(shouldSucceed) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (shouldSucceed) {
                resolve("Operation succeeded");
            } else {
                reject(new Error("Operation failed"));
            }
        }, 1000);
    });
}
```

---

## then() and catch()

### then() Method

`then()` handles fulfilled promises:

```javascript
let promise = new Promise((resolve) => {
    setTimeout(() => resolve("Hello"), 1000);
});

promise.then((result) => {
    console.log(result);  // "Hello"
});
```

### catch() Method

`catch()` handles rejected promises:

```javascript
let promise = new Promise((resolve, reject) => {
    setTimeout(() => reject(new Error("Failed")), 1000);
});

promise.catch((error) => {
    console.log("Error:", error.message);  // "Error: Failed"
});
```

### then() and catch() Together

```javascript
let promise = new Promise((resolve, reject) => {
    let success = Math.random() > 0.5;
    setTimeout(() => {
        if (success) {
            resolve("Success!");
        } else {
            reject(new Error("Failed!"));
        }
    }, 1000);
});

promise
    .then((result) => {
        console.log("Success:", result);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });
```

### then() with Two Handlers

```javascript
promise.then(
    (result) => {
        console.log("Success:", result);
    },
    (error) => {
        console.log("Error:", error.message);
    }
);
```

---

## Promise Chaining

Promises can be chained together, making sequential operations easy.

### Basic Chaining

```javascript
function step1() {
    return new Promise((resolve) => {
        setTimeout(() => resolve("Step 1"), 1000);
    });
}

function step2(data) {
    return new Promise((resolve) => {
        setTimeout(() => resolve(`${data} -> Step 2`), 1000);
    });
}

function step3(data) {
    return new Promise((resolve) => {
        setTimeout(() => resolve(`${data} -> Step 3`), 1000);
    });
}

step1()
    .then(step2)
    .then(step3)
    .then((result) => {
        console.log("Final:", result);
    });
```

### Chaining with Data Transformation

```javascript
fetchUser(1)
    .then((user) => {
        console.log("User:", user);
        return user.id;
    })
    .then((userId) => {
        return fetchPosts(userId);
    })
    .then((posts) => {
        console.log("Posts:", posts);
    })
    .catch((error) => {
        console.log("Error:", error);
    });
```

### Error Handling in Chains

```javascript
step1()
    .then(step2)
    .then(step3)
    .catch((error) => {
        console.log("Error in any step:", error);
        // Error from any step is caught here
    });
```

---

## Promise.all()

`Promise.all()` waits for all promises to resolve, or rejects if any promise rejects.

### Basic Promise.all()

```javascript
let promise1 = new Promise((resolve) => {
    setTimeout(() => resolve("Result 1"), 1000);
});

let promise2 = new Promise((resolve) => {
    setTimeout(() => resolve("Result 2"), 2000);
});

let promise3 = new Promise((resolve) => {
    setTimeout(() => resolve("Result 3"), 1500);
});

Promise.all([promise1, promise2, promise3])
    .then((results) => {
        console.log("All completed:", results);
        // ["Result 1", "Result 2", "Result 3"]
    });
```

### Promise.all() with Rejection

```javascript
let promise1 = Promise.resolve("Success 1");
let promise2 = Promise.reject(new Error("Failed"));
let promise3 = Promise.resolve("Success 3");

Promise.all([promise1, promise2, promise3])
    .then((results) => {
        console.log("All succeeded");
    })
    .catch((error) => {
        console.log("One failed:", error.message);  // "One failed: Failed"
    });
```

### Practical Example

```javascript
function fetchUser(userId) {
    return new Promise((resolve) => {
        setTimeout(() => resolve({ id: userId, name: `User ${userId}` }), 1000);
    });
}

function fetchPosts(userId) {
    return new Promise((resolve) => {
        setTimeout(() => resolve([
            { id: 1, title: "Post 1" },
            { id: 2, title: "Post 2" }
        ]), 1500);
    });
}

function fetchComments(postId) {
    return new Promise((resolve) => {
        setTimeout(() => resolve([
            { id: 1, text: "Comment 1" }
        ]), 500);
    });
}

// Fetch all in parallel
Promise.all([
    fetchUser(1),
    fetchPosts(1),
    fetchComments(1)
])
    .then(([user, posts, comments]) => {
        console.log("User:", user);
        console.log("Posts:", posts);
        console.log("Comments:", comments);
    });
```

---

## Promise.race()

`Promise.race()` returns the first promise that settles (fulfills or rejects).

### Basic Promise.race()

```javascript
let promise1 = new Promise((resolve) => {
    setTimeout(() => resolve("Fast"), 500);
});

let promise2 = new Promise((resolve) => {
    setTimeout(() => resolve("Slow"), 2000);
});

Promise.race([promise1, promise2])
    .then((result) => {
        console.log("Winner:", result);  // "Winner: Fast"
    });
```

### Promise.race() with Timeout

```javascript
function fetchWithTimeout(url, timeout) {
    let fetchPromise = fetch(url);
    let timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => reject(new Error("Timeout")), timeout);
    });
    
    return Promise.race([fetchPromise, timeoutPromise]);
}

fetchWithTimeout("/api/data", 5000)
    .then((data) => {
        console.log("Data:", data);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });
```

---

## Promise Utility Methods

### Promise.resolve()

Creates a resolved promise:

```javascript
let resolved = Promise.resolve("Value");
resolved.then((value) => {
    console.log(value);  // "Value"
});
```

### Promise.reject()

Creates a rejected promise:

```javascript
let rejected = Promise.reject(new Error("Error"));
rejected.catch((error) => {
    console.log(error.message);  // "Error"
});
```

### Promise.allSettled()

Waits for all promises to settle (fulfill or reject):

```javascript
let promise1 = Promise.resolve("Success 1");
let promise2 = Promise.reject(new Error("Failed"));
let promise3 = Promise.resolve("Success 3");

Promise.allSettled([promise1, promise2, promise3])
    .then((results) => {
        results.forEach((result, index) => {
            if (result.status === "fulfilled") {
                console.log(`Promise ${index + 1}:`, result.value);
            } else {
                console.log(`Promise ${index + 1}:`, result.reason.message);
            }
        });
    });
```

---

## Practical Examples

### Example 1: API Request

```javascript
function fetchUser(userId) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (userId > 0) {
                resolve({
                    id: userId,
                    name: "Alice",
                    email: "alice@example.com"
                });
            } else {
                reject(new Error("Invalid user ID"));
            }
        }, 1000);
    });
}

fetchUser(1)
    .then((user) => {
        console.log("User:", user);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });
```

### Example 2: Sequential Operations

```javascript
function login(username, password) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (username && password) {
                resolve({ token: "abc123", userId: 1 });
            } else {
                reject(new Error("Invalid credentials"));
            }
        }, 1000);
    });
}

function fetchUserData(token) {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({ name: "Alice", email: "alice@example.com" });
        }, 1000);
    });
}

login("alice", "password")
    .then((auth) => {
        console.log("Logged in:", auth.token);
        return fetchUserData(auth.token);
    })
    .then((userData) => {
        console.log("User data:", userData);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });
```

### Example 3: Parallel Operations

```javascript
function fetchUser(userId) {
    return new Promise((resolve) => {
        setTimeout(() => resolve({ id: userId, name: `User ${userId}` }), 1000);
    });
}

function fetchPosts(userId) {
    return new Promise((resolve) => {
        setTimeout(() => resolve([
            { id: 1, title: "Post 1" },
            { id: 2, title: "Post 2" }
        ]), 1500);
    });
}

// Fetch in parallel
Promise.all([
    fetchUser(1),
    fetchPosts(1)
])
    .then(([user, posts]) => {
        console.log("User:", user);
        console.log("Posts:", posts);
    });
```

---

## Practice Exercise

### Exercise: Promise Practice

**Objective**: Practice creating and using Promises in various scenarios.

**Instructions**:

1. Create a file called `promises-practice.js`

2. Practice:
   - Creating Promises
   - Using then() and catch()
   - Chaining Promises
   - Using Promise.all() and Promise.race()
   - Error handling
   - Real-world scenarios

**Example Solution**:

```javascript
// Promises Practice
console.log("=== Creating Promises ===");

let promise1 = new Promise((resolve, reject) => {
    setTimeout(() => {
        resolve("Promise 1 resolved");
    }, 1000);
});

promise1.then((result) => {
    console.log("Result:", result);
});
console.log();

console.log("=== Promise with Rejection ===");

let promise2 = new Promise((resolve, reject) => {
    setTimeout(() => {
        let success = Math.random() > 0.5;
        if (success) {
            resolve("Success!");
        } else {
            reject(new Error("Failed!"));
        }
    }, 1000);
});

promise2
    .then((result) => {
        console.log("Success:", result);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });
console.log();

console.log("=== Promise Chaining ===");

function step1() {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 1 complete");
            resolve("Step 1 result");
        }, 1000);
    });
}

function step2(data) {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 2 complete with:", data);
            resolve("Step 2 result");
        }, 1000);
    });
}

function step3(data) {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 3 complete with:", data);
            resolve("Final result");
        }, 1000);
    });
}

step1()
    .then(step2)
    .then(step3)
    .then((result) => {
        console.log("All steps complete:", result);
    })
    .catch((error) => {
        console.log("Error in chain:", error);
    });
console.log();

console.log("=== Promise.all() ===");

function fetchUser(userId) {
    return new Promise((resolve) => {
        let delay = Math.random() * 1000;
        setTimeout(() => {
            resolve({ id: userId, name: `User ${userId}` });
        }, delay);
    });
}

function fetchPosts(userId) {
    return new Promise((resolve) => {
        let delay = Math.random() * 1000;
        setTimeout(() => {
            resolve([
                { id: 1, title: "Post 1" },
                { id: 2, title: "Post 2" }
            ]);
        }, delay);
    });
}

Promise.all([
    fetchUser(1),
    fetchPosts(1)
])
    .then(([user, posts]) => {
        console.log("User:", user);
        console.log("Posts:", posts);
    });
console.log();

console.log("=== Promise.race() ===");

let fastPromise = new Promise((resolve) => {
    setTimeout(() => resolve("Fast"), 500);
});

let slowPromise = new Promise((resolve) => {
    setTimeout(() => resolve("Slow"), 2000);
});

Promise.race([fastPromise, slowPromise])
    .then((result) => {
        console.log("Winner:", result);  // "Fast"
    });
console.log();

console.log("=== Promise.resolve() and Promise.reject() ===");

let resolved = Promise.resolve("Resolved value");
resolved.then((value) => {
    console.log("Resolved:", value);
});

let rejected = Promise.reject(new Error("Rejected"));
rejected.catch((error) => {
    console.log("Rejected:", error.message);
});
console.log();

console.log("=== Error Handling ===");

function mightFail(shouldFail) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (shouldFail) {
                reject(new Error("Operation failed"));
            } else {
                resolve("Operation succeeded");
            }
        }, 1000);
    });
}

mightFail(false)
    .then((result) => {
        console.log("Success:", result);
        return mightFail(true);
    })
    .then((result) => {
        console.log("This won''t run");
    })
    .catch((error) => {
        console.log("Caught error:", error.message);
    });
console.log();

console.log("=== Real-World Example: API Calls ===");

function apiCall(endpoint) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (endpoint === "/users") {
                resolve([
                    { id: 1, name: "Alice" },
                    { id: 2, name: "Bob" }
                ]);
            } else if (endpoint === "/posts") {
                resolve([
                    { id: 1, title: "Post 1" },
                    { id: 2, title: "Post 2" }
                ]);
            } else {
                reject(new Error("Endpoint not found"));
            }
        }, 1000);
    });
}

// Sequential
apiCall("/users")
    .then((users) => {
        console.log("Users:", users);
        return apiCall("/posts");
    })
    .then((posts) => {
        console.log("Posts:", posts);
    })
    .catch((error) => {
        console.log("Error:", error.message);
    });

// Parallel
setTimeout(() => {
    Promise.all([
        apiCall("/users"),
        apiCall("/posts")
    ])
        .then(([users, posts]) => {
            console.log("All data:", { users, posts });
        })
        .catch((error) => {
            console.log("Error:", error.message);
        });
}, 3000);
```

**Expected Output**:
```
=== Creating Promises ===

=== Promise with Rejection ===
[Either "Success: Success!" or "Error: Failed!"]

=== Promise Chaining ===
Step 1 complete
Step 2 complete with: Step 1 result
Step 3 complete with: Step 2 result
All steps complete: Final result

=== Promise.all() ===
Posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]
User: { id: 1, name: "User 1" }

=== Promise.race() ===
Winner: Fast

=== Promise.resolve() and Promise.reject() ===
Resolved: Resolved value
Rejected: Rejected

=== Error Handling ===
Success: Operation succeeded
Caught error: Operation failed

=== Real-World Example: API Calls ===
Users: [ { id: 1, name: "Alice" }, { id: 2, name: "Bob" } ]
Posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]
All data: { users: [ { id: 1, name: "Alice" }, { id: 2, name: "Bob" } ], posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ] }
```

**Challenge (Optional)**:
- Build a Promise-based API wrapper
- Create a Promise utility library
- Build a retry mechanism with Promises
- Create a timeout wrapper for Promises

---

## Common Mistakes

### 1. Forgetting to Return in then()

```javascript
// ⚠️ Problem: Doesn''t return promise
promise1
    .then((result) => {
        promise2(result);  // Forgot return
    })
    .then((result) => {
        // result is undefined!
    });

// ✅ Solution: Return promise
promise1
    .then((result) => {
        return promise2(result);
    })
    .then((result) => {
        // result is correct
    });
```

### 2. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
promise.then((result) => {
    console.log(result);
});

// ✅ Solution: Always handle errors
promise
    .then((result) => {
        console.log(result);
    })
    .catch((error) => {
        console.log("Error:", error);
    });
```

### 3. Creating Promise in then()

```javascript
// ⚠️ Problem: Unnecessary nesting
promise.then((result) => {
    return new Promise((resolve) => {
        resolve(process(result));
    });
});

// ✅ Solution: Return value directly
promise.then((result) => {
    return process(result);
});
```

### 4. Promise Constructor Anti-pattern

```javascript
// ⚠️ Problem: Wrapping already-promise value
function badFunction() {
    return new Promise((resolve) => {
        resolve(anotherPromise);  // Unnecessary
    });
}

// ✅ Solution: Return promise directly
function goodFunction() {
    return anotherPromise;
}
```

---

## Key Takeaways

1. **Promises**: Represent eventual completion of async operations
2. **States**: Pending, Fulfilled, Rejected
3. **then()**: Handles fulfilled promises
4. **catch()**: Handles rejected promises
5. **Chaining**: Chain operations with then()
6. **Promise.all()**: Wait for all promises
7. **Promise.race()**: Get first settled promise
8. **Best Practice**: Always handle errors, return promises in chains

---

## Quiz: Promises

Test your understanding with these questions:

1. **What is a Promise?**
   - A) A function
   - B) Object representing async operation
   - C) A variable
   - D) An error

2. **Promise has how many states?**
   - A) 1
   - B) 2
   - C) 3
   - D) 4

3. **then() handles:**
   - A) Rejected promises
   - B) Fulfilled promises
   - C) Pending promises
   - D) All promises

4. **catch() handles:**
   - A) Fulfilled promises
   - B) Rejected promises
   - C) All promises
   - D) Nothing

5. **Promise.all() waits for:**
   - A) First promise
   - B) All promises
   - C) Any promise
   - D) No promises

6. **Promise.race() returns:**
   - A) All promises
   - B) First settled promise
   - C) Last promise
   - D) Error

7. **In then(), you should:**
   - A) Return value
   - B) Not return
   - C) Always return promise
   - D) Return undefined

**Answers**:
1. B) Object representing async operation
2. C) 3 (Pending, Fulfilled, Rejected)
3. B) Fulfilled promises
4. B) Rejected promises
5. B) All promises
6. B) First settled promise
7. A) Return value (or promise for chaining)

---

## Next Steps

Congratulations! You''ve learned Promises. You now know:
- How to create and use Promises
- Promise chaining
- Promise.all() and Promise.race()
- Error handling with Promises

**What''s Next?**
- Lesson 9.3: Async/Await
- Learn modern async syntax
- Understand async/await vs Promises
- Write even cleaner async code

---

## Additional Resources

- **MDN: Promises**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise)
- **JavaScript.info: Promises**: [javascript.info/promise-basics](https://javascript.info/promise-basics)
- **Promise Patterns**: Common patterns and best practices

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:47:33', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what Promises are and why they''re useful
- Create Promises
- Use `then()` and `catch()` to handle results
- Chain Promises together
- Use `Promise.all()` and `Promise.race()`
- Handle errors in Promises
- Write clean asynchronous code with Promises');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (134, 49, 11, 'Async/Await', 'async-await', '# Lesson 9.3: Async/Await

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand async functions
- Use the `await` keyword
- Handle errors with try-catch in async code
- Compare async/await with Promises
- Write clean, readable asynchronous code
- Use async/await in practical scenarios

---

## Introduction to Async/Await

Async/await is syntactic sugar built on top of Promises. It makes asynchronous code look and behave more like synchronous code, making it easier to read and write.

### Why Async/Await?

- **Readable**: Looks like synchronous code
- **Simple**: Easier than Promise chains
- **Error Handling**: Use try-catch like synchronous code
- **Modern**: Preferred in modern JavaScript
- **Less Nesting**: Avoid callback hell and deep Promise chains

---

## async Functions

An `async` function is a function that returns a Promise. The function body can use the `await` keyword.

### Basic async Function

```javascript
async function myFunction() {
    return "Hello";
}

myFunction().then((result) => {
    console.log(result);  // "Hello"
});
```

### async Function Always Returns Promise

```javascript
async function getValue() {
    return 42;  // Automatically wrapped in Promise
}

getValue().then((value) => {
    console.log(value);  // 42
});
```

### async Function with Promise

```javascript
async function fetchData() {
    return new Promise((resolve) => {
        setTimeout(() => resolve("Data"), 1000);
    });
}

fetchData().then((data) => {
    console.log(data);  // "Data"
});
```

---

## await Keyword

The `await` keyword pauses the execution of an async function until a Promise is settled.

### Basic await

```javascript
async function fetchUser() {
    let user = await fetchUserData();
    console.log(user);
    return user;
}
```

### await with Promises

```javascript
function fetchUserData() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({ id: 1, name: "Alice" });
        }, 1000);
    });
}

async function getUser() {
    let user = await fetchUserData();
    console.log("User:", user);  // { id: 1, name: "Alice" }
    return user;
}

getUser();
```

### await Pauses Execution

```javascript
async function example() {
    console.log("1. Start");
    
    let result = await new Promise((resolve) => {
        setTimeout(() => resolve("Done"), 1000);
    });
    
    console.log("2. After await:", result);
    console.log("3. End");
}

example();
// Output:
// 1. Start
// (wait 1 second)
// 2. After await: Done
// 3. End
```

---

## Error Handling with try-catch

Async/await allows using try-catch for error handling, just like synchronous code.

### Basic Error Handling

```javascript
async function fetchData() {
    try {
        let data = await fetchUserData();
        console.log("Success:", data);
        return data;
    } catch (error) {
        console.log("Error:", error.message);
        throw error;
    }
}
```

### try-catch with Promises

```javascript
function fetchUserData() {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            let success = Math.random() > 0.5;
            if (success) {
                resolve({ id: 1, name: "Alice" });
            } else {
                reject(new Error("Failed to fetch"));
            }
        }, 1000);
    });
}

async function getUser() {
    try {
        let user = await fetchUserData();
        console.log("User:", user);
        return user;
    } catch (error) {
        console.log("Error:", error.message);
        return null;
    }
}

getUser();
```

### Multiple await with Error Handling

```javascript
async function processUser() {
    try {
        let user = await fetchUser();
        let posts = await fetchPosts(user.id);
        let comments = await fetchComments(posts[0].id);
        
        return { user, posts, comments };
    } catch (error) {
        console.log("Error in processUser:", error.message);
        throw error;
    }
}
```

---

## Async/Await vs Promises

### Promise Chain

```javascript
fetchUser()
    .then((user) => {
        return fetchPosts(user.id);
    })
    .then((posts) => {
        return fetchComments(posts[0].id);
    })
    .then((comments) => {
        console.log("Comments:", comments);
    })
    .catch((error) => {
        console.log("Error:", error);
    });
```

### Async/Await Equivalent

```javascript
async function getComments() {
    try {
        let user = await fetchUser();
        let posts = await fetchPosts(user.id);
        let comments = await fetchComments(posts[0].id);
        console.log("Comments:", comments);
    } catch (error) {
        console.log("Error:", error);
    }
}
```

### Comparison

**Promises:**
- Chainable
- Functional style
- Can be complex with nesting

**Async/Await:**
- Sequential style
- Easier to read
- Natural error handling
- Looks like synchronous code

---

## Sequential vs Parallel Execution

### Sequential with await

```javascript
async function sequential() {
    let user = await fetchUser(1);      // Wait for user
    let posts = await fetchPosts(1);    // Wait for posts
    let comments = await fetchComments(1); // Wait for comments
    
    return { user, posts, comments };
}
// Total time: sum of all operations
```

### Parallel with Promise.all()

```javascript
async function parallel() {
    let [user, posts, comments] = await Promise.all([
        fetchUser(1),
        fetchPosts(1),
        fetchComments(1)
    ]);
    
    return { user, posts, comments };
}
// Total time: longest operation
```

### Mixed Approach

```javascript
async function mixed() {
    // First, get user (required)
    let user = await fetchUser(1);
    
    // Then, fetch posts and comments in parallel
    let [posts, comments] = await Promise.all([
        fetchPosts(user.id),
        fetchComments(user.id)
    ]);
    
    return { user, posts, comments };
}
```

---

## Practical Examples

### Example 1: API Calls

```javascript
async function fetchUserData(userId) {
    try {
        let response = await fetch(`/api/users/${userId}`);
        let user = await response.json();
        return user;
    } catch (error) {
        console.log("Error fetching user:", error);
        throw error;
    }
}

async function displayUser(userId) {
    try {
        let user = await fetchUserData(userId);
        console.log("User:", user);
    } catch (error) {
        console.log("Failed to display user");
    }
}
```

### Example 2: Sequential Operations

```javascript
async function login(username, password) {
    try {
        // Step 1: Authenticate
        let auth = await authenticate(username, password);
        console.log("Authenticated:", auth.token);
        
        // Step 2: Fetch user data
        let user = await fetchUserData(auth.token);
        console.log("User data:", user);
        
        // Step 3: Load user preferences
        let preferences = await loadPreferences(user.id);
        console.log("Preferences:", preferences);
        
        return { user, preferences };
    } catch (error) {
        console.log("Login failed:", error.message);
        throw error;
    }
}
```

### Example 3: Parallel Operations

```javascript
async function loadDashboard(userId) {
    try {
        // Load all data in parallel
        let [user, posts, notifications, settings] = await Promise.all([
            fetchUser(userId),
            fetchPosts(userId),
            fetchNotifications(userId),
            fetchSettings(userId)
        ]);
        
        return {
            user,
            posts,
            notifications,
            settings
        };
    } catch (error) {
        console.log("Failed to load dashboard:", error);
        throw error;
    }
}
```

### Example 4: Error Handling

```javascript
async function processOrder(orderId) {
    try {
        let order = await fetchOrder(orderId);
        
        if (!order) {
            throw new Error("Order not found");
        }
        
        let payment = await processPayment(order);
        let confirmation = await sendConfirmation(order, payment);
        
        return confirmation;
    } catch (error) {
        // Handle different error types
        if (error.message === "Order not found") {
            console.log("Order doesn''t exist");
        } else if (error.message === "Payment failed") {
            console.log("Payment processing failed");
        } else {
            console.log("Unexpected error:", error);
        }
        throw error;
    }
}
```

---

## Advanced Patterns

### Pattern 1: Retry Logic

```javascript
async function fetchWithRetry(url, maxRetries = 3) {
    for (let i = 0; i < maxRetries; i++) {
        try {
            let response = await fetch(url);
            return await response.json();
        } catch (error) {
            if (i === maxRetries - 1) {
                throw error;
            }
            console.log(`Retry ${i + 1}/${maxRetries}`);
            await new Promise(resolve => setTimeout(resolve, 1000));
        }
    }
}
```

### Pattern 2: Timeout

```javascript
async function fetchWithTimeout(url, timeout = 5000) {
    let fetchPromise = fetch(url);
    let timeoutPromise = new Promise((_, reject) => {
        setTimeout(() => reject(new Error("Timeout")), timeout);
    });
    
    try {
        let response = await Promise.race([fetchPromise, timeoutPromise]);
        return await response.json();
    } catch (error) {
        console.log("Request failed:", error.message);
        throw error;
    }
}
```

### Pattern 3: Conditional await

```javascript
async function loadData(loadUser, loadPosts) {
    let data = {};
    
    if (loadUser) {
        data.user = await fetchUser();
    }
    
    if (loadPosts) {
        data.posts = await fetchPosts();
    }
    
    return data;
}
```

---

## Practice Exercise

### Exercise: Async/Await Practice

**Objective**: Practice using async/await for asynchronous operations.

**Instructions**:

1. Create a file called `async-await-practice.js`

2. Practice:
   - Creating async functions
   - Using await keyword
   - Error handling with try-catch
   - Sequential and parallel execution
   - Real-world scenarios

**Example Solution**:

```javascript
// Async/Await Practice
console.log("=== Basic async Function ===");

async function basicAsync() {
    return "Hello from async";
}

basicAsync().then((result) => {
    console.log("Result:", result);
});
console.log();

console.log("=== await with Promises ===");

function fetchData() {
    return new Promise((resolve) => {
        setTimeout(() => {
            resolve({ id: 1, name: "Alice" });
        }, 1000);
    });
}

async function getData() {
    console.log("Fetching data...");
    let data = await fetchData();
    console.log("Data received:", data);
    return data;
}

getData();
console.log();

console.log("=== Sequential Execution ===");

function step1() {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 1 complete");
            resolve("Step 1 result");
        }, 1000);
    });
}

function step2(data) {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 2 complete with:", data);
            resolve("Step 2 result");
        }, 1000);
    });
}

function step3(data) {
    return new Promise((resolve) => {
        setTimeout(() => {
            console.log("Step 3 complete with:", data);
            resolve("Final result");
        }, 1000);
    });
}

async function sequential() {
    try {
        let result1 = await step1();
        let result2 = await step2(result1);
        let result3 = await step3(result2);
        console.log("All steps complete:", result3);
    } catch (error) {
        console.log("Error:", error);
    }
}

sequential();
console.log();

console.log("=== Parallel Execution ===");

function fetchUser(userId) {
    return new Promise((resolve) => {
        let delay = Math.random() * 1000;
        setTimeout(() => {
            resolve({ id: userId, name: `User ${userId}` });
        }, delay);
    });
}

function fetchPosts(userId) {
    return new Promise((resolve) => {
        let delay = Math.random() * 1000;
        setTimeout(() => {
            resolve([
                { id: 1, title: "Post 1" },
                { id: 2, title: "Post 2" }
            ]);
        }, delay);
    });
}

async function parallel() {
    try {
        let [user, posts] = await Promise.all([
            fetchUser(1),
            fetchPosts(1)
        ]);
        console.log("User:", user);
        console.log("Posts:", posts);
    } catch (error) {
        console.log("Error:", error);
    }
}

setTimeout(() => {
    parallel();
}, 4000);
console.log();

console.log("=== Error Handling ===");

function mightFail(shouldFail) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (shouldFail) {
                reject(new Error("Operation failed"));
            } else {
                resolve("Operation succeeded");
            }
        }, 1000);
    });
}

async function handleErrors() {
    try {
        let result = await mightFail(false);
        console.log("Success:", result);
        
        let result2 = await mightFail(true);
        console.log("This won''t run");
    } catch (error) {
        console.log("Caught error:", error.message);
    }
}

setTimeout(() => {
    handleErrors();
}, 7000);
console.log();

console.log("=== Real-World Example: API Calls ===");

function apiCall(endpoint) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            if (endpoint === "/users") {
                resolve([
                    { id: 1, name: "Alice" },
                    { id: 2, name: "Bob" }
                ]);
            } else if (endpoint === "/posts") {
                resolve([
                    { id: 1, title: "Post 1" },
                    { id: 2, title: "Post 2" }
                ]);
            } else {
                reject(new Error("Endpoint not found"));
            }
        }, 1000);
    });
}

async function loadData() {
    try {
        // Sequential
        console.log("Loading users...");
        let users = await apiCall("/users");
        console.log("Users loaded:", users);
        
        console.log("Loading posts...");
        let posts = await apiCall("/posts");
        console.log("Posts loaded:", posts);
        
        return { users, posts };
    } catch (error) {
        console.log("Error loading data:", error.message);
        throw error;
    }
}

setTimeout(() => {
    loadData();
}, 10000);
console.log();

console.log("=== Mixed Sequential and Parallel ===");

async function mixed() {
    try {
        // First, get user (required)
        console.log("Fetching user...");
        let user = await fetchUser(1);
        console.log("User:", user);
        
        // Then, fetch related data in parallel
        console.log("Fetching related data in parallel...");
        let [posts, comments] = await Promise.all([
            fetchPosts(user.id),
            fetchComments(user.id)
        ]);
        
        console.log("Posts:", posts);
        console.log("Comments:", comments);
        
        return { user, posts, comments };
    } catch (error) {
        console.log("Error:", error);
    }
}

setTimeout(() => {
    mixed();
}, 13000);
```

**Expected Output**:
```
=== Basic async Function ===
Result: Hello from async

=== await with Promises ===
Fetching data...
Data received: { id: 1, name: "Alice" }

=== Sequential Execution ===
Step 1 complete
Step 2 complete with: Step 1 result
Step 3 complete with: Step 2 result
All steps complete: Final result

=== Parallel Execution ===
Posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]
User: { id: 1, name: "User 1" }

=== Error Handling ===
Success: Operation succeeded
Caught error: Operation failed

=== Real-World Example: API Calls ===
Loading users...
Users loaded: [ { id: 1, name: "Alice" }, { id: 2, name: "Bob" } ]
Loading posts...
Posts loaded: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]

=== Mixed Sequential and Parallel ===
Fetching user...
User: { id: 1, name: "User 1" }
Fetching related data in parallel...
Posts: [ { id: 1, title: "Post 1" }, { id: 2, title: "Post 2" } ]
Comments: [ { id: 1, text: "Comment 1" } ]
```

**Challenge (Optional)**:
- Build async/await API wrapper
- Create retry logic with async/await
- Build timeout utilities
- Create async utility functions

---

## Common Mistakes

### 1. Forgetting await

```javascript
// ⚠️ Problem: Returns Promise, not value
async function getData() {
    let data = fetchData();  // Missing await
    return data;  // Returns Promise, not data
}

// ✅ Solution: Use await
async function getData() {
    let data = await fetchData();
    return data;
}
```

### 2. await in Non-async Function

```javascript
// ❌ Error: await only in async functions
function getData() {
    let data = await fetchData();  // Error!
}

// ✅ Solution: Make function async
async function getData() {
    let data = await fetchData();
}
```

### 3. Not Handling Errors

```javascript
// ⚠️ Problem: Unhandled promise rejection
async function getData() {
    let data = await fetchData();  // What if it fails?
    return data;
}

// ✅ Solution: Use try-catch
async function getData() {
    try {
        let data = await fetchData();
        return data;
    } catch (error) {
        console.log("Error:", error);
        throw error;
    }
}
```

### 4. Sequential When Parallel Possible

```javascript
// ⚠️ Problem: Unnecessarily sequential
async function loadData() {
    let user = await fetchUser();
    let posts = await fetchPosts();  // Could be parallel
    return { user, posts };
}

// ✅ Solution: Use Promise.all() for parallel
async function loadData() {
    let [user, posts] = await Promise.all([
        fetchUser(),
        fetchPosts()
    ]);
    return { user, posts };
}
```

---

## Key Takeaways

1. **async Function**: Always returns a Promise
2. **await**: Pauses execution until Promise settles
3. **Error Handling**: Use try-catch like synchronous code
4. **Sequential**: Use await for dependent operations
5. **Parallel**: Use Promise.all() for independent operations
6. **Readability**: Much cleaner than Promise chains
7. **Best Practice**: Always handle errors, use parallel when possible
8. **Modern Standard**: Preferred over callbacks and Promise chains

---

## Quiz: Async/Await

Test your understanding with these questions:

1. **async function always returns:**
   - A) Value
   - B) Promise
   - C) undefined
   - D) Error

2. **await can only be used:**
   - A) In any function
   - B) In async functions
   - C) In Promises
   - D) Never

3. **await pauses:**
   - A) Entire program
   - B) Async function execution
   - C) Nothing
   - D) Browser

4. **Error handling in async/await uses:**
   - A) catch()
   - B) try-catch
   - C) then()
   - D) finally()

5. **For parallel operations, use:**
   - A) Multiple await
   - B) Promise.all()
   - C) Sequential await
   - D) Callbacks

6. **async/await is:**
   - A) Different from Promises
   - B) Syntactic sugar over Promises
   - C) Replaces Promises
   - D) Not related to Promises

7. **Missing await returns:**
   - A) Value
   - B) Promise
   - C) undefined
   - D) Error

**Answers**:
1. B) Promise
2. B) In async functions
3. B) Async function execution
4. B) try-catch
5. B) Promise.all()
6. B) Syntactic sugar over Promises
7. B) Promise

---

## Next Steps

Congratulations! You''ve completed Module 9: Asynchronous JavaScript. You now know:
- How callbacks work
- How to use Promises
- How to use async/await
- Modern asynchronous patterns

**What''s Next?**
- Module 10: Iterators and Generators
- Practice combining async patterns
- Build real-world async applications
- Continue learning advanced JavaScript

---

## Additional Resources

- **MDN: async function**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function)
- **MDN: await**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await)
- **JavaScript.info: Async/await**: [javascript.info/async-await](https://javascript.info/async-await)
- **Async/Await Best Practices**: Common patterns and pitfalls

---

*Lesson completed! You''ve finished Module 9: Asynchronous JavaScript. Ready for Module 10: Iterators and Generators!*

', NULL, 3, '2026-01-03 09:47:33', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand async functions
- Use the `await` keyword
- Handle errors with try-catch in async code
- Compare async/await with Promises
- Write clean, readable asynchronous code
- Use async/await in practical scenarios');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (135, 50, 11, 'Iterators', 'iterators', '# Lesson 10.1: Iterators

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the Iterator protocol
- Understand the Iterable protocol
- Use Symbol.iterator
- Create custom iterators
- Work with built-in iterables
- Use iterators with for...of loops
- Build iterator-based utilities

---

## Introduction to Iterators

Iterators provide a way to access elements of a collection sequentially. They''re a fundamental part of JavaScript''s iteration mechanism.

### What are Iterators?

An iterator is an object that provides a way to access elements one at a time. It implements the Iterator protocol.

### Why Iterators?

- **Unified Interface**: Same way to iterate over different data structures
- **Lazy Evaluation**: Generate values on demand
- **Memory Efficient**: Don''t need to store all values
- **Custom Iteration**: Define how your objects are iterated

---

## Iterator Protocol

An object is an iterator if it implements a `next()` method that returns an object with:
- `value`: The current value
- `done`: Boolean indicating if iteration is complete

### Basic Iterator

```javascript
let iterator = {
    items: [1, 2, 3],
    index: 0,
    
    next() {
        if (this.index < this.items.length) {
            return {
                value: this.items[this.index++],
                done: false
            };
        } else {
            return { done: true };
        }
    }
};

console.log(iterator.next());  // { value: 1, done: false }
console.log(iterator.next());  // { value: 2, done: false }
console.log(iterator.next());  // { value: 3, done: false }
console.log(iterator.next());  // { done: true }
```

### Iterator Example

```javascript
function createIterator(array) {
    let index = 0;
    
    return {
        next() {
            if (index < array.length) {
                return {
                    value: array[index++],
                    done: false
                };
            } else {
                return { done: true };
            }
        }
    };
}

let iterator = createIterator([1, 2, 3]);
console.log(iterator.next());  // { value: 1, done: false }
console.log(iterator.next());  // { value: 2, done: false }
console.log(iterator.next());  // { value: 3, done: false }
console.log(iterator.next());  // { done: true }
```

---

## Iterable Protocol

An object is iterable if it implements the `Symbol.iterator` method that returns an iterator.

### Symbol.iterator

```javascript
let iterable = {
    items: [1, 2, 3],
    
    [Symbol.iterator]() {
        let index = 0;
        let items = this.items;
        
        return {
            next() {
                if (index < items.length) {
                    return {
                        value: items[index++],
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

// Can use with for...of
for (let item of iterable) {
    console.log(item);  // 1, 2, 3
}
```

### Built-in Iterables

Many built-in objects are iterable:

```javascript
// Arrays
let arr = [1, 2, 3];
for (let item of arr) {
    console.log(item);
}

// Strings
let str = "Hello";
for (let char of str) {
    console.log(char);  // H, e, l, l, o
}

// Maps
let map = new Map([["a", 1], ["b", 2]]);
for (let [key, value] of map) {
    console.log(key, value);
}

// Sets
let set = new Set([1, 2, 3]);
for (let item of set) {
    console.log(item);
}
```

---

## Custom Iterators

### Simple Custom Iterator

```javascript
let countdown = {
    start: 5,
    
    [Symbol.iterator]() {
        let current = this.start;
        
        return {
            next() {
                if (current > 0) {
                    return {
                        value: current--,
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

for (let num of countdown) {
    console.log(num);  // 5, 4, 3, 2, 1
}
```

### Range Iterator

```javascript
let range = {
    start: 1,
    end: 5,
    
    [Symbol.iterator]() {
        let current = this.start;
        let end = this.end;
        
        return {
            next() {
                if (current <= end) {
                    return {
                        value: current++,
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

for (let num of range) {
    console.log(num);  // 1, 2, 3, 4, 5
}
```

### Fibonacci Iterator

```javascript
let fibonacci = {
    [Symbol.iterator]() {
        let prev = 0;
        let curr = 1;
        
        return {
            next() {
                let value = curr;
                curr = prev + curr;
                prev = value;
                
                return {
                    value: value,
                    done: false
                };
            }
        };
    }
};

let count = 0;
for (let num of fibonacci) {
    console.log(num);
    if (++count >= 10) break;  // First 10 numbers
}
```

---

## Using Iterators

### for...of Loop

```javascript
let iterable = {
    [Symbol.iterator]() {
        let items = [1, 2, 3];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return { value: items[index++], done: false };
                }
                return { done: true };
            }
        };
    }
};

for (let item of iterable) {
    console.log(item);  // 1, 2, 3
}
```

### Spread Operator

```javascript
let iterable = {
    [Symbol.iterator]() {
        let items = [1, 2, 3];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return { value: items[index++], done: false };
                }
                return { done: true };
            }
        };
    }
};

let array = [...iterable];
console.log(array);  // [1, 2, 3]
```

### Array.from()

```javascript
let iterable = {
    [Symbol.iterator]() {
        let items = [1, 2, 3];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return { value: items[index++], done: false };
                }
                return { done: true };
            }
        };
    }
};

let array = Array.from(iterable);
console.log(array);  // [1, 2, 3]
```

### Destructuring

```javascript
let iterable = {
    [Symbol.iterator]() {
        let items = [1, 2, 3];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return { value: items[index++], done: false };
                }
                return { done: true };
            }
        };
    }
};

let [first, second, third] = iterable;
console.log(first, second, third);  // 1, 2, 3
```

---

## Advanced Iterator Patterns

### Iterator with Return Method

```javascript
let iterable = {
    [Symbol.iterator]() {
        let items = [1, 2, 3];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return { value: items[index++], done: false };
                }
                return { done: true };
            },
            return() {
                console.log("Iterator closed");
                return { done: true };
            }
        };
    }
};

for (let item of iterable) {
    console.log(item);
    if (item === 2) break;  // Triggers return()
}
```

### Infinite Iterator

```javascript
let infiniteCounter = {
    [Symbol.iterator]() {
        let count = 0;
        
        return {
            next() {
                return {
                    value: count++,
                    done: false
                };
            }
        };
    }
};

let count = 0;
for (let num of infiniteCounter) {
    console.log(num);
    if (++count >= 5) break;  // Must break manually
}
```

### Iterator with Parameters

```javascript
function createRangeIterator(start, end, step = 1) {
    return {
        [Symbol.iterator]() {
            let current = start;
            let endValue = end;
            let stepValue = step;
            
            return {
                next() {
                    if (current <= endValue) {
                        let value = current;
                        current += stepValue;
                        return { value, done: false };
                    }
                    return { done: true };
                }
            };
        }
    };
}

let range = createRangeIterator(0, 10, 2);
for (let num of range) {
    console.log(num);  // 0, 2, 4, 6, 8, 10
}
```

---

## Practical Examples

### Example 1: Object Iterator

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    
    [Symbol.iterator]() {
        let keys = Object.keys(this);
        let index = 0;
        
        return {
            next() {
                if (index < keys.length) {
                    let key = keys[index++];
                    return {
                        value: [key, this[key]],
                        done: false
                    };
                }
                return { done: true };
            }
        };
    }
};

for (let [key, value] of person) {
    console.log(`${key}: ${value}`);
}
```

### Example 2: Tree Iterator

```javascript
let tree = {
    value: 1,
    children: [
        { value: 2, children: [] },
        {
            value: 3,
            children: [
                { value: 4, children: [] },
                { value: 5, children: [] }
            ]
        }
    ],
    
    [Symbol.iterator]() {
        let stack = [this];
        
        return {
            next() {
                if (stack.length === 0) {
                    return { done: true };
                }
                
                let node = stack.pop();
                stack.push(...node.children.reverse());
                
                return {
                    value: node.value,
                    done: false
                };
            }
        };
    }
};

for (let value of tree) {
    console.log(value);  // 1, 3, 5, 4, 2
}
```

### Example 3: Pagination Iterator

```javascript
function createPaginationIterator(items, pageSize) {
    return {
        [Symbol.iterator]() {
            let index = 0;
            let itemsArray = items;
            let size = pageSize;
            
            return {
                next() {
                    if (index < itemsArray.length) {
                        let page = itemsArray.slice(index, index + size);
                        index += size;
                        return {
                            value: page,
                            done: false
                        };
                    }
                    return { done: true };
                }
            };
        }
    };
}

let items = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let pagination = createPaginationIterator(items, 3);

for (let page of pagination) {
    console.log("Page:", page);
}
// Page: [1, 2, 3]
// Page: [4, 5, 6]
// Page: [7, 8, 9]
// Page: [10]
```

---

## Practice Exercise

### Exercise: Creating Iterators

**Objective**: Practice creating custom iterators for various scenarios.

**Instructions**:

1. Create a file called `iterators-practice.js`

2. Create iterators for:
   - Range iterator
   - Countdown iterator
   - Object property iterator
   - Custom data structure iterator

3. Practice:
   - Using Symbol.iterator
   - Implementing next() method
   - Using with for...of
   - Using with spread operator

**Example Solution**:

```javascript
// Iterators Practice
console.log("=== Basic Iterator ===");

let basicIterator = {
    items: [1, 2, 3],
    index: 0,
    
    next() {
        if (this.index < this.items.length) {
            return {
                value: this.items[this.index++],
                done: false
            };
        } else {
            return { done: true };
        }
    }
};

console.log(basicIterator.next());  // { value: 1, done: false }
console.log(basicIterator.next());  // { value: 2, done: false }
console.log(basicIterator.next());  // { value: 3, done: false }
console.log(basicIterator.next());  // { done: true }
console.log();

console.log("=== Iterable with Symbol.iterator ===");

let iterable = {
    items: [1, 2, 3],
    
    [Symbol.iterator]() {
        let index = 0;
        let items = this.items;
        
        return {
            next() {
                if (index < items.length) {
                    return {
                        value: items[index++],
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

console.log("Using for...of:");
for (let item of iterable) {
    console.log(item);  // 1, 2, 3
}

console.log("Using spread:");
let array = [...iterable];
console.log(array);  // [1, 2, 3]

console.log("Using Array.from():");
let array2 = Array.from(iterable);
console.log(array2);  // [1, 2, 3]
console.log();

console.log("=== Range Iterator ===");

let range = {
    start: 1,
    end: 5,
    
    [Symbol.iterator]() {
        let current = this.start;
        let end = this.end;
        
        return {
            next() {
                if (current <= end) {
                    return {
                        value: current++,
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

for (let num of range) {
    console.log(num);  // 1, 2, 3, 4, 5
}
console.log();

console.log("=== Countdown Iterator ===");

let countdown = {
    start: 5,
    
    [Symbol.iterator]() {
        let current = this.start;
        
        return {
            next() {
                if (current > 0) {
                    return {
                        value: current--,
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

for (let num of countdown) {
    console.log(num);  // 5, 4, 3, 2, 1
}
console.log();

console.log("=== Fibonacci Iterator ===");

let fibonacci = {
    [Symbol.iterator]() {
        let prev = 0;
        let curr = 1;
        
        return {
            next() {
                let value = curr;
                curr = prev + curr;
                prev = value;
                
                return {
                    value: value,
                    done: false
                };
            }
        };
    }
};

let count = 0;
console.log("First 10 Fibonacci numbers:");
for (let num of fibonacci) {
    console.log(num);
    if (++count >= 10) break;
}
console.log();

console.log("=== Object Property Iterator ===");

let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    
    [Symbol.iterator]() {
        let keys = Object.keys(this).filter(key => key !== Symbol.iterator);
        let index = 0;
        let self = this;
        
        return {
            next() {
                if (index < keys.length) {
                    let key = keys[index++];
                    return {
                        value: [key, self[key]],
                        done: false
                    };
                } else {
                    return { done: true };
                }
            }
        };
    }
};

for (let [key, value] of person) {
    console.log(`${key}: ${value}`);
}
console.log();

console.log("=== Infinite Iterator ===");

let infiniteCounter = {
    [Symbol.iterator]() {
        let count = 0;
        
        return {
            next() {
                return {
                    value: count++,
                    done: false
                };
            }
        };
    }
};

let counter = 0;
console.log("First 5 numbers from infinite iterator:");
for (let num of infiniteCounter) {
    console.log(num);
    if (++counter >= 5) break;
}
console.log();

console.log("=== Pagination Iterator ===");

function createPaginationIterator(items, pageSize) {
    return {
        [Symbol.iterator]() {
            let index = 0;
            let itemsArray = items;
            let size = pageSize;
            
            return {
                next() {
                    if (index < itemsArray.length) {
                        let page = itemsArray.slice(index, index + size);
                        index += size;
                        return {
                            value: page,
                            done: false
                        };
                    } else {
                        return { done: true };
                    }
                }
            };
        }
    };
}

let items = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let pagination = createPaginationIterator(items, 3);

console.log("Pages:");
for (let page of pagination) {
    console.log("Page:", page);
}
console.log();

console.log("=== Iterator with Return Method ===");

let iterableWithReturn = {
    [Symbol.iterator]() {
        let items = [1, 2, 3, 4, 5];
        let index = 0;
        
        return {
            next() {
                if (index < items.length) {
                    return {
                        value: items[index++],
                        done: false
                    };
                } else {
                    return { done: true };
                }
            },
            return() {
                console.log("Iterator closed early");
                return { done: true };
            }
        };
    }
};

for (let item of iterableWithReturn) {
    console.log(item);
    if (item === 3) break;  // Triggers return()
}
```

**Expected Output**:
```
=== Basic Iterator ===
{ value: 1, done: false }
{ value: 2, done: false }
{ value: 3, done: false }
{ done: true }

=== Iterable with Symbol.iterator ===
Using for...of:
1
2
3
Using spread:
[ 1, 2, 3 ]
Using Array.from():
[ 1, 2, 3 ]

=== Range Iterator ===
1
2
3
4
5

=== Countdown Iterator ===
5
4
3
2
1

=== Fibonacci Iterator ===
First 10 Fibonacci numbers:
1
1
2
3
5
8
13
21
34
55

=== Object Property Iterator ===
name: Alice
age: 25
city: New York

=== Infinite Iterator ===
First 5 numbers from infinite iterator:
0
1
2
3
4

=== Pagination Iterator ===
Pages:
Page: [ 1, 2, 3 ]
Page: [ 4, 5, 6 ]
Page: [ 7, 8, 9 ]
Page: [ 10 ]

=== Iterator with Return Method ===
1
2
3
Iterator closed early
```

**Challenge (Optional)**:
- Build a tree traversal iterator
- Create a file line-by-line iterator
- Build a database result iterator
- Create a streaming data iterator

---

## Common Mistakes

### 1. Forgetting Symbol.iterator

```javascript
// ⚠️ Problem: Not iterable
let obj = {
    items: [1, 2, 3],
    next() { /* ... */ }
};

// for (let item of obj) { }  // Error: obj is not iterable

// ✅ Solution: Add Symbol.iterator
let obj = {
    items: [1, 2, 3],
    [Symbol.iterator]() {
        // Return iterator
    }
};
```

### 2. Not Returning Iterator Object

```javascript
// ⚠️ Problem: next() not in returned object
[Symbol.iterator]() {
    let index = 0;
    this.next = function() { /* ... */ };
    return this;  // Wrong
}

// ✅ Solution: Return object with next()
[Symbol.iterator]() {
    let index = 0;
    return {
        next() { /* ... */ }
    };
}
```

### 3. Mutating State Incorrectly

```javascript
// ⚠️ Problem: Shared state
[Symbol.iterator]() {
    this.index = 0;  // Shared across iterations
    return {
        next() {
            return { value: this.items[this.index++], done: false };
        }
    };
}

// ✅ Solution: Local state
[Symbol.iterator]() {
    let index = 0;  // Local to iterator
    let items = this.items;
    return {
        next() {
            return { value: items[index++], done: false };
        }
    };
}
```

---

## Key Takeaways

1. **Iterator Protocol**: Object with `next()` method returning `{value, done}`
2. **Iterable Protocol**: Object with `Symbol.iterator` method returning iterator
3. **Symbol.iterator**: Special symbol for making objects iterable
4. **for...of**: Works with iterables
5. **Spread/Destructuring**: Works with iterables
6. **Custom Iterators**: Define how your objects are iterated
7. **Lazy Evaluation**: Generate values on demand
8. **Best Practice**: Use iterators for custom iteration logic

---

## Quiz: Iterators

Test your understanding with these questions:

1. **Iterator protocol requires:**
   - A) next() method
   - B) value property
   - C) done property
   - D) All of the above

2. **Iterable protocol requires:**
   - A) next() method
   - B) Symbol.iterator method
   - C) value property
   - D) done property

3. **Symbol.iterator returns:**
   - A) Value
   - B) Iterator
   - C) Array
   - D) Object

4. **for...of works with:**
   - A) Iterators
   - B) Iterables
   - C) Arrays only
   - D) Objects only

5. **next() returns object with:**
   - A) value and done
   - B) value only
   - C) done only
   - D) Nothing

6. **Infinite iterators:**
   - A) Always error
   - B) Need manual break
   - C) Auto-stop
   - D) Not possible

7. **Spread operator works with:**
   - A) Iterables
   - B) Arrays only
   - C) Objects only
   - D) Nothing

**Answers**:
1. A) next() method (returns object with value and done)
2. B) Symbol.iterator method
3. B) Iterator
4. B) Iterables
5. A) value and done
6. B) Need manual break
7. A) Iterables

---

## Next Steps

Congratulations! You''ve learned iterators. You now know:
- Iterator and Iterable protocols
- How to create custom iterators
- How to use Symbol.iterator
- How iterators work with for...of

**What''s Next?**
- Lesson 10.2: Generators
- Learn generator functions
- Understand yield keyword
- Build more advanced iteration patterns

---

## Additional Resources

- **MDN: Iteration Protocols**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Iteration_protocols)
- **MDN: Symbol.iterator**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol/iterator)
- **JavaScript.info: Iterables**: [javascript.info/iterable](https://javascript.info/iterable)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:48:39', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the Iterator protocol
- Understand the Iterable protocol
- Use Symbol.iterator
- Create custom iterators
- Work with built-in iterables
- Use iterators with for...of loops
- Build iterator-based utilities');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (136, 50, 11, 'Generators', 'generators', '# Lesson 10.2: Generators

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand generator functions
- Use the `yield` keyword
- Work with generator methods (next, return, throw)
- Understand generator delegation
- Create infinite generators
- Use generators for iteration
- Build advanced generator patterns

---

## Introduction to Generators

Generators are special functions that can be paused and resumed. They provide a powerful way to create iterators and handle asynchronous operations.

### What are Generators?

A generator function returns a generator object that conforms to both the Iterator and Iterable protocols.

### Why Generators?

- **Lazy Evaluation**: Generate values on demand
- **Memory Efficient**: Don''t need to store all values
- **Pausable**: Can pause and resume execution
- **Simpler Iterators**: Easier than manual iterator implementation
- **Async Patterns**: Useful for async operations

---

## Generator Functions

### Basic Generator Syntax

Generator functions are declared with `function*`:

```javascript
function* myGenerator() {
    yield 1;
    yield 2;
    yield 3;
}

let gen = myGenerator();
console.log(gen.next());  // { value: 1, done: false }
console.log(gen.next());  // { value: 2, done: false }
console.log(gen.next());  // { value: 3, done: false }
console.log(gen.next());  // { value: undefined, done: true }
```

### Generator Function Declaration

```javascript
function* generator() {
    yield "Hello";
    yield "World";
}

let gen = generator();
for (let value of gen) {
    console.log(value);  // "Hello", "World"
}
```

### Generator Function Expression

```javascript
let generator = function*() {
    yield 1;
    yield 2;
};

let gen = generator();
console.log(gen.next());  // { value: 1, done: false }
```

### Generator Arrow Function

**Note**: Arrow functions cannot be generators. Must use `function*`.

---

## yield Keyword

The `yield` keyword pauses generator execution and returns a value.

### Basic yield

```javascript
function* simpleGenerator() {
    yield 1;
    yield 2;
    yield 3;
}

let gen = simpleGenerator();
console.log(gen.next().value);  // 1
console.log(gen.next().value);  // 2
console.log(gen.next().value);  // 3
```

### yield with Expressions

```javascript
function* expressionGenerator() {
    yield 1 + 1;
    yield 2 * 2;
    yield 3 ** 3;
}

let gen = expressionGenerator();
for (let value of gen) {
    console.log(value);  // 2, 4, 27
}
```

### yield in Loops

```javascript
function* rangeGenerator(start, end) {
    for (let i = start; i <= end; i++) {
        yield i;
    }
}

let gen = rangeGenerator(1, 5);
for (let num of gen) {
    console.log(num);  // 1, 2, 3, 4, 5
}
```

### yield with return

```javascript
function* generatorWithReturn() {
    yield 1;
    yield 2;
    return "Done";
    yield 3;  // Never reached
}

let gen = generatorWithReturn();
console.log(gen.next());  // { value: 1, done: false }
console.log(gen.next());  // { value: 2, done: false }
console.log(gen.next());  // { value: "Done", done: true }
console.log(gen.next());  // { value: undefined, done: true }
```

---

## Generator Methods

### next() Method

`next()` resumes execution and returns the next value:

```javascript
function* counter() {
    let count = 0;
    while (true) {
        yield count++;
    }
}

let gen = counter();
console.log(gen.next().value);  // 0
console.log(gen.next().value);  // 1
console.log(gen.next().value);  // 2
```

### next() with Arguments

Values passed to `next()` become the result of the `yield` expression:

```javascript
function* generator() {
    let x = yield 1;
    let y = yield x + 2;
    yield y + 3;
}

let gen = generator();
console.log(gen.next());      // { value: 1, done: false }
console.log(gen.next(10));   // { value: 12, done: false } (x = 10)
console.log(gen.next(20));  // { value: 23, done: false } (y = 20)
```

### return() Method

`return()` terminates the generator:

```javascript
function* generator() {
    yield 1;
    yield 2;
    yield 3;
}

let gen = generator();
console.log(gen.next());        // { value: 1, done: false }
console.log(gen.return("End"));  // { value: "End", done: true }
console.log(gen.next());         // { value: undefined, done: true }
```

### throw() Method

`throw()` throws an error into the generator:

```javascript
function* generator() {
    try {
        yield 1;
        yield 2;
    } catch (error) {
        console.log("Caught:", error.message);
        yield 3;
    }
}

let gen = generator();
console.log(gen.next());              // { value: 1, done: false }
console.log(gen.throw(new Error("Error")));  // Caught: Error, { value: 3, done: false }
console.log(gen.next());              // { value: undefined, done: true }
```

---

## Generator Delegation

### yield*

`yield*` delegates to another generator or iterable:

```javascript
function* generator1() {
    yield 1;
    yield 2;
}

function* generator2() {
    yield* generator1();
    yield 3;
    yield 4;
}

let gen = generator2();
for (let value of gen) {
    console.log(value);  // 1, 2, 3, 4
}
```

### yield* with Arrays

```javascript
function* generator() {
    yield* [1, 2, 3];
    yield* "ABC";
}

let gen = generator();
for (let value of gen) {
    console.log(value);  // 1, 2, 3, "A", "B", "C"
}
```

### Recursive Delegation

```javascript
function* treeTraversal(node) {
    yield node.value;
    if (node.children) {
        for (let child of node.children) {
            yield* treeTraversal(child);
        }
    }
}

let tree = {
    value: 1,
    children: [
        { value: 2, children: [] },
        {
            value: 3,
            children: [
                { value: 4, children: [] }
            ]
        }
    ]
};

for (let value of treeTraversal(tree)) {
    console.log(value);  // 1, 2, 3, 4
}
```

---

## Practical Examples

### Example 1: Fibonacci Generator

```javascript
function* fibonacci() {
    let prev = 0;
    let curr = 1;
    
    while (true) {
        yield curr;
        [prev, curr] = [curr, prev + curr];
    }
}

let fib = fibonacci();
let count = 0;
for (let num of fib) {
    console.log(num);
    if (++count >= 10) break;  // First 10 numbers
}
```

### Example 2: Range Generator

```javascript
function* range(start, end, step = 1) {
    for (let i = start; i <= end; i += step) {
        yield i;
    }
}

for (let num of range(0, 10, 2)) {
    console.log(num);  // 0, 2, 4, 6, 8, 10
}
```

### Example 3: Infinite Counter

```javascript
function* counter(start = 0, step = 1) {
    let current = start;
    while (true) {
        yield current;
        current += step;
    }
}

let count = counter(10, 5);
console.log(count.next().value);  // 10
console.log(count.next().value);  // 15
console.log(count.next().value);  // 20
```

### Example 4: Data Processing Pipeline

```javascript
function* numbers() {
    yield* [1, 2, 3, 4, 5];
}

function* squares(iterable) {
    for (let num of iterable) {
        yield num * num;
    }
}

function* evens(iterable) {
    for (let num of iterable) {
        if (num % 2 === 0) {
            yield num;
        }
    }
}

let pipeline = evens(squares(numbers()));
for (let value of pipeline) {
    console.log(value);  // 4, 16 (squares of 2 and 4)
}
```

### Example 5: Async-like Generator

```javascript
function* asyncGenerator() {
    yield new Promise(resolve => setTimeout(() => resolve(1), 1000));
    yield new Promise(resolve => setTimeout(() => resolve(2), 1000));
    yield new Promise(resolve => setTimeout(() => resolve(3), 1000));
}

async function process() {
    for await (let value of asyncGenerator()) {
        console.log(value);  // 1, 2, 3 (with delays)
    }
}

process();
```

---

## Advanced Patterns

### Pattern 1: Generator as State Machine

```javascript
function* stateMachine() {
    while (true) {
        let action = yield;
        switch (action) {
            case "start":
                console.log("Starting...");
                break;
            case "pause":
                console.log("Paused");
                break;
            case "stop":
                console.log("Stopped");
                return;
            default:
                console.log("Unknown action");
        }
    }
}

let machine = stateMachine();
machine.next();  // Initialize
machine.next("start");   // Starting...
machine.next("pause");  // Paused
machine.next("stop");   // Stopped
```

### Pattern 2: Coroutines

```javascript
function* coroutine() {
    let result = yield "First";
    console.log("Received:", result);
    result = yield "Second";
    console.log("Received:", result);
    return "Done";
}

let co = coroutine();
console.log(co.next());        // { value: "First", done: false }
console.log(co.next("Hello")); // Received: Hello, { value: "Second", done: false }
console.log(co.next("World")); // Received: World, { value: "Done", done: true }
```

### Pattern 3: Generator Composition

```javascript
function* map(iterable, fn) {
    for (let item of iterable) {
        yield fn(item);
    }
}

function* filter(iterable, predicate) {
    for (let item of iterable) {
        if (predicate(item)) {
            yield item;
        }
    }
}

function* take(iterable, n) {
    let count = 0;
    for (let item of iterable) {
        if (count++ >= n) break;
        yield item;
    }
}

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let pipeline = take(
    filter(
        map(numbers, x => x * 2),
        x => x > 10
    ),
    3
);

for (let value of pipeline) {
    console.log(value);  // 12, 14, 16
}
```

---

## Practice Exercise

### Exercise: Generator Practice

**Objective**: Practice creating and using generators in various scenarios.

**Instructions**:

1. Create a file called `generators-practice.js`

2. Create generators for:
   - Range generator
   - Fibonacci generator
   - Infinite counter
   - Data processing pipeline
   - State machine

3. Practice:
   - Using yield keyword
   - Generator methods (next, return, throw)
   - Generator delegation
   - for...of with generators

**Example Solution**:

```javascript
// Generators Practice
console.log("=== Basic Generator ===");

function* basicGenerator() {
    yield 1;
    yield 2;
    yield 3;
}

let gen = basicGenerator();
console.log(gen.next());  // { value: 1, done: false }
console.log(gen.next());  // { value: 2, done: false }
console.log(gen.next());  // { value: 3, done: false }
console.log(gen.next());  // { value: undefined, done: true }
console.log();

console.log("=== Generator with for...of ===");

function* rangeGenerator(start, end) {
    for (let i = start; i <= end; i++) {
        yield i;
    }
}

for (let num of rangeGenerator(1, 5)) {
    console.log(num);  // 1, 2, 3, 4, 5
}
console.log();

console.log("=== Fibonacci Generator ===");

function* fibonacci() {
    let prev = 0;
    let curr = 1;
    
    while (true) {
        yield curr;
        [prev, curr] = [curr, prev + curr];
    }
}

let fib = fibonacci();
let count = 0;
console.log("First 10 Fibonacci numbers:");
for (let num of fib) {
    console.log(num);
    if (++count >= 10) break;
}
console.log();

console.log("=== next() with Arguments ===");

function* generatorWithArgs() {
    let x = yield "First";
    console.log("Received x:", x);
    let y = yield "Second";
    console.log("Received y:", y);
    yield x + y;
}

let gen2 = generatorWithArgs();
console.log(gen2.next());      // { value: "First", done: false }
console.log(gen2.next(10));   // Received x: 10, { value: "Second", done: false }
console.log(gen2.next(20));   // Received y: 20, { value: 30, done: false }
console.log();

console.log("=== return() Method ===");

function* generatorWithReturn() {
    yield 1;
    yield 2;
    yield 3;
}

let gen3 = generatorWithReturn();
console.log(gen3.next());           // { value: 1, done: false }
console.log(gen3.return("Early"));  // { value: "Early", done: true }
console.log(gen3.next());           // { value: undefined, done: true }
console.log();

console.log("=== throw() Method ===");

function* generatorWithThrow() {
    try {
        yield 1;
        yield 2;
    } catch (error) {
        console.log("Caught error:", error.message);
        yield 3;
    }
}

let gen4 = generatorWithThrow();
console.log(gen4.next());                    // { value: 1, done: false }
console.log(gen4.throw(new Error("Test"))); // Caught error: Test, { value: 3, done: false }
console.log(gen4.next());                    // { value: undefined, done: true }
console.log();

console.log("=== Generator Delegation ===");

function* generator1() {
    yield 1;
    yield 2;
}

function* generator2() {
    yield* generator1();
    yield 3;
    yield 4;
}

for (let value of generator2()) {
    console.log(value);  // 1, 2, 3, 4
}
console.log();

console.log("=== yield* with Arrays ===");

function* arrayGenerator() {
    yield* [1, 2, 3];
    yield* "ABC";
}

for (let value of arrayGenerator()) {
    console.log(value);  // 1, 2, 3, "A", "B", "C"
}
console.log();

console.log("=== Infinite Generator ===");

function* infiniteCounter(start = 0, step = 1) {
    let current = start;
    while (true) {
        yield current;
        current += step;
    }
}

let counter = infiniteCounter(10, 5);
console.log("First 5 values:");
for (let i = 0; i < 5; i++) {
    console.log(counter.next().value);  // 10, 15, 20, 25, 30
}
console.log();

console.log("=== Data Processing Pipeline ===");

function* numbers() {
    yield* [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
}

function* squares(iterable) {
    for (let num of iterable) {
        yield num * num;
    }
}

function* evens(iterable) {
    for (let num of iterable) {
        if (num % 2 === 0) {
            yield num;
        }
    }
}

let pipeline = evens(squares(numbers()));
console.log("Even squares:");
for (let value of pipeline) {
    console.log(value);  // 4, 16, 36, 64, 100
}
console.log();

console.log("=== State Machine Generator ===");

function* stateMachine() {
    while (true) {
        let action = yield;
        switch (action) {
            case "start":
                console.log("  State: Starting");
                break;
            case "run":
                console.log("  State: Running");
                break;
            case "pause":
                console.log("  State: Paused");
                break;
            case "stop":
                console.log("  State: Stopped");
                return;
            default:
                console.log("  Unknown action:", action);
        }
    }
}

let machine = stateMachine();
machine.next();  // Initialize
machine.next("start");   // State: Starting
machine.next("run");     // State: Running
machine.next("pause");   // State: Paused
machine.next("stop");    // State: Stopped
console.log();

console.log("=== Generator Composition ===");

function* map(iterable, fn) {
    for (let item of iterable) {
        yield fn(item);
    }
}

function* filter(iterable, predicate) {
    for (let item of iterable) {
        if (predicate(item)) {
            yield item;
        }
    }
}

function* take(iterable, n) {
    let count = 0;
    for (let item of iterable) {
        if (count++ >= n) break;
        yield item;
    }
}

let data = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let result = take(
    filter(
        map(data, x => x * 2),
        x => x > 10
    ),
    3
);

console.log("Composed pipeline result:");
for (let value of result) {
    console.log(value);  // 12, 14, 16
}
```

**Expected Output**:
```
=== Basic Generator ===
{ value: 1, done: false }
{ value: 2, done: false }
{ value: 3, done: false }
{ value: undefined, done: true }

=== Generator with for...of ===
1
2
3
4
5

=== Fibonacci Generator ===
First 10 Fibonacci numbers:
1
1
2
3
5
8
13
21
34
55

=== next() with Arguments ===
{ value: "First", done: false }
Received x: 10
{ value: "Second", done: false }
Received y: 20
{ value: 30, done: false }

=== return() Method ===
{ value: 1, done: false }
{ value: "Early", done: true }
{ value: undefined, done: true }

=== throw() Method ===
{ value: 1, done: false }
Caught error: Test
{ value: 3, done: false }
{ value: undefined, done: true }

=== Generator Delegation ===
1
2
3
4

=== yield* with Arrays ===
1
2
3
A
B
C

=== Infinite Generator ===
First 5 values:
10
15
20
25
30

=== Data Processing Pipeline ===
Even squares:
4
16
36
64
100

=== State Machine Generator ===
  State: Starting
  State: Running
  State: Paused
  State: Stopped

=== Generator Composition ===
Composed pipeline result:
12
14
16
```

**Challenge (Optional)**:
- Build a generator-based async library
- Create a tree traversal generator
- Build a file processing generator
- Create a reactive programming system with generators

---

## Common Mistakes

### 1. Forgetting function*

```javascript
// ❌ Error: Not a generator
function myGenerator() {
    yield 1;  // Error: Unexpected token
}

// ✅ Correct: Use function*
function* myGenerator() {
    yield 1;
}
```

### 2. Calling Generator Directly

```javascript
// ⚠️ Problem: Generator function returns generator object
function* generator() {
    yield 1;
}

generator();  // Returns generator, doesn''t execute

// ✅ Correct: Call and use
let gen = generator();
gen.next();  // Execute
```

### 3. Not Handling Infinite Generators

```javascript
// ⚠️ Problem: Infinite loop
function* infinite() {
    while (true) {
        yield Math.random();
    }
}

for (let value of infinite()) {
    console.log(value);  // Never ends!
}

// ✅ Solution: Break manually
let count = 0;
for (let value of infinite()) {
    console.log(value);
    if (++count >= 10) break;
}
```

### 4. Misunderstanding yield Return Value

```javascript
// ⚠️ Confusion: yield returns value passed to next()
function* generator() {
    let x = yield 1;  // x is value from next()
}

let gen = generator();
gen.next();      // Returns { value: 1, done: false }
gen.next(10);    // x becomes 10
```

---

## Key Takeaways

1. **Generator Functions**: Declared with `function*`
2. **yield**: Pauses execution and returns value
3. **next()**: Resumes execution, can pass value
4. **return()**: Terminates generator
5. **throw()**: Throws error into generator
6. **yield***: Delegates to another generator/iterable
7. **Iterable**: Generators are iterable (work with for...of)
8. **Best Practice**: Use generators for lazy evaluation and iteration

---

## Quiz: Generators

Test your understanding with these questions:

1. **Generator functions use:**
   - A) function
   - B) function*
   - C) function**
   - D) generator

2. **yield keyword:**
   - A) Returns value
   - B) Pauses execution
   - C) Both A and B
   - D) Nothing

3. **next() method:**
   - A) Starts generator
   - B) Resumes execution
   - C) Stops generator
   - D) Returns error

4. **yield* delegates to:**
   - A) Another generator
   - B) Iterable
   - C) Both A and B
   - D) Function

5. **Generators are:**
   - A) Iterators
   - B) Iterables
   - C) Both
   - D) Neither

6. **return() method:**
   - A) Returns value
   - B) Terminates generator
   - C) Both A and B
   - D) Resumes generator

7. **Infinite generators need:**
   - A) Auto-stop
   - B) Manual break
   - C) Error
   - D) Nothing

**Answers**:
1. B) function*
2. C) Both A and B
3. B) Resumes execution
4. C) Both A and B
5. C) Both
6. C) Both A and B
7. B) Manual break

---

## Next Steps

Congratulations! You''ve completed Module 10: Iterators and Generators. You now know:
- How iterators work
- How to create custom iterators
- How generators work
- How to use yield and generator methods

**What''s Next?**
- Module 11: Modules
- Lesson 11.1: ES6 Modules
- Practice combining iterators and generators
- Build more advanced patterns

---

## Additional Resources

- **MDN: Generator Functions**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/function*)
- **MDN: yield**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/yield](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/yield)
- **JavaScript.info: Generators**: [javascript.info/generators](https://javascript.info/generators)
- **Generator Patterns**: Advanced patterns and use cases

---

*Lesson completed! You''ve finished Module 10: Iterators and Generators. Ready for Module 11: Modules!*

', NULL, 2, '2026-01-03 09:48:39', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand generator functions
- Use the `yield` keyword
- Work with generator methods (next, return, throw)
- Understand generator delegation
- Create infinite generators
- Use generators for iteration
- Build advanced generator patterns');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (137, 51, 11, 'ES6 Modules', 'es6-modules', '# Lesson 11.1: ES6 Modules

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand ES6 module system
- Use `export` keyword to export values
- Use `import` keyword to import values
- Differentiate between default and named exports
- Create and use modules
- Organize code with modules
- Write modern modular JavaScript

---

## Introduction to ES6 Modules

ES6 modules provide a standardized way to organize and share code between files. They''re the modern standard for JavaScript module systems.

### Why Modules?

- **Code Organization**: Split code into logical units
- **Reusability**: Share code between files
- **Dependency Management**: Clear dependencies
- **Scope Isolation**: Each module has its own scope
- **Tree Shaking**: Remove unused code
- **Modern Standard**: Supported in modern browsers and Node.js

---

## Basic Module Syntax

### Exporting Values

Use `export` to make values available to other modules:

```javascript
// math.js
export const PI = 3.14159;
export function add(a, b) {
    return a + b;
}
```

### Importing Values

Use `import` to use values from other modules:

```javascript
// main.js
import { PI, add } from ''./math.js'';

console.log(PI);        // 3.14159
console.log(add(5, 3)); // 8
```

---

## Named Exports

Named exports allow you to export multiple values with specific names.

### Exporting Multiple Named Exports

```javascript
// utils.js
export function greet(name) {
    return `Hello, ${name}!`;
}

export function farewell(name) {
    return `Goodbye, ${name}!`;
}

export const MAX_SIZE = 100;
```

### Importing Named Exports

```javascript
// main.js
import { greet, farewell, MAX_SIZE } from ''./utils.js'';

console.log(greet("Alice"));      // "Hello, Alice!"
console.log(farewell("Bob"));     // "Goodbye, Bob!"
console.log(MAX_SIZE);            // 100
```

### Import with Different Names

```javascript
// Import with alias
import { greet as sayHello, farewell as sayGoodbye } from ''./utils.js'';

sayHello("Alice");
sayGoodbye("Bob");
```

### Import All Named Exports

```javascript
// Import everything
import * as utils from ''./utils.js'';

console.log(utils.greet("Alice"));
console.log(utils.MAX_SIZE);
```

### Export After Declaration

```javascript
// math.js
function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
}

export { add, subtract };
```

### Export with Rename

```javascript
// math.js
function add(a, b) {
    return a + b;
}

export { add as sum };
```

---

## Default Exports

Default exports allow you to export a single value as the default export.

### Single Default Export

```javascript
// calculator.js
export default function calculator(a, b, operation) {
    switch (operation) {
        case ''add'':
            return a + b;
        case ''subtract'':
            return a - b;
        default:
            return 0;
    }
}
```

### Importing Default Export

```javascript
// main.js
import calculator from ''./calculator.js'';

console.log(calculator(5, 3, ''add''));  // 8
```

### Default Export with Named Exports

```javascript
// math.js
export default function add(a, b) {
    return a + b;
}

export function subtract(a, b) {
    return a - b;
}

export const PI = 3.14159;
```

### Importing Default and Named

```javascript
// main.js
import add, { subtract, PI } from ''./math.js'';

console.log(add(5, 3));        // 8
console.log(subtract(5, 3));   // 2
console.log(PI);               // 3.14159
```

### Default Export with Rename

```javascript
// main.js
import { default as add, subtract } from ''./math.js'';
```

---

## Export Syntax Variations

### Export Variable

```javascript
// constants.js
export const API_URL = "https://api.example.com";
export let counter = 0;
```

### Export Class

```javascript
// user.js
export class User {
    constructor(name) {
        this.name = name;
    }
    
    greet() {
        return `Hello, I''m ${this.name}`;
    }
}
```

### Export Object

```javascript
// config.js
const config = {
    apiUrl: "https://api.example.com",
    timeout: 5000
};

export default config;
```

### Re-exporting

```javascript
// index.js
export { add, subtract } from ''./math.js'';
export { greet } from ''./utils.js'';
export { default as Calculator } from ''./calculator.js'';
```

---

## Module Scope

Each module has its own scope. Variables declared in a module are not global.

### Module Scope Example

```javascript
// module1.js
let privateVar = "I''m private";
export let publicVar = "I''m public";

// module2.js
import { publicVar } from ''./module1.js'';
console.log(publicVar);  // "I''m public"
// console.log(privateVar);  // Error: privateVar is not defined
```

### Top-Level Variables

```javascript
// module.js
let count = 0;  // Module-scoped, not global

export function increment() {
    count++;
    return count;
}
```

---

## Practical Examples

### Example 1: Math Module

```javascript
// math.js
export function add(a, b) {
    return a + b;
}

export function subtract(a, b) {
    return a - b;
}

export function multiply(a, b) {
    return a * b;
}

export function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero");
    }
    return a / b;
}

export const PI = 3.14159;
export const E = 2.71828;
```

```javascript
// main.js
import { add, subtract, multiply, divide, PI } from ''./math.js'';

console.log(add(5, 3));        // 8
console.log(multiply(4, 2));   // 8
console.log(PI);               // 3.14159
```

### Example 2: User Module

```javascript
// user.js
export class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} (${this.email})`;
    }
}

export function createUser(name, email) {
    return new User(name, email);
}
```

```javascript
// main.js
import { User, createUser } from ''./user.js'';

let user1 = new User("Alice", "alice@example.com");
let user2 = createUser("Bob", "bob@example.com");

console.log(user1.getInfo());  // "Alice (alice@example.com)"
console.log(user2.getInfo());  // "Bob (bob@example.com)"
```

### Example 3: Configuration Module

```javascript
// config.js
const config = {
    apiUrl: "https://api.example.com",
    timeout: 5000,
    retries: 3
};

export default config;
```

```javascript
// main.js
import config from ''./config.js'';

console.log(config.apiUrl);   // "https://api.example.com"
console.log(config.timeout);  // 5000
```

### Example 4: Utility Module

```javascript
// utils.js
export function formatDate(date) {
    return date.toLocaleDateString();
}

export function formatCurrency(amount) {
    return `$${amount.toFixed(2)}`;
}

export function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func(...args), delay);
    };
}
```

```javascript
// main.js
import { formatDate, formatCurrency, debounce } from ''./utils.js'';

console.log(formatDate(new Date()));
console.log(formatCurrency(19.99));

let debouncedLog = debounce(() => console.log("Debounced"), 1000);
```

---

## Module Best Practices

### 1. One Default Export Per Module

```javascript
// ✅ Good: One default export
export default class Calculator { }

// ⚠️ Avoid: Multiple default exports (not possible)
```

### 2. Consistent Naming

```javascript
// ✅ Good: Clear, descriptive names
export function calculateTotal(items) { }
export const MAX_ITEMS = 100;

// ⚠️ Avoid: Unclear names
export function calc(items) { }
export const MAX = 100;
```

### 3. Barrel Exports (index.js)

```javascript
// index.js - Re-export from multiple modules
export { add, subtract } from ''./math.js'';
export { greet, farewell } from ''./utils.js'';
export { User } from ''./user.js'';
```

### 4. Organize by Feature

```
src/
  users/
    user.js
    userService.js
    index.js
  products/
    product.js
    productService.js
    index.js
```

---

## Practice Exercise

### Exercise: Creating Modules

**Objective**: Practice creating and using ES6 modules.

**Instructions**:

1. Create multiple module files:
   - `math.js` - Math utilities
   - `user.js` - User class and functions
   - `utils.js` - Utility functions
   - `config.js` - Configuration
   - `main.js` - Main file importing from modules

2. Practice:
   - Named exports
   - Default exports
   - Importing with different syntaxes
   - Re-exporting
   - Module organization

**Example Solution**:

```javascript
// math.js
export function add(a, b) {
    return a + b;
}

export function subtract(a, b) {
    return a - b;
}

export function multiply(a, b) {
    return a * b;
}

export function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero");
    }
    return a / b;
}

export const PI = 3.14159;
export const E = 2.71828;

// Default export
export default {
    add,
    subtract,
    multiply,
    divide,
    PI,
    E
};
```

```javascript
// user.js
export class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} (${this.email})`;
    }
}

export function createUser(name, email) {
    return new User(name, email);
}

export function validateEmail(email) {
    return email.includes("@");
}
```

```javascript
// utils.js
export function formatDate(date) {
    return date.toLocaleDateString();
}

export function formatCurrency(amount) {
    return `$${amount.toFixed(2)}`;
}

export function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func(...args), delay);
    };
}

export function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    };
}
```

```javascript
// config.js
const config = {
    apiUrl: "https://api.example.com",
    timeout: 5000,
    retries: 3,
    environment: "development"
};

export default config;
```

```javascript
// index.js - Barrel export
export { add, subtract, multiply, divide, PI, E } from ''./math.js'';
export { default as math } from ''./math.js'';
export { User, createUser, validateEmail } from ''./user.js'';
export { formatDate, formatCurrency, debounce, throttle } from ''./utils.js'';
export { default as config } from ''./config.js'';
```

```javascript
// main.js
// Import named exports
import { add, subtract, PI } from ''./math.js'';
import { User, createUser } from ''./user.js'';
import { formatDate, formatCurrency } from ''./utils.js'';

// Import default export
import config from ''./config.js'';

// Import with alias
import { add as sum, subtract as diff } from ''./math.js'';

// Import all
import * as math from ''./math.js'';

// Use imported values
console.log("=== Math Operations ===");
console.log("Add:", add(5, 3));           // 8
console.log("Subtract:", subtract(5, 3));  // 2
console.log("PI:", PI);                   // 3.14159
console.log("Sum (alias):", sum(10, 5));  // 15
console.log("Math module:", math.multiply(4, 2));  // 8

console.log("\\n=== User Operations ===");
let user1 = new User("Alice", "alice@example.com");
let user2 = createUser("Bob", "bob@example.com");
console.log("User 1:", user1.getInfo());
console.log("User 2:", user2.getInfo());

console.log("\\n=== Utility Functions ===");
console.log("Date:", formatDate(new Date()));
console.log("Currency:", formatCurrency(19.99));

console.log("\\n=== Configuration ===");
console.log("API URL:", config.apiUrl);
console.log("Timeout:", config.timeout);
console.log("Environment:", config.environment);

// Import from barrel export
import { formatDate as format, config as appConfig } from ''./index.js'';
console.log("\\n=== From Barrel Export ===");
console.log("Formatted date:", format(new Date()));
console.log("Config:", appConfig);
```

**Expected Output**:
```
=== Math Operations ===
Add: 8
Subtract: 2
PI: 3.14159
Sum (alias): 15
Math module: 8

=== User Operations ===
User 1: Alice (alice@example.com)
User 2: Bob (bob@example.com)

=== Utility Functions ===
Date: [Current date]
Currency: $19.99

=== Configuration ===
API URL: https://api.example.com
Timeout: 5000
Environment: development

=== From Barrel Export ===
Formatted date: [Current date]
Config: { apiUrl: "https://api.example.com", timeout: 5000, retries: 3, environment: "development" }
```

**Challenge (Optional)**:
- Build a complete module-based application
- Create a module library
- Organize a large codebase with modules
- Create reusable module patterns

---

## Common Mistakes

### 1. Missing File Extension

```javascript
// ⚠️ Problem: Missing .js extension
import { add } from ''./math'';  // May not work in all environments

// ✅ Solution: Include extension
import { add } from ''./math.js'';
```

### 2. Mixing Default and Named Exports Incorrectly

```javascript
// ⚠️ Problem: Wrong import syntax
import add, { subtract } from ''./math.js'';  // add is default

// ✅ Correct: Default first, then named
import add, { subtract } from ''./math.js'';
```

### 3. Circular Dependencies

```javascript
// ⚠️ Problem: Circular dependency
// module1.js
import { func2 } from ''./module2.js'';

// module2.js
import { func1 } from ''./module1.js'';  // Circular!

// ✅ Solution: Restructure to avoid circular dependencies
```

### 4. Exporting Non-existent Values

```javascript
// ⚠️ Problem: Exporting undefined
export { nonExistentVar };  // Error

// ✅ Solution: Export existing values
let myVar = "value";
export { myVar };
```

---

## Key Takeaways

1. **export**: Makes values available to other modules
2. **import**: Brings values from other modules
3. **Named Exports**: Multiple exports with specific names
4. **Default Export**: Single default export per module
5. **Module Scope**: Each module has its own scope
6. **File Extension**: Use `.js` extension in imports
7. **Best Practice**: One default export, multiple named exports
8. **Organization**: Organize modules by feature

---

## Quiz: ES6 Modules

Test your understanding with these questions:

1. **What keyword exports values?**
   - A) export
   - B) import
   - C) module
   - D) require

2. **What keyword imports values?**
   - A) export
   - B) import
   - C) module
   - D) require

3. **How many default exports per module?**
   - A) 0
   - B) 1
   - C) Multiple
   - D) Unlimited

4. **Named exports use:**
   - A) export default
   - B) export { name }
   - C) Both
   - D) Neither

5. **Import syntax for default export:**
   - A) import { name } from ''./module.js''
   - B) import name from ''./module.js''
   - C) import * as name from ''./module.js''
   - D) All of the above

6. **Modules have:**
   - A) Global scope
   - B) Module scope
   - C) Function scope
   - D) Block scope

7. **Re-exporting uses:**
   - A) export from
   - B) import from
   - C) require from
   - D) module from

**Answers**:
1. A) export
2. B) import
3. B) 1
4. B) export { name }
5. B) import name from ''./module.js''
6. B) Module scope
7. A) export from

---

## Next Steps

Congratulations! You''ve learned ES6 modules. You now know:
- How to export and import values
- Named vs default exports
- Module syntax and organization
- Best practices for modules

**What''s Next?**
- Lesson 11.2: CommonJS and Module Systems
- Learn about other module systems
- Understand module bundlers
- Build larger applications

---

## Additional Resources

- **MDN: ES6 Modules**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules)
- **JavaScript.info: Modules**: [javascript.info/modules-intro](https://javascript.info/modules-intro)
- **ES6 Modules Guide**: Comprehensive module patterns

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:49:46', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand ES6 module system
- Use `export` keyword to export values
- Use `import` keyword to import values
- Differentiate between default and named exports
- Create and use modules
- Organize code with modules
- Write modern modular JavaScript');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (138, 51, 11, 'CommonJS and Module Systems', 'commonjs-and-module-systems', '# Lesson 11.2: CommonJS and Module Systems

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand CommonJS module system
- Use `require()` and `module.exports`
- Understand AMD modules
- Learn about module bundlers (Webpack, Rollup)
- Compare different module systems
- Choose the right module system for your project
- Understand module loading strategies

---

## Introduction to Module Systems

JavaScript has evolved through different module systems. Understanding them helps you work with different codebases and tools.

### Module System Evolution

1. **No Modules**: Global variables (old way)
2. **CommonJS**: Node.js standard (require/module.exports)
3. **AMD**: Asynchronous Module Definition (browser)
4. **ES6 Modules**: Modern standard (import/export)
5. **Bundlers**: Tools that combine modules (Webpack, Rollup)

---

## CommonJS

CommonJS is the module system used in Node.js. It uses `require()` to import and `module.exports` to export.

### Basic CommonJS Export

```javascript
// math.js
function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
}

module.exports = {
    add,
    subtract
};
```

### Basic CommonJS Import

```javascript
// main.js
const math = require(''./math.js'');

console.log(math.add(5, 3));      // 8
console.log(math.subtract(5, 3));  // 2
```

### Export Individual Functions

```javascript
// utils.js
exports.greet = function(name) {
    return `Hello, ${name}!`;
};

exports.farewell = function(name) {
    return `Goodbye, ${name}!`;
};
```

```javascript
// main.js
const { greet, farewell } = require(''./utils.js'');

console.log(greet("Alice"));    // "Hello, Alice!"
console.log(farewell("Bob"));   // "Goodbye, Bob!"
```

### Default Export

```javascript
// calculator.js
function Calculator() {
    this.add = (a, b) => a + b;
    this.subtract = (a, b) => a - b;
}

module.exports = Calculator;
```

```javascript
// main.js
const Calculator = require(''./calculator.js'');
const calc = new Calculator();

console.log(calc.add(5, 3));  // 8
```

### Export Single Function

```javascript
// add.js
module.exports = function(a, b) {
    return a + b;
};
```

```javascript
// main.js
const add = require(''./add.js'');
console.log(add(5, 3));  // 8
```

### CommonJS vs ES6 Modules

| Feature | CommonJS | ES6 Modules |
|---------|----------|-------------|
| Syntax | `require()` / `module.exports` | `import` / `export` |
| Loading | Synchronous | Asynchronous |
| Tree Shaking | No | Yes |
| Static Analysis | Limited | Full |
| Browser Support | Via bundler | Native |
| Node.js | Native | Native (ESM) |

---

## AMD (Asynchronous Module Definition)

AMD is designed for browser environments where modules load asynchronously.

### Basic AMD Module

```javascript
// math.js
define(function() {
    return {
        add: function(a, b) {
            return a + b;
        },
        subtract: function(a, b) {
            return a - b;
        }
    };
});
```

### AMD with Dependencies

```javascript
// calculator.js
define([''math''], function(math) {
    return {
        calculate: function(a, b, operation) {
            if (operation === ''add'') {
                return math.add(a, b);
            }
            return math.subtract(a, b);
        }
    };
});
```

### AMD with RequireJS

```javascript
// Using RequireJS
require([''math'', ''calculator''], function(math, calculator) {
    console.log(math.add(5, 3));
    console.log(calculator.calculate(10, 5, ''add''));
});
```

**Note**: AMD is less common now, replaced by ES6 modules and bundlers.

---

## Module Bundlers

Module bundlers combine multiple modules into one or more files for browser use.

### Why Bundlers?

- **Browser Compatibility**: Browsers don''t natively support all module systems
- **Optimization**: Minify, tree-shake, optimize code
- **Asset Management**: Handle CSS, images, etc.
- **Development Tools**: Hot reload, source maps
- **Code Splitting**: Load code on demand

### Popular Bundlers

1. **Webpack**: Most popular, highly configurable
2. **Rollup**: Great for libraries, tree-shaking
3. **Parcel**: Zero-configuration bundler
4. **Vite**: Fast development, modern tooling
5. **esbuild**: Extremely fast bundler

---

## Webpack

Webpack is a powerful module bundler that can handle various assets.

### Basic Webpack Setup

**package.json**:
```json
{
  "name": "my-app",
  "version": "1.0.0",
  "scripts": {
    "build": "webpack",
    "dev": "webpack serve"
  },
  "devDependencies": {
    "webpack": "^5.0.0",
    "webpack-cli": "^4.0.0"
  }
}
```

**webpack.config.js**:
```javascript
const path = require(''path'');

module.exports = {
  entry: ''./src/index.js'',
  output: {
    filename: ''bundle.js'',
    path: path.resolve(__dirname, ''dist'')
  },
  mode: ''development''
};
```

### Webpack Features

- **Loaders**: Transform files (Babel, TypeScript, CSS)
- **Plugins**: Extend functionality
- **Code Splitting**: Split code into chunks
- **Hot Module Replacement**: Update without refresh
- **Source Maps**: Debug original code

---

## Rollup

Rollup is optimized for creating libraries and uses ES6 modules.

### Basic Rollup Setup

**rollup.config.js**:
```javascript
export default {
  input: ''src/index.js'',
  output: {
    file: ''dist/bundle.js'',
    format: ''es''  // ES module format
  }
};
```

### Rollup Features

- **Tree Shaking**: Remove unused code
- **ES6 Modules**: Native ES6 module support
- **Smaller Bundles**: Optimized for libraries
- **Multiple Formats**: ES, CommonJS, UMD

---

## Vite

Vite is a modern build tool that provides fast development experience.

### Basic Vite Setup

**package.json**:
```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build"
  },
  "devDependencies": {
    "vite": "^4.0.0"
  }
}
```

### Vite Features

- **Fast HMR**: Instant hot module replacement
- **ES Modules**: Native ES module support
- **Optimized Build**: Uses Rollup for production
- **Zero Config**: Works out of the box

---

## Module System Comparison

### When to Use Each

**CommonJS:**
- Node.js applications
- Legacy codebases
- Server-side JavaScript

**ES6 Modules:**
- Modern JavaScript projects
- Browser applications
- When you need tree-shaking
- Modern Node.js (with ESM)

**AMD:**
- Legacy browser applications
- RequireJS projects
- (Generally avoid for new projects)

**Bundlers:**
- Browser applications
- When you need optimization
- Complex build requirements
- Asset management

---

## Practical Examples

### Example 1: CommonJS Module

```javascript
// user.js
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} (${this.email})`;
    }
}

module.exports = User;
```

```javascript
// main.js
const User = require(''./user.js'');

let user = new User("Alice", "alice@example.com");
console.log(user.getInfo());
```

### Example 2: CommonJS with Multiple Exports

```javascript
// math.js
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => a / b;
```

```javascript
// main.js
const { add, subtract, multiply, divide } = require(''./math.js'');

console.log(add(5, 3));        // 8
console.log(multiply(4, 2));   // 8
```

### Example 3: Mixed Exports

```javascript
// utils.js
function formatDate(date) {
    return date.toLocaleDateString();
}

function formatCurrency(amount) {
    return `$${amount.toFixed(2)}`;
}

// Named exports
exports.formatDate = formatDate;
exports.formatCurrency = formatCurrency;

// Default export
module.exports.default = {
    formatDate,
    formatCurrency
};
```

---

## Practice Exercise

### Exercise: Module Systems

**Objective**: Practice using different module systems and understand bundlers.

**Instructions**:

1. Create CommonJS modules
2. Convert to ES6 modules
3. Understand bundler concepts
4. Compare module systems

**Example Solution**:

```javascript
// CommonJS Example
// math.js
function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
}

function multiply(a, b) {
    return a * b;
}

function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero");
    }
    return a / b;
}

module.exports = {
    add,
    subtract,
    multiply,
    divide
};

// Alternative syntax
// exports.add = add;
// exports.subtract = subtract;
```

```javascript
// main.js (CommonJS)
const math = require(''./math.js'');

console.log("=== CommonJS Module ===");
console.log("Add:", math.add(5, 3));        // 8
console.log("Subtract:", math.subtract(5, 3));  // 2
console.log("Multiply:", math.multiply(4, 2));  // 8
console.log("Divide:", math.divide(10, 2));     // 5

// Destructuring
const { add, subtract } = require(''./math.js'');
console.log("Destructured:", add(10, 5));  // 15
```

```javascript
// ES6 Module Equivalent
// math.js
export function add(a, b) {
    return a + b;
}

export function subtract(a, b) {
    return a - b;
}

export function multiply(a, b) {
    return a * b;
}

export function divide(a, b) {
    if (b === 0) {
        throw new Error("Division by zero");
    }
    return a / b;
}
```

```javascript
// main.js (ES6)
import { add, subtract, multiply, divide } from ''./math.js'';

console.log("=== ES6 Module ===");
console.log("Add:", add(5, 3));
console.log("Subtract:", subtract(5, 3));
console.log("Multiply:", multiply(4, 2));
console.log("Divide:", divide(10, 2));
```

```javascript
// CommonJS: User Module
// user.js
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    getInfo() {
        return `${this.name} (${this.email})`;
    }
}

module.exports = User;
```

```javascript
// main.js
const User = require(''./user.js'');

let user = new User("Alice", "alice@example.com");
console.log("User:", user.getInfo());
```

```javascript
// CommonJS: Configuration
// config.js
const config = {
    apiUrl: "https://api.example.com",
    timeout: 5000,
    retries: 3
};

module.exports = config;
```

```javascript
// main.js
const config = require(''./config.js'');
console.log("Config:", config);
```

**Expected Output**:
```
=== CommonJS Module ===
Add: 8
Subtract: 2
Multiply: 8
Divide: 5
Destructured: 15

=== ES6 Module ===
Add: 8
Subtract: 2
Multiply: 8
Divide: 5

User: Alice (alice@example.com)
Config: { apiUrl: "https://api.example.com", timeout: 5000, retries: 3 }
```

**Challenge (Optional)**:
- Set up a Webpack project
- Set up a Rollup project
- Convert CommonJS to ES6 modules
- Create a module library

---

## Common Mistakes

### 1. Mixing Module Systems

```javascript
// ⚠️ Problem: Mixing CommonJS and ES6
// module1.js (CommonJS)
module.exports = { add };

// module2.js (ES6)
import { add } from ''./module1.js'';  // May not work

// ✅ Solution: Use one system consistently
```

### 2. Circular Dependencies

```javascript
// ⚠️ Problem: Circular dependency
// module1.js
const { func2 } = require(''./module2.js'');

// module2.js
const { func1 } = require(''./module1.js'');  // Circular!

// ✅ Solution: Restructure to avoid
```

### 3. Wrong Export Syntax

```javascript
// ⚠️ Problem: Wrong syntax
exports = { add };  // Doesn''t work

// ✅ Solution: Use module.exports or exports.property
module.exports = { add };
// or
exports.add = add;
```

### 4. Forgetting File Extension

```javascript
// ⚠️ Problem: May not work in all environments
const math = require(''./math'');

// ✅ Solution: Include extension (optional in CommonJS, required in ES6)
const math = require(''./math.js'');
```

---

## Key Takeaways

1. **CommonJS**: Node.js standard, uses `require()` and `module.exports`
2. **AMD**: Browser-focused, asynchronous loading (legacy)
3. **ES6 Modules**: Modern standard, `import`/`export`
4. **Bundlers**: Combine modules for browsers (Webpack, Rollup, Vite)
5. **Choose Wisely**: Use ES6 for new projects, CommonJS for Node.js
6. **Bundlers Essential**: Needed for browser applications
7. **Best Practice**: Use consistent module system
8. **Modern Approach**: ES6 modules with bundler

---

## Quiz: Module Systems

Test your understanding with these questions:

1. **CommonJS uses:**
   - A) import/export
   - B) require/module.exports
   - C) define/require
   - D) module/import

2. **ES6 modules use:**
   - A) require/module.exports
   - B) import/export
   - C) define/require
   - D) module/require

3. **CommonJS is:**
   - A) Asynchronous
   - B) Synchronous
   - C) Both
   - D) Neither

4. **AMD stands for:**
   - A) Asynchronous Module Definition
   - B) Advanced Module Definition
   - C) Application Module Definition
   - D) Automatic Module Definition

5. **Webpack is a:**
   - A) Module system
   - B) Module bundler
   - C) Framework
   - D) Library

6. **Rollup is optimized for:**
   - A) Applications
   - B) Libraries
   - C) Both
   - D) Neither

7. **Modern projects should use:**
   - A) CommonJS only
   - B) ES6 modules
   - C) AMD
   - D) No modules

**Answers**:
1. B) require/module.exports
2. B) import/export
3. B) Synchronous
4. A) Asynchronous Module Definition
5. B) Module bundler
6. B) Libraries
7. B) ES6 modules

---

## Next Steps

Congratulations! You''ve completed Module 11: Modules. You now know:
- How ES6 modules work
- How CommonJS works
- About module bundlers
- When to use each system

**What''s Next?**
- Module 12: Working with APIs
- Lesson 12.1: Fetch API
- Practice building modular applications
- Continue learning advanced JavaScript

---

## Additional Resources

- **Node.js Modules**: [nodejs.org/api/modules.html](https://nodejs.org/api/modules.html)
- **Webpack Documentation**: [webpack.js.org](https://webpack.js.org/)
- **Rollup Documentation**: [rollupjs.org](https://rollupjs.org/)
- **Vite Documentation**: [vitejs.dev](https://vitejs.dev/)

---

*Lesson completed! You''ve finished Module 11: Modules. Ready for Module 12: Working with APIs!*

', NULL, 2, '2026-01-03 09:49:46', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand CommonJS module system
- Use `require()` and `module.exports`
- Understand AMD modules
- Learn about module bundlers (Webpack, Rollup)
- Compare different module systems
- Choose the right module system for your project
- Understand module loading strategies');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (139, 52, 11, 'Fetch API', 'fetch-api', '# Lesson 12.1: Fetch API

## Learning Objectives

By the end of this lesson, you will be able to:
- Make HTTP requests using the Fetch API
- Perform GET, POST, PUT, and DELETE requests
- Configure request options (headers, body, method)
- Handle responses and parse data
- Handle errors properly
- Work with async/await and Fetch
- Build API-integrated applications

---

## Introduction to Fetch API

The Fetch API provides a modern, promise-based way to make HTTP requests. It''s built into modern browsers and is the standard for making network requests in JavaScript.

### Why Fetch API?

- **Promise-based**: Works with async/await
- **Modern**: Built into browsers
- **Flexible**: Supports all HTTP methods
- **Streaming**: Can handle streaming responses
- **Standard**: Replaces older XMLHttpRequest

---

## Basic Fetch Request

### Simple GET Request

```javascript
fetch(''https://api.example.com/users'')
    .then(response => response.json())
    .then(data => {
        console.log(data);
    })
    .catch(error => {
        console.error(''Error:'', error);
    });
```

### Fetch with async/await

```javascript
async function fetchUsers() {
    try {
        const response = await fetch(''https://api.example.com/users'');
        const data = await response.json();
        console.log(data);
    } catch (error) {
        console.error(''Error:'', error);
    }
}

fetchUsers();
```

---

## HTTP Methods

### GET Request

```javascript
// Simple GET
fetch(''https://api.example.com/users'')
    .then(response => response.json())
    .then(data => console.log(data));

// GET with async/await
async function getUsers() {
    const response = await fetch(''https://api.example.com/users'');
    const data = await response.json();
    return data;
}
```

### POST Request

```javascript
// POST with JSON body
fetch(''https://api.example.com/users'', {
    method: ''POST'',
    headers: {
        ''Content-Type'': ''application/json''
    },
    body: JSON.stringify({
        name: ''Alice'',
        email: ''alice@example.com''
    })
})
    .then(response => response.json())
    .then(data => console.log(''Created:'', data));

// POST with async/await
async function createUser(userData) {
    const response = await fetch(''https://api.example.com/users'', {
        method: ''POST'',
        headers: {
            ''Content-Type'': ''application/json''
        },
        body: JSON.stringify(userData)
    });
    return await response.json();
}
```

### PUT Request

```javascript
// PUT to update resource
async function updateUser(userId, userData) {
    const response = await fetch(`https://api.example.com/users/${userId}`, {
        method: ''PUT'',
        headers: {
            ''Content-Type'': ''application/json''
        },
        body: JSON.stringify(userData)
    });
    return await response.json();
}
```

### DELETE Request

```javascript
// DELETE to remove resource
async function deleteUser(userId) {
    const response = await fetch(`https://api.example.com/users/${userId}`, {
        method: ''DELETE''
    });
    return await response.json();
}
```

---

## Request Options

### Headers

```javascript
fetch(''https://api.example.com/data'', {
    headers: {
        ''Content-Type'': ''application/json'',
        ''Authorization'': ''Bearer token123'',
        ''X-Custom-Header'': ''value''
    }
});
```

### Request Body

```javascript
// JSON body
fetch(''https://api.example.com/users'', {
    method: ''POST'',
    headers: {
        ''Content-Type'': ''application/json''
    },
    body: JSON.stringify({
        name: ''Alice'',
        age: 25
    })
});

// Form data
const formData = new FormData();
formData.append(''name'', ''Alice'');
formData.append(''age'', ''25'');

fetch(''https://api.example.com/users'', {
    method: ''POST'',
    body: formData
});
```

### Complete Request Options

```javascript
fetch(''https://api.example.com/users'', {
    method: ''POST'',
    headers: {
        ''Content-Type'': ''application/json'',
        ''Authorization'': ''Bearer token123''
    },
    body: JSON.stringify({
        name: ''Alice'',
        email: ''alice@example.com''
    }),
    mode: ''cors'',           // cors, no-cors, same-origin
    cache: ''no-cache'',      // default, no-cache, reload, force-cache
    credentials: ''include'', // include, same-origin, omit
    redirect: ''follow''      // follow, error, manual
});
```

---

## Response Handling

### Checking Response Status

```javascript
async function fetchData() {
    const response = await fetch(''https://api.example.com/data'');
    
    if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
    }
    
    const data = await response.json();
    return data;
}
```

### Response Methods

```javascript
async function handleResponse() {
    const response = await fetch(''https://api.example.com/data'');
    
    // JSON
    const jsonData = await response.json();
    
    // Text
    const textData = await response.text();
    
    // Blob
    const blobData = await response.blob();
    
    // ArrayBuffer
    const bufferData = await response.arrayBuffer();
    
    // FormData
    const formData = await response.formData();
}
```

### Response Properties

```javascript
async function checkResponse() {
    const response = await fetch(''https://api.example.com/data'');
    
    console.log(response.status);      // 200
    console.log(response.statusText);   // "OK"
    console.log(response.ok);          // true
    console.log(response.headers);     // Headers object
    console.log(response.url);         // Request URL
    console.log(response.type);        // "cors", "basic", etc.
}
```

---

## Error Handling

### Basic Error Handling

```javascript
async function fetchWithErrorHandling() {
    try {
        const response = await fetch(''https://api.example.com/data'');
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        console.error(''Fetch error:'', error);
        throw error;
    }
}
```

### Handling Different Error Types

```javascript
async function robustFetch(url) {
    try {
        const response = await fetch(url);
        
        // Check for HTTP errors
        if (!response.ok) {
            if (response.status === 404) {
                throw new Error(''Resource not found'');
            } else if (response.status === 500) {
                throw new Error(''Server error'');
            } else {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
        }
        
        // Parse JSON
        const data = await response.json();
        return data;
    } catch (error) {
        // Handle network errors
        if (error instanceof TypeError) {
            console.error(''Network error:'', error.message);
        } else {
            console.error(''Error:'', error.message);
        }
        throw error;
    }
}
```

---

## Practical Examples

### Example 1: Fetching User Data

```javascript
async function getUser(userId) {
    try {
        const response = await fetch(`https://api.example.com/users/${userId}`);
        
        if (!response.ok) {
            throw new Error(`Failed to fetch user: ${response.status}`);
        }
        
        const user = await response.json();
        return user;
    } catch (error) {
        console.error(''Error fetching user:'', error);
        throw error;
    }
}

// Usage
getUser(1)
    .then(user => console.log(''User:'', user))
    .catch(error => console.error(''Error:'', error));
```

### Example 2: Creating a Resource

```javascript
async function createUser(userData) {
    try {
        const response = await fetch(''https://api.example.com/users'', {
            method: ''POST'',
            headers: {
                ''Content-Type'': ''application/json''
            },
            body: JSON.stringify(userData)
        });
        
        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.message || ''Failed to create user'');
        }
        
        const newUser = await response.json();
        return newUser;
    } catch (error) {
        console.error(''Error creating user:'', error);
        throw error;
    }
}

// Usage
createUser({ name: ''Alice'', email: ''alice@example.com'' })
    .then(user => console.log(''Created:'', user))
    .catch(error => console.error(''Error:'', error));
```

### Example 3: Updating a Resource

```javascript
async function updateUser(userId, updates) {
    try {
        const response = await fetch(`https://api.example.com/users/${userId}`, {
            method: ''PUT'',
            headers: {
                ''Content-Type'': ''application/json''
            },
            body: JSON.stringify(updates)
        });
        
        if (!response.ok) {
            throw new Error(`Failed to update user: ${response.status}`);
        }
        
        const updatedUser = await response.json();
        return updatedUser;
    } catch (error) {
        console.error(''Error updating user:'', error);
        throw error;
    }
}
```

### Example 4: Deleting a Resource

```javascript
async function deleteUser(userId) {
    try {
        const response = await fetch(`https://api.example.com/users/${userId}`, {
            method: ''DELETE''
        });
        
        if (!response.ok) {
            throw new Error(`Failed to delete user: ${response.status}`);
        }
        
        // Some APIs return data, others return empty
        if (response.status === 204) {
            return { success: true };
        }
        
        return await response.json();
    } catch (error) {
        console.error(''Error deleting user:'', error);
        throw error;
    }
}
```

### Example 5: Fetching Multiple Resources

```javascript
async function fetchMultipleUsers(userIds) {
    try {
        const promises = userIds.map(id =>
            fetch(`https://api.example.com/users/${id}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`Failed to fetch user ${id}`);
                    }
                    return response.json();
                })
        );
        
        const users = await Promise.all(promises);
        return users;
    } catch (error) {
        console.error(''Error fetching users:'', error);
        throw error;
    }
}

// Usage
fetchMultipleUsers([1, 2, 3])
    .then(users => console.log(''Users:'', users))
    .catch(error => console.error(''Error:'', error));
```

---

## Practice Exercise

### Exercise: Fetch API Practice

**Objective**: Practice making HTTP requests with the Fetch API.

**Instructions**:

1. Create a file called `fetch-practice.js`

2. Practice:
   - GET requests
   - POST requests
   - PUT requests
   - DELETE requests
   - Error handling
   - Response handling
   - Multiple requests

3. Use a mock API or JSONPlaceholder (https://jsonplaceholder.typicode.com)

**Example Solution**:

```javascript
// Fetch API Practice
const API_URL = ''https://jsonplaceholder.typicode.com'';

console.log("=== GET Request ===");

async function getUsers() {
    try {
        const response = await fetch(`${API_URL}/users`);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const users = await response.json();
        console.log(''Users:'', users);
        return users;
    } catch (error) {
        console.error(''Error fetching users:'', error);
        throw error;
    }
}

getUsers().then(users => {
    console.log(`Fetched ${users.length} users`);
});
console.log();

console.log("=== GET Single User ===");

async function getUser(userId) {
    try {
        const response = await fetch(`${API_URL}/users/${userId}`);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const user = await response.json();
        console.log(''User:'', user);
        return user;
    } catch (error) {
        console.error(''Error fetching user:'', error);
        throw error;
    }
}

getUser(1).then(user => {
    console.log(`User name: ${user.name}`);
});
console.log();

console.log("=== POST Request ===");

async function createPost(postData) {
    try {
        const response = await fetch(`${API_URL}/posts`, {
            method: ''POST'',
            headers: {
                ''Content-Type'': ''application/json''
            },
            body: JSON.stringify(postData)
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const newPost = await response.json();
        console.log(''Created post:'', newPost);
        return newPost;
    } catch (error) {
        console.error(''Error creating post:'', error);
        throw error;
    }
}

createPost({
    title: ''My New Post'',
    body: ''This is the body of my post'',
    userId: 1
}).then(post => {
    console.log(`Post created with ID: ${post.id}`);
});
console.log();

console.log("=== PUT Request ===");

async function updatePost(postId, updates) {
    try {
        const response = await fetch(`${API_URL}/posts/${postId}`, {
            method: ''PUT'',
            headers: {
                ''Content-Type'': ''application/json''
            },
            body: JSON.stringify(updates)
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const updatedPost = await response.json();
        console.log(''Updated post:'', updatedPost);
        return updatedPost;
    } catch (error) {
        console.error(''Error updating post:'', error);
        throw error;
    }
}

updatePost(1, {
    title: ''Updated Title'',
    body: ''Updated body'',
    userId: 1
}).then(post => {
    console.log(`Post ${post.id} updated`);
});
console.log();

console.log("=== DELETE Request ===");

async function deletePost(postId) {
    try {
        const response = await fetch(`${API_URL}/posts/${postId}`, {
            method: ''DELETE''
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        console.log(`Post ${postId} deleted`);
        return { success: true };
    } catch (error) {
        console.error(''Error deleting post:'', error);
        throw error;
    }
}

deletePost(1).then(result => {
    console.log(''Delete result:'', result);
});
console.log();

console.log("=== Error Handling ===");

async function fetchWithErrorHandling(url) {
    try {
        const response = await fetch(url);
        
        if (!response.ok) {
            if (response.status === 404) {
                throw new Error(''Resource not found'');
            } else if (response.status >= 500) {
                throw new Error(''Server error'');
            } else {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
        }
        
        const data = await response.json();
        return data;
    } catch (error) {
        if (error instanceof TypeError) {
            console.error(''Network error:'', error.message);
        } else {
            console.error(''Error:'', error.message);
        }
        throw error;
    }
}

// Test with invalid URL
fetchWithErrorHandling(`${API_URL}/invalid`)
    .catch(error => {
        console.log(''Caught error:'', error.message);
    });
console.log();

console.log("=== Multiple Requests ===");

async function fetchUserPosts(userId) {
    try {
        // Fetch user and posts in parallel
        const [userResponse, postsResponse] = await Promise.all([
            fetch(`${API_URL}/users/${userId}`),
            fetch(`${API_URL}/users/${userId}/posts`)
        ]);
        
        if (!userResponse.ok || !postsResponse.ok) {
            throw new Error(''Failed to fetch data'');
        }
        
        const [user, posts] = await Promise.all([
            userResponse.json(),
            postsResponse.json()
        ]);
        
        console.log(`User: ${user.name}`);
        console.log(`Posts: ${posts.length}`);
        return { user, posts };
    } catch (error) {
        console.error(''Error:'', error);
        throw error;
    }
}

fetchUserPosts(1).then(data => {
    console.log(''User data:'', data);
});
console.log();

console.log("=== Response Headers ===");

async function checkHeaders() {
    try {
        const response = await fetch(`${API_URL}/users/1`);
        
        console.log(''Status:'', response.status);
        console.log(''Status Text:'', response.statusText);
        console.log(''OK:'', response.ok);
        console.log(''Content-Type:'', response.headers.get(''Content-Type''));
        console.log(''URL:'', response.url);
    } catch (error) {
        console.error(''Error:'', error);
    }
}

checkHeaders();
```

**Expected Output** (will vary based on API response):
```
=== GET Request ===
Users: [array of users]
Fetched 10 users

=== GET Single User ===
User: { id: 1, name: "Leanne Graham", ... }
User name: Leanne Graham

=== POST Request ===
Created post: { id: 101, title: "My New Post", ... }
Post created with ID: 101

=== PUT Request ===
Updated post: { id: 1, title: "Updated Title", ... }
Post 1 updated

=== DELETE Request ===
Post 1 deleted
Delete result: { success: true }

=== Error Handling ===
Error: Resource not found
Caught error: Resource not found

=== Multiple Requests ===
User: Leanne Graham
Posts: 10
User data: { user: {...}, posts: [...] }

=== Response Headers ===
Status: 200
Status Text: OK
OK: true
Content-Type: application/json; charset=utf-8
URL: https://jsonplaceholder.typicode.com/users/1
```

**Challenge (Optional)**:
- Build a complete CRUD application with Fetch
- Create a reusable API client
- Implement retry logic
- Add request timeout handling

---

## Common Mistakes

### 1. Not Checking response.ok

```javascript
// ⚠️ Problem: Doesn''t check for HTTP errors
const response = await fetch(url);
const data = await response.json();  // May fail if response is error

// ✅ Solution: Always check response.ok
const response = await fetch(url);
if (!response.ok) {
    throw new Error(`HTTP error! status: ${response.status}`);
}
const data = await response.json();
```

### 2. Forgetting to Parse JSON

```javascript
// ⚠️ Problem: Response is not parsed
const response = await fetch(url);
console.log(response);  // Response object, not data

// ✅ Solution: Parse response
const response = await fetch(url);
const data = await response.json();
console.log(data);  // Actual data
```

### 3. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
const data = await fetch(url).then(r => r.json());

// ✅ Solution: Always handle errors
try {
    const response = await fetch(url);
    if (!response.ok) throw new Error(''HTTP error'');
    const data = await response.json();
} catch (error) {
    console.error(''Error:'', error);
}
```

### 4. Missing Headers for POST/PUT

```javascript
// ⚠️ Problem: Missing Content-Type header
fetch(url, {
    method: ''POST'',
    body: JSON.stringify(data)  // Server may not parse correctly
});

// ✅ Solution: Include Content-Type
fetch(url, {
    method: ''POST'',
    headers: {
        ''Content-Type'': ''application/json''
    },
    body: JSON.stringify(data)
});
```

---

## Key Takeaways

1. **Fetch API**: Modern, promise-based HTTP client
2. **HTTP Methods**: GET, POST, PUT, DELETE
3. **Request Options**: Headers, body, method, etc.
4. **Response Handling**: Check status, parse data
5. **Error Handling**: Always check response.ok, handle errors
6. **async/await**: Preferred over .then() chains
7. **Best Practice**: Always handle errors, check response status
8. **Modern Standard**: Fetch is the standard for HTTP requests

---

## Quiz: Fetch API

Test your understanding with these questions:

1. **Fetch returns:**
   - A) Data directly
   - B) Promise
   - C) Response object
   - D) Error

2. **To parse JSON response:**
   - A) response.json()
   - B) response.text()
   - C) JSON.parse(response)
   - D) response.data

3. **POST request needs:**
   - A) method: ''POST''
   - B) body
   - C) headers (usually)
   - D) All of the above

4. **response.ok is:**
   - A) Always true
   - B) True for 2xx status
   - C) True for 200 only
   - D) Always false

5. **Fetch is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

6. **Error handling should:**
   - A) Check response.ok
   - B) Use try-catch
   - C) Both A and B
   - D) Neither

7. **Multiple requests can use:**
   - A) Promise.all()
   - B) Sequential await
   - C) Both
   - D) Neither

**Answers**:
1. B) Promise (that resolves to Response)
2. A) response.json()
3. D) All of the above
4. B) True for 2xx status codes
5. B) Asynchronous
6. C) Both A and B
7. C) Both (Promise.all for parallel, sequential await for dependent)

---

## Next Steps

Congratulations! You''ve learned the Fetch API. You now know:
- How to make HTTP requests
- All HTTP methods (GET, POST, PUT, DELETE)
- How to handle responses and errors
- Best practices for API calls

**What''s Next?**
- Lesson 12.2: Axios and HTTP Libraries
- Learn about alternative HTTP libraries
- Understand when to use different tools
- Build more complex API integrations

---

## Additional Resources

- **MDN: Fetch API**: [developer.mozilla.org/en-US/docs/Web/API/Fetch_API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)
- **Fetch API Guide**: Comprehensive examples and patterns
- **JSONPlaceholder**: [jsonplaceholder.typicode.com](https://jsonplaceholder.typicode.com) - Free fake API for testing

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:51:41', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Make HTTP requests using the Fetch API
- Perform GET, POST, PUT, and DELETE requests
- Configure request options (headers, body, method)
- Handle responses and parse data
- Handle errors properly
- Work with async/await and Fetch
- Build API-integrated applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (140, 52, 11, 'Axios and HTTP Libraries', 'axios-and-http-libraries', '# Lesson 12.2: Axios and HTTP Libraries

## Learning Objectives

By the end of this lesson, you will be able to:
- Install and use Axios
- Compare Axios with Fetch API
- Use request and response interceptors
- Handle errors with Axios
- Configure Axios instances
- Work with other HTTP libraries
- Choose the right HTTP client for your project

---

## Introduction to Axios

Axios is a popular HTTP client library for JavaScript. It provides a simple API and additional features compared to the native Fetch API.

### Why Axios?

- **Promise-based**: Works with async/await
- **Automatic JSON**: Automatically parses JSON
- **Interceptors**: Request/response interceptors
- **Error Handling**: Better error handling
- **Request Cancellation**: Cancel requests
- **Browser & Node.js**: Works in both environments

---

## Installing Axios

### npm Installation

```bash
npm install axios
```

### CDN (Browser)

```html
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
```

### Import Axios

```javascript
// ES6 Modules
import axios from ''axios'';

// CommonJS
const axios = require(''axios'');
```

---

## Basic Axios Usage

### GET Request

```javascript
// Simple GET
axios.get(''https://api.example.com/users'')
    .then(response => {
        console.log(response.data);
    })
    .catch(error => {
        console.error(''Error:'', error);
    });

// With async/await
async function getUsers() {
    try {
        const response = await axios.get(''https://api.example.com/users'');
        console.log(response.data);
        return response.data;
    } catch (error) {
        console.error(''Error:'', error);
        throw error;
    }
}
```

### POST Request

```javascript
// POST request
axios.post(''https://api.example.com/users'', {
    name: ''Alice'',
    email: ''alice@example.com''
})
    .then(response => {
        console.log(''Created:'', response.data);
    })
    .catch(error => {
        console.error(''Error:'', error);
    });

// With async/await
async function createUser(userData) {
    try {
        const response = await axios.post(''https://api.example.com/users'', userData);
        return response.data;
    } catch (error) {
        console.error(''Error creating user:'', error);
        throw error;
    }
}
```

### PUT Request

```javascript
async function updateUser(userId, userData) {
    try {
        const response = await axios.put(`https://api.example.com/users/${userId}`, userData);
        return response.data;
    } catch (error) {
        console.error(''Error updating user:'', error);
        throw error;
    }
}
```

### DELETE Request

```javascript
async function deleteUser(userId) {
    try {
        const response = await axios.delete(`https://api.example.com/users/${userId}`);
        return response.data;
    } catch (error) {
        console.error(''Error deleting user:'', error);
        throw error;
    }
}
```

---

## Axios vs Fetch

### Comparison Table

| Feature | Fetch | Axios |
|---------|-------|-------|
| **JSON Parsing** | Manual (response.json()) | Automatic |
| **Request Cancellation** | AbortController | Built-in |
| **Interceptors** | No | Yes |
| **Error Handling** | Manual check | Automatic |
| **Browser Support** | Modern browsers | All browsers |
| **Bundle Size** | Built-in (0KB) | ~13KB |
| **Request Timeout** | Manual | Built-in |
| **Response Timeout** | No | Yes |

### Code Comparison

**Fetch:**
```javascript
fetch(''https://api.example.com/users'', {
    method: ''POST'',
    headers: {
        ''Content-Type'': ''application/json''
    },
    body: JSON.stringify({ name: ''Alice'' })
})
    .then(response => {
        if (!response.ok) {
            throw new Error(''HTTP error'');
        }
        return response.json();
    })
    .then(data => console.log(data))
    .catch(error => console.error(error));
```

**Axios:**
```javascript
axios.post(''https://api.example.com/users'', { name: ''Alice'' })
    .then(response => console.log(response.data))
    .catch(error => console.error(error));
```

---

## Request Configuration

### Config Object

```javascript
axios({
    method: ''POST'',
    url: ''https://api.example.com/users'',
    data: {
        name: ''Alice'',
        email: ''alice@example.com''
    },
    headers: {
        ''Content-Type'': ''application/json'',
        ''Authorization'': ''Bearer token123''
    },
    timeout: 5000,
    params: {
        page: 1,
        limit: 10
    }
});
```

### Common Config Options

```javascript
axios.get(''https://api.example.com/users'', {
    params: {
        page: 1,
        limit: 10
    },
    headers: {
        ''Authorization'': ''Bearer token123''
    },
    timeout: 5000,
    responseType: ''json''  // json, text, blob, arraybuffer
});
```

---

## Response Object

### Response Structure

```javascript
const response = await axios.get(''https://api.example.com/users'');

console.log(response.data);      // Response body (parsed)
console.log(response.status);     // HTTP status code
console.log(response.statusText); // HTTP status text
console.log(response.headers);   // Response headers
console.log(response.config);    // Request config
```

### Accessing Data

```javascript
// Axios automatically parses JSON
const response = await axios.get(''https://api.example.com/users'');
const users = response.data;  // Already parsed JSON

// For other types
const response = await axios.get(''https://api.example.com/image.png'', {
    responseType: ''blob''
});
const image = response.data;  // Blob object
```

---

## Error Handling

### Basic Error Handling

```javascript
try {
    const response = await axios.get(''https://api.example.com/users'');
    console.log(response.data);
} catch (error) {
    if (error.response) {
        // Server responded with error status
        console.error(''Status:'', error.response.status);
        console.error(''Data:'', error.response.data);
    } else if (error.request) {
        // Request made but no response
        console.error(''No response:'', error.request);
    } else {
        // Error setting up request
        console.error(''Error:'', error.message);
    }
}
```

### Error Object Structure

```javascript
catch (error) {
    console.log(error.message);        // Error message
    console.log(error.response);       // Response object (if received)
    console.log(error.response.status); // HTTP status
    console.log(error.response.data);   // Response data
    console.log(error.request);         // Request object
    console.log(error.config);          // Request config
}
```

### Handling Specific Status Codes

```javascript
try {
    const response = await axios.get(''https://api.example.com/users'');
} catch (error) {
    if (error.response) {
        switch (error.response.status) {
            case 404:
                console.error(''Resource not found'');
                break;
            case 401:
                console.error(''Unauthorized'');
                break;
            case 500:
                console.error(''Server error'');
                break;
            default:
                console.error(''Error:'', error.response.status);
        }
    }
}
```

---

## Interceptors

### Request Interceptor

```javascript
// Add token to all requests
axios.interceptors.request.use(
    config => {
        const token = localStorage.getItem(''token'');
        if (token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    },
    error => {
        return Promise.reject(error);
    }
);
```

### Response Interceptor

```javascript
// Handle responses globally
axios.interceptors.response.use(
    response => {
        // Modify response before returning
        return response;
    },
    error => {
        // Handle errors globally
        if (error.response?.status === 401) {
            // Redirect to login
            window.location.href = ''/login'';
        }
        return Promise.reject(error);
    }
);
```

### Multiple Interceptors

```javascript
// Request interceptor 1
const requestInterceptor1 = axios.interceptors.request.use(config => {
    console.log(''Request 1:'', config.url);
    return config;
});

// Request interceptor 2
const requestInterceptor2 = axios.interceptors.request.use(config => {
    config.headers[''X-Custom''] = ''value'';
    return config;
});

// Remove interceptor
axios.interceptors.request.eject(requestInterceptor1);
```

---

## Axios Instances

### Creating an Instance

```javascript
const apiClient = axios.create({
    baseURL: ''https://api.example.com'',
    timeout: 5000,
    headers: {
        ''Content-Type'': ''application/json''
    }
});

// Use instance
apiClient.get(''/users'')
    .then(response => console.log(response.data));
```

### Instance with Defaults

```javascript
const apiClient = axios.create({
    baseURL: ''https://api.example.com'',
    timeout: 10000
});

// Add default header
apiClient.defaults.headers.common[''Authorization''] = ''Bearer token123'';

// Add interceptor to instance
apiClient.interceptors.request.use(config => {
    console.log(''API Request:'', config.url);
    return config;
});
```

---

## Request Cancellation

### Cancel Token (Axios < 0.22)

```javascript
const CancelToken = axios.CancelToken;
const source = CancelToken.source();

axios.get(''https://api.example.com/users'', {
    cancelToken: source.token
})
    .then(response => console.log(response.data))
    .catch(error => {
        if (axios.isCancel(error)) {
            console.log(''Request cancelled'');
        }
    });

// Cancel request
source.cancel(''Operation cancelled'');
```

### AbortController (Axios >= 0.22)

```javascript
const controller = new AbortController();

axios.get(''https://api.example.com/users'', {
    signal: controller.signal
})
    .then(response => console.log(response.data))
    .catch(error => {
        if (axios.isCancel(error)) {
            console.log(''Request cancelled'');
        }
    });

// Cancel request
controller.abort();
```

---

## Practical Examples

### Example 1: API Client Class

```javascript
class ApiClient {
    constructor(baseURL) {
        this.client = axios.create({
            baseURL,
            timeout: 10000,
            headers: {
                ''Content-Type'': ''application/json''
            }
        });
        
        this.setupInterceptors();
    }
    
    setupInterceptors() {
        // Request interceptor
        this.client.interceptors.request.use(
            config => {
                const token = localStorage.getItem(''token'');
                if (token) {
                    config.headers.Authorization = `Bearer ${token}`;
                }
                return config;
            },
            error => Promise.reject(error)
        );
        
        // Response interceptor
        this.client.interceptors.response.use(
            response => response,
            error => {
                if (error.response?.status === 401) {
                    localStorage.removeItem(''token'');
                    window.location.href = ''/login'';
                }
                return Promise.reject(error);
            }
        );
    }
    
    async get(url, config) {
        return this.client.get(url, config);
    }
    
    async post(url, data, config) {
        return this.client.post(url, data, config);
    }
    
    async put(url, data, config) {
        return this.client.put(url, data, config);
    }
    
    async delete(url, config) {
        return this.client.delete(url, config);
    }
}

// Usage
const api = new ApiClient(''https://api.example.com'');
const users = await api.get(''/users'');
```

### Example 2: Error Handling Utility

```javascript
function handleAxiosError(error) {
    if (error.response) {
        // Server responded with error
        const { status, data } = error.response;
        switch (status) {
            case 400:
                return { message: ''Bad request'', details: data };
            case 401:
                return { message: ''Unauthorized'', details: data };
            case 404:
                return { message: ''Not found'', details: data };
            case 500:
                return { message: ''Server error'', details: data };
            default:
                return { message: `HTTP error ${status}`, details: data };
        }
    } else if (error.request) {
        // Request made but no response
        return { message: ''No response from server'', details: null };
    } else {
        // Error setting up request
        return { message: error.message, details: null };
    }
}

// Usage
try {
    await axios.get(''https://api.example.com/users'');
} catch (error) {
    const errorInfo = handleAxiosError(error);
    console.error(errorInfo);
}
```

---

## Practice Exercise

### Exercise: Axios Practice

**Objective**: Practice using Axios for HTTP requests.

**Instructions**:

1. Install Axios (or use CDN)
2. Create a file called `axios-practice.js`
3. Practice:
   - GET, POST, PUT, DELETE requests
   - Error handling
   - Interceptors
   - Creating instances
   - Request cancellation

**Example Solution**:

```javascript
// Axios Practice
// Note: Requires axios to be installed or loaded via CDN
const axios = require(''axios''); // or import axios from ''axios'';

const API_URL = ''https://jsonplaceholder.typicode.com'';

console.log("=== Basic GET Request ===");

async function getUsers() {
    try {
        const response = await axios.get(`${API_URL}/users`);
        console.log(`Fetched ${response.data.length} users`);
        return response.data;
    } catch (error) {
        console.error(''Error:'', error.message);
        throw error;
    }
}

getUsers();
console.log();

console.log("=== GET with Params ===");

async function getUserPosts(userId) {
    try {
        const response = await axios.get(`${API_URL}/posts`, {
            params: {
                userId: userId
            }
        });
        console.log(`User ${userId} has ${response.data.length} posts`);
        return response.data;
    } catch (error) {
        console.error(''Error:'', error.message);
        throw error;
    }
}

getUserPosts(1);
console.log();

console.log("=== POST Request ===");

async function createPost(postData) {
    try {
        const response = await axios.post(`${API_URL}/posts`, postData);
        console.log(''Created post:'', response.data.id);
        return response.data;
    } catch (error) {
        console.error(''Error creating post:'', error.message);
        throw error;
    }
}

createPost({
    title: ''My New Post'',
    body: ''This is the body'',
    userId: 1
});
console.log();

console.log("=== PUT Request ===");

async function updatePost(postId, updates) {
    try {
        const response = await axios.put(`${API_URL}/posts/${postId}`, updates);
        console.log(''Updated post:'', response.data.id);
        return response.data;
    } catch (error) {
        console.error(''Error updating post:'', error.message);
        throw error;
    }
}

updatePost(1, {
    title: ''Updated Title'',
    body: ''Updated body'',
    userId: 1
});
console.log();

console.log("=== DELETE Request ===");

async function deletePost(postId) {
    try {
        const response = await axios.delete(`${API_URL}/posts/${postId}`);
        console.log(`Post ${postId} deleted`);
        return response.data;
    } catch (error) {
        console.error(''Error deleting post:'', error.message);
        throw error;
    }
}

deletePost(1);
console.log();

console.log("=== Error Handling ===");

async function handleErrors() {
    try {
        await axios.get(`${API_URL}/invalid-endpoint`);
    } catch (error) {
        if (error.response) {
            console.log(''Status:'', error.response.status);
            console.log(''Data:'', error.response.data);
        } else if (error.request) {
            console.log(''No response received'');
        } else {
            console.log(''Error:'', error.message);
        }
    }
}

handleErrors();
console.log();

console.log("=== Request Interceptor ===");

// Add token to all requests
axios.interceptors.request.use(
    config => {
        const token = ''mock-token-123'';
        if (token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        console.log(''Request interceptor:'', config.url);
        return config;
    },
    error => {
        return Promise.reject(error);
    }
);

axios.get(`${API_URL}/users/1`)
    .then(response => {
        console.log(''Request completed with interceptor'');
    });
console.log();

console.log("=== Response Interceptor ===");

axios.interceptors.response.use(
    response => {
        console.log(''Response interceptor:'', response.status);
        return response;
    },
    error => {
        if (error.response?.status === 404) {
            console.log(''404 error intercepted'');
        }
        return Promise.reject(error);
    }
);

axios.get(`${API_URL}/users/1`)
    .then(response => {
        console.log(''Response received'');
    });
console.log();

console.log("=== Axios Instance ===");

const apiClient = axios.create({
    baseURL: API_URL,
    timeout: 5000,
    headers: {
        ''Content-Type'': ''application/json''
    }
});

// Use instance
apiClient.get(''/users/1'')
    .then(response => {
        console.log(''Instance request successful'');
    });
console.log();

console.log("=== Request Cancellation ===");

const controller = new AbortController();

setTimeout(() => {
    controller.abort();
    console.log(''Request cancelled'');
}, 100);

try {
    await axios.get(`${API_URL}/users`, {
        signal: controller.signal
    });
} catch (error) {
    if (axios.isCancel(error)) {
        console.log(''Request was cancelled'');
    } else {
        console.error(''Error:'', error.message);
    }
}
```

**Expected Output** (will vary):
```
=== Basic GET Request ===
Fetched 10 users

=== GET with Params ===
User 1 has 10 posts

=== POST Request ===
Created post: 101

=== PUT Request ===
Updated post: 1

=== DELETE Request ===
Post 1 deleted

=== Error Handling ===
Status: 404
Data: {}

=== Request Interceptor ===
Request interceptor: https://jsonplaceholder.typicode.com/users/1
Request completed with interceptor

=== Response Interceptor ===
Response interceptor: 200
Response received

=== Axios Instance ===
Instance request successful

=== Request Cancellation ===
Request cancelled
Request was cancelled
```

**Challenge (Optional)**:
- Build a complete API client with Axios
- Create reusable interceptors
- Implement retry logic
- Build error handling utilities

---

## Common Mistakes

### 1. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
const response = await axios.get(url);
console.log(response.data);

// ✅ Solution: Always handle errors
try {
    const response = await axios.get(url);
    console.log(response.data);
} catch (error) {
    console.error(''Error:'', error);
}
```

### 2. Accessing Wrong Property

```javascript
// ⚠️ Problem: Wrong property
const data = await axios.get(url);
console.log(data);  // Response object, not data

// ✅ Solution: Use response.data
const response = await axios.get(url);
console.log(response.data);  // Actual data
```

### 3. Not Using Interceptors Properly

```javascript
// ⚠️ Problem: Interceptor not returning config
axios.interceptors.request.use(config => {
    config.headers.Auth = ''token'';
    // Missing return!
});

// ✅ Solution: Always return config
axios.interceptors.request.use(config => {
    config.headers.Auth = ''token'';
    return config;
});
```

---

## Key Takeaways

1. **Axios**: Popular HTTP client library
2. **Automatic JSON**: Parses JSON automatically
3. **Interceptors**: Request/response interceptors
4. **Error Handling**: Better error handling than Fetch
5. **Instances**: Create configured instances
6. **Cancellation**: Cancel requests
7. **Best Practice**: Use interceptors for common logic
8. **When to Use**: When you need features beyond Fetch

---

## Quiz: HTTP Libraries

Test your understanding with these questions:

1. **Axios automatically:**
   - A) Parses JSON
   - B) Handles errors
   - C) Both A and B
   - D) Neither

2. **Interceptors are used for:**
   - A) Request modification
   - B) Response modification
   - C) Both A and B
   - D) Error handling only

3. **Axios instance is created with:**
   - A) axios.create()
   - B) new Axios()
   - C) axios.instance()
   - D) axios.new()

4. **Axios vs Fetch:**
   - A) Axios is built-in
   - B) Fetch needs more code
   - C) Both are same
   - D) Fetch is better

5. **Error.response contains:**
   - A) Status code
   - B) Response data
   - C) Both A and B
   - D) Request data

6. **Request cancellation uses:**
   - A) AbortController
   - B) CancelToken
   - C) Both (depending on version)
   - D) Neither

7. **Axios is:**
   - A) Only for browsers
   - B) Only for Node.js
   - C) Both browser and Node.js
   - D) Neither

**Answers**:
1. C) Both A and B
2. C) Both A and B
3. A) axios.create()
4. B) Fetch needs more code (Axios is simpler)
5. C) Both A and B
6. C) Both (depending on version)
7. C) Both browser and Node.js

---

## Next Steps

Congratulations! You''ve learned Axios. You now know:
- How to use Axios for HTTP requests
- How Axios compares to Fetch
- How to use interceptors
- How to handle errors with Axios

**What''s Next?**
- Lesson 12.3: Working with JSON
- Learn JSON manipulation
- Practice API data handling
- Build complete API integrations

---

## Additional Resources

- **Axios Documentation**: [axios-http.com](https://axios-http.com/)
- **Axios GitHub**: [github.com/axios/axios](https://github.com/axios/axios)
- **Axios vs Fetch**: Comparison guides

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:51:41', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Install and use Axios
- Compare Axios with Fetch API
- Use request and response interceptors
- Handle errors with Axios
- Configure Axios instances
- Work with other HTTP libraries
- Choose the right HTTP client for your project');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (141, 52, 11, 'Handling API Responses', 'handling-api-responses', '# Lesson 12.3: Working with JSON

## Learning Objectives

By the end of this lesson, you will be able to:
- Use `JSON.stringify()` to convert objects to JSON
- Use `JSON.parse()` to convert JSON to objects
- Handle JSON data from APIs
- Work with nested JSON structures
- Use JSON with common patterns
- Handle JSON errors
- Manipulate JSON data effectively

---

## Introduction to JSON

JSON (JavaScript Object Notation) is a lightweight data interchange format. It''s the standard format for data exchange in web APIs.

### What is JSON?

- **Text Format**: Human-readable text format
- **Language Independent**: Works with any language
- **Lightweight**: Smaller than XML
- **Standard**: Used by most APIs
- **JavaScript Native**: Built into JavaScript

### JSON Syntax

```json
{
  "name": "Alice",
  "age": 25,
  "city": "New York",
  "isActive": true,
  "hobbies": ["reading", "coding"],
  "address": {
    "street": "123 Main St",
    "zipCode": "10001"
  }
}
```

---

## JSON.stringify()

`JSON.stringify()` converts a JavaScript value to a JSON string.

### Basic Usage

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

let jsonString = JSON.stringify(person);
console.log(jsonString);
// ''{"name":"Alice","age":25,"city":"New York"}''
```

### Stringifying Different Types

```javascript
// Object
JSON.stringify({ name: "Alice" });  // ''{"name":"Alice"}''

// Array
JSON.stringify([1, 2, 3]);  // ''[1,2,3]''

// String
JSON.stringify("Hello");  // ''"Hello"''

// Number
JSON.stringify(42);  // ''42''

// Boolean
JSON.stringify(true);  // ''true''

// null
JSON.stringify(null);  // ''null''

// undefined (excluded)
JSON.stringify({ x: undefined });  // ''{}''
```

### Replacer Function

```javascript
let person = {
    name: "Alice",
    age: 25,
    password: "secret123"
};

// Exclude password
let json = JSON.stringify(person, (key, value) => {
    if (key === "password") {
        return undefined;  // Exclude
    }
    return value;
});

console.log(json);  // ''{"name":"Alice","age":25}''
```

### Replacer Array

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    email: "alice@example.com"
};

// Only include specified keys
let json = JSON.stringify(person, ["name", "age"]);
console.log(json);  // ''{"name":"Alice","age":25}''
```

### Space Parameter (Pretty Print)

```javascript
let person = {
    name: "Alice",
    age: 25,
    city: "New York"
};

// Pretty print with 2 spaces
let json = JSON.stringify(person, null, 2);
console.log(json);
/*
{
  "name": "Alice",
  "age": 25,
  "city": "New York"
}
*/

// Pretty print with tabs
let json2 = JSON.stringify(person, null, "\\t");
```

### Handling Circular References

```javascript
let obj = { name: "Alice" };
obj.self = obj;  // Circular reference

// ⚠️ Error: Converting circular structure
// JSON.stringify(obj);  // Error!

// ✅ Solution: Handle circular references
function stringifyCircular(obj) {
    let seen = new WeakSet();
    return JSON.stringify(obj, (key, value) => {
        if (typeof value === "object" && value !== null) {
            if (seen.has(value)) {
                return "[Circular]";
            }
            seen.add(value);
        }
        return value;
    });
}
```

---

## JSON.parse()

`JSON.parse()` converts a JSON string to a JavaScript object.

### Basic Usage

```javascript
let jsonString = ''{"name":"Alice","age":25,"city":"New York"}'';
let person = JSON.parse(jsonString);

console.log(person.name);  // "Alice"
console.log(person.age);   // 25
```

### Parsing Arrays

```javascript
let jsonArray = ''[1, 2, 3, 4, 5]'';
let numbers = JSON.parse(jsonArray);

console.log(numbers);      // [1, 2, 3, 4, 5]
console.log(numbers[0]);   // 1
```

### Reviver Function

```javascript
let jsonString = ''{"name":"Alice","age":"25","date":"2024-01-01"}'';

let person = JSON.parse(jsonString, (key, value) => {
    // Convert age string to number
    if (key === "age") {
        return parseInt(value);
    }
    // Convert date string to Date object
    if (key === "date") {
        return new Date(value);
    }
    return value;
});

console.log(person.age);   // 25 (number)
console.log(person.date);  // Date object
```

### Error Handling

```javascript
function safeParse(jsonString) {
    try {
        return JSON.parse(jsonString);
    } catch (error) {
        console.error("Invalid JSON:", error.message);
        return null;
    }
}

let valid = safeParse(''{"name":"Alice"}'');  // { name: "Alice" }
let invalid = safeParse(''{name:"Alice"}'');  // null (invalid JSON)
```

---

## Working with API Data

### Fetching and Parsing JSON

```javascript
async function fetchUserData(userId) {
    try {
        const response = await fetch(`https://api.example.com/users/${userId}`);
        const jsonString = await response.text();
        const user = JSON.parse(jsonString);
        return user;
    } catch (error) {
        console.error("Error:", error);
        throw error;
    }
}

// Or use response.json() which does parsing automatically
async function fetchUserData(userId) {
    const response = await fetch(`https://api.example.com/users/${userId}`);
    const user = await response.json();  // Automatically parses JSON
    return user;
}
```

### Sending JSON Data

```javascript
async function createUser(userData) {
    try {
        const response = await fetch(''https://api.example.com/users'', {
            method: ''POST'',
            headers: {
                ''Content-Type'': ''application/json''
            },
            body: JSON.stringify(userData)  // Convert to JSON string
        });
        
        const newUser = await response.json();
        return newUser;
    } catch (error) {
        console.error("Error:", error);
        throw error;
    }
}

createUser({
    name: "Alice",
    age: 25,
    email: "alice@example.com"
});
```

---

## Common JSON Patterns

### Pattern 1: Deep Clone

```javascript
function deepClone(obj) {
    return JSON.parse(JSON.stringify(obj));
}

let original = {
    name: "Alice",
    address: {
        city: "New York"
    }
};

let cloned = deepClone(original);
cloned.address.city = "Boston";

console.log(original.address.city);  // "New York" (unchanged)
console.log(cloned.address.city);    // "Boston"
```

**Note**: This doesn''t work with functions, dates, or circular references.

### Pattern 2: Comparing Objects

```javascript
function objectsEqual(obj1, obj2) {
    return JSON.stringify(obj1) === JSON.stringify(obj2);
}

let obj1 = { name: "Alice", age: 25 };
let obj2 = { name: "Alice", age: 25 };
let obj3 = { age: 25, name: "Alice" };  // Different order

console.log(objectsEqual(obj1, obj2));  // true
console.log(objectsEqual(obj1, obj3));  // false (order matters)
```

### Pattern 3: Filtering Object Properties

```javascript
function filterObject(obj, keys) {
    let filtered = {};
    keys.forEach(key => {
        if (obj.hasOwnProperty(key)) {
            filtered[key] = obj[key];
        }
    });
    return filtered;
}

let person = {
    name: "Alice",
    age: 25,
    email: "alice@example.com",
    password: "secret"
};

let public = filterObject(person, ["name", "age"]);
let json = JSON.stringify(public);
console.log(json);  // ''{"name":"Alice","age":25}''
```

### Pattern 4: Transforming Data

```javascript
function transformData(data, transformer) {
    return JSON.parse(
        JSON.stringify(data, transformer)
    );
}

let person = {
    name: "Alice",
    age: 25,
    password: "secret"
};

let transformed = transformData(person, (key, value) => {
    if (key === "password") {
        return undefined;  // Remove
    }
    if (key === "age") {
        return value + 1;  // Transform
    }
    return value;
});

console.log(transformed);  // { name: "Alice", age: 26 }
```

---

## Nested JSON Structures

### Working with Nested Objects

```javascript
let company = {
    name: "Tech Corp",
    employees: [
        {
            id: 1,
            name: "Alice",
            department: {
                name: "Engineering",
                location: "New York"
            }
        },
        {
            id: 2,
            name: "Bob",
            department: {
                name: "Sales",
                location: "Boston"
            }
        }
    ]
};

let json = JSON.stringify(company, null, 2);
console.log(json);

// Access nested data
let parsed = JSON.parse(json);
console.log(parsed.employees[0].department.name);  // "Engineering"
```

### Flattening Nested JSON

```javascript
function flattenObject(obj, prefix = "") {
    let flattened = {};
    
    for (let key in obj) {
        let newKey = prefix ? `${prefix}.${key}` : key;
        
        if (typeof obj[key] === "object" && obj[key] !== null && !Array.isArray(obj[key])) {
            Object.assign(flattened, flattenObject(obj[key], newKey));
        } else {
            flattened[newKey] = obj[key];
        }
    }
    
    return flattened;
}

let nested = {
    user: {
        name: "Alice",
        address: {
            city: "New York"
        }
    }
};

let flat = flattenObject(nested);
console.log(flat);
// { "user.name": "Alice", "user.address.city": "New York" }
```

---

## Practice Exercise

### Exercise: JSON Manipulation

**Objective**: Practice working with JSON data.

**Instructions**:

1. Create a file called `json-practice.js`

2. Practice:
   - JSON.stringify() with different options
   - JSON.parse() with reviver
   - Working with API data
   - Common JSON patterns
   - Nested JSON structures

**Example Solution**:

```javascript
// JSON Practice
console.log("=== JSON.stringify() Basics ===");

let person = {
    name: "Alice",
    age: 25,
    city: "New York",
    isActive: true,
    hobbies: ["reading", "coding"]
};

let json = JSON.stringify(person);
console.log("JSON string:", json);

let pretty = JSON.stringify(person, null, 2);
console.log("Pretty JSON:");
console.log(pretty);
console.log();

console.log("=== JSON.parse() Basics ===");

let jsonString = ''{"name":"Alice","age":25,"city":"New York"}'';
let parsed = JSON.parse(jsonString);

console.log("Parsed object:", parsed);
console.log("Name:", parsed.name);
console.log("Age:", parsed.age);
console.log();

console.log("=== Replacer Function ===");

let user = {
    name: "Alice",
    age: 25,
    password: "secret123",
    email: "alice@example.com"
};

// Exclude password
let safeJson = JSON.stringify(user, (key, value) => {
    if (key === "password") {
        return undefined;
    }
    return value;
});

console.log("Safe JSON:", safeJson);
console.log();

console.log("=== Replacer Array ===");

let selectedFields = JSON.stringify(user, ["name", "email"]);
console.log("Selected fields:", selectedFields);
console.log();

console.log("=== Reviver Function ===");

let jsonWithTypes = ''{"name":"Alice","age":"25","birthDate":"1999-01-01"}'';

let parsedWithTypes = JSON.parse(jsonWithTypes, (key, value) => {
    if (key === "age") {
        return parseInt(value);
    }
    if (key === "birthDate") {
        return new Date(value);
    }
    return value;
});

console.log("Age type:", typeof parsedWithTypes.age);  // "number"
console.log("Birth date type:", parsedWithTypes.birthDate instanceof Date);  // true
console.log();

console.log("=== Error Handling ===");

function safeParse(jsonString) {
    try {
        return JSON.parse(jsonString);
    } catch (error) {
        console.error("Parse error:", error.message);
        return null;
    }
}

let valid = safeParse(''{"name":"Alice"}'');
console.log("Valid JSON:", valid);

let invalid = safeParse(''{name:"Alice"}'');
console.log("Invalid JSON:", invalid);
console.log();

console.log("=== Deep Clone ===");

let original = {
    name: "Alice",
    address: {
        city: "New York",
        zipCode: "10001"
    }
};

let cloned = JSON.parse(JSON.stringify(original));
cloned.address.city = "Boston";

console.log("Original city:", original.address.city);  // "New York"
console.log("Cloned city:", cloned.address.city);      // "Boston"
console.log();

console.log("=== Comparing Objects ===");

function objectsEqual(obj1, obj2) {
    return JSON.stringify(obj1) === JSON.stringify(obj2);
}

let obj1 = { a: 1, b: 2 };
let obj2 = { a: 1, b: 2 };
let obj3 = { a: 1, b: 3 };

console.log("obj1 === obj2:", objectsEqual(obj1, obj2));  // true
console.log("obj1 === obj3:", objectsEqual(obj1, obj3));  // false
console.log();

console.log("=== Filtering Properties ===");

function filterProperties(obj, keys) {
    let filtered = {};
    keys.forEach(key => {
        if (obj.hasOwnProperty(key)) {
            filtered[key] = obj[key];
        }
    });
    return filtered;
}

let fullUser = {
    name: "Alice",
    age: 25,
    email: "alice@example.com",
    password: "secret",
    phone: "555-1234"
};

let publicUser = filterProperties(fullUser, ["name", "age", "email"]);
console.log("Public user:", JSON.stringify(publicUser, null, 2));
console.log();

console.log("=== Nested JSON ===");

let company = {
    name: "Tech Corp",
    employees: [
        {
            id: 1,
            name: "Alice",
            department: {
                name: "Engineering",
                location: "New York"
            },
            skills: ["JavaScript", "Python"]
        },
        {
            id: 2,
            name: "Bob",
            department: {
                name: "Sales",
                location: "Boston"
            },
            skills: ["Communication", "Negotiation"]
        }
    ]
};

let companyJson = JSON.stringify(company, null, 2);
console.log("Company JSON:");
console.log(companyJson);

let parsedCompany = JSON.parse(companyJson);
console.log("\\nFirst employee department:", parsedCompany.employees[0].department.name);
console.log();

console.log("=== Transforming Data ===");

function transformJSON(data, transformer) {
    return JSON.parse(
        JSON.stringify(data, transformer)
    );
}

let data = {
    name: "Alice",
    age: 25,
    password: "secret",
    score: 85
};

let transformed = transformJSON(data, (key, value) => {
    if (key === "password") {
        return undefined;  // Remove
    }
    if (key === "score") {
        return value > 80 ? "A" : "B";  // Transform
    }
    return value;
});

console.log("Transformed:", JSON.stringify(transformed, null, 2));
console.log();

console.log("=== API Data Simulation ===");

// Simulate API response
let apiResponse = {
    status: "success",
    data: {
        users: [
            { id: 1, name: "Alice", email: "alice@example.com" },
            { id: 2, name: "Bob", email: "bob@example.com" }
        ],
        total: 2
    }
};

let responseJson = JSON.stringify(apiResponse);
console.log("API Response JSON:", responseJson);

let parsedResponse = JSON.parse(responseJson);
console.log("Total users:", parsedResponse.data.total);
console.log("First user:", parsedResponse.data.users[0].name);
console.log();

console.log("=== Working with Arrays ===");

let users = [
    { id: 1, name: "Alice" },
    { id: 2, name: "Bob" },
    { id: 3, name: "Charlie" }
];

let usersJson = JSON.stringify(users);
console.log("Users JSON:", usersJson);

let parsedUsers = JSON.parse(usersJson);
console.log("User count:", parsedUsers.length);
console.log("Second user:", parsedUsers[1].name);
```

**Expected Output**:
```
=== JSON.stringify() Basics ===
JSON string: {"name":"Alice","age":25,"city":"New York","isActive":true,"hobbies":["reading","coding"]}
Pretty JSON:
{
  "name": "Alice",
  "age": 25,
  "city": "New York",
  "isActive": true,
  "hobbies": [
    "reading",
    "coding"
  ]
}

=== JSON.parse() Basics ===
Parsed object: { name: "Alice", age: 25, city: "New York" }
Name: Alice
Age: 25

=== Replacer Function ===
Safe JSON: {"name":"Alice","age":25,"email":"alice@example.com"}

=== Replacer Array ===
Selected fields: {"name":"Alice","email":"alice@example.com"}

=== Reviver Function ===
Age type: number
Birth date type: true

=== Error Handling ===
Valid JSON: { name: "Alice" }
Parse error: Expected property name or ''}'' in JSON at position 1
Invalid JSON: null

=== Deep Clone ===
Original city: New York
Cloned city: Boston

=== Comparing Objects ===
obj1 === obj2: true
obj1 === obj3: false

=== Filtering Properties ===
Public user: {
  "name": "Alice",
  "age": 25,
  "email": "alice@example.com"
}

=== Nested JSON ===
Company JSON:
{
  "name": "Tech Corp",
  "employees": [
    {
      "id": 1,
      "name": "Alice",
      "department": {
        "name": "Engineering",
        "location": "New York"
      },
      "skills": [
        "JavaScript",
        "Python"
      ]
    },
    {
      "id": 2,
      "name": "Bob",
      "department": {
        "name": "Sales",
        "location": "Boston"
      },
      "skills": [
        "Communication",
        "Negotiation"
      ]
    }
  ]
}

First employee department: Engineering

=== Transforming Data ===
Transformed: {
  "name": "Alice",
  "age": 25,
  "score": "A"
}

=== API Data Simulation ===
API Response JSON: {"status":"success","data":{"users":[{"id":1,"name":"Alice","email":"alice@example.com"},{"id":2,"name":"Bob","email":"bob@example.com"}],"total":2}}
Total users: 2
First user: Alice

=== Working with Arrays ===
Users JSON: [{"id":1,"name":"Alice"},{"id":2,"name":"Bob"},{"id":3,"name":"Charlie"}]
User count: 3
Second user: Bob
```

**Challenge (Optional)**:
- Build a JSON validator
- Create JSON transformation utilities
- Build a JSON diff tool
- Create JSON schema validator

---

## Common Mistakes

### 1. Not Handling Parse Errors

```javascript
// ⚠️ Problem: No error handling
let data = JSON.parse(invalidJson);  // Throws error

// ✅ Solution: Use try-catch
try {
    let data = JSON.parse(jsonString);
} catch (error) {
    console.error("Invalid JSON:", error);
}
```

### 2. Forgetting to Stringify

```javascript
// ⚠️ Problem: Sending object directly
fetch(url, {
    method: ''POST'',
    body: userObject  // Wrong!
});

// ✅ Solution: Stringify first
fetch(url, {
    method: ''POST'',
    body: JSON.stringify(userObject)
});
```

### 3. Circular References

```javascript
// ⚠️ Problem: Circular reference
let obj = { name: "Alice" };
obj.self = obj;
JSON.stringify(obj);  // Error!

// ✅ Solution: Handle circular references
function safeStringify(obj) {
    let seen = new WeakSet();
    return JSON.stringify(obj, (key, value) => {
        if (typeof value === "object" && value !== null) {
            if (seen.has(value)) {
                return "[Circular]";
            }
            seen.add(value);
        }
        return value;
    });
}
```

### 4. Functions Not Stringified

```javascript
// ⚠️ Problem: Functions are lost
let obj = {
    name: "Alice",
    greet: function() {
        return "Hello";
    }
};

JSON.stringify(obj);  // ''{"name":"Alice"}'' (function lost)

// ✅ Solution: Convert functions to strings or exclude
JSON.stringify(obj, (key, value) => {
    if (typeof value === "function") {
        return value.toString();
    }
    return value;
});
```

---

## Key Takeaways

1. **JSON.stringify()**: Converts JavaScript to JSON string
2. **JSON.parse()**: Converts JSON string to JavaScript
3. **Replacer**: Filter/transform during stringify
4. **Reviver**: Transform during parse
5. **Error Handling**: Always handle parse errors
6. **API Integration**: JSON is standard for APIs
7. **Best Practice**: Use try-catch for parsing
8. **Common Patterns**: Deep clone, compare, filter

---

## Quiz: JSON

Test your understanding with these questions:

1. **JSON.stringify() converts:**
   - A) JSON to object
   - B) Object to JSON string
   - C) String to object
   - D) Nothing

2. **JSON.parse() converts:**
   - A) JSON string to object
   - B) Object to JSON
   - C) String to number
   - D) Nothing

3. **Replacer function is used with:**
   - A) JSON.parse()
   - B) JSON.stringify()
   - C) Both
   - D) Neither

4. **Reviver function is used with:**
   - A) JSON.parse()
   - B) JSON.stringify()
   - C) Both
   - D) Neither

5. **JSON.stringify() excludes:**
   - A) undefined
   - B) functions
   - C) Both A and B
   - D) Nothing

6. **Circular references cause:**
   - A) Error in stringify
   - B) Infinite loop
   - C) Both A and B
   - D) Nothing

7. **Pretty printing uses:**
   - A) Space parameter
   - B) Tab parameter
   - C) Both A and B
   - D) Neither

**Answers**:
1. B) Object to JSON string
2. A) JSON string to object
3. B) JSON.stringify()
4. A) JSON.parse()
5. C) Both A and B
6. A) Error in stringify
7. C) Both A and B (space parameter can be number or string)

---

## Next Steps

Congratulations! You''ve completed Module 12: Working with APIs. You now know:
- How to use the Fetch API
- How to use Axios
- How to work with JSON data
- Complete API integration

**What''s Next?**
- Course 3: DOM Manipulation and Events
- Module 13: DOM Basics
- Learn to manipulate web pages
- Build interactive web applications

---

## Additional Resources

- **MDN: JSON**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON)
- **JSON.org**: [json.org](https://www.json.org/)
- **JSON Guide**: Comprehensive JSON patterns and best practices

---

*Lesson completed! You''ve finished Module 12: Working with APIs. Ready for Course 3: DOM Manipulation and Events!*

', NULL, 3, '2026-01-03 09:51:41', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use `JSON.stringify()` to convert objects to JSON
- Use `JSON.parse()` to convert JSON to objects
- Handle JSON data from APIs
- Work with nested JSON structures
- Use JSON with common patterns
- Handle JSON errors
- Manipulate JSON data effectively');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (142, 53, 12, 'DOM Basics', 'dom-basics', '# Lesson 13.1: DOM Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what the DOM is
- Understand the DOM tree structure
- Differentiate between nodes and elements
- Access DOM elements using various methods
- Navigate the DOM tree
- Work with the document object
- Understand DOM relationships

---

## Introduction to the DOM

The Document Object Model (DOM) is a programming interface for HTML and XML documents. It represents the page structure as a tree of objects that can be manipulated with JavaScript.

### What is the DOM?

- **Tree Structure**: Represents HTML as a tree
- **Programmatic Access**: JavaScript can access and modify it
- **Live Representation**: Changes reflect in the browser
- **Standard API**: Cross-browser standard
- **Dynamic**: Can be modified at runtime

### Why Learn the DOM?

- **Interactive Web Pages**: Make pages dynamic
- **User Interaction**: Respond to user actions
- **Content Updates**: Change page content dynamically
- **Modern Web Development**: Essential for web apps

---

## DOM Tree Structure

### HTML to DOM Tree

```html
<!DOCTYPE html>
<html>
<head>
    <title>My Page</title>
</head>
<body>
    <h1>Hello</h1>
    <p>World</p>
</body>
</html>
```

**DOM Tree:**
```
Document
└── html
    ├── head
    │   └── title
    │       └── "My Page"
    └── body
        ├── h1
        │   └── "Hello"
        └── p
            └── "World"
```

### Understanding the Tree

- **Root**: `document` object
- **Nodes**: Every part of the tree (elements, text, attributes)
- **Elements**: HTML tags (div, p, h1, etc.)
- **Text Nodes**: Text content
- **Attributes**: Properties of elements (id, class, etc.)

---

## Nodes vs Elements

### Nodes

A node is any object in the DOM tree. Types include:
- **Element Node**: HTML elements (div, p, etc.)
- **Text Node**: Text content
- **Attribute Node**: Attributes (id, class, etc.)
- **Comment Node**: HTML comments
- **Document Node**: The document itself

### Elements

An element is a specific type of node representing HTML tags.

### Example

```html
<div id="container">Hello World</div>
```

- **Element Node**: `<div>` element
- **Attribute Node**: `id="container"`
- **Text Node**: "Hello World"

---

## The document Object

The `document` object represents the entire HTML document.

### Accessing document

```javascript
// document is available globally
console.log(document);
console.log(document.documentElement);  // <html> element
console.log(document.body);            // <body> element
console.log(document.head);            // <head> element
```

### Document Properties

```javascript
console.log(document.title);        // Page title
console.log(document.URL);          // Page URL
console.log(document.domain);       // Domain name
console.log(document.readyState);   // Loading state
```

---

## Accessing Elements

### getElementById()

Get element by its ID attribute:

```javascript
// HTML: <div id="myDiv">Content</div>
let element = document.getElementById(''myDiv'');
console.log(element);  // <div id="myDiv">Content</div>
```

**Note**: Returns `null` if element not found.

### getElementsByClassName()

Get elements by class name (returns HTMLCollection):

```javascript
// HTML: <div class="item">1</div><div class="item">2</div>
let elements = document.getElementsByClassName(''item'');
console.log(elements.length);  // 2
console.log(elements[0]);     // First element
```

### getElementsByTagName()

Get elements by tag name (returns HTMLCollection):

```javascript
// HTML: <p>Para 1</p><p>Para 2</p>
let paragraphs = document.getElementsByTagName(''p'');
console.log(paragraphs.length);  // 2
```

### querySelector()

Get first element matching CSS selector:

```javascript
// Get by ID
let element = document.querySelector(''#myDiv'');

// Get by class
let element = document.querySelector(''.myClass'');

// Get by tag
let element = document.querySelector(''p'');

// Complex selector
let element = document.querySelector(''div.container > p'');
```

### querySelectorAll()

Get all elements matching CSS selector (returns NodeList):

```javascript
// Get all elements with class
let elements = document.querySelectorAll(''.item'');

// Get all paragraphs
let paragraphs = document.querySelectorAll(''p'');

// Complex selector
let elements = document.querySelectorAll(''div.container p'');
```

### Comparison

| Method | Returns | Live Collection | Selector Support |
|--------|---------|----------------|------------------|
| `getElementById()` | Single element | No | No |
| `getElementsByClassName()` | HTMLCollection | Yes | No |
| `getElementsByTagName()` | HTMLCollection | Yes | No |
| `querySelector()` | Single element | No | Yes |
| `querySelectorAll()` | NodeList | No | Yes |

---

## HTMLCollection vs NodeList

### HTMLCollection

- **Live**: Updates when DOM changes
- **Array-like**: Can use index, length
- **Methods**: Limited (no forEach in older browsers)

```javascript
let items = document.getElementsByClassName(''item'');
console.log(items.length);  // Current count

// Add new element
document.body.appendChild(document.createElement(''div'')).className = ''item'';
console.log(items.length);  // Updated count (live)
```

### NodeList

- **Static**: Doesn''t update (querySelectorAll)
- **Array-like**: Can use index, length
- **Methods**: forEach, entries, keys, values

```javascript
let items = document.querySelectorAll(''.item'');
console.log(items.length);  // Current count

// Add new element
document.body.appendChild(document.createElement(''div'')).className = ''item'';
console.log(items.length);  // Same count (static)
```

### Converting to Array

```javascript
// HTMLCollection to Array
let items = Array.from(document.getElementsByClassName(''item''));

// NodeList to Array
let items = Array.from(document.querySelectorAll(''.item''));

// Or use spread
let items = [...document.querySelectorAll(''.item'')];
```

---

## Practical Examples

### Example 1: Accessing Elements

```html
<!DOCTYPE html>
<html>
<body>
    <div id="container">
        <h1 class="title">Hello</h1>
        <p class="text">World</p>
        <p class="text">JavaScript</p>
    </div>
</body>
</html>
```

```javascript
// Get by ID
let container = document.getElementById(''container'');

// Get by class
let titles = document.getElementsByClassName(''title'');
let texts = document.getElementsByClassName(''text'');

// Get by tag
let paragraphs = document.getElementsByTagName(''p'');

// Query selector
let firstText = document.querySelector(''.text'');
let allTexts = document.querySelectorAll(''.text'');

// Complex selector
let textInContainer = document.querySelector(''#container .text'');
```

### Example 2: Checking Element Existence

```javascript
function getElementSafely(id) {
    let element = document.getElementById(id);
    if (element) {
        return element;
    } else {
        console.warn(`Element with id "${id}" not found`);
        return null;
    }
}

let element = getElementSafely(''myDiv'');
if (element) {
    // Work with element
    console.log(element);
}
```

### Example 3: Working with Collections

```javascript
// Get all buttons
let buttons = document.querySelectorAll(''button'');

// Iterate with forEach
buttons.forEach((button, index) => {
    console.log(`Button ${index}:`, button.textContent);
});

// Convert to array and use array methods
let buttonArray = Array.from(buttons);
let buttonTexts = buttonArray.map(btn => btn.textContent);
```

---

## Practice Exercise

### Exercise: DOM Navigation

**Objective**: Practice accessing and navigating DOM elements.

**Instructions**:

1. Create an HTML file with various elements
2. Create a JavaScript file to access elements
3. Practice:
   - Using all element access methods
   - Working with HTMLCollection and NodeList
   - Navigating the DOM tree
   - Checking element existence

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Navigation Practice</title>
</head>
<body>
    <div id="container">
        <h1 class="title">My Page</h1>
        <p class="text">First paragraph</p>
        <p class="text">Second paragraph</p>
        <ul id="list">
            <li class="item">Item 1</li>
            <li class="item">Item 2</li>
            <li class="item">Item 3</li>
        </ul>
        <button class="btn">Click Me</button>
        <button class="btn">Another Button</button>
    </div>
    <script src="dom-navigation.js"></script>
</body>
</html>
```

```javascript
// dom-navigation.js
console.log("=== DOM Navigation Practice ===");

console.log("\\n=== Document Object ===");
console.log("Document:", document);
console.log("Document title:", document.title);
console.log("Document URL:", document.URL);
console.log("Document body:", document.body);
console.log("Document head:", document.head);

console.log("\\n=== getElementById() ===");
let container = document.getElementById(''container'');
console.log("Container:", container);
console.log("Container ID:", container.id);
console.log("Container tag name:", container.tagName);

let list = document.getElementById(''list'');
console.log("List:", list);
console.log("List children count:", list.children.length);

console.log("\\n=== getElementsByClassName() ===");
let texts = document.getElementsByClassName(''text'');
console.log("Text elements count:", texts.length);
console.log("First text:", texts[0].textContent);
console.log("Second text:", texts[1].textContent);

let items = document.getElementsByClassName(''item'');
console.log("Item elements count:", items.length);
for (let i = 0; i < items.length; i++) {
    console.log(`Item ${i + 1}:`, items[i].textContent);
}

let buttons = document.getElementsByClassName(''btn'');
console.log("Button elements count:", buttons.length);

console.log("\\n=== getElementsByTagName() ===");
let paragraphs = document.getElementsByTagName(''p'');
console.log("Paragraphs count:", paragraphs.length);

let listItems = document.getElementsByTagName(''li'');
console.log("List items count:", listItems.length);

let allDivs = document.getElementsByTagName(''div'');
console.log("Divs count:", allDivs.length);

console.log("\\n=== querySelector() ===");
let firstText = document.querySelector(''.text'');
console.log("First text element:", firstText.textContent);

let title = document.querySelector(''.title'');
console.log("Title:", title.textContent);

let firstButton = document.querySelector(''.btn'');
console.log("First button:", firstButton.textContent);

let containerQuery = document.querySelector(''#container'');
console.log("Container via querySelector:", containerQuery.id);

let nestedItem = document.querySelector(''#list .item'');
console.log("First nested item:", nestedItem.textContent);

console.log("\\n=== querySelectorAll() ===");
let allTexts = document.querySelectorAll(''.text'');
console.log("All text elements:", allTexts.length);
allTexts.forEach((text, index) => {
    console.log(`Text ${index + 1}:`, text.textContent);
});

let allItems = document.querySelectorAll(''.item'');
console.log("All items:", allItems.length);
allItems.forEach((item, index) => {
    console.log(`Item ${index + 1}:`, item.textContent);
});

let allButtons = document.querySelectorAll(''.btn'');
console.log("All buttons:", allButtons.length);
allButtons.forEach((btn, index) => {
    console.log(`Button ${index + 1}:`, btn.textContent);
});

console.log("\\n=== Complex Selectors ===");
let itemsInList = document.querySelectorAll(''#list .item'');
console.log("Items in list:", itemsInList.length);

let buttonsInContainer = document.querySelectorAll(''#container .btn'');
console.log("Buttons in container:", buttonsInContainer.length);

let directChildren = document.querySelectorAll(''#container > p'');
console.log("Direct paragraph children:", directChildren.length);

console.log("\\n=== HTMLCollection vs NodeList ===");
let classCollection = document.getElementsByClassName(''text'');
let queryNodeList = document.querySelectorAll(''.text'');

console.log("HTMLCollection length:", classCollection.length);
console.log("NodeList length:", queryNodeList.length);

// Add new element
let newP = document.createElement(''p'');
newP.className = ''text'';
newP.textContent = ''New paragraph'';
document.getElementById(''container'').appendChild(newP);

console.log("After adding element:");
console.log("HTMLCollection length (live):", classCollection.length);
console.log("NodeList length (static):", queryNodeList.length);

console.log("\\n=== Converting to Array ===");
let itemsArray = Array.from(items);
console.log("Items as array:", itemsArray);
console.log("Can use array methods:", itemsArray.map(item => item.textContent));

let buttonsArray = [...allButtons];
console.log("Buttons as array:", buttonsArray);
console.log("Button texts:", buttonsArray.map(btn => btn.textContent));

console.log("\\n=== Checking Element Existence ===");
function getElementSafely(id) {
    let element = document.getElementById(id);
    if (element) {
        return element;
    } else {
        console.warn(`Element with id "${id}" not found`);
        return null;
    }
}

let existing = getElementSafely(''container'');
console.log("Existing element:", existing ? existing.id : "null");

let missing = getElementSafely(''nonExistent'');
console.log("Missing element:", missing);

console.log("\\n=== Element Properties ===");
if (container) {
    console.log("Container ID:", container.id);
    console.log("Container className:", container.className);
    console.log("Container tagName:", container.tagName);
    console.log("Container textContent:", container.textContent);
    console.log("Container innerHTML:", container.innerHTML.substring(0, 50) + "...");
}
```

**Expected Output** (in browser console):
```
=== DOM Navigation Practice ===

=== Document Object ===
Document: [Document object]
Document title: DOM Navigation Practice
Document URL: [current URL]
Document body: [body element]
Document head: [head element]

=== getElementById() ===
Container: [div#container]
Container ID: container
Container tag name: DIV
List: [ul#list]
List children count: 3

=== getElementsByClassName() ===
Text elements count: 2
First text: First paragraph
Second text: Second paragraph
Item elements count: 3
Item 1: Item 1
Item 2: Item 2
Item 3: Item 3
Button elements count: 2

=== getElementsByTagName() ===
Paragraphs count: 2
List items count: 3
Divs count: 1

=== querySelector() ===
First text element: First paragraph
Title: My Page
First button: Click Me
Container via querySelector: container
First nested item: Item 1

=== querySelectorAll() ===
All text elements: 2
Text 1: First paragraph
Text 2: Second paragraph
All items: 3
Item 1: Item 1
Item 2: Item 2
Item 3: Item 3
All buttons: 2
Button 1: Click Me
Button 2: Another Button

=== Complex Selectors ===
Items in list: 3
Buttons in container: 2
Direct paragraph children: 2

=== HTMLCollection vs NodeList ===
HTMLCollection length: 2
NodeList length: 2
After adding element:
HTMLCollection length (live): 3
NodeList length (static): 2

=== Converting to Array ===
Items as array: [array of elements]
Can use array methods: ["Item 1", "Item 2", "Item 3"]
Buttons as array: [array of elements]
Button texts: ["Click Me", "Another Button"]

=== Checking Element Existence ===
Existing element: container
Missing element: null

=== Element Properties ===
Container ID: container
Container className: 
Container tagName: DIV
Container textContent: [all text content]
Container innerHTML: [HTML content]
```

**Challenge (Optional)**:
- Build a DOM inspector tool
- Create element finder utilities
- Build a DOM navigation helper
- Create element validation functions

---

## Common Mistakes

### 1. Not Checking for null

```javascript
// ⚠️ Problem: Element might not exist
let element = document.getElementById(''myDiv'');
element.textContent = "Hello";  // Error if element is null

// ✅ Solution: Always check
let element = document.getElementById(''myDiv'');
if (element) {
    element.textContent = "Hello";
}
```

### 2. Confusing HTMLCollection and Array

```javascript
// ⚠️ Problem: HTMLCollection doesn''t have all array methods
let items = document.getElementsByClassName(''item'');
items.forEach(item => { });  // Error in older browsers

// ✅ Solution: Convert to array
let items = Array.from(document.getElementsByClassName(''item''));
items.forEach(item => { });
```

### 3. Using Wrong Method

```javascript
// ⚠️ Problem: getElementById doesn''t accept selector
let element = document.getElementById(''.myClass'');  // Wrong

// ✅ Solution: Use appropriate method
let element = document.querySelector(''.myClass'');
// or
let element = document.getElementsByClassName(''myClass'')[0];
```

### 4. Forgetting Live Collections

```javascript
// ⚠️ Problem: Collection updates automatically
let items = document.getElementsByClassName(''item'');
console.log(items.length);  // 3

// Add new item
document.body.appendChild(createItem());

console.log(items.length);  // 4 (updated automatically)

// ✅ Solution: Be aware of live collections
// Or use querySelectorAll for static collection
```

---

## Key Takeaways

1. **DOM**: Tree structure representing HTML
2. **Nodes**: All objects in DOM tree
3. **Elements**: Specific type of node (HTML tags)
4. **Access Methods**: getElementById, querySelector, etc.
5. **HTMLCollection**: Live collection (updates automatically)
6. **NodeList**: Static collection (from querySelectorAll)
7. **Best Practice**: Always check for null, use querySelector for flexibility
8. **Modern Approach**: Prefer querySelector/querySelectorAll

---

## Quiz: DOM Basics

Test your understanding with these questions:

1. **What does DOM stand for?**
   - A) Document Object Model
   - B) Data Object Model
   - C) Document Order Model
   - D) Data Order Model

2. **getElementById returns:**
   - A) Array
   - B) Single element or null
   - C) HTMLCollection
   - D) NodeList

3. **querySelectorAll returns:**
   - A) HTMLCollection
   - B) NodeList
   - C) Array
   - D) Single element

4. **HTMLCollection is:**
   - A) Static
   - B) Live
   - C) Both
   - D) Neither

5. **querySelector supports:**
   - A) ID only
   - B) Class only
   - C) CSS selectors
   - D) Tag only

6. **document represents:**
   - A) Body element
   - B) HTML element
   - C) Entire document
   - D) Head element

7. **Which is most flexible?**
   - A) getElementById
   - B) getElementsByClassName
   - C) querySelector
   - D) getElementsByTagName

**Answers**:
1. A) Document Object Model
2. B) Single element or null
3. B) NodeList
4. B) Live
5. C) CSS selectors
6. C) Entire document
7. C) querySelector

---

## Next Steps

Congratulations! You''ve learned DOM basics. You now know:
- What the DOM is
- How to access elements
- Different access methods
- HTMLCollection vs NodeList

**What''s Next?**
- Lesson 13.2: Manipulating the DOM
- Learn to create and modify elements
- Change content dynamically
- Build interactive web pages

---

## Additional Resources

- **MDN: DOM**: [developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model](https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model)
- **MDN: Document**: [developer.mozilla.org/en-US/docs/Web/API/Document](https://developer.mozilla.org/en-US/docs/Web/API/Document)
- **JavaScript.info: DOM**: [javascript.info/dom-nodes](https://javascript.info/dom-nodes)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:52:47', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what the DOM is
- Understand the DOM tree structure
- Differentiate between nodes and elements
- Access DOM elements using various methods
- Navigate the DOM tree
- Work with the document object
- Understand DOM relationships');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (143, 53, 12, 'Manipulating the DOM', 'manipulating-the-dom', '# Lesson 13.2: Manipulating the DOM

## Learning Objectives

By the end of this lesson, you will be able to:
- Create new DOM elements
- Add elements to the DOM
- Remove elements from the DOM
- Modify element content (text and HTML)
- Change element attributes
- Add and remove CSS classes
- Update element styles
- Build dynamic web pages

---

## Introduction to DOM Manipulation

DOM manipulation allows you to dynamically change the content, structure, and appearance of web pages using JavaScript.

### Why Manipulate the DOM?

- **Dynamic Content**: Update page without reload
- **User Interaction**: Respond to user actions
- **Real-time Updates**: Show live data
- **Interactive UIs**: Build modern web applications

---

## Creating Elements

### createElement()

Create a new HTML element:

```javascript
// Create a div element
let div = document.createElement(''div'');

// Create a paragraph
let paragraph = document.createElement(''p'');

// Create a button
let button = document.createElement(''button'');
```

### Setting Element Properties

```javascript
let div = document.createElement(''div'');
div.id = ''myDiv'';
div.className = ''container'';
div.textContent = ''Hello World'';
```

### Creating Elements with Attributes

```javascript
let link = document.createElement(''a'');
link.href = ''https://example.com'';
link.textContent = ''Visit Example'';
link.target = ''_blank'';
```

---

## Adding Elements to DOM

### appendChild()

Add element as the last child:

```javascript
let container = document.getElementById(''container'');
let newDiv = document.createElement(''div'');
newDiv.textContent = ''New content'';
container.appendChild(newDiv);
```

### insertBefore()

Insert element before another element:

```javascript
let container = document.getElementById(''container'');
let newDiv = document.createElement(''div'');
let existingDiv = document.getElementById(''existing'');
container.insertBefore(newDiv, existingDiv);
```

### insertAdjacentElement()

Insert element at specific position:

```javascript
let element = document.getElementById(''target'');

// beforebegin: Before element
element.insertAdjacentElement(''beforebegin'', newElement);

// afterbegin: First child
element.insertAdjacentElement(''afterbegin'', newElement);

// beforeend: Last child
element.insertAdjacentElement(''beforeend'', newElement);

// afterend: After element
element.insertAdjacentElement(''afterend'', newElement);
```

### prepend() and append()

Modern methods (may need polyfill for older browsers):

```javascript
let container = document.getElementById(''container'');

// Add at beginning
container.prepend(newElement);

// Add at end
container.append(newElement);
```

---

## Removing Elements

### removeChild()

Remove a child element:

```javascript
let container = document.getElementById(''container'');
let child = document.getElementById(''child'');
container.removeChild(child);
```

### remove()

Modern method to remove element:

```javascript
let element = document.getElementById(''myElement'');
element.remove();
```

### Clearing All Children

```javascript
let container = document.getElementById(''container'');

// Method 1: Remove all children
while (container.firstChild) {
    container.removeChild(container.firstChild);
}

// Method 2: Clear innerHTML
container.innerHTML = '''';

// Method 3: Modern way
container.replaceChildren();
```

---

## Modifying Element Content

### textContent

Get or set text content (strips HTML):

```javascript
let element = document.getElementById(''myDiv'');

// Get text content
console.log(element.textContent);  // "Hello World"

// Set text content
element.textContent = ''New text'';
```

### innerHTML

Get or set HTML content:

```javascript
let element = document.getElementById(''myDiv'');

// Get HTML
console.log(element.innerHTML);  // "<span>Hello</span>"

// Set HTML
element.innerHTML = ''<strong>Bold text</strong>'';
```

### innerText

Get or set visible text (respects CSS):

```javascript
let element = document.getElementById(''myDiv'');
element.innerText = ''Visible text'';
```

### Comparison

| Property | Gets | Sets | HTML Support |
|----------|------|------|--------------|
| `textContent` | All text | Plain text | No |
| `innerHTML` | HTML string | HTML string | Yes |
| `innerText` | Visible text | Plain text | No |

---

## Changing Attributes

### getAttribute() and setAttribute()

```javascript
let element = document.getElementById(''myLink'');

// Get attribute
let href = element.getAttribute(''href'');

// Set attribute
element.setAttribute(''href'', ''https://example.com'');
element.setAttribute(''target'', ''_blank'');
element.setAttribute(''data-id'', ''123'');
```

### Direct Property Access

```javascript
let element = document.getElementById(''myLink'');

// Set properties directly
element.href = ''https://example.com'';
element.id = ''newId'';
element.className = ''newClass'';
```

### hasAttribute() and removeAttribute()

```javascript
let element = document.getElementById(''myDiv'');

// Check if attribute exists
if (element.hasAttribute(''data-id'')) {
    console.log(''Has data-id'');
}

// Remove attribute
element.removeAttribute(''data-id'');
```

### data-* Attributes

```javascript
let element = document.getElementById(''myDiv'');

// Set data attribute
element.setAttribute(''data-user-id'', ''123'');
element.setAttribute(''data-status'', ''active'');

// Access via dataset
console.log(element.dataset.userId);  // "123"
console.log(element.dataset.status);  // "active"

// Set via dataset
element.dataset.userId = ''456'';
element.dataset.newAttribute = ''value'';
```

---

## Working with Classes

### className

Get or set all classes:

```javascript
let element = document.getElementById(''myDiv'');

// Get classes
console.log(element.className);  // "class1 class2"

// Set classes
element.className = ''newClass'';
element.className = ''class1 class2 class3'';
```

### classList

Modern API for class manipulation:

```javascript
let element = document.getElementById(''myDiv'');

// Add class
element.classList.add(''newClass'');
element.classList.add(''class1'', ''class2'');

// Remove class
element.classList.remove(''oldClass'');
element.classList.remove(''class1'', ''class2'');

// Toggle class
element.classList.toggle(''active'');

// Check if has class
if (element.classList.contains(''active'')) {
    console.log(''Has active class'');
}

// Replace class
element.classList.replace(''oldClass'', ''newClass'');
```

### classList Methods

```javascript
let element = document.getElementById(''myDiv'');

// Add multiple classes
element.classList.add(''class1'', ''class2'', ''class3'');

// Remove multiple classes
element.classList.remove(''class1'', ''class2'');

// Toggle with condition
element.classList.toggle(''active'', true);   // Force add
element.classList.toggle(''active'', false);  // Force remove

// Get all classes as array
let classes = Array.from(element.classList);
console.log(classes);  // ["class1", "class2"]
```

---

## Changing Styles

### style Property

Set inline styles:

```javascript
let element = document.getElementById(''myDiv'');

// Set individual styles
element.style.color = ''red'';
element.style.backgroundColor = ''blue'';
element.style.fontSize = ''20px'';
element.style.display = ''none'';
```

### style Property (camelCase)

CSS properties use camelCase in JavaScript:

```javascript
element.style.backgroundColor = ''red'';      // background-color
element.style.fontSize = ''16px'';           // font-size
element.style.marginTop = ''10px'';          // margin-top
element.style.zIndex = ''100'';              // z-index
```

### getComputedStyle()

Get computed styles (including CSS):

```javascript
let element = document.getElementById(''myDiv'');
let styles = window.getComputedStyle(element);

console.log(styles.color);
console.log(styles.backgroundColor);
console.log(styles.fontSize);
```

### Setting Multiple Styles

```javascript
// Method 1: Individual properties
element.style.color = ''red'';
element.style.fontSize = ''20px'';

// Method 2: cssText
element.style.cssText = ''color: red; font-size: 20px; background: blue;'';

// Method 3: Object.assign
Object.assign(element.style, {
    color: ''red'',
    fontSize: ''20px'',
    backgroundColor: ''blue''
});
```

---

## Practical Examples

### Example 1: Creating a List

```javascript
function createList(items) {
    let ul = document.createElement(''ul'');
    
    items.forEach(item => {
        let li = document.createElement(''li'');
        li.textContent = item;
        ul.appendChild(li);
    });
    
    return ul;
}

let list = createList([''Apple'', ''Banana'', ''Orange'']);
document.body.appendChild(list);
```

### Example 2: Dynamic Card Creation

```javascript
function createCard(title, content) {
    let card = document.createElement(''div'');
    card.className = ''card'';
    
    let cardTitle = document.createElement(''h2'');
    cardTitle.textContent = title;
    cardTitle.className = ''card-title'';
    
    let cardContent = document.createElement(''p'');
    cardContent.textContent = content;
    cardContent.className = ''card-content'';
    
    card.appendChild(cardTitle);
    card.appendChild(cardContent);
    
    return card;
}

let card = createCard(''My Title'', ''Card content here'');
document.getElementById(''container'').appendChild(card);
```

### Example 3: Toggle Visibility

```javascript
function toggleElement(elementId) {
    let element = document.getElementById(elementId);
    
    if (element.style.display === ''none'') {
        element.style.display = ''block'';
    } else {
        element.style.display = ''none'';
    }
}

// Or using classList
function toggleElement(elementId) {
    let element = document.getElementById(elementId);
    element.classList.toggle(''hidden'');
}
```

### Example 4: Form Validation Display

```javascript
function showError(inputId, message) {
    let input = document.getElementById(inputId);
    
    // Remove existing error
    let existingError = input.parentElement.querySelector(''.error'');
    if (existingError) {
        existingError.remove();
    }
    
    // Add error class
    input.classList.add(''error'');
    
    // Create error message
    let errorDiv = document.createElement(''div'');
    errorDiv.className = ''error'';
    errorDiv.textContent = message;
    errorDiv.style.color = ''red'';
    
    input.parentElement.appendChild(errorDiv);
}
```

---

## Practice Exercise

### Exercise: DOM Manipulation

**Objective**: Practice creating, modifying, and removing DOM elements.

**Instructions**:

1. Create an HTML file with a container
2. Create a JavaScript file for manipulation
3. Practice:
   - Creating elements
   - Adding elements
   - Removing elements
   - Modifying content
   - Changing attributes and classes
   - Updating styles

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Manipulation Practice</title>
    <style>
        .card {
            border: 1px solid #ccc;
            padding: 20px;
            margin: 10px;
            border-radius: 5px;
        }
        .highlight {
            background-color: yellow;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>DOM Manipulation Practice</h1>
        <button id="addBtn">Add Card</button>
        <button id="removeBtn">Remove Last</button>
        <button id="toggleBtn">Toggle Highlight</button>
    </div>
    <script src="dom-manipulation.js"></script>
</body>
</html>
```

```javascript
// dom-manipulation.js
console.log("=== DOM Manipulation Practice ===");

console.log("\\n=== Creating Elements ===");

// Create a div
let div = document.createElement(''div'');
div.id = ''myDiv'';
div.className = ''card'';
div.textContent = ''Created with createElement'';
console.log("Created div:", div);

// Create a paragraph
let paragraph = document.createElement(''p'');
paragraph.textContent = ''This is a paragraph'';
paragraph.style.color = ''blue'';
console.log("Created paragraph:", paragraph);

// Create a button
let button = document.createElement(''button'');
button.textContent = ''Click Me'';
button.className = ''btn'';
button.setAttribute(''data-action'', ''click'');
console.log("Created button:", button);
console.log();

console.log("=== Adding Elements ===");

let container = document.getElementById(''container'');

// Append child
let newDiv = document.createElement(''div'');
newDiv.textContent = ''Appended element'';
newDiv.className = ''card'';
container.appendChild(newDiv);
console.log("Appended element to container");

// Insert before
let beforeDiv = document.createElement(''div'');
beforeDiv.textContent = ''Inserted before'';
beforeDiv.className = ''card'';
container.insertBefore(beforeDiv, newDiv);
console.log("Inserted element before");

// Using insertAdjacentElement
let adjacentDiv = document.createElement(''div'');
adjacentDiv.textContent = ''Adjacent element'';
adjacentDiv.className = ''card'';
container.insertAdjacentElement(''beforeend'', adjacentDiv);
console.log("Inserted adjacent element");
console.log();

console.log("=== Modifying Content ===");

let contentDiv = document.createElement(''div'');
contentDiv.id = ''contentDiv'';

// textContent
contentDiv.textContent = ''Plain text content'';
console.log("textContent:", contentDiv.textContent);

// innerHTML
contentDiv.innerHTML = ''<strong>Bold</strong> and <em>italic</em> text'';
console.log("innerHTML:", contentDiv.innerHTML);
console.log("textContent after innerHTML:", contentDiv.textContent);

container.appendChild(contentDiv);
console.log();

console.log("=== Changing Attributes ===");

let link = document.createElement(''a'');
link.href = ''https://example.com'';
link.textContent = ''Visit Example'';
link.target = ''_blank'';
link.setAttribute(''data-link-id'', ''123'');

console.log("Link href:", link.getAttribute(''href''));
console.log("Link target:", link.target);
console.log("Link data-id:", link.dataset.linkId);

// Update attributes
link.setAttribute(''href'', ''https://google.com'');
link.setAttribute(''data-link-id'', ''456'');
console.log("Updated href:", link.getAttribute(''href''));
console.log("Updated data-id:", link.dataset.linkId);
console.log();

console.log("=== Working with Classes ===");

let classDiv = document.createElement(''div'');
classDiv.className = ''card'';

// Add classes
classDiv.classList.add(''highlight'');
classDiv.classList.add(''active'', ''visible'');
console.log("Classes after add:", classDiv.className);

// Remove classes
classDiv.classList.remove(''active'');
console.log("Classes after remove:", classDiv.className);

// Toggle class
classDiv.classList.toggle(''highlight'');
console.log("Has highlight:", classDiv.classList.contains(''highlight''));

classDiv.classList.toggle(''highlight'');
console.log("Has highlight after toggle:", classDiv.classList.contains(''highlight''));

// Replace class
classDiv.classList.replace(''visible'', ''hidden'');
console.log("Classes after replace:", classDiv.className);
console.log();

console.log("=== Changing Styles ===");

let styleDiv = document.createElement(''div'');
styleDiv.textContent = ''Styled div'';
styleDiv.style.color = ''red'';
styleDiv.style.backgroundColor = ''yellow'';
styleDiv.style.padding = ''20px'';
styleDiv.style.border = ''2px solid black'';

console.log("Color:", styleDiv.style.color);
console.log("Background:", styleDiv.style.backgroundColor);

// Using cssText
let styleDiv2 = document.createElement(''div'');
styleDiv2.textContent = ''Styled with cssText'';
styleDiv2.style.cssText = ''color: blue; font-size: 20px; margin: 10px;'';

// Using Object.assign
let styleDiv3 = document.createElement(''div'');
styleDiv3.textContent = ''Styled with Object.assign'';
Object.assign(styleDiv3.style, {
    color: ''green'',
    fontSize: ''18px'',
    padding: ''15px''
});

container.appendChild(styleDiv);
container.appendChild(styleDiv2);
container.appendChild(styleDiv3);
console.log();

console.log("=== Removing Elements ===");

// Create elements to remove
let removeDiv1 = document.createElement(''div'');
removeDiv1.textContent = ''Will be removed'';
removeDiv1.id = ''removeMe'';
container.appendChild(removeDiv1);

let removeDiv2 = document.createElement(''div'');
removeDiv2.textContent = ''Will also be removed'';
container.appendChild(removeDiv2);

console.log("Container children before removal:", container.children.length);

// Remove by reference
container.removeChild(removeDiv1);
console.log("Removed first element");

// Remove using remove()
removeDiv2.remove();
console.log("Removed second element");

console.log("Container children after removal:", container.children.length);
console.log();

console.log("=== Practical Example: Card Creator ===");

function createCard(title, content, color = ''white'') {
    let card = document.createElement(''div'');
    card.className = ''card'';
    card.style.backgroundColor = color;
    
    let cardTitle = document.createElement(''h2'');
    cardTitle.textContent = title;
    cardTitle.style.marginTop = ''0'';
    
    let cardContent = document.createElement(''p'');
    cardContent.textContent = content;
    
    let removeBtn = document.createElement(''button'');
    removeBtn.textContent = ''Remove'';
    removeBtn.onclick = () => card.remove();
    
    card.appendChild(cardTitle);
    card.appendChild(cardContent);
    card.appendChild(removeBtn);
    
    return card;
}

// Add cards
let card1 = createCard(''Card 1'', ''This is the first card'', ''#f0f0f0'');
let card2 = createCard(''Card 2'', ''This is the second card'', ''#e0e0e0'');
let card3 = createCard(''Card 3'', ''This is the third card'', ''#d0d0d0'');

container.appendChild(card1);
container.appendChild(card2);
container.appendChild(card3);

console.log("Created 3 cards");
console.log();

console.log("=== Toggle Functionality ===");

let toggleDiv = document.createElement(''div'');
toggleDiv.id = ''toggleDiv'';
toggleDiv.textContent = ''This div can be toggled'';
toggleDiv.style.padding = ''10px'';
toggleDiv.style.border = ''1px solid black'';
container.appendChild(toggleDiv);

function toggleVisibility(elementId) {
    let element = document.getElementById(elementId);
    element.classList.toggle(''hidden'');
    console.log("Toggled visibility, is hidden:", element.classList.contains(''hidden''));
}

// Test toggle
toggleVisibility(''toggleDiv'');
toggleVisibility(''toggleDiv'');
console.log();

console.log("=== List Creator ===");

function createList(items) {
    let ul = document.createElement(''ul'');
    ul.style.listStyle = ''none'';
    ul.style.padding = ''0'';
    
    items.forEach((item, index) => {
        let li = document.createElement(''li'');
        li.textContent = item;
        li.style.padding = ''5px'';
        li.style.backgroundColor = index % 2 === 0 ? ''#f0f0f0'' : ''#ffffff'';
        ul.appendChild(li);
    });
    
    return ul;
}

let list = createList([''Apple'', ''Banana'', ''Orange'', ''Grape'', ''Mango'']);
container.appendChild(list);
console.log("Created list with", list.children.length, "items");
```

**Expected Output** (in browser console):
```
=== DOM Manipulation Practice ===

=== Creating Elements ===
Created div: [div element]
Created paragraph: [p element]
Created button: [button element]

=== Adding Elements ===
Appended element to container
Inserted element before
Inserted adjacent element

=== Modifying Content ===
textContent: Plain text content
innerHTML: <strong>Bold</strong> and <em>italic</em> text
textContent after innerHTML: Bold and italic text

=== Changing Attributes ===
Link href: https://example.com
Link target: _blank
Link data-id: 123
Updated href: https://google.com
Updated data-id: 456

=== Working with Classes ===
Classes after add: card highlight active visible
Classes after remove: card highlight visible
Has highlight: false
Has highlight after toggle: true
Classes after replace: card highlight hidden

=== Changing Styles ===
Color: red
Background: yellow

=== Removing Elements ===
Container children before removal: [number]
Removed first element
Removed second element
Container children after removal: [number]

=== Practical Example: Card Creator ===
Created 3 cards

=== Toggle Functionality ===
Toggled visibility, is hidden: true
Toggled visibility, is hidden: false

=== List Creator ===
Created list with 5 items
```

**Challenge (Optional)**:
- Build a dynamic form generator
- Create a todo list application
- Build a card-based UI system
- Create a dynamic table generator

---

## Common Mistakes

### 1. Using innerHTML with User Input

```javascript
// ⚠️ Security risk: XSS vulnerability
let userInput = "<img src=x onerror=''alert(1)''>";
element.innerHTML = userInput;  // Dangerous!

// ✅ Solution: Use textContent or sanitize
element.textContent = userInput;
// or use a sanitization library
```

### 2. Not Checking Element Existence

```javascript
// ⚠️ Problem: Element might not exist
let element = document.getElementById(''myDiv'');
element.appendChild(newElement);  // Error if element is null

// ✅ Solution: Always check
let element = document.getElementById(''myDiv'');
if (element) {
    element.appendChild(newElement);
}
```

### 3. Creating Elements in Loop Without Optimization

```javascript
// ⚠️ Problem: Multiple DOM updates
for (let i = 0; i < 1000; i++) {
    let div = document.createElement(''div'');
    container.appendChild(div);  // Updates DOM each time
}

// ✅ Solution: Use DocumentFragment
let fragment = document.createDocumentFragment();
for (let i = 0; i < 1000; i++) {
    let div = document.createElement(''div'');
    fragment.appendChild(div);
}
container.appendChild(fragment);  // Single DOM update
```

### 4. Confusing textContent and innerHTML

```javascript
// ⚠️ Problem: innerHTML doesn''t work as expected
element.innerHTML = ''<strong>Bold</strong>'';  // Renders HTML
element.textContent = ''<strong>Bold</strong>'';  // Shows as text

// ✅ Solution: Use appropriate property
// Use innerHTML for HTML, textContent for plain text
```

---

## Key Takeaways

1. **createElement()**: Create new elements
2. **appendChild()**: Add elements to DOM
3. **remove()**: Remove elements
4. **textContent**: Plain text content
5. **innerHTML**: HTML content
6. **setAttribute()**: Set attributes
7. **classList**: Modern class manipulation
8. **style**: Inline styles
9. **Best Practice**: Check for null, use DocumentFragment for multiple elements
10. **Security**: Be careful with innerHTML and user input

---

## Quiz: DOM Manipulation

Test your understanding with these questions:

1. **createElement() creates:**
   - A) Element in DOM
   - B) Element object (not in DOM)
   - C) Text node
   - D) Attribute

2. **appendChild() adds element:**
   - A) At beginning
   - B) At end
   - C) Before element
   - D) After element

3. **textContent:**
   - A) Includes HTML
   - B) Strips HTML
   - C) Renders HTML
   - D) Nothing

4. **innerHTML:**
   - A) Plain text only
   - B) Renders HTML
   - C) Strips HTML
   - D) Nothing

5. **classList.add() is:**
   - A) Old method
   - B) Modern method
   - C) Deprecated
   - D) Not available

6. **element.remove() is:**
   - A) Old method
   - B) Modern method
   - C) Not available
   - D) Error

7. **DocumentFragment is used for:**
   - A) Single element
   - B) Multiple elements (optimization)
   - C) Text nodes
   - D) Attributes

**Answers**:
1. B) Element object (not in DOM yet)
2. B) At end
3. B) Strips HTML
4. B) Renders HTML
5. B) Modern method
6. B) Modern method
7. B) Multiple elements (optimization)

---

## Next Steps

Congratulations! You''ve learned DOM manipulation. You now know:
- How to create elements
- How to add and remove elements
- How to modify content
- How to change attributes and classes

**What''s Next?**
- Lesson 13.3: DOM Traversal
- Learn to navigate the DOM tree
- Understand parent/child relationships
- Build more complex DOM operations

---

## Additional Resources

- **MDN: Element**: [developer.mozilla.org/en-US/docs/Web/API/Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)
- **MDN: Document.createElement()**: [developer.mozilla.org/en-US/docs/Web/API/Document/createElement](https://developer.mozilla.org/en-US/docs/Web/API/Document/createElement)
- **JavaScript.info: DOM Manipulation**: [javascript.info/modifying-document](https://javascript.info/modifying-document)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:52:47', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create new DOM elements
- Add elements to the DOM
- Remove elements from the DOM
- Modify element content (text and HTML)
- Change element attributes
- Add and remove CSS classes
- Update element styles
- Build dynamic web pages');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (144, 53, 12, 'DOM Traversal', 'dom-traversal', '# Lesson 13.3: DOM Traversal

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand parent, child, and sibling relationships
- Navigate up the DOM tree (parent nodes)
- Navigate down the DOM tree (child nodes)
- Navigate sideways (sibling nodes)
- Use traversal methods effectively
- Differentiate between Element and Node methods
- Build efficient DOM navigation code

---

## Introduction to DOM Traversal

DOM traversal is the process of moving through the DOM tree to access different nodes based on their relationships.

### Why Traverse the DOM?

- **Find Related Elements**: Access parent, children, siblings
- **Navigate Structure**: Move through DOM tree
- **Efficient Access**: Direct navigation vs searching
- **Dynamic Operations**: Work with element relationships

---

## Parent Nodes

### parentNode

Get the parent node:

```javascript
let element = document.getElementById(''child'');
let parent = element.parentNode;
console.log(parent);
```

### parentElement

Get the parent element (excludes non-element nodes):

```javascript
let element = document.getElementById(''child'');
let parent = element.parentElement;
console.log(parent);
```

### Difference

```javascript
// parentNode: Returns any node type
let textNode = document.createTextNode(''Hello'');
let parent = textNode.parentNode;  // Could be element or document

// parentElement: Returns only element nodes
let parent = textNode.parentElement;  // null if parent is not element
```

### Closest()

Find closest ancestor matching selector:

```javascript
let element = document.getElementById(''child'');
let container = element.closest(''.container'');
let div = element.closest(''div'');
```

---

## Child Nodes

### childNodes

Get all child nodes (including text nodes):

```javascript
let container = document.getElementById(''container'');
let children = container.childNodes;
console.log(children.length);  // Includes text nodes
```

### children

Get only element children:

```javascript
let container = document.getElementById(''container'');
let children = container.children;
console.log(children.length);  // Only element nodes
```

### firstChild and lastChild

Get first and last child nodes:

```javascript
let container = document.getElementById(''container'');
let first = container.firstChild;  // May be text node
let last = container.lastChild;    // May be text node
```

### firstElementChild and lastElementChild

Get first and last element children:

```javascript
let container = document.getElementById(''container'');
let first = container.firstElementChild;  // First element
let last = container.lastElementChild;    // Last element
```

### hasChildNodes()

Check if element has children:

```javascript
let container = document.getElementById(''container'');
if (container.hasChildNodes()) {
    console.log(''Has children'');
}
```

---

## Sibling Nodes

### nextSibling and previousSibling

Get next/previous sibling nodes:

```javascript
let element = document.getElementById(''middle'');
let next = element.nextSibling;      // May be text node
let previous = element.previousSibling; // May be text node
```

### nextElementSibling and previousElementSibling

Get next/previous element siblings:

```javascript
let element = document.getElementById(''middle'');
let next = element.nextElementSibling;      // Next element
let previous = element.previousElementSibling; // Previous element
```

---

## Element vs Node Methods

### Node Methods (All Nodes)

- `parentNode`
- `childNodes`
- `firstChild` / `lastChild`
- `nextSibling` / `previousSibling`

### Element Methods (Elements Only)

- `parentElement`
- `children`
- `firstElementChild` / `lastElementChild`
- `nextElementSibling` / `previousElementSibling`

### When to Use Each

**Use Node methods when:**
- You need to work with all node types
- Text nodes are important
- Working with document structure

**Use Element methods when:**
- You only care about elements
- Text nodes are whitespace
- More convenient for most cases

---

## Practical Examples

### Example 1: Finding Parent Container

```javascript
function findContainer(element) {
    let current = element;
    
    while (current) {
        if (current.classList && current.classList.contains(''container'')) {
            return current;
        }
        current = current.parentElement;
    }
    
    return null;
}

// Or using closest()
function findContainer(element) {
    return element.closest(''.container'');
}
```

### Example 2: Getting All Siblings

```javascript
function getAllSiblings(element) {
    let siblings = [];
    let parent = element.parentElement;
    
    if (parent) {
        let children = parent.children;
        for (let child of children) {
            if (child !== element) {
                siblings.push(child);
            }
        }
    }
    
    return siblings;
}
```

### Example 3: Getting All Children

```javascript
function getAllChildren(element) {
    return Array.from(element.children);
}

// Or get all including text nodes
function getAllChildNodes(element) {
    return Array.from(element.childNodes);
}
```

### Example 4: Finding Next Element

```javascript
function findNextElement(element, selector) {
    let current = element.nextElementSibling;
    
    while (current) {
        if (current.matches(selector)) {
            return current;
        }
        current = current.nextElementSibling;
    }
    
    return null;
}
```

### Example 5: Walking the Tree

```javascript
function walkTree(element, callback) {
    callback(element);
    
    let children = element.children;
    for (let child of children) {
        walkTree(child, callback);
    }
}

// Usage
walkTree(document.body, (element) => {
    console.log(element.tagName);
});
```

---

## Advanced Traversal

### matches()

Check if element matches selector:

```javascript
let element = document.getElementById(''myDiv'');
if (element.matches(''.container'')) {
    console.log(''Matches container class'');
}
```

### contains()

Check if element contains another element:

```javascript
let container = document.getElementById(''container'');
let child = document.getElementById(''child'');

if (container.contains(child)) {
    console.log(''Container contains child'');
}
```

### compareDocumentPosition()

Compare positions of two nodes:

```javascript
let element1 = document.getElementById(''elem1'');
let element2 = document.getElementById(''elem2'');

let position = element1.compareDocumentPosition(element2);

if (position & Node.DOCUMENT_POSITION_FOLLOWING) {
    console.log(''element2 follows element1'');
}
```

---

## Practice Exercise

### Exercise: DOM Traversal

**Objective**: Practice navigating the DOM tree using traversal methods.

**Instructions**:

1. Create an HTML file with nested structure
2. Create a JavaScript file for traversal
3. Practice:
   - Navigating to parent nodes
   - Accessing child nodes
   - Finding sibling nodes
   - Using Element vs Node methods
   - Building traversal utilities

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Traversal Practice</title>
</head>
<body>
    <div id="container" class="container">
        <h1 id="title">My Page</h1>
        <div class="section">
            <p id="para1" class="text">First paragraph</p>
            <p id="para2" class="text">Second paragraph</p>
            <p id="para3" class="text">Third paragraph</p>
        </div>
        <ul id="list">
            <li class="item">Item 1</li>
            <li class="item" id="middleItem">Item 2</li>
            <li class="item">Item 3</li>
        </ul>
    </div>
    <script src="dom-traversal.js"></script>
</body>
</html>
```

```javascript
// dom-traversal.js
console.log("=== DOM Traversal Practice ===");

console.log("\\n=== Parent Nodes ===");

let para1 = document.getElementById(''para1'');
console.log("Para1:", para1.textContent);

// parentNode
let parentNode = para1.parentNode;
console.log("Parent node:", parentNode.tagName);

// parentElement
let parentElement = para1.parentElement;
console.log("Parent element:", parentElement.tagName);

// closest()
let container = para1.closest(''.container'');
console.log("Closest container:", container.id);

let section = para1.closest(''.section'');
console.log("Closest section:", section.className);
console.log();

console.log("=== Child Nodes ===");

let container = document.getElementById(''container'');

// childNodes (includes text nodes)
console.log("Child nodes count:", container.childNodes.length);

// children (only elements)
console.log("Children count:", container.children.length);

// firstChild vs firstElementChild
console.log("First child node:", container.firstChild.nodeType);
console.log("First element child:", container.firstElementChild.tagName);

// lastChild vs lastElementChild
console.log("Last child node:", container.lastChild.nodeType);
console.log("Last element child:", container.lastElementChild.tagName);

// hasChildNodes()
console.log("Has child nodes:", container.hasChildNodes());
console.log();

console.log("=== Sibling Nodes ===");

let para2 = document.getElementById(''para2'');
console.log("Para2:", para2.textContent);

// nextSibling vs nextElementSibling
let nextSibling = para2.nextSibling;
console.log("Next sibling node type:", nextSibling ? nextSibling.nodeType : "null");
let nextElement = para2.nextElementSibling;
console.log("Next element sibling:", nextElement ? nextElement.id : "null");

// previousSibling vs previousElementSibling
let prevSibling = para2.previousSibling;
console.log("Previous sibling node type:", prevSibling ? prevSibling.nodeType : "null");
let prevElement = para2.previousElementSibling;
console.log("Previous element sibling:", prevElement ? prevElement.id : "null");
console.log();

console.log("=== Node vs Element Methods ===");

let list = document.getElementById(''list'');

console.log("Using Node methods:");
console.log("childNodes length:", list.childNodes.length);
console.log("firstChild:", list.firstChild.nodeType === Node.TEXT_NODE ? "Text node" : "Element");

console.log("\\nUsing Element methods:");
console.log("children length:", list.children.length);
console.log("firstElementChild:", list.firstElementChild.tagName);
console.log();

console.log("=== Finding Parent Container ===");

function findContainer(element) {
    return element.closest(''.container'');
}

let item = document.getElementById(''middleItem'');
let foundContainer = findContainer(item);
console.log("Container found:", foundContainer ? foundContainer.id : "null");
console.log();

console.log("=== Getting All Siblings ===");

function getAllSiblings(element) {
    let siblings = [];
    let parent = element.parentElement;
    
    if (parent) {
        let children = parent.children;
        for (let child of children) {
            if (child !== element) {
                siblings.push(child);
            }
        }
    }
    
    return siblings;
}

let middleItem = document.getElementById(''middleItem'');
let siblings = getAllSiblings(middleItem);
console.log("Siblings of middleItem:", siblings.length);
siblings.forEach((sibling, index) => {
    console.log(`Sibling ${index + 1}:`, sibling.textContent);
});
console.log();

console.log("=== Getting All Children ===");

function getAllChildren(element) {
    return Array.from(element.children);
}

let section = document.querySelector(''.section'');
let children = getAllChildren(section);
console.log("Children of section:", children.length);
children.forEach((child, index) => {
    console.log(`Child ${index + 1}:`, child.tagName, "-", child.textContent);
});
console.log();

console.log("=== Finding Next Element ===");

function findNextElement(element, selector) {
    let current = element.nextElementSibling;
    
    while (current) {
        if (current.matches(selector)) {
            return current;
        }
        current = current.nextElementSibling;
    }
    
    return null;
}

let para1 = document.getElementById(''para1'');
let nextText = findNextElement(para1, ''.text'');
console.log("Next text element after para1:", nextText ? nextText.id : "null");
console.log();

console.log("=== Walking the Tree ===");

function walkTree(element, callback, depth = 0) {
    callback(element, depth);
    
    let children = element.children;
    for (let child of children) {
        walkTree(child, callback, depth + 1);
    }
}

console.log("Tree structure:");
walkTree(document.getElementById(''container''), (element, depth) => {
    let indent = ''  ''.repeat(depth);
    console.log(`${indent}${element.tagName}${element.id ? ''#'' + element.id : ''''}${element.className ? ''.'' + element.className : ''''}`);
});
console.log();

console.log("=== matches() Method ===");

let element = document.getElementById(''para1'');
console.log("Para1 matches .text:", element.matches(''.text''));
console.log("Para1 matches p:", element.matches(''p''));
console.log("Para1 matches #para1:", element.matches(''#para1''));
console.log();

console.log("=== contains() Method ===");

let container = document.getElementById(''container'');
let para1 = document.getElementById(''para1'');
let title = document.getElementById(''title'');

console.log("Container contains para1:", container.contains(para1));
console.log("Container contains title:", container.contains(title));
console.log("Para1 contains container:", para1.contains(container));
console.log();

console.log("=== Navigation Utilities ===");

// Get all ancestors
function getAllAncestors(element) {
    let ancestors = [];
    let current = element.parentElement;
    
    while (current) {
        ancestors.push(current);
        current = current.parentElement;
    }
    
    return ancestors;
}

let item = document.getElementById(''middleItem'');
let ancestors = getAllAncestors(item);
console.log("Ancestors of middleItem:");
ancestors.forEach((ancestor, index) => {
    console.log(`  Level ${index + 1}:`, ancestor.tagName, ancestor.id || ancestor.className || '''');
});
console.log();

// Get all descendants
function getAllDescendants(element) {
    let descendants = [];
    let children = element.children;
    
    for (let child of children) {
        descendants.push(child);
        descendants.push(...getAllDescendants(child));
    }
    
    return descendants;
}

let container = document.getElementById(''container'');
let descendants = getAllDescendants(container);
console.log("Descendants of container:", descendants.length);
descendants.forEach((desc, index) => {
    console.log(`  ${index + 1}.`, desc.tagName, desc.id || desc.className || '''');
});
```

**Expected Output** (in browser console):
```
=== DOM Traversal Practice ===

=== Parent Nodes ===
Para1: First paragraph
Parent node: DIV
Parent element: DIV
Closest container: container
Closest section: section

=== Child Nodes ===
Child nodes count: [number including text nodes]
Children count: [number of elements only]
First child node: 3 (text node)
First element child: H1
Last child node: 3 (text node)
Last element child: UL
Has child nodes: true

=== Sibling Nodes ===
Para2: Second paragraph
Next sibling node type: 3 (text node)
Next element sibling: para3
Previous sibling node type: 3 (text node)
Previous element sibling: para1

=== Node vs Element Methods ===
Using Node methods:
childNodes length: [number]
firstChild: Text node

Using Element methods:
children length: 3
firstElementChild: LI

=== Finding Parent Container ===
Container found: container

=== Getting All Siblings ===
Siblings of middleItem: 2
Sibling 1: Item 1
Sibling 2: Item 3

=== Getting All Children ===
Children of section: 3
Child 1: P - First paragraph
Child 2: P - Second paragraph
Child 3: P - Third paragraph

=== Finding Next Element ===
Next text element after para1: para2

=== Walking the Tree ===
Tree structure:
DIV#container.container
  H1#title
  DIV.section
    P#para1.text
    P#para2.text
    P#para3.text
  UL#list
    LI.item
    LI#middleItem.item
    LI.item

=== matches() Method ===
Para1 matches .text: true
Para1 matches p: true
Para1 matches #para1: true

=== contains() Method ===
Container contains para1: true
Container contains title: true
Para1 contains container: false

=== Navigation Utilities ===
Ancestors of middleItem:
  Level 1: UL list
  Level 2: DIV container

Descendants of container: [number]
  1. H1 title
  2. DIV section
  3. P para1
  4. P para2
  5. P para3
  6. UL list
  7. LI item
  8. LI middleItem
  9. LI item
```

**Challenge (Optional)**:
- Build a DOM tree visualizer
- Create navigation utilities
- Build a breadcrumb generator
- Create element finder utilities

---

## Common Mistakes

### 1. Confusing Node and Element Methods

```javascript
// ⚠️ Problem: firstChild might be text node
let first = container.firstChild;
first.classList.add(''active'');  // Error if text node

// ✅ Solution: Use firstElementChild
let first = container.firstElementChild;
first.classList.add(''active'');
```

### 2. Not Checking for null

```javascript
// ⚠️ Problem: Sibling might not exist
let next = element.nextElementSibling;
next.classList.add(''active'');  // Error if null

// ✅ Solution: Always check
let next = element.nextElementSibling;
if (next) {
    next.classList.add(''active'');
}
```

### 3. Forgetting Text Nodes

```javascript
// ⚠️ Problem: childNodes includes text nodes
let children = container.childNodes;
children.forEach(child => {
    child.classList.add(''active'');  // Error for text nodes
});

// ✅ Solution: Use children or check node type
let children = container.children;
children.forEach(child => {
    child.classList.add(''active'');
});
```

### 4. Infinite Loops in Traversal

```javascript
// ⚠️ Problem: Circular reference
function traverse(element) {
    // No base case
    traverse(element.parentElement);  // Infinite loop
}

// ✅ Solution: Add base case
function traverse(element) {
    if (!element) return;  // Base case
    console.log(element);
    traverse(element.parentElement);
}
```

---

## Key Takeaways

1. **Parent Nodes**: parentNode, parentElement, closest()
2. **Child Nodes**: childNodes, children, firstChild, lastChild
3. **Sibling Nodes**: nextSibling, previousSibling, nextElementSibling, previousElementSibling
4. **Node Methods**: Work with all node types
5. **Element Methods**: Work only with elements (usually preferred)
6. **matches()**: Check if element matches selector
7. **contains()**: Check if element contains another
8. **Best Practice**: Use Element methods for most cases, check for null

---

## Quiz: DOM Traversal

Test your understanding with these questions:

1. **parentNode returns:**
   - A) Only elements
   - B) Any node type
   - C) Only text nodes
   - D) Nothing

2. **children returns:**
   - A) All nodes
   - B) Only elements
   - C) Only text nodes
   - D) Attributes

3. **nextElementSibling:**
   - A) Next node (any type)
   - B) Next element
   - C) Previous element
   - D) Parent element

4. **firstChild might be:**
   - A) Element only
   - B) Text node
   - C) Both A and B
   - D) Neither

5. **closest() finds:**
   - A) Child element
   - B) Ancestor element
   - C) Sibling element
   - D) Any element

6. **Element methods work with:**
   - A) All nodes
   - B) Elements only
   - C) Text nodes only
   - D) Attributes only

7. **contains() checks:**
   - A) If element contains another
   - B) If element is contained
   - C) If elements are siblings
   - D) If elements match

**Answers**:
1. B) Any node type
2. B) Only elements
3. B) Next element
4. C) Both A and B (could be text or element)
5. B) Ancestor element
6. B) Elements only
7. A) If element contains another

---

## Next Steps

Congratulations! You''ve completed Module 13: Document Object Model (DOM). You now know:
- How to access DOM elements
- How to manipulate the DOM
- How to traverse the DOM tree
- Complete DOM operations

**What''s Next?**
- Module 14: Events
- Lesson 14.1: Event Basics
- Learn to handle user interactions
- Build interactive web applications

---

## Additional Resources

- **MDN: Node**: [developer.mozilla.org/en-US/docs/Web/API/Node](https://developer.mozilla.org/en-US/docs/Web/API/Node)
- **MDN: Element**: [developer.mozilla.org/en-US/docs/Web/API/Element](https://developer.mozilla.org/en-US/docs/Web/API/Element)
- **JavaScript.info: DOM Navigation**: [javascript.info/dom-navigation](https://javascript.info/dom-navigation)

---

*Lesson completed! You''ve finished Module 13: Document Object Model (DOM). Ready for Module 14: Events!*

', NULL, 3, '2026-01-03 09:52:47', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand parent, child, and sibling relationships
- Navigate up the DOM tree (parent nodes)
- Navigate down the DOM tree (child nodes)
- Navigate sideways (sibling nodes)
- Use traversal methods effectively
- Differentiate between Element and Node methods
- Build efficient DOM navigation code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (145, 54, 12, 'Event Basics', 'event-basics', '# Lesson 14.1: Event Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what events are
- Recognize different event types
- Add event listeners using addEventListener
- Understand event objects
- Access event properties
- Remove event listeners
- Handle events effectively

---

## Introduction to Events

Events are actions or occurrences that happen in the browser, such as clicks, keyboard presses, or page loads. JavaScript can listen for these events and respond to them.

### What are Events?

- **User Actions**: Clicks, key presses, mouse movements
- **Browser Actions**: Page load, resize, scroll
- **Form Actions**: Submit, input, change
- **Network Actions**: Load, error, complete

### Why Events?

- **Interactivity**: Make pages respond to user actions
- **User Experience**: Create engaging interfaces
- **Dynamic Behavior**: Change page based on events
- **Modern Web**: Essential for web applications

---

## Event Types

### Mouse Events

```javascript
// click - Mouse click
element.addEventListener(''click'', handler);

// dblclick - Double click
element.addEventListener(''dblclick'', handler);

// mousedown - Mouse button pressed
element.addEventListener(''mousedown'', handler);

// mouseup - Mouse button released
element.addEventListener(''mouseup'', handler);

// mouseover - Mouse enters element
element.addEventListener(''mouseover'', handler);

// mouseout - Mouse leaves element
element.addEventListener(''mouseout'', handler);

// mousemove - Mouse moves over element
element.addEventListener(''mousemove'', handler);
```

### Keyboard Events

```javascript
// keydown - Key pressed down
element.addEventListener(''keydown'', handler);

// keyup - Key released
element.addEventListener(''keyup'', handler);

// keypress - Key pressed (deprecated, use keydown)
element.addEventListener(''keypress'', handler);
```

### Form Events

```javascript
// submit - Form submitted
form.addEventListener(''submit'', handler);

// change - Input value changed
input.addEventListener(''change'', handler);

// input - Input value changing (real-time)
input.addEventListener(''input'', handler);

// focus - Element receives focus
input.addEventListener(''focus'', handler);

// blur - Element loses focus
input.addEventListener(''blur'', handler);
```

### Window Events

```javascript
// load - Page loaded
window.addEventListener(''load'', handler);

// DOMContentLoaded - DOM ready
document.addEventListener(''DOMContentLoaded'', handler);

// resize - Window resized
window.addEventListener(''resize'', handler);

// scroll - Page scrolled
window.addEventListener(''scroll'', handler);

// beforeunload - Before page unloads
window.addEventListener(''beforeunload'', handler);
```

---

## addEventListener()

The modern way to add event listeners.

### Basic Syntax

```javascript
element.addEventListener(eventType, handler, options);
```

### Basic Example

```javascript
let button = document.getElementById(''myButton'');

button.addEventListener(''click'', function() {
    console.log(''Button clicked!'');
});
```

### Arrow Function

```javascript
button.addEventListener(''click'', () => {
    console.log(''Button clicked!'');
});
```

### Named Function

```javascript
function handleClick() {
    console.log(''Button clicked!'');
}

button.addEventListener(''click'', handleClick);
```

### Multiple Listeners

```javascript
button.addEventListener(''click'', function() {
    console.log(''First handler'');
});

button.addEventListener(''click'', function() {
    console.log(''Second handler'');
});

// Both handlers execute
```

### Options Parameter

```javascript
// Once: Remove after first trigger
button.addEventListener(''click'', handler, { once: true });

// Capture: Use capture phase
button.addEventListener(''click'', handler, { capture: true });

// Passive: Listener won''t call preventDefault()
button.addEventListener(''scroll'', handler, { passive: true });
```

---

## Event Objects

Event handlers receive an event object with information about the event.

### Accessing Event Object

```javascript
button.addEventListener(''click'', function(event) {
    console.log(event);
    console.log(event.type);      // "click"
    console.log(event.target);    // Element that triggered event
    console.log(event.currentTarget); // Element with listener
});
```

### Common Event Properties

```javascript
function handleEvent(event) {
    // Event type
    console.log(event.type);           // "click", "keydown", etc.
    
    // Target element
    console.log(event.target);         // Element that triggered event
    console.log(event.currentTarget);  // Element with listener
    
    // Mouse events
    console.log(event.clientX);        // X coordinate
    console.log(event.clientY);        // Y coordinate
    console.log(event.button);         // Mouse button (0=left, 1=middle, 2=right)
    
    // Keyboard events
    console.log(event.key);            // Key pressed
    console.log(event.code);           // Physical key code
    console.log(event.ctrlKey);        // Ctrl key pressed
    console.log(event.shiftKey);       // Shift key pressed
    console.log(event.altKey);         // Alt key pressed
    
    // Time
    console.log(event.timeStamp);      // When event occurred
}
```

---

## Removing Event Listeners

### removeEventListener()

Remove an event listener (must be same function reference):

```javascript
function handleClick() {
    console.log(''Clicked'');
}

button.addEventListener(''click'', handleClick);

// Remove listener
button.removeEventListener(''click'', handleClick);
```

### Important: Function Reference

```javascript
// ❌ Won''t work: Different function reference
button.addEventListener(''click'', function() {
    console.log(''Clicked'');
});
button.removeEventListener(''click'', function() { });  // Different function!

// ✅ Works: Same function reference
function handler() {
    console.log(''Clicked'');
}
button.addEventListener(''click'', handler);
button.removeEventListener(''click'', handler);
```

### Using once Option

```javascript
// Automatically removes after first trigger
button.addEventListener(''click'', handler, { once: true });
```

---

## Practical Examples

### Example 1: Button Click

```javascript
let button = document.getElementById(''myButton'');

button.addEventListener(''click'', function(event) {
    console.log(''Button clicked!'');
    console.log(''Event type:'', event.type);
    console.log(''Target:'', event.target);
});
```

### Example 2: Form Submission

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();  // Prevent default form submission
    
    let formData = new FormData(form);
    console.log(''Form submitted:'', formData);
    
    // Process form data
});
```

### Example 3: Input Change

```javascript
let input = document.getElementById(''myInput'');

input.addEventListener(''input'', function(event) {
    console.log(''Input value:'', event.target.value);
    
    // Real-time validation or processing
    if (event.target.value.length < 5) {
        console.log(''Too short'');
    }
});
```

### Example 4: Keyboard Events

```javascript
let input = document.getElementById(''myInput'');

input.addEventListener(''keydown'', function(event) {
    console.log(''Key pressed:'', event.key);
    console.log(''Key code:'', event.code);
    
    // Enter key
    if (event.key === ''Enter'') {
        console.log(''Enter pressed'');
    }
    
    // Ctrl+S
    if (event.ctrlKey && event.key === ''s'') {
        event.preventDefault();
        console.log(''Save shortcut'');
    }
});
```

### Example 5: Mouse Events

```javascript
let div = document.getElementById(''myDiv'');

div.addEventListener(''mouseenter'', function() {
    div.style.backgroundColor = ''yellow'';
});

div.addEventListener(''mouseleave'', function() {
    div.style.backgroundColor = ''white'';
});

div.addEventListener(''mousemove'', function(event) {
    console.log(''Mouse at:'', event.clientX, event.clientY);
});
```

### Example 6: Window Events

```javascript
// Page load
window.addEventListener(''load'', function() {
    console.log(''Page loaded'');
});

// DOM ready (faster than load)
document.addEventListener(''DOMContentLoaded'', function() {
    console.log(''DOM ready'');
});

// Window resize
window.addEventListener(''resize'', function() {
    console.log(''Window resized:'', window.innerWidth, window.innerHeight);
});

// Scroll
window.addEventListener(''scroll'', function() {
    console.log(''Scrolled:'', window.scrollY);
});
```

---

## Practice Exercise

### Exercise: Basic Event Handling

**Objective**: Practice adding and handling various events.

**Instructions**:

1. Create an HTML file with various interactive elements
2. Create a JavaScript file for event handling
3. Practice:
   - Adding event listeners
   - Handling different event types
   - Accessing event properties
   - Removing event listeners

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Basics Practice</title>
    <style>
        .box {
            width: 200px;
            height: 200px;
            background-color: lightblue;
            margin: 20px;
            padding: 20px;
            cursor: pointer;
        }
        .highlight {
            background-color: yellow;
        }
    </style>
</head>
<body>
    <h1>Event Basics Practice</h1>
    
    <button id="clickBtn">Click Me</button>
    <button id="doubleClickBtn">Double Click Me</button>
    
    <div id="hoverBox" class="box">Hover over me</div>
    
    <input type="text" id="textInput" placeholder="Type something">
    <p id="output"></p>
    
    <form id="myForm">
        <input type="text" name="username" placeholder="Username">
        <button type="submit">Submit</button>
    </form>
    
    <script src="event-basics.js"></script>
</body>
</html>
```

```javascript
// event-basics.js
console.log("=== Event Basics Practice ===");

console.log("\\n=== Click Event ===");

let clickBtn = document.getElementById(''clickBtn'');
clickBtn.addEventListener(''click'', function(event) {
    console.log(''Button clicked!'');
    console.log(''Event type:'', event.type);
    console.log(''Target:'', event.target);
    console.log(''Current target:'', event.currentTarget);
    event.target.textContent = ''Clicked!'';
});
console.log();

console.log("=== Double Click Event ===");

let doubleClickBtn = document.getElementById(''doubleClickBtn'');
doubleClickBtn.addEventListener(''dblclick'', function(event) {
    console.log(''Double clicked!'');
    event.target.textContent = ''Double Clicked!'';
});
console.log();

console.log("=== Mouse Events ===");

let hoverBox = document.getElementById(''hoverBox'');

hoverBox.addEventListener(''mouseenter'', function(event) {
    console.log(''Mouse entered box'');
    event.target.classList.add(''highlight'');
});

hoverBox.addEventListener(''mouseleave'', function(event) {
    console.log(''Mouse left box'');
    event.target.classList.remove(''highlight'');
});

hoverBox.addEventListener(''mousemove'', function(event) {
    let x = event.clientX;
    let y = event.clientY;
    event.target.textContent = `Mouse: ${x}, ${y}`;
});

hoverBox.addEventListener(''mousedown'', function(event) {
    console.log(''Mouse down on box'');
    event.target.style.backgroundColor = ''red'';
});

hoverBox.addEventListener(''mouseup'', function(event) {
    console.log(''Mouse up on box'');
    event.target.style.backgroundColor = ''lightblue'';
});
console.log();

console.log("=== Keyboard Events ===");

let textInput = document.getElementById(''textInput'');
let output = document.getElementById(''output'');

textInput.addEventListener(''keydown'', function(event) {
    console.log(''Key down:'', event.key, event.code);
    
    // Enter key
    if (event.key === ''Enter'') {
        console.log(''Enter pressed'');
    }
    
    // Escape key
    if (event.key === ''Escape'') {
        event.target.value = '''';
    }
});

textInput.addEventListener(''keyup'', function(event) {
    console.log(''Key up:'', event.key);
});

textInput.addEventListener(''input'', function(event) {
    output.textContent = ''You typed: '' + event.target.value;
});

textInput.addEventListener(''focus'', function(event) {
    console.log(''Input focused'');
    event.target.style.border = ''2px solid blue'';
});

textInput.addEventListener(''blur'', function(event) {
    console.log(''Input blurred'');
    event.target.style.border = ''1px solid gray'';
});
console.log();

console.log("=== Form Events ===");

let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();  // Prevent default submission
    console.log(''Form submitted'');
    
    let formData = new FormData(form);
    let username = formData.get(''username'');
    console.log(''Username:'', username);
    
    alert(''Form submitted: '' + username);
});

let usernameInput = form.querySelector(''input[name="username"]'');
usernameInput.addEventListener(''change'', function(event) {
    console.log(''Username changed:'', event.target.value);
});
console.log();

console.log("=== Window Events ===");

window.addEventListener(''load'', function() {
    console.log(''Page fully loaded'');
});

document.addEventListener(''DOMContentLoaded'', function() {
    console.log(''DOM content loaded'');
});

window.addEventListener(''resize'', function() {
    console.log(''Window resized:'', window.innerWidth, ''x'', window.innerHeight);
});

window.addEventListener(''scroll'', function() {
    console.log(''Scrolled:'', window.scrollY);
});
console.log();

console.log("=== Event Object Properties ===");

let testBtn = document.createElement(''button'');
testBtn.textContent = ''Test Event Properties'';
document.body.appendChild(testBtn);

testBtn.addEventListener(''click'', function(event) {
    console.log(''=== Event Properties ==='');
    console.log(''Type:'', event.type);
    console.log(''Target:'', event.target);
    console.log(''Current Target:'', event.currentTarget);
    console.log(''Time Stamp:'', event.timeStamp);
    console.log(''Bubbles:'', event.bubbles);
    console.log(''Cancelable:'', event.cancelable);
    console.log(''Default Prevented:'', event.defaultPrevented);
});
console.log();

console.log("=== Removing Event Listeners ===");

let removeBtn = document.createElement(''button'');
removeBtn.textContent = ''Click to Remove Listener'';
document.body.appendChild(removeBtn);

let clickCount = 0;

function handleRemoveClick(event) {
    clickCount++;
    console.log(`Clicked ${clickCount} times`);
    
    if (clickCount >= 3) {
        removeBtn.removeEventListener(''click'', handleRemoveClick);
        removeBtn.textContent = ''Listener removed'';
        console.log(''Event listener removed'');
    }
}

removeBtn.addEventListener(''click'', handleRemoveClick);
console.log();

console.log("=== Once Option ===");

let onceBtn = document.createElement(''button'');
onceBtn.textContent = ''Click Once (auto-remove)'';
document.body.appendChild(onceBtn);

onceBtn.addEventListener(''click'', function() {
    console.log(''This will only fire once'');
    onceBtn.textContent = ''Already clicked'';
}, { once: true });
console.log();

console.log("=== Multiple Listeners ===");

let multiBtn = document.createElement(''button'');
multiBtn.textContent = ''Multiple Listeners'';
document.body.appendChild(multiBtn);

multiBtn.addEventListener(''click'', function() {
    console.log(''Handler 1'');
});

multiBtn.addEventListener(''click'', function() {
    console.log(''Handler 2'');
});

multiBtn.addEventListener(''click'', function() {
    console.log(''Handler 3'');
});

// All three handlers execute
console.log();
```

**Expected Output** (in browser console):
```
=== Event Basics Practice ===

=== Click Event ===
[On click]
Button clicked!
Event type: click
Target: [button element]
Current target: [button element]

=== Double Click Event ===
[On double click]
Double clicked!

=== Mouse Events ===
[On mouse enter]
Mouse entered box
[On mouse leave]
Mouse left box
[On mouse move]
[Shows coordinates]

=== Keyboard Events ===
[On key press]
Key down: [key] [code]
[On input]
[Shows typed text]

=== Form Events ===
[On submit]
Form submitted
Username: [value]

=== Window Events ===
DOM content loaded
Page fully loaded
[On resize]
Window resized: [width] x [height]
[On scroll]
Scrolled: [position]

=== Event Object Properties ===
[On click]
=== Event Properties ===
Type: click
Target: [element]
Current Target: [element]
Time Stamp: [timestamp]
Bubbles: true
Cancelable: true
Default Prevented: false

=== Removing Event Listeners ===
[On click]
Clicked 1 times
Clicked 2 times
Clicked 3 times
Event listener removed

=== Once Option ===
[On click]
This will only fire once

=== Multiple Listeners ===
[On click]
Handler 1
Handler 2
Handler 3
```

**Challenge (Optional)**:
- Build an interactive game with events
- Create a form validation system
- Build a keyboard shortcut system
- Create a drag-and-drop interface

---

## Common Mistakes

### 1. Not Preventing Default

```javascript
// ⚠️ Problem: Form submits and page reloads
form.addEventListener(''submit'', function(event) {
    // Process form
    // Page reloads!
});

// ✅ Solution: Prevent default
form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    // Process form
});
```

### 2. Wrong Function Reference for Removal

```javascript
// ⚠️ Problem: Can''t remove (different function)
button.addEventListener(''click'', function() {
    console.log(''Click'');
});
button.removeEventListener(''click'', function() { });  // Won''t work

// ✅ Solution: Use same reference
function handler() {
    console.log(''Click'');
}
button.addEventListener(''click'', handler);
button.removeEventListener(''click'', handler);
```

### 3. Adding Listener Before Element Exists

```javascript
// ⚠️ Problem: Element might not exist
let button = document.getElementById(''myButton'');
button.addEventListener(''click'', handler);  // Error if button is null

// ✅ Solution: Check or wait for DOM
document.addEventListener(''DOMContentLoaded'', function() {
    let button = document.getElementById(''myButton'');
    if (button) {
        button.addEventListener(''click'', handler);
    }
});
```

### 4. Using Inline Handlers

```javascript
// ⚠️ Problem: Inline handlers (not recommended)
<button onclick="handleClick()">Click</button>

// ✅ Solution: Use addEventListener
button.addEventListener(''click'', handleClick);
```

---

## Key Takeaways

1. **Events**: Actions that occur in the browser
2. **addEventListener()**: Modern way to add listeners
3. **Event Types**: click, keydown, submit, load, etc.
4. **Event Object**: Contains event information
5. **removeEventListener()**: Remove listeners (same function reference)
6. **Options**: once, capture, passive
7. **Best Practice**: Use addEventListener, prevent default when needed
8. **Multiple Listeners**: Can add multiple listeners to same element

---

## Quiz: Events Basics

Test your understanding with these questions:

1. **addEventListener() is:**
   - A) Old method
   - B) Modern method
   - C) Deprecated
   - D) Not available

2. **Event handler receives:**
   - A) Nothing
   - B) Event object
   - C) Element
   - D) String

3. **removeEventListener() requires:**
   - A) Same function reference
   - B) Different function
   - C) No function
   - D) String

4. **event.target is:**
   - A) Element with listener
   - B) Element that triggered event
   - C) Parent element
   - D) Document

5. **once option:**
   - A) Prevents event
   - B) Removes after first trigger
   - C) Adds multiple times
   - D) Nothing

6. **DOMContentLoaded fires:**
   - A) After images load
   - B) When DOM ready
   - C) Never
   - D) On click

7. **Multiple listeners:**
   - A) Only first executes
   - B) All execute
   - C) Error
   - D) Random

**Answers**:
1. B) Modern method
2. B) Event object
3. A) Same function reference
4. B) Element that triggered event
5. B) Removes after first trigger
6. B) When DOM ready
7. B) All execute

---

## Next Steps

Congratulations! You''ve learned event basics. You now know:
- What events are
- Different event types
- How to add event listeners
- How to access event properties

**What''s Next?**
- Lesson 14.2: Event Propagation
- Learn about event bubbling and capturing
- Understand event delegation
- Build more complex event handling

---

## Additional Resources

- **MDN: Events**: [developer.mozilla.org/en-US/docs/Web/API/Event](https://developer.mozilla.org/en-US/docs/Web/API/Event)
- **MDN: addEventListener()**: [developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener)
- **JavaScript.info: Events**: [javascript.info/events](https://javascript.info/events)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:53:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what events are
- Recognize different event types
- Add event listeners using addEventListener
- Understand event objects
- Access event properties
- Remove event listeners
- Handle events effectively');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (146, 54, 12, 'Event Propagation', 'event-propagation', '# Lesson 14.2: Event Propagation

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand event bubbling
- Understand event capturing
- Use stopPropagation() to stop event propagation
- Use preventDefault() to prevent default behavior
- Implement event delegation
- Control event flow effectively
- Build efficient event handling systems

---

## Introduction to Event Propagation

Event propagation is the mechanism by which events travel through the DOM tree. Understanding propagation is crucial for effective event handling.

### Event Propagation Phases

1. **Capturing Phase**: Event travels down from document to target
2. **Target Phase**: Event reaches the target element
3. **Bubbling Phase**: Event travels up from target to document

---

## Event Bubbling

Event bubbling means events bubble up from the target element to the document root.

### How Bubbling Works

```html
<div id="grandparent">
    <div id="parent">
        <div id="child">Click me</div>
    </div>
</div>
```

```javascript
document.getElementById(''grandparent'').addEventListener(''click'', function() {
    console.log(''Grandparent clicked'');
});

document.getElementById(''parent'').addEventListener(''click'', function() {
    console.log(''Parent clicked'');
});

document.getElementById(''child'').addEventListener(''click'', function() {
    console.log(''Child clicked'');
});

// Clicking child outputs:
// Child clicked
// Parent clicked
// Grandparent clicked
```

### Bubbling Example

```javascript
let container = document.getElementById(''container'');
let button = document.getElementById(''button'');

button.addEventListener(''click'', function(event) {
    console.log(''Button clicked'');
});

container.addEventListener(''click'', function(event) {
    console.log(''Container clicked'');
});

// Clicking button triggers both handlers
```

---

## Event Capturing

Event capturing means events are captured on the way down to the target.

### How Capturing Works

```javascript
document.getElementById(''grandparent'').addEventListener(''click'', function() {
    console.log(''Grandparent captured'');
}, true);  // Use capture phase

document.getElementById(''parent'').addEventListener(''click'', function() {
    console.log(''Parent captured'');
}, true);

document.getElementById(''child'').addEventListener(''click'', function() {
    console.log(''Child clicked'');
});

// Clicking child outputs:
// Grandparent captured
// Parent captured
// Child clicked
```

### Capture vs Bubble

```javascript
// Capture phase (true)
element.addEventListener(''click'', handler, true);

// Bubble phase (false or omitted)
element.addEventListener(''click'', handler, false);
element.addEventListener(''click'', handler);  // Default: bubble
```

---

## stopPropagation()

`stopPropagation()` stops the event from propagating to other elements.

### Stopping Bubbling

```javascript
let parent = document.getElementById(''parent'');
let child = document.getElementById(''child'');

child.addEventListener(''click'', function(event) {
    console.log(''Child clicked'');
    event.stopPropagation();  // Stop bubbling
});

parent.addEventListener(''click'', function() {
    console.log(''Parent clicked'');  // Won''t execute
});

// Only "Child clicked" is logged
```

### Stopping Capturing

```javascript
let parent = document.getElementById(''parent'');
let child = document.getElementById(''child'');

parent.addEventListener(''click'', function(event) {
    console.log(''Parent captured'');
    event.stopPropagation();  // Stop capturing
}, true);

child.addEventListener(''click'', function() {
    console.log(''Child clicked'');  // Won''t execute
});
```

### stopImmediatePropagation()

Stops propagation and prevents other listeners on same element:

```javascript
button.addEventListener(''click'', function(event) {
    console.log(''Handler 1'');
    event.stopImmediatePropagation();  // Stops all other handlers
});

button.addEventListener(''click'', function() {
    console.log(''Handler 2'');  // Won''t execute
});

// Only "Handler 1" is logged
```

---

## preventDefault()

`preventDefault()` prevents the default behavior of an event.

### Common Use Cases

```javascript
// Prevent form submission
form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    // Handle form manually
});

// Prevent link navigation
link.addEventListener(''click'', function(event) {
    event.preventDefault();
    // Handle navigation manually
});

// Prevent context menu
element.addEventListener(''contextmenu'', function(event) {
    event.preventDefault();
    // Show custom menu
});
```

### preventDefault() vs stopPropagation()

```javascript
// preventDefault(): Prevents default behavior
link.addEventListener(''click'', function(event) {
    event.preventDefault();  // Link won''t navigate
    // Event still bubbles
});

// stopPropagation(): Stops event propagation
link.addEventListener(''click'', function(event) {
    event.stopPropagation();  // Event won''t bubble
    // Link still navigates (default behavior)
});

// Both
link.addEventListener(''click'', function(event) {
    event.preventDefault();      // Prevent navigation
    event.stopPropagation();     // Stop bubbling
});
```

---

## Event Delegation

Event delegation uses event bubbling to handle events on multiple elements with a single listener.

### Problem: Multiple Listeners

```javascript
// ⚠️ Problem: Many listeners
let items = document.querySelectorAll(''.item'');
items.forEach(item => {
    item.addEventListener(''click'', function() {
        console.log(''Item clicked'');
    });
});

// New items added dynamically won''t have listeners
```

### Solution: Event Delegation

```javascript
// ✅ Solution: Single listener on parent
let list = document.getElementById(''list'');

list.addEventListener(''click'', function(event) {
    // Check if clicked element is an item
    if (event.target.classList.contains(''item'')) {
        console.log(''Item clicked:'', event.target.textContent);
    }
});

// Works for dynamically added items too!
```

### Event Delegation Benefits

- **Performance**: Fewer event listeners
- **Dynamic Elements**: Works with dynamically added elements
- **Memory**: Less memory usage
- **Flexibility**: Easy to add/remove items

### Event Delegation Pattern

```javascript
parent.addEventListener(''click'', function(event) {
    // Check if target matches selector
    if (event.target.matches(''.item'')) {
        // Handle event
        handleItemClick(event.target);
    }
});

// Or use closest() for nested elements
parent.addEventListener(''click'', function(event) {
    let item = event.target.closest(''.item'');
    if (item) {
        handleItemClick(item);
    }
});
```

---

## Practical Examples

### Example 1: Stop Bubbling

```javascript
let container = document.getElementById(''container'');
let button = document.getElementById(''button'');

button.addEventListener(''click'', function(event) {
    console.log(''Button clicked'');
    event.stopPropagation();  // Don''t bubble to container
});

container.addEventListener(''click'', function() {
    console.log(''Container clicked'');  // Won''t execute
});
```

### Example 2: Prevent Default

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();  // Prevent form submission
    
    // Validate and process
    let formData = new FormData(form);
    console.log(''Form data:'', formData);
    
    // Submit via AJAX instead
    fetch(''/api/submit'', {
        method: ''POST'',
        body: formData
    });
});
```

### Example 3: Event Delegation for List

```javascript
let todoList = document.getElementById(''todoList'');

// Single listener for all items
todoList.addEventListener(''click'', function(event) {
    let item = event.target.closest(''.todo-item'');
    if (item) {
        // Handle item click
        if (event.target.classList.contains(''delete-btn'')) {
            item.remove();
        } else if (event.target.classList.contains(''complete-btn'')) {
            item.classList.toggle(''completed'');
        }
    }
});

// Add new items dynamically
function addTodoItem(text) {
    let li = document.createElement(''li'');
    li.className = ''todo-item'';
    li.innerHTML = `
        <span>${text}</span>
        <button class="complete-btn">Complete</button>
        <button class="delete-btn">Delete</button>
    `;
    todoList.appendChild(li);
    // No need to add listeners - delegation handles it!
}
```

### Example 4: Modal Close on Outside Click

```javascript
let modal = document.getElementById(''modal'');
let modalContent = document.getElementById(''modalContent'');

modal.addEventListener(''click'', function(event) {
    // If click is outside modal content
    if (!modalContent.contains(event.target)) {
        modal.style.display = ''none'';
    }
});

// Prevent clicks inside modal from closing
modalContent.addEventListener(''click'', function(event) {
    event.stopPropagation();
});
```

---

## Practice Exercise

### Exercise: Event Propagation

**Objective**: Practice event propagation, stopping propagation, and event delegation.

**Instructions**:

1. Create an HTML file with nested elements
2. Create a JavaScript file for event handling
3. Practice:
   - Event bubbling
   - Event capturing
   - stopPropagation()
   - preventDefault()
   - Event delegation

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Propagation Practice</title>
    <style>
        .container {
            padding: 20px;
            border: 2px solid blue;
            margin: 10px;
        }
        .box {
            padding: 15px;
            border: 2px solid green;
            margin: 10px;
        }
        .item {
            padding: 10px;
            border: 2px solid red;
            margin: 5px;
            cursor: pointer;
        }
        .highlight {
            background-color: yellow;
        }
    </style>
</head>
<body>
    <h1>Event Propagation Practice</h1>
    
    <div id="grandparent" class="container">
        Grandparent
        <div id="parent" class="box">
            Parent
            <div id="child" class="item">Child - Click me</div>
        </div>
    </div>
    
    <form id="myForm">
        <input type="text" name="username" placeholder="Username">
        <button type="submit">Submit</button>
    </form>
    
    <ul id="todoList">
        <li class="todo-item">
            <span>Task 1</span>
            <button class="delete-btn">Delete</button>
        </li>
        <li class="todo-item">
            <span>Task 2</span>
            <button class="delete-btn">Delete</button>
        </li>
    </ul>
    <button id="addTask">Add Task</button>
    
    <script src="event-propagation.js"></script>
</body>
</html>
```

```javascript
// event-propagation.js
console.log("=== Event Propagation Practice ===");

console.log("\\n=== Event Bubbling ===");

let grandparent = document.getElementById(''grandparent'');
let parent = document.getElementById(''parent'');
let child = document.getElementById(''child'');

grandparent.addEventListener(''click'', function(event) {
    console.log(''Grandparent clicked (bubble)'');
    event.currentTarget.classList.add(''highlight'');
    setTimeout(() => event.currentTarget.classList.remove(''highlight''), 500);
});

parent.addEventListener(''click'', function(event) {
    console.log(''Parent clicked (bubble)'');
    event.currentTarget.classList.add(''highlight'');
    setTimeout(() => event.currentTarget.classList.remove(''highlight''), 500);
});

child.addEventListener(''click'', function(event) {
    console.log(''Child clicked (bubble)'');
    event.currentTarget.classList.add(''highlight'');
    setTimeout(() => event.currentTarget.classList.remove(''highlight''), 500);
});

// Clicking child triggers all three (bubbling)
console.log();

console.log("=== Event Capturing ===");

let grandparentCapture = document.getElementById(''grandparent'');
let parentCapture = document.getElementById(''parent'');
let childCapture = document.getElementById(''child'');

grandparentCapture.addEventListener(''click'', function(event) {
    console.log(''Grandparent captured'');
}, true);  // Capture phase

parentCapture.addEventListener(''click'', function(event) {
    console.log(''Parent captured'');
}, true);  // Capture phase

childCapture.addEventListener(''click'', function(event) {
    console.log(''Child clicked'');
});  // Bubble phase (default)

// Clicking child outputs: Grandparent captured, Parent captured, Child clicked
console.log();

console.log("=== stopPropagation() ===");

let stopParent = document.getElementById(''parent'');
let stopChild = document.getElementById(''child'');

// Create new elements for stopPropagation demo
let stopContainer = document.createElement(''div'');
stopContainer.className = ''container'';
stopContainer.id = ''stopContainer'';
stopContainer.innerHTML = `
    <div class="box" id="stopParent">
        <div class="item" id="stopChild">Click to stop propagation</div>
    </div>
`;
document.body.appendChild(stopContainer);

let stopParentEl = document.getElementById(''stopParent'');
let stopChildEl = document.getElementById(''stopChild'');

stopParentEl.addEventListener(''click'', function() {
    console.log(''Parent clicked (should not see this)'');
});

stopChildEl.addEventListener(''click'', function(event) {
    console.log(''Child clicked - stopping propagation'');
    event.stopPropagation();  // Stop bubbling
});
console.log();

console.log("=== preventDefault() ===");

let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();  // Prevent form submission
    console.log(''Form submission prevented'');
    
    let formData = new FormData(form);
    let username = formData.get(''username'');
    console.log(''Username:'', username);
    
    alert(''Form would submit: '' + username);
});
console.log();

console.log("=== Event Delegation ===");

let todoList = document.getElementById(''todoList'');
let addTaskBtn = document.getElementById(''addTask'');

// Single listener for all items (including dynamically added)
todoList.addEventListener(''click'', function(event) {
    let item = event.target.closest(''.todo-item'');
    
    if (item) {
        if (event.target.classList.contains(''delete-btn'')) {
            console.log(''Delete button clicked'');
            item.remove();
        } else if (event.target.tagName === ''SPAN'') {
            console.log(''Task clicked:'', event.target.textContent);
            item.classList.toggle(''highlight'');
        }
    }
});

// Add new tasks dynamically
addTaskBtn.addEventListener(''click'', function() {
    let taskNumber = todoList.children.length + 1;
    let li = document.createElement(''li'');
    li.className = ''todo-item'';
    li.innerHTML = `
        <span>Task ${taskNumber}</span>
        <button class="delete-btn">Delete</button>
    `;
    todoList.appendChild(li);
    console.log(`Added Task ${taskNumber} (delegation handles clicks)`);
});
console.log();

console.log("=== stopImmediatePropagation() ===");

let immediateBtn = document.createElement(''button'');
immediateBtn.textContent = ''Stop Immediate Propagation'';
document.body.appendChild(immediateBtn);

immediateBtn.addEventListener(''click'', function(event) {
    console.log(''Handler 1'');
    event.stopImmediatePropagation();  // Stops other handlers
});

immediateBtn.addEventListener(''click'', function() {
    console.log(''Handler 2'');  // Won''t execute
});

immediateBtn.addEventListener(''click'', function() {
    console.log(''Handler 3'');  // Won''t execute
});
console.log();

console.log("=== Combined: preventDefault and stopPropagation ===");

let link = document.createElement(''a'');
link.href = ''https://example.com'';
link.textContent = ''Link (prevented)'';
link.style.display = ''block'';
link.style.margin = ''10px'';
document.body.appendChild(link);

link.addEventListener(''click'', function(event) {
    event.preventDefault();      // Prevent navigation
    event.stopPropagation();     // Stop bubbling
    console.log(''Link clicked - default prevented and propagation stopped'');
    alert(''Link click handled, navigation prevented'');
});
console.log();

console.log("=== Event Delegation with matches() ===");

let container = document.createElement(''div'');
container.id = ''delegationContainer'';
container.className = ''container'';
container.innerHTML = `
    <button class="action-btn" data-action="save">Save</button>
    <button class="action-btn" data-action="delete">Delete</button>
    <button class="action-btn" data-action="edit">Edit</button>
    <div class="info">Click buttons above</div>
`;
document.body.appendChild(container);

let infoDiv = container.querySelector(''.info'');

container.addEventListener(''click'', function(event) {
    if (event.target.matches(''.action-btn'')) {
        let action = event.target.dataset.action;
        console.log(`Action: ${action}`);
        infoDiv.textContent = `Last action: ${action}`;
    }
});
console.log();

console.log("=== Nested Event Delegation ===");

let nestedList = document.createElement(''ul'');
nestedList.id = ''nestedList'';
nestedList.innerHTML = `
    <li class="category">
        <span class="category-name">Category 1</span>
        <ul>
            <li class="item">Item 1.1</li>
            <li class="item">Item 1.2</li>
        </ul>
    </li>
    <li class="category">
        <span class="category-name">Category 2</span>
        <ul>
            <li class="item">Item 2.1</li>
            <li class="item">Item 2.2</li>
        </ul>
    </li>
`;
document.body.appendChild(nestedList);

nestedList.addEventListener(''click'', function(event) {
    // Handle category clicks
    if (event.target.classList.contains(''category-name'')) {
        console.log(''Category clicked:'', event.target.textContent);
        event.target.parentElement.classList.toggle(''highlight'');
    }
    
    // Handle item clicks (using closest for nested elements)
    let item = event.target.closest(''.item'');
    if (item && event.target === item) {
        console.log(''Item clicked:'', item.textContent);
        item.classList.toggle(''highlight'');
    }
});
```

**Expected Output** (in browser console):
```
=== Event Propagation Practice ===

=== Event Bubbling ===
[On clicking child]
Child clicked (bubble)
Parent clicked (bubble)
Grandparent clicked (bubble)

=== Event Capturing ===
[On clicking child]
Grandparent captured
Parent captured
Child clicked

=== stopPropagation() ===
[On clicking stopChild]
Child clicked - stopping propagation

=== preventDefault() ===
[On form submit]
Form submission prevented
Username: [value]

=== Event Delegation ===
[On clicking delete button]
Delete button clicked
[On clicking task]
Task clicked: Task 1
[On adding task]
Added Task 3 (delegation handles clicks)

=== stopImmediatePropagation() ===
[On clicking button]
Handler 1

=== Combined: preventDefault and stopPropagation ===
[On clicking link]
Link clicked - default prevented and propagation stopped

=== Event Delegation with matches() ===
[On clicking button]
Action: save
[On clicking button]
Action: delete

=== Nested Event Delegation ===
[On clicking category]
Category clicked: Category 1
[On clicking item]
Item clicked: Item 1.1
```

**Challenge (Optional)**:
- Build a complex event delegation system
- Create a modal system with outside click detection
- Build a nested menu system
- Create a drag-and-drop with event handling

---

## Common Mistakes

### 1. Confusing preventDefault and stopPropagation

```javascript
// ⚠️ Confusion
event.preventDefault();   // Prevents default behavior
event.stopPropagation();  // Stops event propagation

// They do different things!
```

### 2. Not Using Event Delegation

```javascript
// ⚠️ Problem: Many listeners, doesn''t work with dynamic elements
items.forEach(item => {
    item.addEventListener(''click'', handler);
});

// ✅ Solution: Event delegation
parent.addEventListener(''click'', function(event) {
    if (event.target.matches(''.item'')) {
        handler(event.target);
    }
});
```

### 3. stopPropagation Too Early

```javascript
// ⚠️ Problem: Stops before handling
child.addEventListener(''click'', function(event) {
    event.stopPropagation();  // Stops immediately
    // Do something
    // Parent won''t receive event (might be needed)
});

// ✅ Solution: Only stop if needed
child.addEventListener(''click'', function(event) {
    // Do something
    if (shouldStopPropagation) {
        event.stopPropagation();
    }
});
```

### 4. Wrong Target in Delegation

```javascript
// ⚠️ Problem: Target might be nested element
list.addEventListener(''click'', function(event) {
    event.target.classList.add(''active'');  // Might be span inside li
});

// ✅ Solution: Use closest()
list.addEventListener(''click'', function(event) {
    let item = event.target.closest(''.item'');
    if (item) {
        item.classList.add(''active'');
    }
});
```

---

## Key Takeaways

1. **Event Bubbling**: Events bubble up from target to document
2. **Event Capturing**: Events captured on way down (use true option)
3. **stopPropagation()**: Stops event propagation
4. **preventDefault()**: Prevents default behavior
5. **Event Delegation**: Single listener on parent for multiple children
6. **closest()**: Find ancestor matching selector
7. **matches()**: Check if element matches selector
8. **Best Practice**: Use event delegation for dynamic elements

---

## Quiz: Event Propagation

Test your understanding with these questions:

1. **Event bubbling:**
   - A) Goes down
   - B) Goes up
   - C) Stays at target
   - D) Doesn''t happen

2. **Event capturing uses:**
   - A) addEventListener(..., true)
   - B) addEventListener(..., false)
   - C) No option
   - D) preventDefault()

3. **stopPropagation() stops:**
   - A) Default behavior
   - B) Event propagation
   - C) Event listener
   - D) Nothing

4. **preventDefault() prevents:**
   - A) Event propagation
   - B) Default behavior
   - C) Event listener
   - D) Nothing

5. **Event delegation uses:**
   - A) Multiple listeners
   - B) Single listener on parent
   - C) No listeners
   - D) Inline handlers

6. **closest() finds:**
   - A) Child element
   - B) Ancestor element
   - C) Sibling element
   - D) Any element

7. **stopImmediatePropagation() stops:**
   - A) Propagation only
   - B) Other listeners on same element
   - C) Default behavior
   - D) Nothing

**Answers**:
1. B) Goes up
2. A) addEventListener(..., true)
3. B) Event propagation
4. B) Default behavior
5. B) Single listener on parent
6. B) Ancestor element
7. B) Other listeners on same element

---

## Next Steps

Congratulations! You''ve learned event propagation. You now know:
- How event bubbling and capturing work
- How to stop propagation
- How to prevent default behavior
- How to use event delegation

**What''s Next?**
- Lesson 14.3: Advanced Events
- Learn custom events
- Understand debouncing and throttling
- Work with touch and keyboard events

---

## Additional Resources

- **MDN: Event Propagation**: [developer.mozilla.org/en-US/docs/Web/API/Event/stopPropagation](https://developer.mozilla.org/en-US/docs/Web/API/Event/stopPropagation)
- **MDN: preventDefault()**: [developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault](https://developer.mozilla.org/en-US/docs/Web/API/Event/preventDefault)
- **JavaScript.info: Event Delegation**: [javascript.info/event-delegation](https://javascript.info/event-delegation)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:53:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand event bubbling
- Understand event capturing
- Use stopPropagation() to stop event propagation
- Use preventDefault() to prevent default behavior
- Implement event delegation
- Control event flow effectively
- Build efficient event handling systems');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (147, 54, 12, 'Advanced Events', 'advanced-events', '# Lesson 14.3: Advanced Events

## Learning Objectives

By the end of this lesson, you will be able to:
- Create and dispatch custom events
- Understand event patterns
- Implement debouncing for performance
- Implement throttling for performance
- Handle touch events for mobile
- Work with keyboard events in detail
- Build advanced event-driven applications

---

## Introduction to Advanced Events

Advanced event handling includes custom events, performance optimization patterns, and specialized event types for modern web applications.

### Advanced Event Topics

- **Custom Events**: Create your own events
- **Debouncing**: Limit function calls
- **Throttling**: Limit function execution rate
- **Touch Events**: Mobile device interactions
- **Keyboard Events**: Advanced keyboard handling

---

## Custom Events

Custom events allow you to create and dispatch your own events.

### Creating Custom Events

```javascript
// Create custom event
let customEvent = new CustomEvent(''myEvent'', {
    detail: {
        message: ''Hello from custom event'',
        data: { id: 1, name: ''Alice'' }
    },
    bubbles: true,
    cancelable: true
});

// Dispatch event
element.dispatchEvent(customEvent);
```

### Listening to Custom Events

```javascript
element.addEventListener(''myEvent'', function(event) {
    console.log(''Custom event received:'', event.detail);
    console.log(''Message:'', event.detail.message);
    console.log(''Data:'', event.detail.data);
});
```

### CustomEvent Constructor

```javascript
new CustomEvent(eventName, {
    detail: {},        // Custom data
    bubbles: true,    // Bubbles up
    cancelable: true  // Can be cancelled
});
```

### Practical Example: Notification System

```javascript
// Create notification event
function showNotification(message, type = ''info'') {
    let event = new CustomEvent(''notification'', {
        detail: {
            message: message,
            type: type,
            timestamp: Date.now()
        },
        bubbles: true
    });
    
    document.dispatchEvent(event);
}

// Listen for notifications
document.addEventListener(''notification'', function(event) {
    let { message, type, timestamp } = event.detail;
    console.log(`[${type}] ${message} at ${new Date(timestamp)}`);
    // Display notification in UI
});

// Use it
showNotification(''User logged in'', ''success'');
showNotification(''Error occurred'', ''error'');
```

---

## Debouncing

Debouncing limits how often a function can be called. It waits for a pause before executing.

### Basic Debounce Function

```javascript
function debounce(func, delay) {
    let timeoutId;
    
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func(...args);
        }, delay);
    };
}
```

### Debounce Example: Search Input

```javascript
let searchInput = document.getElementById(''search'');

function performSearch(query) {
    console.log(''Searching for:'', query);
    // Make API call
}

let debouncedSearch = debounce(performSearch, 300);

searchInput.addEventListener(''input'', function(event) {
    debouncedSearch(event.target.value);
    // Only searches 300ms after user stops typing
});
```

### Debounce Example: Window Resize

```javascript
function handleResize() {
    console.log(''Window resized:'', window.innerWidth, window.innerHeight);
    // Update layout
}

let debouncedResize = debounce(handleResize, 250);

window.addEventListener(''resize'', debouncedResize);
```

### Debounce with Immediate Option

```javascript
function debounce(func, delay, immediate = false) {
    let timeoutId;
    
    return function(...args) {
        let callNow = immediate && !timeoutId;
        
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            timeoutId = null;
            if (!immediate) {
                func(...args);
            }
        }, delay);
        
        if (callNow) {
            func(...args);
        }
    };
}
```

---

## Throttling

Throttling limits how often a function can execute. It ensures the function runs at most once per time period.

### Basic Throttle Function

```javascript
function throttle(func, limit) {
    let inThrottle;
    
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}
```

### Throttle Example: Scroll Event

```javascript
function handleScroll() {
    console.log(''Scrolled:'', window.scrollY);
    // Update UI
}

let throttledScroll = throttle(handleScroll, 100);

window.addEventListener(''scroll'', throttledScroll);
// Executes at most once per 100ms
```

### Throttle Example: Mouse Move

```javascript
let element = document.getElementById(''myDiv'');

function trackMouse(event) {
    console.log(''Mouse at:'', event.clientX, event.clientY);
}

let throttledTrack = throttle(trackMouse, 100);

element.addEventListener(''mousemove'', throttledTrack);
```

### Advanced Throttle (Leading and Trailing)

```javascript
function throttle(func, limit, options = {}) {
    let timeoutId;
    let lastRan;
    let { leading = true, trailing = true } = options;
    
    return function(...args) {
        if (!lastRan && leading) {
            func(...args);
            lastRan = Date.now();
        } else {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(() => {
                if (trailing && Date.now() - lastRan >= limit) {
                    func(...args);
                    lastRan = Date.now();
                }
            }, limit - (Date.now() - lastRan));
        }
    };
}
```

---

## Touch Events

Touch events handle interactions on touch devices (mobile, tablets).

### Touch Event Types

```javascript
// touchstart - Finger touches screen
element.addEventListener(''touchstart'', handler);

// touchmove - Finger moves on screen
element.addEventListener(''touchmove'', handler);

// touchend - Finger leaves screen
element.addEventListener(''touchend'', handler);

// touchcancel - Touch interrupted
element.addEventListener(''touchcancel'', handler);
```

### Touch Event Object

```javascript
element.addEventListener(''touchstart'', function(event) {
    let touches = event.touches;        // All touches
    let targetTouches = event.targetTouches;  // Touches on element
    let changedTouches = event.changedTouches; // Changed touches
    
    // Access first touch
    let touch = touches[0];
    console.log(''Touch X:'', touch.clientX);
    console.log(''Touch Y:'', touch.clientY);
    console.log(''Touch ID:'', touch.identifier);
});
```

### Multi-Touch Example

```javascript
element.addEventListener(''touchstart'', function(event) {
    console.log(''Number of touches:'', event.touches.length);
    
    for (let i = 0; i < event.touches.length; i++) {
        let touch = event.touches[i];
        console.log(`Touch ${i}:`, touch.clientX, touch.clientY);
    }
});
```

### Preventing Default Touch Behavior

```javascript
element.addEventListener(''touchmove'', function(event) {
    event.preventDefault();  // Prevent scrolling
    // Handle touch movement
}, { passive: false });
```

---

## Advanced Keyboard Events

### Key Properties

```javascript
input.addEventListener(''keydown'', function(event) {
    console.log(''Key:'', event.key);           // "a", "Enter", "ArrowUp"
    console.log(''Code:'', event.code);         // "KeyA", "Enter", "ArrowUp"
    console.log(''Key Code:'', event.keyCode);  // 65, 13, 38 (deprecated)
    
    // Modifier keys
    console.log(''Ctrl:'', event.ctrlKey);
    console.log(''Shift:'', event.shiftKey);
    console.log(''Alt:'', event.altKey);
    console.log(''Meta:'', event.metaKey);
    
    // Repeat
    console.log(''Repeat:'', event.repeat);
});
```

### Keyboard Shortcuts

```javascript
document.addEventListener(''keydown'', function(event) {
    // Ctrl+S (Save)
    if (event.ctrlKey && event.key === ''s'') {
        event.preventDefault();
        console.log(''Save shortcut'');
        saveDocument();
    }
    
    // Ctrl+Z (Undo)
    if (event.ctrlKey && event.key === ''z'' && !event.shiftKey) {
        event.preventDefault();
        undo();
    }
    
    // Ctrl+Shift+Z (Redo)
    if (event.ctrlKey && event.shiftKey && event.key === ''z'') {
        event.preventDefault();
        redo();
    }
    
    // Escape
    if (event.key === ''Escape'') {
        closeModal();
    }
});
```

### Arrow Key Navigation

```javascript
let items = document.querySelectorAll(''.item'');
let currentIndex = 0;

document.addEventListener(''keydown'', function(event) {
    switch (event.key) {
        case ''ArrowDown'':
            event.preventDefault();
            currentIndex = Math.min(currentIndex + 1, items.length - 1);
            items[currentIndex].focus();
            break;
            
        case ''ArrowUp'':
            event.preventDefault();
            currentIndex = Math.max(currentIndex - 1, 0);
            items[currentIndex].focus();
            break;
            
        case ''Home'':
            event.preventDefault();
            currentIndex = 0;
            items[currentIndex].focus();
            break;
            
        case ''End'':
            event.preventDefault();
            currentIndex = items.length - 1;
            items[currentIndex].focus();
            break;
    }
});
```

---

## Event Patterns

### Pattern 1: Event Bus

```javascript
class EventBus {
    constructor() {
        this.events = {};
    }
    
    on(event, callback) {
        if (!this.events[event]) {
            this.events[event] = [];
        }
        this.events[event].push(callback);
    }
    
    off(event, callback) {
        if (this.events[event]) {
            this.events[event] = this.events[event].filter(cb => cb !== callback);
        }
    }
    
    emit(event, data) {
        if (this.events[event]) {
            this.events[event].forEach(callback => callback(data));
        }
    }
}

// Usage
let eventBus = new EventBus();

eventBus.on(''userLogin'', (user) => {
    console.log(''User logged in:'', user);
});

eventBus.on(''userLogin'', (user) => {
    updateUI(user);
});

eventBus.emit(''userLogin'', { id: 1, name: ''Alice'' });
```

### Pattern 2: Observer Pattern

```javascript
class Observable {
    constructor() {
        this.observers = [];
    }
    
    subscribe(observer) {
        this.observers.push(observer);
    }
    
    unsubscribe(observer) {
        this.observers = this.observers.filter(obs => obs !== observer);
    }
    
    notify(data) {
        this.observers.forEach(observer => observer(data));
    }
}

// Usage
let subject = new Observable();

subject.subscribe((data) => {
    console.log(''Observer 1:'', data);
});

subject.subscribe((data) => {
    console.log(''Observer 2:'', data);
});

subject.notify(''Hello'');
```

---

## Practice Exercise

### Exercise: Advanced Events

**Objective**: Practice custom events, debouncing, throttling, and advanced event handling.

**Instructions**:

1. Create an HTML file with various interactive elements
2. Create a JavaScript file for advanced event handling
3. Practice:
   - Creating and dispatching custom events
   - Implementing debouncing
   - Implementing throttling
   - Handling touch events
   - Advanced keyboard handling

**Example Solution**:

```javascript
// Advanced Events Practice
console.log("=== Custom Events ===");

// Create custom event
function createCustomEvent(name, data) {
    return new CustomEvent(name, {
        detail: data,
        bubbles: true,
        cancelable: true
    });
}

// Notification system
function showNotification(message, type = ''info'') {
    let event = createCustomEvent(''notification'', {
        message: message,
        type: type,
        timestamp: Date.now()
    });
    document.dispatchEvent(event);
}

document.addEventListener(''notification'', function(event) {
    let { message, type, timestamp } = event.detail;
    console.log(`[${type.toUpperCase()}] ${message} at ${new Date(timestamp).toLocaleTimeString()}`);
});

showNotification(''User logged in'', ''success'');
showNotification(''Data saved'', ''info'');
showNotification(''Error occurred'', ''error'');
console.log();

console.log("=== Debouncing ===");

function debounce(func, delay) {
    let timeoutId;
    
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func(...args);
        }, delay);
    };
}

// Search input debouncing
let searchInput = document.createElement(''input'');
searchInput.type = ''text'';
searchInput.placeholder = ''Type to search (debounced)'';
document.body.appendChild(searchInput);

let searchCount = 0;
function performSearch(query) {
    searchCount++;
    console.log(`Search ${searchCount} for: "${query}"`);
}

let debouncedSearch = debounce(performSearch, 500);

searchInput.addEventListener(''input'', function(event) {
    debouncedSearch(event.target.value);
});
console.log("Type in search input - searches after 500ms pause");
console.log();

console.log("=== Throttling ===");

function throttle(func, limit) {
    let inThrottle;
    
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}

// Scroll throttling
let scrollCount = 0;
function handleScroll() {
    scrollCount++;
    console.log(`Scroll event ${scrollCount} at position: ${window.scrollY}`);
}

let throttledScroll = throttle(handleScroll, 1000);

window.addEventListener(''scroll'', throttledScroll);
console.log("Scroll page - events throttled to once per second");
console.log();

console.log("=== Mouse Move Throttling ===");

let moveBox = document.createElement(''div'');
moveBox.style.width = ''200px'';
moveBox.style.height = ''200px'';
moveBox.style.backgroundColor = ''lightblue'';
moveBox.style.margin = ''20px'';
moveBox.textContent = ''Move mouse here (throttled)'';
document.body.appendChild(moveBox);

let moveCount = 0;
function trackMouse(event) {
    moveCount++;
    console.log(`Mouse move ${moveCount}: (${event.clientX}, ${event.clientY})`);
}

let throttledMouse = throttle(trackMouse, 200);
moveBox.addEventListener(''mousemove'', throttledMouse);
console.log();

console.log("=== Touch Events ===");

let touchBox = document.createElement(''div'');
touchBox.style.width = ''200px'';
touchBox.style.height = ''200px'';
touchBox.style.backgroundColor = ''lightgreen'';
touchBox.style.margin = ''20px'';
touchBox.textContent = ''Touch here (mobile)'';
document.body.appendChild(touchBox);

touchBox.addEventListener(''touchstart'', function(event) {
    console.log(''Touch started'');
    let touch = event.touches[0];
    console.log(`Touch at: (${touch.clientX}, ${touch.clientY})`);
    console.log(''Number of touches:'', event.touches.length);
});

touchBox.addEventListener(''touchmove'', function(event) {
    event.preventDefault();
    let touch = event.touches[0];
    console.log(`Touch moved to: (${touch.clientX}, ${touch.clientY})`);
});

touchBox.addEventListener(''touchend'', function(event) {
    console.log(''Touch ended'');
    console.log(''Changed touches:'', event.changedTouches.length);
});
console.log();

console.log("=== Advanced Keyboard Events ===");

let keyboardInput = document.createElement(''input'');
keyboardInput.type = ''text'';
keyboardInput.placeholder = ''Type here (keyboard events)'';
keyboardInput.style.display = ''block'';
keyboardInput.style.margin = ''20px'';
keyboardInput.style.padding = ''10px'';
document.body.appendChild(keyboardInput);

keyboardInput.addEventListener(''keydown'', function(event) {
    console.log(''=== Key Down ==='');
    console.log(''Key:'', event.key);
    console.log(''Code:'', event.code);
    console.log(''Ctrl:'', event.ctrlKey);
    console.log(''Shift:'', event.shiftKey);
    console.log(''Alt:'', event.altKey);
    console.log(''Repeat:'', event.repeat);
});

keyboardInput.addEventListener(''keyup'', function(event) {
    console.log(''Key up:'', event.key);
});
console.log();

console.log("=== Keyboard Shortcuts ===");

document.addEventListener(''keydown'', function(event) {
    // Ctrl+S
    if (event.ctrlKey && event.key === ''s'') {
        event.preventDefault();
        console.log(''Save shortcut (Ctrl+S)'');
    }
    
    // Ctrl+Z
    if (event.ctrlKey && event.key === ''z'' && !event.shiftKey) {
        event.preventDefault();
        console.log(''Undo shortcut (Ctrl+Z)'');
    }
    
    // Ctrl+Shift+Z
    if (event.ctrlKey && event.shiftKey && event.key === ''z'') {
        event.preventDefault();
        console.log(''Redo shortcut (Ctrl+Shift+Z)'');
    }
    
    // Escape
    if (event.key === ''Escape'') {
        console.log(''Escape pressed'');
    }
    
    // Arrow keys
    if (event.key.startsWith(''Arrow'')) {
        console.log(''Arrow key:'', event.key);
    }
});
console.log();

console.log("=== Event Bus Pattern ===");

class EventBus {
    constructor() {
        this.events = {};
    }
    
    on(event, callback) {
        if (!this.events[event]) {
            this.events[event] = [];
        }
        this.events[event].push(callback);
    }
    
    off(event, callback) {
        if (this.events[event]) {
            this.events[event] = this.events[event].filter(cb => cb !== callback);
        }
    }
    
    emit(event, data) {
        if (this.events[event]) {
            this.events[event].forEach(callback => callback(data));
        }
    }
}

let eventBus = new EventBus();

eventBus.on(''userAction'', (data) => {
    console.log(''Handler 1:'', data);
});

eventBus.on(''userAction'', (data) => {
    console.log(''Handler 2:'', data);
});

eventBus.emit(''userAction'', { action: ''click'', target: ''button'' });
console.log();

console.log("=== Debounce with Immediate ===");

function debounceImmediate(func, delay, immediate = false) {
    let timeoutId;
    
    return function(...args) {
        let callNow = immediate && !timeoutId;
        
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            timeoutId = null;
            if (!immediate) {
                func(...args);
            }
        }, delay);
        
        if (callNow) {
            func(...args);
        }
    };
}

let immediateInput = document.createElement(''input'');
immediateInput.type = ''text'';
immediateInput.placeholder = ''Type (immediate debounce)'';
document.body.appendChild(immediateInput);

function searchImmediate(query) {
    console.log(''Immediate search for:'', query);
}

let immediateSearch = debounceImmediate(searchImmediate, 500, true);
immediateInput.addEventListener(''input'', function(event) {
    immediateSearch(event.target.value);
});
console.log();

console.log("=== Advanced Throttle ===");

function advancedThrottle(func, limit) {
    let lastRan;
    let timeoutId;
    
    return function(...args) {
        if (!lastRan) {
            func(...args);
            lastRan = Date.now();
        } else {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(() => {
                if (Date.now() - lastRan >= limit) {
                    func(...args);
                    lastRan = Date.now();
                }
            }, limit - (Date.now() - lastRan));
        }
    };
}

let throttleBox = document.createElement(''div'');
throttleBox.style.width = ''200px'';
throttleBox.style.height = ''200px'';
throttleBox.style.backgroundColor = ''lightyellow'';
throttleBox.style.margin = ''20px'';
throttleBox.textContent = ''Move mouse (advanced throttle)'';
document.body.appendChild(throttleBox);

let throttleCount = 0;
function advancedTrack(event) {
    throttleCount++;
    console.log(`Advanced throttle ${throttleCount}: (${event.clientX}, ${event.clientY})`);
}

let advancedThrottled = advancedThrottle(advancedTrack, 300);
throttleBox.addEventListener(''mousemove'', advancedThrottled);
```

**Expected Output** (in browser console):
```
=== Custom Events ===
[SUCCESS] User logged in at [time]
[INFO] Data saved at [time]
[ERROR] Error occurred at [time]

=== Debouncing ===
Type in search input - searches after 500ms pause
[After typing and pausing]
Search 1 for: "[typed text]"

=== Throttling ===
Scroll page - events throttled to once per second
[On scrolling]
Scroll event 1 at position: [position]
[After 1 second]
Scroll event 2 at position: [position]

=== Mouse Move Throttling ===
[On mouse move]
Mouse move 1: (x, y)
[After 200ms]
Mouse move 2: (x, y)

=== Touch Events ===
[On touch - mobile]
Touch started
Touch at: (x, y)
Number of touches: 1
[On move]
Touch moved to: (x, y)
[On release]
Touch ended
Changed touches: 1

=== Advanced Keyboard Events ===
[On key press]
=== Key Down ===
Key: [key]
Code: [code]
Ctrl: false
Shift: false
Alt: false
Repeat: false

=== Keyboard Shortcuts ===
[On Ctrl+S]
Save shortcut (Ctrl+S)
[On Escape]
Escape pressed
[On Arrow keys]
Arrow key: ArrowDown

=== Event Bus Pattern ===
Handler 1: { action: "click", target: "button" }
Handler 2: { action: "click", target: "button" }

=== Debounce with Immediate ===
[On first input]
Immediate search for: [first char]
[After pause]
Immediate search for: [full text]

=== Advanced Throttle ===
[On mouse move]
Advanced throttle 1: (x, y)
[After delay]
Advanced throttle 2: (x, y)
```

**Challenge (Optional)**:
- Build a complete event system
- Create a gesture recognition system
- Build keyboard navigation
- Create a performance-optimized event handler

---

## Common Mistakes

### 1. Not Clearing Timeout in Debounce

```javascript
// ⚠️ Problem: Multiple timeouts
function badDebounce(func, delay) {
    setTimeout(() => func(), delay);  // Doesn''t clear previous
}

// ✅ Solution: Clear timeout
function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => func(...args), delay);
    };
}
```

### 2. Throttle Not Resetting

```javascript
// ⚠️ Problem: Throttle never resets
function badThrottle(func, limit) {
    let inThrottle = false;
    return function() {
        if (!inThrottle) {
            func();
            inThrottle = true;  // Never resets!
        }
    };
}

// ✅ Solution: Reset after delay
function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            func(...args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    };
}
```

### 3. Touch Events Not Prevented

```javascript
// ⚠️ Problem: Default scroll behavior
element.addEventListener(''touchmove'', function(event) {
    // Handle touch but page still scrolls
});

// ✅ Solution: Prevent default
element.addEventListener(''touchmove'', function(event) {
    event.preventDefault();
    // Handle touch
}, { passive: false });
```

---

## Key Takeaways

1. **Custom Events**: Create and dispatch your own events
2. **Debouncing**: Wait for pause before executing
3. **Throttling**: Limit execution rate
4. **Touch Events**: Handle mobile interactions
5. **Keyboard Events**: Advanced keyboard handling
6. **Event Patterns**: Event bus, observer pattern
7. **Best Practice**: Use debounce/throttle for performance
8. **Mobile Support**: Handle touch events for mobile devices

---

## Quiz: Advanced Events

Test your understanding with these questions:

1. **Custom events are created with:**
   - A) new Event()
   - B) new CustomEvent()
   - C) createEvent()
   - D) addEvent()

2. **Debouncing:**
   - A) Executes immediately
   - B) Waits for pause
   - C) Limits rate
   - D) Nothing

3. **Throttling:**
   - A) Waits for pause
   - B) Limits execution rate
   - C) Executes once
   - D) Nothing

4. **touchstart fires:**
   - A) When finger moves
   - B) When finger touches
   - C) When finger leaves
   - D) Never

5. **event.key returns:**
   - A) Key code
   - B) Key name
   - C) Key number
   - D) Nothing

6. **Debounce is best for:**
   - A) Scroll events
   - B) Search input
   - C) Click events
   - D) Load events

7. **Throttle is best for:**
   - A) Search input
   - B) Scroll events
   - C) Click events
   - D) Load events

**Answers**:
1. B) new CustomEvent()
2. B) Waits for pause
3. B) Limits execution rate
4. B) When finger touches
5. B) Key name
6. B) Search input
7. B) Scroll events

---

## Next Steps

Congratulations! You''ve completed Module 14: Events. You now know:
- Event basics and types
- Event propagation and delegation
- Custom events and advanced patterns
- Performance optimization

**What''s Next?**
- Module 15: Forms and Validation
- Lesson 15.1: Working with Forms
- Learn form handling and validation
- Build interactive forms

---

## Additional Resources

- **MDN: CustomEvent**: [developer.mozilla.org/en-US/docs/Web/API/CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent)
- **MDN: Touch Events**: [developer.mozilla.org/en-US/docs/Web/API/Touch_events](https://developer.mozilla.org/en-US/docs/Web/API/Touch_events)
- **JavaScript.info: Custom Events**: [javascript.info/dispatch-events](https://javascript.info/dispatch-events)

---

*Lesson completed! You''ve finished Module 14: Events. Ready for Module 15: Forms and Validation!*

', NULL, 3, '2026-01-03 09:53:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create and dispatch custom events
- Understand event patterns
- Implement debouncing for performance
- Implement throttling for performance
- Handle touch events for mobile
- Work with keyboard events in detail
- Build advanced event-driven applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (148, 55, 12, 'Working with Forms', 'working-with-forms', '# Lesson 15.1: Working with Forms

## Learning Objectives

By the end of this lesson, you will be able to:
- Access form elements
- Get and set form data
- Handle form submission
- Validate form data
- Work with different form elements
- Prevent default form submission
- Build interactive forms

---

## Introduction to Forms

Forms are essential for collecting user input. JavaScript allows you to interact with forms, validate data, and handle submissions programmatically.

### Why Work with Forms?

- **User Input**: Collect data from users
- **Validation**: Ensure data quality
- **User Experience**: Provide feedback
- **Data Processing**: Handle form data before submission
- **Modern Web**: Essential for web applications

---

## Accessing Form Elements

### Accessing Form by ID

```javascript
let form = document.getElementById(''myForm'');
```

### Accessing Form via forms Collection

```javascript
// Access by index
let firstForm = document.forms[0];

// Access by name
let form = document.forms[''myForm''];

// Access by id
let form = document.forms.myForm;
```

### Accessing Form Elements

```javascript
let form = document.getElementById(''myForm'');

// By name
let username = form.elements.username;
let email = form.elements.email;

// By index
let firstInput = form.elements[0];

// By id (if element has id)
let username = document.getElementById(''username'');
```

---

## Getting Form Data

### Individual Fields

```javascript
let form = document.getElementById(''myForm'');
let username = form.elements.username.value;
let email = form.elements.email.value;
```

### FormData Object

```javascript
let form = document.getElementById(''myForm'');
let formData = new FormData(form);

// Get specific value
let username = formData.get(''username'');

// Get all values
for (let [key, value] of formData.entries()) {
    console.log(key, value);
}
```

### Serialize Form Data

```javascript
function serializeForm(form) {
    let data = {};
    let formData = new FormData(form);
    
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    
    return data;
}

let form = document.getElementById(''myForm'');
let data = serializeForm(form);
console.log(data);
```

### Getting All Form Values

```javascript
function getFormValues(form) {
    let values = {};
    
    for (let element of form.elements) {
        if (element.name) {
            if (element.type === ''checkbox'') {
                values[element.name] = element.checked;
            } else if (element.type === ''radio'') {
                if (element.checked) {
                    values[element.name] = element.value;
                }
            } else {
                values[element.name] = element.value;
            }
        }
    }
    
    return values;
}
```

---

## Setting Form Data

### Setting Individual Fields

```javascript
let form = document.getElementById(''myForm'');
form.elements.username.value = ''Alice'';
form.elements.email.value = ''alice@example.com'';
```

### Setting Multiple Fields

```javascript
function setFormValues(form, data) {
    for (let key in data) {
        let element = form.elements[key];
        if (element) {
            if (element.type === ''checkbox'') {
                element.checked = data[key];
            } else {
                element.value = data[key];
            }
        }
    }
}

let form = document.getElementById(''myForm'');
setFormValues(form, {
    username: ''Alice'',
    email: ''alice@example.com'',
    remember: true
});
```

### Resetting Form

```javascript
// Reset to default values
form.reset();

// Or reset programmatically
form.elements.username.value = '''';
form.elements.email.value = '''';
```

---

## Form Submission

### Preventing Default Submission

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();  // Prevent default form submission
    
    // Handle form data
    let formData = new FormData(form);
    console.log(''Form data:'', formData);
    
    // Submit via AJAX or process data
});
```

### Handling Form Submission

```javascript
form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    // Get form data
    let formData = new FormData(form);
    let data = Object.fromEntries(formData);
    
    // Validate
    if (validateForm(data)) {
        // Submit
        submitForm(data);
    } else {
        // Show errors
        showErrors();
    }
});
```

### Programmatic Submission

```javascript
// Submit form programmatically
form.submit();

// Or trigger submit event
let submitEvent = new Event(''submit'');
form.dispatchEvent(submitEvent);
```

---

## Form Validation

### Basic Validation

```javascript
function validateForm(form) {
    let isValid = true;
    let errors = [];
    
    // Validate username
    let username = form.elements.username.value.trim();
    if (username.length < 3) {
        isValid = false;
        errors.push(''Username must be at least 3 characters'');
    }
    
    // Validate email
    let email = form.elements.email.value.trim();
    if (!email.includes(''@'')) {
        isValid = false;
        errors.push(''Invalid email address'');
    }
    
    // Validate password
    let password = form.elements.password.value;
    if (password.length < 8) {
        isValid = false;
        errors.push(''Password must be at least 8 characters'');
    }
    
    return { isValid, errors };
}
```

### Real-time Validation

```javascript
let usernameInput = form.elements.username;

usernameInput.addEventListener(''blur'', function() {
    let value = this.value.trim();
    
    if (value.length < 3) {
        showError(this, ''Username must be at least 3 characters'');
    } else {
        clearError(this);
    }
});
```

### Validation Functions

```javascript
function validateEmail(email) {
    let regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return regex.test(email);
}

function validatePassword(password) {
    return password.length >= 8 && 
           /[A-Z]/.test(password) && 
           /[a-z]/.test(password) && 
           /\\d/.test(password);
}

function validateUsername(username) {
    return username.length >= 3 && 
           /^[a-zA-Z0-9_]+$/.test(username);
}
```

---

## Working with Different Form Elements

### Text Inputs

```javascript
let input = form.elements.username;
console.log(input.value);        // Get value
input.value = ''New value'';       // Set value
input.placeholder = ''Enter username'';
input.required = true;
```

### Checkboxes

```javascript
let checkbox = form.elements.remember;
console.log(checkbox.checked);   // true or false
checkbox.checked = true;         // Set checked
```

### Radio Buttons

```javascript
let radios = form.elements.gender;
console.log(radios.value);       // Value of checked radio

// Set checked
radios.value = ''male'';
// or
radios[0].checked = true;
```

### Select Dropdowns

```javascript
let select = form.elements.country;
console.log(select.value);      // Selected value
console.log(select.selectedIndex); // Selected index

// Set value
select.value = ''usa'';

// Get selected option
let selectedOption = select.options[select.selectedIndex];
console.log(selectedOption.text);
```

### Textareas

```javascript
let textarea = form.elements.message;
console.log(textarea.value);     // Get value
textarea.value = ''New message'';  // Set value
textarea.rows = 5;              // Set rows
textarea.cols = 50;              // Set columns
```

---

## Practical Examples

### Example 1: Simple Form Handler

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    let formData = new FormData(form);
    let data = {
        username: formData.get(''username''),
        email: formData.get(''email''),
        password: formData.get(''password'')
    };
    
    console.log(''Form data:'', data);
    
    // Process or submit data
    processFormData(data);
});
```

### Example 2: Form with Validation

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    let errors = validateForm(form);
    
    if (errors.length === 0) {
        // Form is valid
        let formData = new FormData(form);
        submitForm(formData);
    } else {
        // Show errors
        displayErrors(errors);
    }
});

function validateForm(form) {
    let errors = [];
    
    // Validate each field
    let username = form.elements.username.value.trim();
    if (!username) {
        errors.push(''Username is required'');
    } else if (username.length < 3) {
        errors.push(''Username must be at least 3 characters'');
    }
    
    let email = form.elements.email.value.trim();
    if (!email) {
        errors.push(''Email is required'');
    } else if (!validateEmail(email)) {
        errors.push(''Invalid email address'');
    }
    
    return errors;
}
```

### Example 3: Real-time Validation

```javascript
let form = document.getElementById(''myForm'');

// Validate on blur
form.elements.username.addEventListener(''blur'', function() {
    validateField(this, validateUsername);
});

form.elements.email.addEventListener(''blur'', function() {
    validateField(this, validateEmail);
});

function validateField(field, validator) {
    let value = field.value.trim();
    let errorElement = field.parentElement.querySelector(''.error'');
    
    if (!value) {
        showError(field, ''This field is required'');
    } else if (!validator(value)) {
        showError(field, ''Invalid value'');
    } else {
        clearError(field);
    }
}

function showError(field, message) {
    clearError(field);
    field.classList.add(''error'');
    let errorDiv = document.createElement(''div'');
    errorDiv.className = ''error-message'';
    errorDiv.textContent = message;
    field.parentElement.appendChild(errorDiv);
}

function clearError(field) {
    field.classList.remove(''error'');
    let errorDiv = field.parentElement.querySelector(''.error-message'');
    if (errorDiv) {
        errorDiv.remove();
    }
}
```

---

## Practice Exercise

### Exercise: Form Handling

**Objective**: Practice working with forms, accessing data, and validation.

**Instructions**:

1. Create an HTML file with a form
2. Create a JavaScript file for form handling
3. Practice:
   - Accessing form elements
   - Getting form data
   - Setting form data
   - Handling form submission
   - Form validation

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Handling Practice</title>
    <style>
        .error {
            border: 2px solid red;
        }
        .error-message {
            color: red;
            font-size: 12px;
            margin-top: 5px;
        }
        .success {
            border: 2px solid green;
        }
        form {
            max-width: 400px;
            margin: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <h1>Form Handling Practice</h1>
    
    <form id="userForm">
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="email">Email:</label>
            <input type="email" id="email" name="email" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="country">Country:</label>
            <select id="country" name="country">
                <option value="">Select country</option>
                <option value="us">United States</option>
                <option value="uk">United Kingdom</option>
                <option value="ca">Canada</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>
                <input type="checkbox" name="newsletter" value="yes">
                Subscribe to newsletter
            </label>
        </div>
        
        <div class="form-group">
            <label>Gender:</label>
            <label><input type="radio" name="gender" value="male"> Male</label>
            <label><input type="radio" name="gender" value="female"> Female</label>
            <label><input type="radio" name="gender" value="other"> Other</label>
        </div>
        
        <div class="form-group">
            <label for="message">Message:</label>
            <textarea id="message" name="message" rows="4"></textarea>
        </div>
        
        <button type="submit">Submit</button>
        <button type="reset">Reset</button>
    </form>
    
    <div id="output"></div>
    
    <script src="form-handling.js"></script>
</body>
</html>
```

```javascript
// form-handling.js
console.log("=== Form Handling Practice ===");

let form = document.getElementById(''userForm'');
let output = document.getElementById(''output'');

console.log("\\n=== Accessing Form Elements ===");

// Access form
console.log("Form:", form);
console.log("Form ID:", form.id);
console.log("Form method:", form.method);
console.log("Form action:", form.action);

// Access elements
console.log("Username element:", form.elements.username);
console.log("Email element:", form.elements.email);
console.log("Number of elements:", form.elements.length);
console.log();

console.log("=== Getting Form Data ===");

// Individual fields
function getFormData() {
    return {
        username: form.elements.username.value,
        email: form.elements.email.value,
        password: form.elements.password.value,
        country: form.elements.country.value,
        newsletter: form.elements.newsletter.checked,
        gender: form.elements.gender.value,
        message: form.elements.message.value
    };
}

// Using FormData
function getFormDataFormData() {
    let formData = new FormData(form);
    let data = {};
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    return data;
}

// Display current form data
function displayFormData() {
    let data = getFormData();
    console.log("Current form data:", data);
}
console.log();

console.log("=== Setting Form Data ===");

function setFormData(data) {
    if (data.username) form.elements.username.value = data.username;
    if (data.email) form.elements.email.value = data.email;
    if (data.password) form.elements.password.value = data.password;
    if (data.country) form.elements.country.value = data.country;
    if (data.newsletter !== undefined) form.elements.newsletter.checked = data.newsletter;
    if (data.gender) form.elements.gender.value = data.gender;
    if (data.message) form.elements.message.value = data.message;
}

// Set sample data
setFormData({
    username: ''alice'',
    email: ''alice@example.com'',
    country: ''us'',
    newsletter: true,
    gender: ''female'',
    message: ''Hello world''
});

console.log("Set sample form data");
displayFormData();
console.log();

console.log("=== Form Submission ===");

form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    console.log(''Form submitted'');
    
    let data = getFormData();
    console.log(''Submitted data:'', data);
    
    // Validate
    let errors = validateForm(form);
    
    if (errors.length === 0) {
        console.log(''Form is valid'');
        output.innerHTML = ''<p style="color: green;">Form submitted successfully!</p>'';
        output.innerHTML += ''<pre>'' + JSON.stringify(data, null, 2) + ''</pre>'';
        
        // Could submit to server here
        // submitToServer(data);
    } else {
        console.log(''Form has errors:'', errors);
        output.innerHTML = ''<p style="color: red;">Form has errors:</p><ul>'';
        errors.forEach(error => {
            output.innerHTML += ''<li>'' + error + ''</li>'';
        });
        output.innerHTML += ''</ul>'';
    }
});
console.log();

console.log("=== Form Validation ===");

function validateForm(form) {
    let errors = [];
    
    // Username validation
    let username = form.elements.username.value.trim();
    if (!username) {
        errors.push(''Username is required'');
    } else if (username.length < 3) {
        errors.push(''Username must be at least 3 characters'');
    } else if (!/^[a-zA-Z0-9_]+$/.test(username)) {
        errors.push(''Username can only contain letters, numbers, and underscores'');
    }
    
    // Email validation
    let email = form.elements.email.value.trim();
    if (!email) {
        errors.push(''Email is required'');
    } else if (!validateEmail(email)) {
        errors.push(''Invalid email address'');
    }
    
    // Password validation
    let password = form.elements.password.value;
    if (!password) {
        errors.push(''Password is required'');
    } else if (password.length < 8) {
        errors.push(''Password must be at least 8 characters'');
    }
    
    // Country validation
    let country = form.elements.country.value;
    if (!country) {
        errors.push(''Country is required'');
    }
    
    return errors;
}

function validateEmail(email) {
    let regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return regex.test(email);
}
console.log();

console.log("=== Real-time Validation ===");

// Username validation
form.elements.username.addEventListener(''blur'', function() {
    validateField(this, function(value) {
        if (!value) {
            return ''Username is required'';
        } else if (value.length < 3) {
            return ''Username must be at least 3 characters'';
        } else if (!/^[a-zA-Z0-9_]+$/.test(value)) {
            return ''Username can only contain letters, numbers, and underscores'';
        }
        return null;
    });
});

// Email validation
form.elements.email.addEventListener(''blur'', function() {
    validateField(this, function(value) {
        if (!value) {
            return ''Email is required'';
        } else if (!validateEmail(value)) {
            return ''Invalid email address'';
        }
        return null;
    });
});

// Password validation
form.elements.password.addEventListener(''blur'', function() {
    validateField(this, function(value) {
        if (!value) {
            return ''Password is required'';
        } else if (value.length < 8) {
            return ''Password must be at least 8 characters'';
        }
        return null;
    });
});

function validateField(field, validator) {
    let value = field.value.trim();
    let errorMessage = field.parentElement.querySelector(''.error-message'');
    let error = validator(value);
    
    if (error) {
        field.classList.add(''error'');
        field.classList.remove(''success'');
        if (errorMessage) {
            errorMessage.textContent = error;
        }
    } else {
        field.classList.remove(''error'');
        field.classList.add(''success'');
        if (errorMessage) {
            errorMessage.textContent = '''';
        }
    }
}
console.log();

console.log("=== Working with Different Elements ===");

// Text input
console.log("Text input value:", form.elements.username.value);

// Checkbox
console.log("Checkbox checked:", form.elements.newsletter.checked);

// Radio buttons
console.log("Radio value:", form.elements.gender.value);

// Select
console.log("Select value:", form.elements.country.value);
console.log("Select selected index:", form.elements.country.selectedIndex);
console.log("Selected option:", form.elements.country.options[form.elements.country.selectedIndex]?.text);

// Textarea
console.log("Textarea value:", form.elements.message.value);
console.log();

console.log("=== Form Reset ===");

form.addEventListener(''reset'', function() {
    console.log(''Form reset'');
    output.innerHTML = '''';
    
    // Clear all error messages
    let errorMessages = document.querySelectorAll(''.error-message'');
    errorMessages.forEach(msg => msg.textContent = '''');
    
    let errorFields = document.querySelectorAll(''.error'');
    errorFields.forEach(field => {
        field.classList.remove(''error'');
        field.classList.remove(''success'');
    });
});
console.log();

console.log("=== FormData API ===");

function demonstrateFormData() {
    let formData = new FormData(form);
    
    console.log("FormData entries:");
    for (let [key, value] of formData.entries()) {
        console.log(`${key}: ${value}`);
    }
    
    // Get specific value
    console.log("Username from FormData:", formData.get(''username''));
    console.log("Newsletter from FormData:", formData.get(''newsletter''));
    
    // Check if has key
    console.log("Has username:", formData.has(''username''));
    
    // Get all values for a key (if multiple)
    console.log("All values:", Array.from(formData.values()));
}

// Demonstrate when form is submitted
form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    demonstrateFormData();
});
```

**Expected Output** (in browser console):
```
=== Form Handling Practice ===

=== Accessing Form Elements ===
Form: [form element]
Form ID: userForm
Form method: get
Form action: 
Username element: [input element]
Email element: [input element]
Number of elements: [number]

=== Getting Form Data ===
Current form data: { username: "alice", email: "alice@example.com", ... }

=== Setting Form Data ===
Set sample form data
Current form data: { username: "alice", email: "alice@example.com", ... }

=== Form Submission ===
[On submit]
Form submitted
Submitted data: { username: "...", email: "...", ... }
Form is valid / Form has errors: [...]

=== Form Validation ===
[Validation functions defined]

=== Real-time Validation ===
[On blur events]
[Shows validation messages]

=== Working with Different Elements ===
Text input value: alice
Checkbox checked: true
Radio value: female
Select value: us
Selected option: United States
Textarea value: Hello world

=== Form Reset ===
[On reset]
Form reset

=== FormData API ===
[On submit]
FormData entries:
username: alice
email: alice@example.com
...
Username from FormData: alice
Newsletter from FormData: yes
Has username: true
All values: [array of values]
```

**Challenge (Optional)**:
- Build a complete form validation system
- Create a multi-step form
- Build a form builder
- Create a form data persistence system

---

## Common Mistakes

### 1. Not Preventing Default

```javascript
// ⚠️ Problem: Form submits and page reloads
form.addEventListener(''submit'', function(event) {
    // Process form
    // Page reloads!
});

// ✅ Solution: Prevent default
form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    // Process form
});
```

### 2. Accessing Value Before Input

```javascript
// ⚠️ Problem: Value might be empty
let username = form.elements.username.value;
console.log(username);  // Might be empty

// ✅ Solution: Check or wait for input
form.elements.username.addEventListener(''input'', function() {
    console.log(this.value);
});
```

### 3. Not Handling Checkboxes/Radios

```javascript
// ⚠️ Problem: Wrong way to get checkbox value
let newsletter = form.elements.newsletter.value;  // Always "yes"

// ✅ Solution: Check checked property
let newsletter = form.elements.newsletter.checked;
```

### 4. Not Trimming Values

```javascript
// ⚠️ Problem: Includes whitespace
let username = form.elements.username.value;
if (username.length < 3) { }  // Might fail due to spaces

// ✅ Solution: Trim first
let username = form.elements.username.value.trim();
```

---

## Key Takeaways

1. **Form Access**: Use getElementById, forms collection, or querySelector
2. **Form Data**: Use FormData or access elements directly
3. **Form Submission**: Prevent default, handle programmatically
4. **Validation**: Check values before submission
5. **Form Elements**: Different elements need different handling
6. **Real-time**: Validate on blur or input
7. **Best Practice**: Always prevent default, validate data, trim values
8. **FormData**: Modern API for form data handling

---

## Quiz: Forms

Test your understanding with these questions:

1. **Form elements accessed via:**
   - A) form.elements
   - B) form.inputs
   - C) form.fields
   - D) form.data

2. **FormData is:**
   - A) Old API
   - B) Modern API
   - C) Deprecated
   - D) Not available

3. **Checkbox value accessed via:**
   - A) value property
   - B) checked property
   - C) Both
   - D) Neither

4. **preventDefault() prevents:**
   - A) Form submission
   - B) Event propagation
   - C) Both
   - D) Neither

5. **form.reset() does:**
   - A) Clears all fields
   - B) Resets to default values
   - C) Both
   - D) Nothing

6. **Radio button value:**
   - A) Value of checked button
   - B) All values
   - C) First value
   - D) Nothing

7. **FormData.get() returns:**
   - A) All values
   - B) First value for key
   - C) Last value
   - D) Nothing

**Answers**:
1. A) form.elements
2. B) Modern API
3. B) checked property (for boolean, value for string)
4. A) Form submission (default behavior)
5. B) Resets to default values
6. A) Value of checked button
7. B) First value for key

---

## Next Steps

Congratulations! You''ve learned form handling. You now know:
- How to access form elements
- How to get and set form data
- How to handle form submission
- How to validate forms

**What''s Next?**
- Lesson 15.2: Input Types and Validation
- Learn different input types
- Understand HTML5 validation
- Build comprehensive validation systems

---

## Additional Resources

- **MDN: Forms**: [developer.mozilla.org/en-US/docs/Web/HTML/Element/form](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/form)
- **MDN: FormData**: [developer.mozilla.org/en-US/docs/Web/API/FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData)
- **JavaScript.info: Forms**: [javascript.info/forms-controls](https://javascript.info/forms-controls)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:53:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Access form elements
- Get and set form data
- Handle form submission
- Validate form data
- Work with different form elements
- Prevent default form submission
- Build interactive forms');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (149, 55, 12, 'Input Types and Validation', 'input-types-and-validation', '# Lesson 15.2: Input Types and Validation

## Learning Objectives

By the end of this lesson, you will be able to:
- Work with different HTML5 input types
- Use HTML5 built-in validation
- Implement JavaScript validation
- Create real-time validation
- Build custom validation rules
- Display validation errors
- Create user-friendly validation feedback

---

## Introduction to Input Types

HTML5 introduced many new input types that provide better user experience and built-in validation.

### Why Different Input Types?

- **Better UX**: Appropriate keyboards on mobile
- **Built-in Validation**: Browser validates automatically
- **Data Type**: Ensures correct data format
- **Accessibility**: Better for screen readers
- **Modern Standard**: HTML5 standard

---

## HTML5 Input Types

### Text Inputs

```html
<!-- Basic text -->
<input type="text" name="username">

<!-- Email -->
<input type="email" name="email">

<!-- Password -->
<input type="password" name="password">

<!-- Number -->
<input type="number" name="age" min="0" max="120">

<!-- Tel -->
<input type="tel" name="phone">

<!-- URL -->
<input type="url" name="website">

<!-- Search -->
<input type="search" name="query">
```

### Date and Time Inputs

```html
<!-- Date -->
<input type="date" name="birthday">

<!-- Time -->
<input type="time" name="appointment">

<!-- DateTime Local -->
<input type="datetime-local" name="event">

<!-- Month -->
<input type="month" name="month">

<!-- Week -->
<input type="week" name="week">
```

### Other Input Types

```html
<!-- Color -->
<input type="color" name="color">

<!-- Range -->
<input type="range" name="volume" min="0" max="100">

<!-- File -->
<input type="file" name="upload" accept="image/*">

<!-- Hidden -->
<input type="hidden" name="token" value="abc123">
```

---

## HTML5 Validation Attributes

### required

Makes field required:

```html
<input type="text" name="username" required>
```

### min and max

Set minimum and maximum values:

```html
<input type="number" name="age" min="18" max="100">
<input type="date" name="date" min="2024-01-01" max="2024-12-31">
```

### minlength and maxlength

Set minimum and maximum length:

```html
<input type="text" name="username" minlength="3" maxlength="20">
```

### pattern

Validate against regex pattern:

```html
<input type="text" name="username" pattern="[a-zA-Z0-9_]+">
```

### step

Set step for number inputs:

```html
<input type="number" name="quantity" min="0" step="5">
```

### Validation Messages

```javascript
let input = document.getElementById(''username'');

input.addEventListener(''invalid'', function(event) {
    if (input.validity.valueMissing) {
        input.setCustomValidity(''Username is required'');
    } else if (input.validity.tooShort) {
        input.setCustomValidity(''Username is too short'');
    } else {
        input.setCustomValidity('''');
    }
});
```

---

## JavaScript Validation

### Validity API

```javascript
let input = document.getElementById(''email'');

// Check validity
console.log(input.validity.valid);           // true or false
console.log(input.validity.valueMissing);     // true if required and empty
console.log(input.validity.typeMismatch);     // true if type doesn''t match
console.log(input.validity.patternMismatch);  // true if pattern doesn''t match
console.log(input.validity.tooLong);          // true if too long
console.log(input.validity.tooShort);         // true if too short
console.log(input.validity.rangeUnderflow);   // true if below min
console.log(input.validity.rangeOverflow);     // true if above max
console.log(input.validity.stepMismatch);     // true if step doesn''t match
console.log(input.validity.badInput);         // true if bad input
console.log(input.validity.customError);      // true if custom error set

// Validation message
console.log(input.validationMessage);
```

### checkValidity()

Check if form or element is valid:

```javascript
let form = document.getElementById(''myForm'');

if (form.checkValidity()) {
    // Form is valid
    submitForm();
} else {
    // Form has errors
    showErrors();
}

// Check individual field
let input = form.elements.username;
if (input.checkValidity()) {
    console.log(''Field is valid'');
} else {
    console.log(''Field error:'', input.validationMessage);
}
```

### reportValidity()

Show validation messages to user:

```javascript
let form = document.getElementById(''myForm'');

if (!form.reportValidity()) {
    // Validation failed, browser shows messages
    return;
}

// Form is valid
submitForm();
```

---

## Custom Validation

### setCustomValidity()

Set custom validation message:

```javascript
let password = document.getElementById(''password'');
let confirmPassword = document.getElementById(''confirmPassword'');

confirmPassword.addEventListener(''input'', function() {
    if (this.value !== password.value) {
        this.setCustomValidity(''Passwords do not match'');
    } else {
        this.setCustomValidity('''');
    }
});
```

### Custom Validation Example

```javascript
function validatePassword(password) {
    let errors = [];
    
    if (password.length < 8) {
        errors.push(''Password must be at least 8 characters'');
    }
    if (!/[A-Z]/.test(password)) {
        errors.push(''Password must contain uppercase letter'');
    }
    if (!/[a-z]/.test(password)) {
        errors.push(''Password must contain lowercase letter'');
    }
    if (!/\\d/.test(password)) {
        errors.push(''Password must contain a number'');
    }
    if (!/[!@#$%^&*]/.test(password)) {
        errors.push(''Password must contain special character'');
    }
    
    return errors;
}

let passwordInput = document.getElementById(''password'');
passwordInput.addEventListener(''blur'', function() {
    let errors = validatePassword(this.value);
    
    if (errors.length > 0) {
        this.setCustomValidity(errors.join(''. ''));
    } else {
        this.setCustomValidity('''');
    }
});
```

---

## Real-time Validation

### Input Event Validation

```javascript
let usernameInput = document.getElementById(''username'');

usernameInput.addEventListener(''input'', function() {
    validateUsername(this);
});

function validateUsername(input) {
    let value = input.value.trim();
    let errorDiv = input.parentElement.querySelector(''.error'');
    
    if (value.length < 3) {
        showError(input, ''Username must be at least 3 characters'');
    } else if (!/^[a-zA-Z0-9_]+$/.test(value)) {
        showError(input, ''Username can only contain letters, numbers, and underscores'');
    } else {
        clearError(input);
    }
}
```

### Blur Event Validation

```javascript
let emailInput = document.getElementById(''email'');

emailInput.addEventListener(''blur'', function() {
    validateEmail(this);
});

function validateEmail(input) {
    let value = input.value.trim();
    
    if (!value) {
        showError(input, ''Email is required'');
    } else if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value)) {
        showError(input, ''Invalid email address'');
    } else {
        clearError(input);
    }
}
```

### Combined Validation

```javascript
function setupValidation(input, validator) {
    // Validate on blur
    input.addEventListener(''blur'', function() {
        validator(this);
    });
    
    // Clear error on input (optional)
    input.addEventListener(''input'', function() {
        if (this.classList.contains(''error'')) {
            validator(this);
        }
    });
}

setupValidation(usernameInput, validateUsername);
setupValidation(emailInput, validateEmail);
```

---

## Validation Patterns

### Email Validation

```javascript
function validateEmail(email) {
    let regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return regex.test(email);
}

// More strict
function validateEmailStrict(email) {
    let regex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;
    return regex.test(email);
}
```

### Password Validation

```javascript
function validatePassword(password) {
    let rules = {
        minLength: password.length >= 8,
        hasUpperCase: /[A-Z]/.test(password),
        hasLowerCase: /[a-z]/.test(password),
        hasNumber: /\\d/.test(password),
        hasSpecial: /[!@#$%^&*(),.?":{}|<>]/.test(password)
    };
    
    return rules;
}
```

### Phone Validation

```javascript
function validatePhone(phone) {
    // Remove non-digits
    let digits = phone.replace(/\\D/g, '''');
    
    // US phone: 10 digits
    if (digits.length === 10) {
        return true;
    }
    
    // International: +country code
    if (phone.startsWith(''+'') && digits.length >= 10) {
        return true;
    }
    
    return false;
}
```

### URL Validation

```javascript
function validateURL(url) {
    try {
        new URL(url);
        return true;
    } catch {
        return false;
    }
}

// Or regex
function validateURLRegex(url) {
    let regex = /^https?:\\/\\/.+\\..+/;
    return regex.test(url);
}
```

---

## Displaying Validation Errors

### Inline Error Messages

```javascript
function showError(input, message) {
    input.classList.add(''error'');
    
    let errorDiv = input.parentElement.querySelector(''.error-message'');
    if (!errorDiv) {
        errorDiv = document.createElement(''div'');
        errorDiv.className = ''error-message'';
        input.parentElement.appendChild(errorDiv);
    }
    errorDiv.textContent = message;
}

function clearError(input) {
    input.classList.remove(''error'');
    let errorDiv = input.parentElement.querySelector(''.error-message'');
    if (errorDiv) {
        errorDiv.remove();
    }
}
```

### Summary Error List

```javascript
function displayFormErrors(errors) {
    let errorContainer = document.getElementById(''errors'');
    errorContainer.innerHTML = '''';
    
    if (errors.length > 0) {
        let errorList = document.createElement(''ul'');
        errorList.className = ''error-list'';
        
        errors.forEach(error => {
            let li = document.createElement(''li'');
            li.textContent = error;
            errorList.appendChild(li);
        });
        
        errorContainer.appendChild(errorList);
    }
}
```

### Visual Feedback

```javascript
function updateFieldStatus(input, isValid, message) {
    if (isValid) {
        input.classList.remove(''error'');
        input.classList.add(''success'');
        clearError(input);
    } else {
        input.classList.remove(''success'');
        input.classList.add(''error'');
        showError(input, message);
    }
}
```

---

## Practical Examples

### Example 1: Complete Form Validation

```javascript
let form = document.getElementById(''myForm'');

form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    let errors = validateForm(form);
    
    if (errors.length === 0) {
        submitForm(form);
    } else {
        displayErrors(errors);
    }
});

function validateForm(form) {
    let errors = [];
    
    // Validate each field
    let username = form.elements.username.value.trim();
    if (!username) {
        errors.push({ field: ''username'', message: ''Username is required'' });
    } else if (username.length < 3) {
        errors.push({ field: ''username'', message: ''Username must be at least 3 characters'' });
    }
    
    let email = form.elements.email.value.trim();
    if (!email) {
        errors.push({ field: ''email'', message: ''Email is required'' });
    } else if (!validateEmail(email)) {
        errors.push({ field: ''email'', message: ''Invalid email address'' });
    }
    
    // ... more validations
    
    return errors;
}
```

### Example 2: Real-time Password Strength

```javascript
let passwordInput = document.getElementById(''password'');
let strengthIndicator = document.getElementById(''strength'');

passwordInput.addEventListener(''input'', function() {
    let strength = calculatePasswordStrength(this.value);
    updateStrengthIndicator(strength);
});

function calculatePasswordStrength(password) {
    let strength = 0;
    
    if (password.length >= 8) strength++;
    if (password.length >= 12) strength++;
    if (/[a-z]/.test(password)) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/\\d/.test(password)) strength++;
    if (/[!@#$%^&*]/.test(password)) strength++;
    
    return strength;
}

function updateStrengthIndicator(strength) {
    strengthIndicator.className = ''strength-'' + strength;
    
    if (strength <= 2) {
        strengthIndicator.textContent = ''Weak'';
    } else if (strength <= 4) {
        strengthIndicator.textContent = ''Medium'';
    } else {
        strengthIndicator.textContent = ''Strong'';
    }
}
```

### Example 3: Conditional Validation

```javascript
let form = document.getElementById(''myForm'');
let ageInput = form.elements.age;
let parentConsent = form.elements.parentConsent;

ageInput.addEventListener(''change'', function() {
    let age = parseInt(this.value);
    
    if (age < 18) {
        parentConsent.required = true;
        parentConsent.parentElement.style.display = ''block'';
    } else {
        parentConsent.required = false;
        parentConsent.parentElement.style.display = ''none'';
    }
});
```

---

## Practice Exercise

### Exercise: Form Validation

**Objective**: Practice working with different input types and implementing validation.

**Instructions**:

1. Create an HTML file with various input types
2. Create a JavaScript file for validation
3. Practice:
   - HTML5 validation attributes
   - JavaScript validation
   - Real-time validation
   - Custom validation rules
   - Error display

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input Types and Validation</title>
    <style>
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        .error {
            border: 2px solid red;
        }
        .success {
            border: 2px solid green;
        }
        .error-message {
            color: red;
            font-size: 12px;
            margin-top: 5px;
        }
        .strength-weak { color: red; }
        .strength-medium { color: orange; }
        .strength-strong { color: green; }
    </style>
</head>
<body>
    <h1>Input Types and Validation Practice</h1>
    
    <form id="validationForm">
        <div class="form-group">
            <label for="email">Email (HTML5):</label>
            <input type="email" id="email" name="email" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" name="username" 
                   pattern="[a-zA-Z0-9_]+" minlength="3" maxlength="20" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="password">Password:</label>
            <input type="password" id="password" name="password" 
                   minlength="8" required>
            <div id="strength"></div>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="confirmPassword">Confirm Password:</label>
            <input type="password" id="confirmPassword" name="confirmPassword" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="age">Age:</label>
            <input type="number" id="age" name="age" min="18" max="100" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="birthday">Birthday:</label>
            <input type="date" id="birthday" name="birthday" required>
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="phone">Phone:</label>
            <input type="tel" id="phone" name="phone" pattern="[0-9]{10}">
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="website">Website:</label>
            <input type="url" id="website" name="website">
            <div class="error-message"></div>
        </div>
        
        <div class="form-group">
            <label for="volume">Volume (0-100):</label>
            <input type="range" id="volume" name="volume" min="0" max="100" value="50">
            <span id="volumeValue">50</span>
        </div>
        
        <div class="form-group">
            <label for="color">Favorite Color:</label>
            <input type="color" id="color" name="color" value="#000000">
        </div>
        
        <button type="submit">Submit</button>
        <button type="reset">Reset</button>
    </form>
    
    <div id="output"></div>
    
    <script src="input-validation.js"></script>
</body>
</html>
```

```javascript
// input-validation.js
console.log("=== Input Types and Validation Practice ===");

let form = document.getElementById(''validationForm'');
let output = document.getElementById(''output'');

console.log("\\n=== HTML5 Input Types ===");

// Email input
let emailInput = form.elements.email;
console.log("Email input type:", emailInput.type);

// Number input
let ageInput = form.elements.age;
console.log("Age input type:", ageInput.type);
console.log("Age min:", ageInput.min);
console.log("Age max:", ageInput.max);

// Date input
let birthdayInput = form.elements.birthday;
console.log("Birthday input type:", birthdayInput.type);

// Range input
let volumeInput = form.elements.volume;
let volumeValue = document.getElementById(''volumeValue'');
volumeInput.addEventListener(''input'', function() {
    volumeValue.textContent = this.value;
});
console.log();

console.log("=== HTML5 Validation ===");

// Check validity
function checkFieldValidity(input) {
    console.log(`${input.name} validity:`, input.validity.valid);
    if (!input.validity.valid) {
        console.log(`  Error: ${input.validationMessage}`);
        console.log(`  Value missing: ${input.validity.valueMissing}`);
        console.log(`  Type mismatch: ${input.validity.typeMismatch}`);
        console.log(`  Too short: ${input.validity.tooShort}`);
        console.log(`  Pattern mismatch: ${input.validity.patternMismatch}`);
    }
}

// Check form validity
function checkFormValidity() {
    console.log("Form valid:", form.checkValidity());
    
    Array.from(form.elements).forEach(element => {
        if (element.tagName === ''INPUT'' || element.tagName === ''SELECT'' || element.tagName === ''TEXTAREA'') {
            if (!element.validity.valid) {
                checkFieldValidity(element);
            }
        }
    });
}
console.log();

console.log("=== Custom Validation Messages ===");

emailInput.addEventListener(''invalid'', function(event) {
    if (this.validity.valueMissing) {
        this.setCustomValidity(''Email address is required'');
    } else if (this.validity.typeMismatch) {
        this.setCustomValidity(''Please enter a valid email address'');
    } else {
        this.setCustomValidity('''');
    }
});
console.log();

console.log("=== Real-time Validation ===");

// Username validation
let usernameInput = form.elements.username;
usernameInput.addEventListener(''blur'', function() {
    validateUsername(this);
});

function validateUsername(input) {
    let value = input.value.trim();
    let error = null;
    
    if (!value) {
        error = ''Username is required'';
    } else if (value.length < 3) {
        error = ''Username must be at least 3 characters'';
    } else if (value.length > 20) {
        error = ''Username must be no more than 20 characters'';
    } else if (!/^[a-zA-Z0-9_]+$/.test(value)) {
        error = ''Username can only contain letters, numbers, and underscores'';
    }
    
    updateFieldStatus(input, !error, error);
}

// Password strength
let passwordInput = form.elements.password;
passwordInput.addEventListener(''input'', function() {
    let strength = calculatePasswordStrength(this.value);
    updatePasswordStrength(strength);
    validatePassword(this);
});

function calculatePasswordStrength(password) {
    let strength = 0;
    
    if (password.length >= 8) strength++;
    if (password.length >= 12) strength++;
    if (/[a-z]/.test(password)) strength++;
    if (/[A-Z]/.test(password)) strength++;
    if (/\\d/.test(password)) strength++;
    if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) strength++;
    
    return strength;
}

function updatePasswordStrength(strength) {
    let strengthDiv = document.getElementById(''strength'');
    
    if (strength <= 2) {
        strengthDiv.textContent = ''Password strength: Weak'';
        strengthDiv.className = ''strength-weak'';
    } else if (strength <= 4) {
        strengthDiv.textContent = ''Password strength: Medium'';
        strengthDiv.className = ''strength-medium'';
    } else {
        strengthDiv.textContent = ''Password strength: Strong'';
        strengthDiv.className = ''strength-strong'';
    }
}

function validatePassword(input) {
    let value = input.value;
    let error = null;
    
    if (!value) {
        error = ''Password is required'';
    } else if (value.length < 8) {
        error = ''Password must be at least 8 characters'';
    } else {
        let rules = {
            hasUpperCase: /[A-Z]/.test(value),
            hasLowerCase: /[a-z]/.test(value),
            hasNumber: /\\d/.test(value),
            hasSpecial: /[!@#$%^&*(),.?":{}|<>]/.test(value)
        };
        
        let missing = [];
        if (!rules.hasUpperCase) missing.push(''uppercase letter'');
        if (!rules.hasLowerCase) missing.push(''lowercase letter'');
        if (!rules.hasNumber) missing.push(''number'');
        if (!rules.hasSpecial) missing.push(''special character'');
        
        if (missing.length > 0) {
            error = `Password must contain: ${missing.join('', '')}`;
        }
    }
    
    updateFieldStatus(input, !error, error);
}

// Confirm password
let confirmPasswordInput = form.elements.confirmPassword;
confirmPasswordInput.addEventListener(''blur'', function() {
    validateConfirmPassword(this);
});

function validateConfirmPassword(input) {
    let value = input.value;
    let password = passwordInput.value;
    let error = null;
    
    if (!value) {
        error = ''Please confirm your password'';
    } else if (value !== password) {
        error = ''Passwords do not match'';
    }
    
    updateFieldStatus(input, !error, error);
}

// Phone validation
let phoneInput = form.elements.phone;
phoneInput.addEventListener(''blur'', function() {
    validatePhone(this);
});

function validatePhone(input) {
    let value = input.value.trim();
    let error = null;
    
    if (value && !/^\\d{10}$/.test(value.replace(/\\D/g, ''''))) {
        error = ''Please enter a valid 10-digit phone number'';
    }
    
    updateFieldStatus(input, !error, error);
}

// Website validation
let websiteInput = form.elements.website;
websiteInput.addEventListener(''blur'', function() {
    validateWebsite(this);
});

function validateWebsite(input) {
    let value = input.value.trim();
    let error = null;
    
    if (value) {
        try {
            new URL(value);
        } catch {
            error = ''Please enter a valid URL (e.g., https://example.com)'';
        }
    }
    
    updateFieldStatus(input, !error, error);
}
console.log();

console.log("=== Field Status Update ===");

function updateFieldStatus(input, isValid, errorMessage) {
    let errorDiv = input.parentElement.querySelector(''.error-message'');
    
    if (isValid) {
        input.classList.remove(''error'');
        input.classList.add(''success'');
        if (errorDiv) {
            errorDiv.textContent = '''';
        }
    } else {
        input.classList.remove(''success'');
        input.classList.add(''error'');
        if (errorDiv) {
            errorDiv.textContent = errorMessage || '''';
        }
    }
}
console.log();

console.log("=== Form Submission with Validation ===");

form.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    console.log(''Form submission attempted'');
    
    // Check HTML5 validity
    if (!form.checkValidity()) {
        console.log(''HTML5 validation failed'');
        form.reportValidity();
        return;
    }
    
    // Additional JavaScript validation
    let errors = [];
    
    // Validate password match
    if (passwordInput.value !== confirmPasswordInput.value) {
        errors.push(''Passwords do not match'');
    }
    
    // Validate age
    let age = parseInt(ageInput.value);
    if (age < 18) {
        errors.push(''You must be at least 18 years old'');
    }
    
    if (errors.length > 0) {
        console.log(''JavaScript validation errors:'', errors);
        output.innerHTML = ''<div style="color: red;"><strong>Errors:</strong><ul>'' +
            errors.map(e => ''<li>'' + e + ''</li>'').join('''') + ''</ul></div>'';
        return;
    }
    
    // Form is valid
    console.log(''Form is valid'');
    let formData = new FormData(form);
    let data = {};
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    
    output.innerHTML = ''<div style="color: green;"><strong>Form submitted successfully!</strong></div>'';
    output.innerHTML += ''<pre>'' + JSON.stringify(data, null, 2) + ''</pre>'';
});
console.log();

console.log("=== Validity API Demonstration ===");

function demonstrateValidityAPI() {
    console.log("=== Email Field Validity ===");
    console.log("Valid:", emailInput.validity.valid);
    console.log("Value missing:", emailInput.validity.valueMissing);
    console.log("Type mismatch:", emailInput.validity.typeMismatch);
    console.log("Validation message:", emailInput.validationMessage);
    
    console.log("\\n=== Username Field Validity ===");
    console.log("Valid:", usernameInput.validity.valid);
    console.log("Pattern mismatch:", usernameInput.validity.patternMismatch);
    console.log("Too short:", usernameInput.validity.tooShort);
    console.log("Too long:", usernameInput.validity.tooLong);
    
    console.log("\\n=== Age Field Validity ===");
    console.log("Valid:", ageInput.validity.valid);
    console.log("Range underflow:", ageInput.validity.rangeUnderflow);
    console.log("Range overflow:", ageInput.validity.rangeOverflow);
    console.log("Step mismatch:", ageInput.validity.stepMismatch);
}

// Demonstrate after form interaction
setTimeout(() => {
    demonstrateValidityAPI();
}, 2000);
console.log();

console.log("=== Input Type Features ===");

// Date input
birthdayInput.addEventListener(''change'', function() {
    console.log(''Birthday selected:'', this.value);
    let date = new Date(this.value);
    console.log(''Date object:'', date);
});

// Range input
volumeInput.addEventListener(''input'', function() {
    console.log(''Volume changed:'', this.value);
});

// Color input
let colorInput = form.elements.color;
colorInput.addEventListener(''change'', function() {
    console.log(''Color selected:'', this.value);
    document.body.style.backgroundColor = this.value;
});
```

**Expected Output** (in browser console):
```
=== Input Types and Validation Practice ===

=== HTML5 Input Types ===
Email input type: email
Age input type: number
Age min: 18
Age max: 100
Birthday input type: date

=== HTML5 Validation ===
[On form check]
Form valid: true/false
[Field validity details]

=== Custom Validation Messages ===
[Custom messages set]

=== Real-time Validation ===
[On blur/input events]
[Validation messages shown]

=== Field Status Update ===
[Fields updated with success/error classes]

=== Form Submission with Validation ===
[On submit]
Form submission attempted
[Validation results]
Form is valid / Errors shown

=== Validity API Demonstration ===
=== Email Field Validity ===
Valid: true/false
Value missing: true/false
Type mismatch: true/false
Validation message: [message]

=== Input Type Features ===
[On interactions]
[Input values logged]
```

**Challenge (Optional)**:
- Build a complete validation library
- Create a multi-step form with validation
- Build a password strength meter
- Create a form validation framework

---

## Common Mistakes

### 1. Not Using HTML5 Validation

```javascript
// ⚠️ Problem: Only JavaScript validation
function validateEmail(email) {
    return email.includes(''@'');
}

// ✅ Solution: Combine HTML5 and JavaScript
<input type="email" required>
// Plus JavaScript for custom rules
```

### 2. Not Clearing Custom Validity

```javascript
// ⚠️ Problem: Custom validity persists
input.setCustomValidity(''Error'');
// Error always shows

// ✅ Solution: Clear when valid
if (isValid) {
    input.setCustomValidity('''');
}
```

### 3. Not Handling All Input Types

```javascript
// ⚠️ Problem: Only handles text
let value = input.value;  // Works for text, but...

// ✅ Solution: Handle different types
if (input.type === ''checkbox'') {
    value = input.checked;
} else if (input.type === ''radio'') {
    value = input.checked ? input.value : null;
} else {
    value = input.value;
}
```

### 4. Not Validating on Both Input and Blur

```javascript
// ⚠️ Problem: Only validates on blur
input.addEventListener(''blur'', validate);

// ✅ Solution: Validate on both
input.addEventListener(''blur'', validate);
input.addEventListener(''input'', function() {
    if (this.classList.contains(''error'')) {
        validate(this);
    }
});
```

---

## Key Takeaways

1. **HTML5 Input Types**: email, number, date, url, tel, etc.
2. **HTML5 Validation**: required, min, max, pattern, etc.
3. **Validity API**: Check field validity programmatically
4. **Custom Validation**: setCustomValidity() for custom rules
5. **Real-time Validation**: Validate on input or blur
6. **Error Display**: Show errors inline or in summary
7. **Best Practice**: Combine HTML5 and JavaScript validation
8. **User Experience**: Provide immediate feedback

---

## Quiz: Validation

Test your understanding with these questions:

1. **HTML5 email input:**
   - A) Only accepts emails
   - B) Validates email format
   - C) Both A and B
   - D) Neither

2. **required attribute:**
   - A) Makes field optional
   - B) Makes field required
   - C) Hides field
   - D) Nothing

3. **checkValidity() returns:**
   - A) Error message
   - B) true/false
   - C) Validation object
   - D) Nothing

4. **setCustomValidity() sets:**
   - A) HTML5 message
   - B) Custom message
   - C) Both
   - D) Neither

5. **pattern attribute uses:**
   - A) CSS selector
   - B) Regular expression
   - C) String
   - D) Number

6. **Real-time validation uses:**
   - A) submit event
   - B) input/blur events
   - C) load event
   - D) click event

7. **validity.valid is:**
   - A) Always true
   - B) true if field valid
   - C) Always false
   - D) Error message

**Answers**:
1. B) Validates email format (doesn''t restrict, just validates)
2. B) Makes field required
3. B) true/false
4. B) Custom message
5. B) Regular expression
6. B) input/blur events
7. B) true if field valid

---

## Next Steps

Congratulations! You''ve completed Module 15: Forms and Validation. You now know:
- How to work with forms
- Different input types
- HTML5 validation
- JavaScript validation
- Real-time validation

**What''s Next?**
- Course 4: Browser APIs and Storage
- Module 16: Browser Storage
- Learn localStorage and sessionStorage
- Work with browser storage APIs

---

## Additional Resources

- **MDN: HTML Input Types**: [developer.mozilla.org/en-US/docs/Web/HTML/Element/input](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input)
- **MDN: Constraint Validation**: [developer.mozilla.org/en-US/docs/Web/API/Constraint_validation](https://developer.mozilla.org/en-US/docs/Web/API/Constraint_validation)
- **JavaScript.info: Forms**: [javascript.info/forms-controls](https://javascript.info/forms-controls)

---

*Lesson completed! You''ve finished Module 15: Forms and Validation. Ready for Course 4: Browser APIs and Storage!*

', NULL, 2, '2026-01-03 09:53:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Work with different HTML5 input types
- Use HTML5 built-in validation
- Implement JavaScript validation
- Create real-time validation
- Build custom validation rules
- Display validation errors
- Create user-friendly validation feedback');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (150, 56, 13, 'localStorage and sessionStorage', 'localstorage-and-sessionstorage', '# Lesson 16.1: localStorage and sessionStorage

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand browser storage APIs
- Use localStorage for persistent storage
- Use sessionStorage for session storage
- Store and retrieve data
- Handle storage limitations
- Work with storage events
- Build storage utilities

---

## Introduction to Browser Storage

Browser storage allows you to store data in the user''s browser. There are two main storage APIs: localStorage and sessionStorage.

### Why Browser Storage?

- **Persistent Data**: Store data across sessions
- **No Server**: Store data client-side
- **Fast Access**: Quick data retrieval
- **User Preferences**: Save user settings
- **Offline Support**: Work without internet
- **Modern Web**: Essential for web apps

---

## localStorage API

localStorage stores data with no expiration date. Data persists until explicitly removed.

### Basic Usage

```javascript
// Store data
localStorage.setItem(''key'', ''value'');

// Retrieve data
let value = localStorage.getItem(''key'');

// Remove data
localStorage.removeItem(''key'');

// Clear all data
localStorage.clear();
```

### Storing Different Data Types

```javascript
// String
localStorage.setItem(''name'', ''Alice'');

// Number (stored as string)
localStorage.setItem(''age'', ''30'');
// Retrieve and convert
let age = parseInt(localStorage.getItem(''age''));

// Boolean (stored as string)
localStorage.setItem(''isActive'', ''true'');
// Retrieve and convert
let isActive = localStorage.getItem(''isActive'') === ''true'';

// Object (must stringify)
let user = { name: ''Alice'', age: 30 };
localStorage.setItem(''user'', JSON.stringify(user));
// Retrieve and parse
let user = JSON.parse(localStorage.getItem(''user''));

// Array (must stringify)
let items = [''apple'', ''banana'', ''orange''];
localStorage.setItem(''items'', JSON.stringify(items));
// Retrieve and parse
let items = JSON.parse(localStorage.getItem(''items''));
```

### Checking if Key Exists

```javascript
// Check if key exists
if (localStorage.getItem(''key'') !== null) {
    console.log(''Key exists'');
}

// Or check directly
if (''key'' in localStorage) {
    console.log(''Key exists'');
}

// Get all keys
let keys = Object.keys(localStorage);
console.log(''All keys:'', keys);
```

### Getting All Items

```javascript
// Get all items
for (let i = 0; i < localStorage.length; i++) {
    let key = localStorage.key(i);
    let value = localStorage.getItem(key);
    console.log(key, value);
}

// Or using Object.keys
Object.keys(localStorage).forEach(key => {
    console.log(key, localStorage.getItem(key));
});
```

---

## sessionStorage API

sessionStorage stores data for one session. Data is cleared when the tab is closed.

### Basic Usage

```javascript
// Store data
sessionStorage.setItem(''key'', ''value'');

// Retrieve data
let value = sessionStorage.getItem(''key'');

// Remove data
sessionStorage.removeItem(''key'');

// Clear all data
sessionStorage.clear();
```

### sessionStorage vs localStorage

```javascript
// localStorage: Persists across sessions
localStorage.setItem(''persistent'', ''data'');
// Close and reopen browser - data still exists

// sessionStorage: Only for current session
sessionStorage.setItem(''session'', ''data'');
// Close tab - data is cleared
```

---

## Storage Methods

### setItem(key, value)

Store data:

```javascript
localStorage.setItem(''username'', ''alice'');
localStorage.setItem(''score'', ''100'');
localStorage.setItem(''settings'', JSON.stringify({ theme: ''dark'' }));
```

### getItem(key)

Retrieve data:

```javascript
let username = localStorage.getItem(''username'');
let score = parseInt(localStorage.getItem(''score''));
let settings = JSON.parse(localStorage.getItem(''settings''));
```

### removeItem(key)

Remove specific item:

```javascript
localStorage.removeItem(''username'');
```

### clear()

Clear all storage:

```javascript
localStorage.clear();  // Removes all localStorage data
sessionStorage.clear();  // Removes all sessionStorage data
```

### key(index)

Get key at index:

```javascript
let firstKey = localStorage.key(0);
console.log(''First key:'', firstKey);
```

### length

Get number of items:

```javascript
let count = localStorage.length;
console.log(''Number of items:'', count);
```

---

## Storage Limitations

### Size Limits

- **localStorage**: ~5-10MB (varies by browser)
- **sessionStorage**: ~5-10MB (varies by browser)
- **Quota Exceeded Error**: Thrown when limit exceeded

### Handling Quota Exceeded

```javascript
function setItemSafe(key, value) {
    try {
        localStorage.setItem(key, value);
        return true;
    } catch (e) {
        if (e.name === ''QuotaExceededError'') {
            console.error(''Storage quota exceeded'');
            // Handle error (e.g., clear old data)
            return false;
        }
        throw e;
    }
}
```

### Checking Available Space

```javascript
function getStorageSize() {
    let total = 0;
    for (let key in localStorage) {
        if (localStorage.hasOwnProperty(key)) {
            total += localStorage[key].length + key.length;
        }
    }
    return total;
}

console.log(''Storage used:'', getStorageSize(), ''bytes'');
```

---

## Storage Events

### storage Event

Fired when storage changes (in other tabs/windows):

```javascript
window.addEventListener(''storage'', function(event) {
    console.log(''Storage changed'');
    console.log(''Key:'', event.key);
    console.log(''Old value:'', event.oldValue);
    console.log(''New value:'', event.newValue);
    console.log(''Storage area:'', event.storageArea);
    console.log(''URL:'', event.url);
});
```

### Important Notes

- **Only fires in other tabs**: Not in the tab that made the change
- **Only for localStorage**: sessionStorage doesn''t fire storage events
- **Useful for sync**: Sync data across tabs

---

## Practical Examples

### Example 1: User Preferences

```javascript
// Save user preferences
function savePreferences(preferences) {
    localStorage.setItem(''preferences'', JSON.stringify(preferences));
}

// Load user preferences
function loadPreferences() {
    let stored = localStorage.getItem(''preferences'');
    if (stored) {
        return JSON.parse(stored);
    }
    return {
        theme: ''light'',
        language: ''en'',
        notifications: true
    };
}

// Use
let prefs = loadPreferences();
console.log(''Theme:'', prefs.theme);

prefs.theme = ''dark'';
savePreferences(prefs);
```

### Example 2: Shopping Cart

```javascript
// Add to cart
function addToCart(item) {
    let cart = getCart();
    cart.push(item);
    localStorage.setItem(''cart'', JSON.stringify(cart));
}

// Get cart
function getCart() {
    let stored = localStorage.getItem(''cart'');
    return stored ? JSON.parse(stored) : [];
}

// Remove from cart
function removeFromCart(index) {
    let cart = getCart();
    cart.splice(index, 1);
    localStorage.setItem(''cart'', JSON.stringify(cart));
}

// Clear cart
function clearCart() {
    localStorage.removeItem(''cart'');
}
```

### Example 3: Form Data Persistence

```javascript
let form = document.getElementById(''myForm'');

// Save form data on input
form.addEventListener(''input'', function() {
    let formData = new FormData(form);
    let data = Object.fromEntries(formData);
    localStorage.setItem(''formDraft'', JSON.stringify(data));
});

// Load form data on page load
window.addEventListener(''load'', function() {
    let draft = localStorage.getItem(''formDraft'');
    if (draft) {
        let data = JSON.parse(draft);
        Object.keys(data).forEach(key => {
            let input = form.elements[key];
            if (input) {
                if (input.type === ''checkbox'') {
                    input.checked = data[key] === ''on'';
                } else {
                    input.value = data[key];
                }
            }
        });
    }
});

// Clear draft on submit
form.addEventListener(''submit'', function() {
    localStorage.removeItem(''formDraft'');
});
```

### Example 4: Session Data

```javascript
// Store session data
sessionStorage.setItem(''sessionId'', generateSessionId());
sessionStorage.setItem(''loginTime'', Date.now().toString());

// Check if session exists
function isSessionActive() {
    return sessionStorage.getItem(''sessionId'') !== null;
}

// Get session info
function getSessionInfo() {
    return {
        id: sessionStorage.getItem(''sessionId''),
        loginTime: parseInt(sessionStorage.getItem(''loginTime''))
    };
}
```

---

## Storage Utilities

### Storage Helper Class

```javascript
class StorageHelper {
    constructor(storage = localStorage) {
        this.storage = storage;
    }
    
    set(key, value) {
        try {
            this.storage.setItem(key, JSON.stringify(value));
            return true;
        } catch (e) {
            console.error(''Storage error:'', e);
            return false;
        }
    }
    
    get(key, defaultValue = null) {
        try {
            let item = this.storage.getItem(key);
            return item ? JSON.parse(item) : defaultValue;
        } catch (e) {
            console.error(''Storage error:'', e);
            return defaultValue;
        }
    }
    
    remove(key) {
        this.storage.removeItem(key);
    }
    
    clear() {
        this.storage.clear();
    }
    
    has(key) {
        return this.storage.getItem(key) !== null;
    }
    
    keys() {
        return Object.keys(this.storage);
    }
    
    size() {
        let total = 0;
        for (let key in this.storage) {
            if (this.storage.hasOwnProperty(key)) {
                total += this.storage[key].length + key.length;
            }
        }
        return total;
    }
}

// Usage
let storage = new StorageHelper();
storage.set(''user'', { name: ''Alice'', age: 30 });
let user = storage.get(''user'');
console.log(user);
```

### Storage with Expiration

```javascript
class ExpiringStorage {
    constructor(storage = localStorage) {
        this.storage = storage;
    }
    
    set(key, value, expirationMinutes) {
        let expiration = Date.now() + (expirationMinutes * 60 * 1000);
        let item = {
            value: value,
            expiration: expiration
        };
        this.storage.setItem(key, JSON.stringify(item));
    }
    
    get(key) {
        let item = this.storage.getItem(key);
        if (!item) return null;
        
        item = JSON.parse(item);
        
        if (Date.now() > item.expiration) {
            this.storage.removeItem(key);
            return null;
        }
        
        return item.value;
    }
}

// Usage
let expiringStorage = new ExpiringStorage();
expiringStorage.set(''token'', ''abc123'', 30);  // Expires in 30 minutes
let token = expiringStorage.get(''token'');
```

---

## Practice Exercise

### Exercise: Using Storage APIs

**Objective**: Practice using localStorage and sessionStorage to store and retrieve data.

**Instructions**:

1. Create an HTML file with various inputs
2. Create a JavaScript file for storage operations
3. Practice:
   - Storing different data types
   - Retrieving data
   - Handling errors
   - Working with storage events
   - Building storage utilities

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Storage Practice</title>
    <style>
        .container {
            max-width: 600px;
            margin: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input, select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
        }
        .output {
            margin-top: 20px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Browser Storage Practice</h1>
        
        <h2>localStorage</h2>
        <div class="form-group">
            <label for="localKey">Key:</label>
            <input type="text" id="localKey" placeholder="Enter key">
        </div>
        <div class="form-group">
            <label for="localValue">Value:</label>
            <input type="text" id="localValue" placeholder="Enter value">
        </div>
        <button onclick="saveToLocalStorage()">Save to localStorage</button>
        <button onclick="loadFromLocalStorage()">Load from localStorage</button>
        <button onclick="removeFromLocalStorage()">Remove from localStorage</button>
        <button onclick="clearLocalStorage()">Clear localStorage</button>
        
        <h2>sessionStorage</h2>
        <div class="form-group">
            <label for="sessionKey">Key:</label>
            <input type="text" id="sessionKey" placeholder="Enter key">
        </div>
        <div class="form-group">
            <label for="sessionValue">Value:</label>
            <input type="text" id="sessionValue" placeholder="Enter value">
        </div>
        <button onclick="saveToSessionStorage()">Save to sessionStorage</button>
        <button onclick="loadFromSessionStorage()">Load from sessionStorage</button>
        <button onclick="clearSessionStorage()">Clear sessionStorage</button>
        
        <h2>Storage Info</h2>
        <button onclick="showStorageInfo()">Show Storage Info</button>
        <button onclick="showAllItems()">Show All Items</button>
        
        <div id="output" class="output"></div>
    </div>
    
    <script src="storage-practice.js"></script>
</body>
</html>
```

```javascript
// storage-practice.js
console.log("=== Browser Storage Practice ===");

let output = document.getElementById(''output'');

function log(message) {
    console.log(message);
    output.innerHTML += ''<p>'' + message + ''</p>'';
}

function clearOutput() {
    output.innerHTML = '''';
}

console.log("\\n=== localStorage Basics ===");

// Save to localStorage
function saveToLocalStorage() {
    clearOutput();
    let key = document.getElementById(''localKey'').value;
    let value = document.getElementById(''localValue'').value;
    
    if (!key) {
        log(''Error: Key is required'');
        return;
    }
    
    try {
        localStorage.setItem(key, value);
        log(`Saved to localStorage: ${key} = ${value}`);
    } catch (e) {
        if (e.name === ''QuotaExceededError'') {
            log(''Error: Storage quota exceeded'');
        } else {
            log(''Error: '' + e.message);
        }
    }
}

// Load from localStorage
function loadFromLocalStorage() {
    clearOutput();
    let key = document.getElementById(''localKey'').value;
    
    if (!key) {
        log(''Error: Key is required'');
        return;
    }
    
    let value = localStorage.getItem(key);
    if (value !== null) {
        log(`Loaded from localStorage: ${key} = ${value}`);
        document.getElementById(''localValue'').value = value;
    } else {
        log(`Key "${key}" not found in localStorage`);
    }
}

// Remove from localStorage
function removeFromLocalStorage() {
    clearOutput();
    let key = document.getElementById(''localKey'').value;
    
    if (!key) {
        log(''Error: Key is required'');
        return;
    }
    
    localStorage.removeItem(key);
    log(`Removed "${key}" from localStorage`);
}

// Clear localStorage
function clearLocalStorage() {
    clearOutput();
    localStorage.clear();
    log(''Cleared all localStorage data'');
}
console.log();

console.log("=== sessionStorage Basics ===");

// Save to sessionStorage
function saveToSessionStorage() {
    clearOutput();
    let key = document.getElementById(''sessionKey'').value;
    let value = document.getElementById(''sessionValue'').value;
    
    if (!key) {
        log(''Error: Key is required'');
        return;
    }
    
    try {
        sessionStorage.setItem(key, value);
        log(`Saved to sessionStorage: ${key} = ${value}`);
    } catch (e) {
        if (e.name === ''QuotaExceededError'') {
            log(''Error: Storage quota exceeded'');
        } else {
            log(''Error: '' + e.message);
        }
    }
}

// Load from sessionStorage
function loadFromSessionStorage() {
    clearOutput();
    let key = document.getElementById(''sessionKey'').value;
    
    if (!key) {
        log(''Error: Key is required'');
        return;
    }
    
    let value = sessionStorage.getItem(key);
    if (value !== null) {
        log(`Loaded from sessionStorage: ${key} = ${value}`);
        document.getElementById(''sessionValue'').value = value;
    } else {
        log(`Key "${key}" not found in sessionStorage`);
    }
}

// Clear sessionStorage
function clearSessionStorage() {
    clearOutput();
    sessionStorage.clear();
    log(''Cleared all sessionStorage data'');
}
console.log();

console.log("=== Storing Different Data Types ===");

// Store object
function storeObject() {
    let user = {
        name: ''Alice'',
        age: 30,
        email: ''alice@example.com''
    };
    localStorage.setItem(''user'', JSON.stringify(user));
    log(''Stored object: '' + JSON.stringify(user));
}

// Store array
function storeArray() {
    let items = [''apple'', ''banana'', ''orange''];
    localStorage.setItem(''items'', JSON.stringify(items));
    log(''Stored array: '' + JSON.stringify(items));
}

// Retrieve and parse
function retrieveObject() {
    let userStr = localStorage.getItem(''user'');
    if (userStr) {
        let user = JSON.parse(userStr);
        log(''Retrieved object: '' + JSON.stringify(user));
        log(''User name: '' + user.name);
    }
}

// Store number
function storeNumber() {
    localStorage.setItem(''score'', ''100'');
    let score = parseInt(localStorage.getItem(''score''));
    log(''Stored and retrieved number: '' + score);
}

// Store boolean
function storeBoolean() {
    localStorage.setItem(''isActive'', ''true'');
    let isActive = localStorage.getItem(''isActive'') === ''true'';
    log(''Stored and retrieved boolean: '' + isActive);
}
console.log();

console.log("=== Storage Info ===");

function showStorageInfo() {
    clearOutput();
    
    log(''=== localStorage Info ==='');
    log(''Number of items: '' + localStorage.length);
    log(''Storage size: ~'' + getStorageSize(localStorage) + '' bytes'');
    
    log(''\\n=== sessionStorage Info ==='');
    log(''Number of items: '' + sessionStorage.length);
    log(''Storage size: ~'' + getStorageSize(sessionStorage) + '' bytes'');
}

function getStorageSize(storage) {
    let total = 0;
    for (let key in storage) {
        if (storage.hasOwnProperty(key)) {
            total += storage[key].length + key.length;
        }
    }
    return total;
}

function showAllItems() {
    clearOutput();
    
    log(''=== localStorage Items ==='');
    if (localStorage.length === 0) {
        log(''No items in localStorage'');
    } else {
        for (let i = 0; i < localStorage.length; i++) {
            let key = localStorage.key(i);
            let value = localStorage.getItem(key);
            log(`${key}: ${value}`);
        }
    }
    
    log(''\\n=== sessionStorage Items ==='');
    if (sessionStorage.length === 0) {
        log(''No items in sessionStorage'');
    } else {
        for (let i = 0; i < sessionStorage.length; i++) {
            let key = sessionStorage.key(i);
            let value = sessionStorage.getItem(key);
            log(`${key}: ${value}`);
        }
    }
}
console.log();

console.log("=== Storage Events ===");

// Listen for storage changes (from other tabs)
window.addEventListener(''storage'', function(event) {
    console.log(''Storage event fired'');
    console.log(''Key:'', event.key);
    console.log(''Old value:'', event.oldValue);
    console.log(''New value:'', event.newValue);
    console.log(''Storage area:'', event.storageArea);
    
    log(`Storage changed: ${event.key} (old: ${event.oldValue}, new: ${event.newValue})`);
});
console.log();

console.log("=== Storage Helper ===");

class StorageHelper {
    constructor(storage = localStorage) {
        this.storage = storage;
    }
    
    set(key, value) {
        try {
            this.storage.setItem(key, JSON.stringify(value));
            return true;
        } catch (e) {
            console.error(''Storage error:'', e);
            return false;
        }
    }
    
    get(key, defaultValue = null) {
        try {
            let item = this.storage.getItem(key);
            return item ? JSON.parse(item) : defaultValue;
        } catch (e) {
            console.error(''Storage error:'', e);
            return defaultValue;
        }
    }
    
    remove(key) {
        this.storage.removeItem(key);
    }
    
    clear() {
        this.storage.clear();
    }
    
    has(key) {
        return this.storage.getItem(key) !== null;
    }
    
    keys() {
        return Object.keys(this.storage);
    }
}

// Demonstrate helper
let helper = new StorageHelper();
helper.set(''test'', { name: ''Test'', value: 123 });
let test = helper.get(''test'');
log(''Helper test: '' + JSON.stringify(test));
console.log();

console.log("=== Practical Examples ===");

// User preferences
function savePreferences() {
    let prefs = {
        theme: ''dark'',
        language: ''en'',
        notifications: true
    };
    localStorage.setItem(''preferences'', JSON.stringify(prefs));
    log(''Saved preferences'');
}

function loadPreferences() {
    let stored = localStorage.getItem(''preferences'');
    if (stored) {
        let prefs = JSON.parse(stored);
        log(''Loaded preferences: '' + JSON.stringify(prefs));
        return prefs;
    }
    return null;
}

// Shopping cart
function addToCart(item) {
    let cart = getCart();
    cart.push(item);
    localStorage.setItem(''cart'', JSON.stringify(cart));
    log(''Added to cart: '' + item);
}

function getCart() {
    let stored = localStorage.getItem(''cart'');
    return stored ? JSON.parse(stored) : [];
}

function showCart() {
    let cart = getCart();
    log(''Cart items: '' + JSON.stringify(cart));
}

// Initialize
window.addEventListener(''load'', function() {
    log(''Page loaded. Storage APIs ready.'');
    log(''Try opening this page in multiple tabs to see storage events!'');
});
```

**Expected Output** (in browser console):
```
=== Browser Storage Practice ===

=== localStorage Basics ===
[On save]
Saved to localStorage: key = value

[On load]
Loaded from localStorage: key = value

=== sessionStorage Basics ===
[On save]
Saved to sessionStorage: key = value

=== Storing Different Data Types ===
[On store object]
Stored object: {"name":"Alice","age":30,"email":"alice@example.com"}

[On retrieve]
Retrieved object: {"name":"Alice","age":30,"email":"alice@example.com"}
User name: Alice

=== Storage Info ===
[On show info]
=== localStorage Info ===
Number of items: [count]
Storage size: ~[size] bytes

=== Storage Events ===
[On change in other tab]
Storage event fired
Key: [key]
Old value: [old]
New value: [new]

=== Storage Helper ===
Helper test: {"name":"Test","value":123}

=== Practical Examples ===
[On save preferences]
Saved preferences
[On load]
Loaded preferences: {"theme":"dark","language":"en","notifications":true}
```

**Challenge (Optional)**:
- Build a complete storage management system
- Create a storage quota monitor
- Build a storage sync system
- Create a storage migration utility

---

## Common Mistakes

### 1. Not Stringifying Objects

```javascript
// ⚠️ Problem: Stores "[object Object]"
localStorage.setItem(''user'', { name: ''Alice'' });

// ✅ Solution: Stringify first
localStorage.setItem(''user'', JSON.stringify({ name: ''Alice'' }));
```

### 2. Not Parsing Retrieved Data

```javascript
// ⚠️ Problem: Returns string, not object
let user = localStorage.getItem(''user'');
console.log(user.name);  // undefined

// ✅ Solution: Parse JSON
let user = JSON.parse(localStorage.getItem(''user''));
console.log(user.name);  // "Alice"
```

### 3. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
localStorage.setItem(''key'', ''value'');  // Might throw

// ✅ Solution: Try-catch
try {
    localStorage.setItem(''key'', ''value'');
} catch (e) {
    if (e.name === ''QuotaExceededError'') {
        // Handle quota exceeded
    }
}
```

### 4. Assuming Data Exists

```javascript
// ⚠️ Problem: Might be null
let user = JSON.parse(localStorage.getItem(''user''));
console.log(user.name);  // Error if null

// ✅ Solution: Check first
let userStr = localStorage.getItem(''user'');
if (userStr) {
    let user = JSON.parse(userStr);
    console.log(user.name);
}
```

---

## Key Takeaways

1. **localStorage**: Persistent storage, survives browser restart
2. **sessionStorage**: Session-only storage, cleared on tab close
3. **Storage Methods**: setItem, getItem, removeItem, clear
4. **Data Types**: Store strings, stringify objects/arrays
5. **Limitations**: ~5-10MB per origin
6. **Storage Events**: Fired in other tabs when storage changes
7. **Best Practice**: Always stringify/parse, handle errors, check for null
8. **Use Cases**: Preferences, cart, form drafts, session data

---

## Quiz: Browser Storage

Test your understanding with these questions:

1. **localStorage data:**
   - A) Cleared on tab close
   - B) Persists across sessions
   - C) Cleared on page reload
   - D) Never cleared

2. **sessionStorage data:**
   - A) Persists across sessions
   - B) Cleared on tab close
   - C) Never cleared
   - D) Cleared on page reload

3. **Objects stored in storage:**
   - A) Directly
   - B) Must stringify
   - C) Not allowed
   - D) Automatically

4. **Storage quota is:**
   - A) Unlimited
   - B) ~5-10MB
   - C) 1MB
   - D) 100MB

5. **storage event fires:**
   - A) In same tab
   - B) In other tabs
   - C) Both
   - D) Never

6. **getItem() returns:**
   - A) Object
   - B) String or null
   - C) Number
   - D) Boolean

7. **clear() removes:**
   - A) One item
   - B) All items
   - C) Nothing
   - D) Only expired items

**Answers**:
1. B) Persists across sessions
2. B) Cleared on tab close
3. B) Must stringify
4. B) ~5-10MB
5. B) In other tabs
6. B) String or null
7. B) All items

---

## Next Steps

Congratulations! You''ve learned localStorage and sessionStorage. You now know:
- How to store and retrieve data
- Storage limitations and error handling
- Storage events
- Building storage utilities

**What''s Next?**
- Lesson 16.2: IndexedDB
- Learn IndexedDB for larger storage
- Understand database operations
- Build more complex storage solutions

---

## Additional Resources

- **MDN: Web Storage API**: [developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Storage_API)
- **MDN: localStorage**: [developer.mozilla.org/en-US/docs/Web/API/Window/localStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage)
- **MDN: sessionStorage**: [developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage](https://developer.mozilla.org/en-US/docs/Web/API/Window/sessionStorage)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:54:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand browser storage APIs
- Use localStorage for persistent storage
- Use sessionStorage for session storage
- Store and retrieve data
- Handle storage limitations
- Work with storage events
- Build storage utilities');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (151, 56, 13, 'IndexedDB', 'indexeddb', '# Lesson 16.2: IndexedDB

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand IndexedDB basics
- Create and open databases
- Create object stores
- Perform CRUD operations
- Use indexes for queries
- Handle transactions
- Compare IndexedDB with localStorage
- Build database-driven applications

---

## Introduction to IndexedDB

IndexedDB is a low-level API for storing large amounts of structured data in the browser. It''s more powerful than localStorage but also more complex.

### Why IndexedDB?

- **Large Storage**: Store much more data than localStorage
- **Structured Data**: Store complex objects
- **Indexes**: Fast queries on any field
- **Transactions**: Safe concurrent operations
- **Asynchronous**: Non-blocking operations
- **Modern Standard**: W3C standard

### IndexedDB vs localStorage

| Feature | localStorage | IndexedDB |
|---------|-------------|-----------|
| Storage Size | ~5-10MB | Much larger (50%+ of disk) |
| Data Type | Strings only | Any structured data |
| Queries | Manual | Indexed queries |
| Performance | Fast for small data | Better for large data |
| Complexity | Simple | More complex |
| Async | Synchronous | Asynchronous |

---

## IndexedDB Basics

### Opening a Database

```javascript
let request = indexedDB.open(''myDatabase'', 1);

request.onerror = function(event) {
    console.error(''Database error:'', event.target.error);
};

request.onsuccess = function(event) {
    let db = event.target.result;
    console.log(''Database opened:'', db);
};

request.onupgradeneeded = function(event) {
    let db = event.target.result;
    // Create object stores here
    if (!db.objectStoreNames.contains(''users'')) {
        let objectStore = db.createObjectStore(''users'', { keyPath: ''id'', autoIncrement: true });
        objectStore.createIndex(''name'', ''name'', { unique: false });
        objectStore.createIndex(''email'', ''email'', { unique: true });
    }
};
```

### Database Version

```javascript
// Version 1
let request = indexedDB.open(''myDatabase'', 1);

// Upgrade to version 2
let request = indexedDB.open(''myDatabase'', 2);

request.onupgradeneeded = function(event) {
    let db = event.target.result;
    let oldVersion = event.oldVersion;
    let newVersion = event.newVersion;
    
    if (oldVersion < 2) {
        // Migration code
    }
};
```

---

## Creating Object Stores

### Basic Object Store

```javascript
request.onupgradeneeded = function(event) {
    let db = event.target.result;
    
    // Create object store
    let objectStore = db.createObjectStore(''users'', {
        keyPath: ''id'',
        autoIncrement: true
    });
};
```

### Object Store Options

```javascript
// With keyPath
let objectStore = db.createObjectStore(''users'', {
    keyPath: ''id''  // Use ''id'' property as key
});

// With autoIncrement
let objectStore = db.createObjectStore(''users'', {
    keyPath: ''id'',
    autoIncrement: true  // Auto-generate keys
});

// Without keyPath (use keys manually)
let objectStore = db.createObjectStore(''items'', {
    autoIncrement: false
});
```

### Creating Indexes

```javascript
request.onupgradeneeded = function(event) {
    let db = event.target.result;
    let objectStore = db.createObjectStore(''users'', {
        keyPath: ''id'',
        autoIncrement: true
    });
    
    // Create index on name
    objectStore.createIndex(''name'', ''name'', { unique: false });
    
    // Create unique index on email
    objectStore.createIndex(''email'', ''email'', { unique: true });
    
    // Create index on age
    objectStore.createIndex(''age'', ''age'', { unique: false });
};
```

---

## CRUD Operations

### Create (Add)

```javascript
function addUser(db, user) {
    let transaction = db.transaction([''users''], ''readwrite'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.add(user);
    
    request.onsuccess = function() {
        console.log(''User added:'', request.result);
    };
    
    request.onerror = function() {
        console.error(''Error adding user:'', request.error);
    };
}

// Usage
indexedDB.open(''myDatabase'', 1).onsuccess = function(event) {
    let db = event.target.result;
    addUser(db, {
        name: ''Alice'',
        email: ''alice@example.com'',
        age: 30
    });
};
```

### Read (Get)

```javascript
function getUser(db, id) {
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.get(id);
    
    request.onsuccess = function() {
        let user = request.result;
        if (user) {
            console.log(''User found:'', user);
        } else {
            console.log(''User not found'');
        }
    };
    
    request.onerror = function() {
        console.error(''Error getting user:'', request.error);
    };
}
```

### Update (Put)

```javascript
function updateUser(db, user) {
    let transaction = db.transaction([''users''], ''readwrite'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.put(user);
    
    request.onsuccess = function() {
        console.log(''User updated'');
    };
    
    request.onerror = function() {
        console.error(''Error updating user:'', request.error);
    };
}

// Usage
updateUser(db, {
    id: 1,
    name: ''Alice Updated'',
    email: ''alice@example.com'',
    age: 31
});
```

### Delete

```javascript
function deleteUser(db, id) {
    let transaction = db.transaction([''users''], ''readwrite'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.delete(id);
    
    request.onsuccess = function() {
        console.log(''User deleted'');
    };
    
    request.onerror = function() {
        console.error(''Error deleting user:'', request.error);
    };
}
```

---

## Queries and Indexes

### Get All Records

```javascript
function getAllUsers(db) {
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.getAll();
    
    request.onsuccess = function() {
        let users = request.result;
        console.log(''All users:'', users);
    };
}
```

### Query by Index

```javascript
function getUserByEmail(db, email) {
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let index = objectStore.index(''email'');
    let request = index.get(email);
    
    request.onsuccess = function() {
        let user = request.result;
        if (user) {
            console.log(''User found:'', user);
        } else {
            console.log(''User not found'');
        }
    };
}
```

### Range Queries

```javascript
function getUsersByAgeRange(db, minAge, maxAge) {
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let index = objectStore.index(''age'');
    let range = IDBKeyRange.bound(minAge, maxAge);
    let request = index.getAll(range);
    
    request.onsuccess = function() {
        let users = request.result;
        console.log(''Users in age range:'', users);
    };
}
```

### Cursor Queries

```javascript
function getAllUsersWithCursor(db) {
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.openCursor();
    
    request.onsuccess = function(event) {
        let cursor = event.target.result;
        if (cursor) {
            console.log(''User:'', cursor.value);
            cursor.continue();  // Move to next
        } else {
            console.log(''No more users'');
        }
    };
}
```

---

## Transactions

### Transaction Modes

```javascript
// Read-only transaction
let transaction = db.transaction([''users''], ''readonly'');

// Read-write transaction
let transaction = db.transaction([''users''], ''readwrite'');
```

### Transaction Events

```javascript
let transaction = db.transaction([''users''], ''readwrite'');

transaction.oncomplete = function() {
    console.log(''Transaction completed'');
};

transaction.onerror = function() {
    console.error(''Transaction error:'', transaction.error);
};

transaction.onabort = function() {
    console.log(''Transaction aborted'');
};
```

### Multiple Object Stores

```javascript
let transaction = db.transaction([''users'', ''orders''], ''readwrite'');
let userStore = transaction.objectStore(''users'');
let orderStore = transaction.objectStore(''orders'');
```

---

## Practical Examples

### Example 1: Database Helper Class

```javascript
class IndexedDBHelper {
    constructor(dbName, version) {
        this.dbName = dbName;
        this.version = version;
        this.db = null;
    }
    
    open() {
        return new Promise((resolve, reject) => {
            let request = indexedDB.open(this.dbName, this.version);
            
            request.onerror = () => reject(request.error);
            request.onsuccess = () => {
                this.db = request.result;
                resolve(this.db);
            };
            
            request.onupgradeneeded = (event) => {
                let db = event.target.result;
                if (!db.objectStoreNames.contains(''users'')) {
                    let store = db.createObjectStore(''users'', {
                        keyPath: ''id'',
                        autoIncrement: true
                    });
                    store.createIndex(''email'', ''email'', { unique: true });
                }
            };
        });
    }
    
    add(storeName, data) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.add(data);
            
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    get(storeName, key) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readonly'');
            let store = transaction.objectStore(storeName);
            let request = store.get(key);
            
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    getAll(storeName) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readonly'');
            let store = transaction.objectStore(storeName);
            let request = store.getAll();
            
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    put(storeName, data) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.put(data);
            
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    delete(storeName, key) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.delete(key);
            
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
        });
    }
    
    query(storeName, indexName, value) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readonly'');
            let store = transaction.objectStore(storeName);
            let index = store.index(indexName);
            let request = index.get(value);
            
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
}

// Usage
let dbHelper = new IndexedDBHelper(''myDatabase'', 1);
dbHelper.open().then(() => {
    return dbHelper.add(''users'', {
        name: ''Alice'',
        email: ''alice@example.com''
    });
}).then(id => {
    console.log(''User added with ID:'', id);
    return dbHelper.get(''users'', id);
}).then(user => {
    console.log(''User retrieved:'', user);
});
```

### Example 2: User Management

```javascript
class UserManager {
    constructor() {
        this.db = null;
    }
    
    async init() {
        return new Promise((resolve, reject) => {
            let request = indexedDB.open(''userDB'', 1);
            
            request.onerror = () => reject(request.error);
            request.onsuccess = () => {
                this.db = request.result;
                resolve();
            };
            
            request.onupgradeneeded = (event) => {
                let db = event.target.result;
                if (!db.objectStoreNames.contains(''users'')) {
                    let store = db.createObjectStore(''users'', {
                        keyPath: ''id'',
                        autoIncrement: true
                    });
                    store.createIndex(''email'', ''email'', { unique: true });
                    store.createIndex(''name'', ''name'', { unique: false });
                }
            };
        });
    }
    
    async addUser(user) {
        let transaction = this.db.transaction([''users''], ''readwrite'');
        let store = transaction.objectStore(''users'');
        return new Promise((resolve, reject) => {
            let request = store.add(user);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    async getUser(id) {
        let transaction = this.db.transaction([''users''], ''readonly'');
        let store = transaction.objectStore(''users'');
        return new Promise((resolve, reject) => {
            let request = store.get(id);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    async getUserByEmail(email) {
        let transaction = this.db.transaction([''users''], ''readonly'');
        let store = transaction.objectStore(''users'');
        let index = store.index(''email'');
        return new Promise((resolve, reject) => {
            let request = index.get(email);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    async getAllUsers() {
        let transaction = this.db.transaction([''users''], ''readonly'');
        let store = transaction.objectStore(''users'');
        return new Promise((resolve, reject) => {
            let request = store.getAll();
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    async updateUser(user) {
        let transaction = this.db.transaction([''users''], ''readwrite'');
        let store = transaction.objectStore(''users'');
        return new Promise((resolve, reject) => {
            let request = store.put(user);
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
        });
    }
    
    async deleteUser(id) {
        let transaction = this.db.transaction([''users''], ''readwrite'');
        let store = transaction.objectStore(''users'');
        return new Promise((resolve, reject) => {
            let request = store.delete(id);
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
        });
    }
}

// Usage
let userManager = new UserManager();
userManager.init().then(async () => {
    await userManager.addUser({
        name: ''Alice'',
        email: ''alice@example.com'',
        age: 30
    });
    
    let user = await userManager.getUserByEmail(''alice@example.com'');
    console.log(''User found:'', user);
});
```

---

## Practice Exercise

### Exercise: IndexedDB Practice

**Objective**: Practice creating databases, object stores, and performing CRUD operations.

**Instructions**:

1. Create an HTML file with a form
2. Create a JavaScript file for IndexedDB operations
3. Practice:
   - Creating and opening databases
   - Creating object stores and indexes
   - Adding, reading, updating, deleting data
   - Querying data with indexes

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IndexedDB Practice</title>
    <style>
        .container {
            max-width: 600px;
            margin: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
        }
        .output {
            margin-top: 20px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>IndexedDB Practice</h1>
        
        <h2>Add User</h2>
        <form id="userForm">
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" required>
            </div>
            <div class="form-group">
                <label for="age">Age:</label>
                <input type="number" id="age" required>
            </div>
            <button type="submit">Add User</button>
        </form>
        
        <h2>Operations</h2>
        <button onclick="showAllUsers()">Show All Users</button>
        <button onclick="clearUsers()">Clear All Users</button>
        
        <div id="output" class="output"></div>
    </div>
    
    <script src="indexeddb-practice.js"></script>
</body>
</html>
```

```javascript
// indexeddb-practice.js
console.log("=== IndexedDB Practice ===");

let db = null;
let output = document.getElementById(''output'');

function log(message) {
    console.log(message);
    output.innerHTML += ''<p>'' + message + ''</p>'';
}

function clearOutput() {
    output.innerHTML = '''';
}

console.log("\\n=== Opening Database ===");

let request = indexedDB.open(''practiceDB'', 1);

request.onerror = function(event) {
    console.error(''Database error:'', event.target.error);
    log(''Error opening database: '' + event.target.error);
};

request.onsuccess = function(event) {
    db = event.target.result;
    console.log(''Database opened successfully'');
    log(''Database opened successfully'');
    
    // Show all users on load
    showAllUsers();
};

request.onupgradeneeded = function(event) {
    db = event.target.result;
    console.log(''Database upgrade needed'');
    
    // Create users object store
    if (!db.objectStoreNames.contains(''users'')) {
        let objectStore = db.createObjectStore(''users'', {
            keyPath: ''id'',
            autoIncrement: true
        });
        
        // Create indexes
        objectStore.createIndex(''email'', ''email'', { unique: true });
        objectStore.createIndex(''name'', ''name'', { unique: false });
        objectStore.createIndex(''age'', ''age'', { unique: false });
        
        console.log(''Object store and indexes created'');
    }
};
console.log();

console.log("=== Adding Users ===");

let userForm = document.getElementById(''userForm'');
userForm.addEventListener(''submit'', function(event) {
    event.preventDefault();
    
    let user = {
        name: document.getElementById(''name'').value,
        email: document.getElementById(''email'').value,
        age: parseInt(document.getElementById(''age'').value)
    };
    
    addUser(user);
    
    // Reset form
    userForm.reset();
});

function addUser(user) {
    if (!db) {
        log(''Database not ready'');
        return;
    }
    
    let transaction = db.transaction([''users''], ''readwrite'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.add(user);
    
    request.onsuccess = function() {
        let id = request.result;
        console.log(''User added with ID:'', id);
        log(''User added with ID: '' + id);
        showAllUsers();
    };
    
    request.onerror = function() {
        console.error(''Error adding user:'', request.error);
        log(''Error adding user: '' + request.error.message);
    };
}
console.log();

console.log("=== Getting All Users ===");

function showAllUsers() {
    if (!db) {
        log(''Database not ready'');
        return;
    }
    
    clearOutput();
    
    let transaction = db.transaction([''users''], ''readonly'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.getAll();
    
    request.onsuccess = function() {
        let users = request.result;
        console.log(''All users:'', users);
        
        if (users.length === 0) {
            log(''No users in database'');
        } else {
            log(''Users ('' + users.length + ''):'');
            users.forEach(user => {
                log(`ID: ${user.id}, Name: ${user.name}, Email: ${user.email}, Age: ${user.age}`);
            });
        }
    };
    
    request.onerror = function() {
        console.error(''Error getting users:'', request.error);
        log(''Error getting users: '' + request.error.message);
    };
}
console.log();

console.log("=== Getting User by ID ===");

function getUser(id) {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let transaction = db.transaction([''users''], ''readonly'');
        let objectStore = transaction.objectStore(''users'');
        let request = objectStore.get(id);
        
        request.onsuccess = function() {
            resolve(request.result);
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Querying by Index ===");

function getUserByEmail(email) {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let transaction = db.transaction([''users''], ''readonly'');
        let objectStore = transaction.objectStore(''users'');
        let index = objectStore.index(''email'');
        let request = index.get(email);
        
        request.onsuccess = function() {
            resolve(request.result);
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Updating User ===");

function updateUser(user) {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let transaction = db.transaction([''users''], ''readwrite'');
        let objectStore = transaction.objectStore(''users'');
        let request = objectStore.put(user);
        
        request.onsuccess = function() {
            resolve();
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Deleting User ===");

function deleteUser(id) {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let transaction = db.transaction([''users''], ''readwrite'');
        let objectStore = transaction.objectStore(''users'');
        let request = objectStore.delete(id);
        
        request.onsuccess = function() {
            resolve();
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Clearing All Users ===");

function clearUsers() {
    if (!db) {
        log(''Database not ready'');
        return;
    }
    
    let transaction = db.transaction([''users''], ''readwrite'');
    let objectStore = transaction.objectStore(''users'');
    let request = objectStore.clear();
    
    request.onsuccess = function() {
        console.log(''All users cleared'');
        log(''All users cleared'');
        showAllUsers();
    };
    
    request.onerror = function() {
        console.error(''Error clearing users:'', request.error);
        log(''Error clearing users: '' + request.error.message);
    };
}
console.log();

console.log("=== Using Cursor ===");

function getAllUsersWithCursor() {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let users = [];
        let transaction = db.transaction([''users''], ''readonly'');
        let objectStore = transaction.objectStore(''users'');
        let request = objectStore.openCursor();
        
        request.onsuccess = function(event) {
            let cursor = event.target.result;
            if (cursor) {
                users.push(cursor.value);
                cursor.continue();
            } else {
                resolve(users);
            }
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Range Queries ===");

function getUsersByAgeRange(minAge, maxAge) {
    if (!db) {
        return Promise.reject(''Database not ready'');
    }
    
    return new Promise((resolve, reject) => {
        let transaction = db.transaction([''users''], ''readonly'');
        let objectStore = transaction.objectStore(''users'');
        let index = objectStore.index(''age'');
        let range = IDBKeyRange.bound(minAge, maxAge);
        let request = index.getAll(range);
        
        request.onsuccess = function() {
            resolve(request.result);
        };
        
        request.onerror = function() {
            reject(request.error);
        };
    });
}
console.log();

console.log("=== Database Helper Class ===");

class DBHelper {
    constructor(dbName, version) {
        this.dbName = dbName;
        this.version = version;
        this.db = null;
    }
    
    open() {
        return new Promise((resolve, reject) => {
            let request = indexedDB.open(this.dbName, this.version);
            
            request.onerror = () => reject(request.error);
            request.onsuccess = () => {
                this.db = request.result;
                resolve(this.db);
            };
            
            request.onupgradeneeded = (event) => {
                let db = event.target.result;
                if (!db.objectStoreNames.contains(''users'')) {
                    let store = db.createObjectStore(''users'', {
                        keyPath: ''id'',
                        autoIncrement: true
                    });
                    store.createIndex(''email'', ''email'', { unique: true });
                }
            };
        });
    }
    
    add(storeName, data) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.add(data);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    get(storeName, key) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readonly'');
            let store = transaction.objectStore(storeName);
            let request = store.get(key);
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    getAll(storeName) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readonly'');
            let store = transaction.objectStore(storeName);
            let request = store.getAll();
            request.onsuccess = () => resolve(request.result);
            request.onerror = () => reject(request.error);
        });
    }
    
    put(storeName, data) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.put(data);
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
        });
    }
    
    delete(storeName, key) {
        return new Promise((resolve, reject) => {
            let transaction = this.db.transaction([storeName], ''readwrite'');
            let store = transaction.objectStore(storeName);
            let request = store.delete(key);
            request.onsuccess = () => resolve();
            request.onerror = () => reject(request.error);
        });
    }
}

// Demonstrate helper
let helper = new DBHelper(''helperDB'', 1);
helper.open().then(() => {
    console.log(''Helper database opened'');
    return helper.add(''users'', { name: ''Test'', email: ''test@example.com'' });
}).then(id => {
    console.log(''Added with ID:'', id);
    return helper.get(''users'', id);
}).then(user => {
    console.log(''Retrieved user:'', user);
});
```

**Expected Output** (in browser console):
```
=== IndexedDB Practice ===

=== Opening Database ===
Database opened successfully
Database upgrade needed
Object store and indexes created

=== Adding Users ===
[On form submit]
User added with ID: 1

=== Getting All Users ===
[On show all]
All users: [array]
Users (1):
ID: 1, Name: Alice, Email: alice@example.com, Age: 30

=== Database Helper Class ===
Helper database opened
Added with ID: 1
Retrieved user: {id: 1, name: "Test", email: "test@example.com"}
```

**Challenge (Optional)**:
- Build a complete database management system
- Create a complex query system
- Build a data migration utility
- Create a database backup/restore system

---

## Common Mistakes

### 1. Not Handling onupgradeneeded

```javascript
// ⚠️ Problem: Object stores not created
let request = indexedDB.open(''db'', 1);
request.onsuccess = function(event) {
    let db = event.target.result;
    // Object store doesn''t exist!
};

// ✅ Solution: Create in onupgradeneeded
request.onupgradeneeded = function(event) {
    let db = event.target.result;
    db.createObjectStore(''users'', { keyPath: ''id'' });
};
```

### 2. Using Database Before It''s Ready

```javascript
// ⚠️ Problem: Database might not be ready
let db = null;
indexedDB.open(''db'', 1).onsuccess = function(event) {
    db = event.target.result;
};
addUser(db, user);  // db might be null!

// ✅ Solution: Wait for success
indexedDB.open(''db'', 1).onsuccess = function(event) {
    let db = event.target.result;
    addUser(db, user);
};
```

### 3. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
let request = objectStore.add(user);

// ✅ Solution: Handle errors
request.onerror = function() {
    console.error(''Error:'', request.error);
};
```

### 4. Forgetting Transaction Completion

```javascript
// ⚠️ Problem: Transaction might complete before operation
let transaction = db.transaction([''users''], ''readwrite'');
let store = transaction.objectStore(''users'');
store.add(user);
// Transaction might complete before add finishes

// ✅ Solution: Wait for request
let request = store.add(user);
request.onsuccess = function() {
    // Operation complete
};
```

---

## Key Takeaways

1. **IndexedDB**: Large structured data storage
2. **Asynchronous**: All operations are async
3. **Object Stores**: Like tables in a database
4. **Indexes**: Fast queries on any field
5. **Transactions**: Safe concurrent operations
6. **CRUD Operations**: Add, get, put, delete
7. **Best Practice**: Handle errors, wait for operations, use transactions
8. **Use Cases**: Large data, complex queries, offline apps

---

## Quiz: IndexedDB

Test your understanding with these questions:

1. **IndexedDB is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

2. **Object stores created in:**
   - A) onsuccess
   - B) onupgradeneeded
   - C) onerror
   - D) Anywhere

3. **Indexes are used for:**
   - A) Storage only
   - B) Fast queries
   - C) Validation
   - D) Nothing

4. **Transactions can be:**
   - A) Read-only
   - B) Read-write
   - C) Both
   - D) Neither

5. **keyPath is:**
   - A) Index name
   - B) Property used as key
   - C) Store name
   - D) Database name

6. **Cursor is used for:**
   - A) Iterating records
   - B) Getting one record
   - C) Deleting records
   - D) Nothing

7. **IndexedDB stores:**
   - A) Only strings
   - B) Structured data
   - C) Only numbers
   - D) Nothing

**Answers**:
1. B) Asynchronous
2. B) onupgradeneeded
3. B) Fast queries
4. C) Both
5. B) Property used as key
6. A) Iterating records
7. B) Structured data

---

## Next Steps

Congratulations! You''ve completed Module 16: Browser Storage. You now know:
- localStorage and sessionStorage
- IndexedDB for large data
- CRUD operations
- Database queries

**What''s Next?**
- Module 17: Browser APIs
- Lesson 17.1: Geolocation API
- Learn to get user location
- Work with browser APIs

---

## Additional Resources

- **MDN: IndexedDB**: [developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API)
- **MDN: Using IndexedDB**: [developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB](https://developer.mozilla.org/en-US/docs/Web/API/IndexedDB_API/Using_IndexedDB)
- **JavaScript.info: IndexedDB**: [javascript.info/indexeddb](https://javascript.info/indexeddb)

---

*Lesson completed! You''ve finished Module 16: Browser Storage. Ready for Module 17: Browser APIs!*

', NULL, 2, '2026-01-03 09:54:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand IndexedDB basics
- Create and open databases
- Create object stores
- Perform CRUD operations
- Use indexes for queries
- Handle transactions
- Compare IndexedDB with localStorage
- Build database-driven applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (152, 57, 13, 'Geolocation API', 'geolocation-api', '# Lesson 17.1: Geolocation API

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the Geolocation API
- Get user''s current position
- Watch position changes
- Handle geolocation errors
- Calculate distances between coordinates
- Build location-based applications
- Respect user privacy

---

## Introduction to Geolocation API

The Geolocation API allows web applications to access the user''s geographical location.

### Why Geolocation?

- **Location Services**: Find nearby places
- **Maps Integration**: Show user on map
- **Navigation**: Provide directions
- **Location Tracking**: Track movement
- **Personalization**: Location-based content
- **Modern Web**: Essential for many apps

### Privacy Considerations

- **User Permission**: Always requires user consent
- **HTTPS Required**: Must use secure connection (except localhost)
- **Privacy Policy**: Inform users about location usage
- **Opt-in**: Users can deny permission

---

## Getting Current Position

### Basic getCurrentPosition()

```javascript
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
        function(position) {
            console.log(''Latitude:'', position.coords.latitude);
            console.log(''Longitude:'', position.coords.longitude);
        },
        function(error) {
            console.error(''Error:'', error.message);
        }
    );
} else {
    console.error(''Geolocation not supported'');
}
```

### Position Object

```javascript
navigator.geolocation.getCurrentPosition(function(position) {
    // Coordinates
    console.log(''Latitude:'', position.coords.latitude);
    console.log(''Longitude:'', position.coords.longitude);
    console.log(''Altitude:'', position.coords.altitude);
    console.log(''Accuracy:'', position.coords.accuracy);  // meters
    console.log(''Altitude Accuracy:'', position.coords.altitudeAccuracy);
    console.log(''Heading:'', position.coords.heading);  // degrees
    console.log(''Speed:'', position.coords.speed);  // m/s
    
    // Timestamp
    console.log(''Timestamp:'', new Date(position.timestamp));
});
```

### Position Options

```javascript
let options = {
    enableHighAccuracy: true,  // Use GPS if available
    timeout: 5000,              // Max time to wait (ms)
    maximumAge: 0               // Max age of cached position (ms)
};

navigator.geolocation.getCurrentPosition(
    successCallback,
    errorCallback,
    options
);
```

### Options Explained

```javascript
// enableHighAccuracy
// true: Use GPS (more accurate, slower, more battery)
// false: Use network (faster, less accurate)
enableHighAccuracy: true

// timeout
// Maximum time to wait for position (milliseconds)
timeout: 10000  // 10 seconds

// maximumAge
// Accept cached position if less than this age (milliseconds)
maximumAge: 60000  // 1 minute
```

---

## Watching Position

### watchPosition()

Continuously watch position changes:

```javascript
let watchId = navigator.geolocation.watchPosition(
    function(position) {
        console.log(''Position updated:'', position.coords);
    },
    function(error) {
        console.error(''Error:'', error.message);
    },
    {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0
    }
);

// Stop watching
navigator.geolocation.clearWatch(watchId);
```

### watchPosition() vs getCurrentPosition()

```javascript
// getCurrentPosition: Get position once
navigator.geolocation.getCurrentPosition(callback);

// watchPosition: Get position continuously
let watchId = navigator.geolocation.watchPosition(callback);
// Returns watch ID to stop later
```

---

## Error Handling

### Error Types

```javascript
navigator.geolocation.getCurrentPosition(
    function(position) {
        // Success
    },
    function(error) {
        switch(error.code) {
            case error.PERMISSION_DENIED:
                console.error(''User denied geolocation'');
                break;
            case error.POSITION_UNAVAILABLE:
                console.error(''Position unavailable'');
                break;
            case error.TIMEOUT:
                console.error(''Request timeout'');
                break;
            default:
                console.error(''Unknown error'');
        }
    }
);
```

### Error Codes

```javascript
// PERMISSION_DENIED (1)
// User denied permission

// POSITION_UNAVAILABLE (2)
// Position could not be determined

// TIMEOUT (3)
// Request timed out
```

### Error Messages

```javascript
function handleGeolocationError(error) {
    let message = '''';
    
    switch(error.code) {
        case error.PERMISSION_DENIED:
            message = ''User denied the request for geolocation.'';
            break;
        case error.POSITION_UNAVAILABLE:
            message = ''Location information is unavailable.'';
            break;
        case error.TIMEOUT:
            message = ''The request to get user location timed out.'';
            break;
        default:
            message = ''An unknown error occurred.'';
    }
    
    console.error(''Geolocation error:'', message);
    return message;
}
```

---

## Practical Examples

### Example 1: Get Current Location

```javascript
function getCurrentLocation() {
    return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
            reject(new Error(''Geolocation not supported''));
            return;
        }
        
        navigator.geolocation.getCurrentPosition(
            (position) => {
                resolve({
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy
                });
            },
            (error) => {
                reject(error);
            },
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            }
        );
    });
}

// Usage
getCurrentLocation()
    .then(location => {
        console.log(''Location:'', location);
    })
    .catch(error => {
        console.error(''Error:'', error);
    });
```

### Example 2: Location Tracker

```javascript
class LocationTracker {
    constructor() {
        this.watchId = null;
        this.callbacks = [];
    }
    
    start(callback) {
        if (this.watchId !== null) {
            console.warn(''Already tracking'');
            return;
        }
        
        if (!navigator.geolocation) {
            throw new Error(''Geolocation not supported'');
        }
        
        this.watchId = navigator.geolocation.watchPosition(
            (position) => {
                let location = {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy,
                    timestamp: position.timestamp
                };
                
                this.callbacks.forEach(cb => cb(location));
            },
            (error) => {
                console.error(''Geolocation error:'', error);
            },
            {
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            }
        );
    }
    
    stop() {
        if (this.watchId !== null) {
            navigator.geolocation.clearWatch(this.watchId);
            this.watchId = null;
        }
    }
    
    onUpdate(callback) {
        this.callbacks.push(callback);
    }
}

// Usage
let tracker = new LocationTracker();
tracker.onUpdate((location) => {
    console.log(''Location updated:'', location);
});
tracker.start();
```

### Example 3: Distance Calculator

```javascript
function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371; // Earth''s radius in km
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    
    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
              Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
              Math.sin(dLon / 2) * Math.sin(dLon / 2);
    
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    const distance = R * c;
    
    return distance;
}

function toRad(degrees) {
    return degrees * (Math.PI / 180);
}

// Usage
let distance = calculateDistance(40.7128, -74.0060, 34.0522, -118.2437);
console.log(''Distance:'', distance, ''km'');
```

### Example 4: Location-based App

```javascript
class LocationApp {
    constructor() {
        this.currentLocation = null;
        this.nearbyPlaces = [];
    }
    
    async initialize() {
        try {
            this.currentLocation = await this.getLocation();
            this.nearbyPlaces = await this.findNearbyPlaces(this.currentLocation);
            this.displayLocation();
            this.displayNearbyPlaces();
        } catch (error) {
            this.handleError(error);
        }
    }
    
    getLocation() {
        return new Promise((resolve, reject) => {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    resolve({
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    });
                },
                reject,
                { enableHighAccuracy: true, timeout: 10000 }
            );
        });
    }
    
    async findNearbyPlaces(location) {
        // Simulate API call
        return [
            { name: ''Place 1'', distance: 0.5 },
            { name: ''Place 2'', distance: 1.2 }
        ];
    }
    
    displayLocation() {
        console.log(''Current location:'', this.currentLocation);
    }
    
    displayNearbyPlaces() {
        console.log(''Nearby places:'', this.nearbyPlaces);
    }
    
    handleError(error) {
        console.error(''Location error:'', error.message);
    }
}
```

---

## Practice Exercise

### Exercise: Geolocation App

**Objective**: Practice using the Geolocation API to get and track user location.

**Instructions**:

1. Create an HTML file with location display
2. Create a JavaScript file for geolocation
3. Practice:
   - Getting current position
   - Watching position changes
   - Handling errors
   - Calculating distances
   - Displaying location on map

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geolocation Practice</title>
    <style>
        .container {
            max-width: 600px;
            margin: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
        }
        .location-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .error {
            color: red;
        }
        .success {
            color: green;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Geolocation Practice</h1>
        
        <button onclick="getCurrentLocation()">Get Current Location</button>
        <button onclick="startTracking()">Start Tracking</button>
        <button onclick="stopTracking()">Stop Tracking</button>
        
        <div id="locationInfo" class="location-info"></div>
        <div id="trackingInfo" class="location-info"></div>
    </div>
    
    <script src="geolocation-practice.js"></script>
</body>
</html>
```

```javascript
// geolocation-practice.js
console.log("=== Geolocation Practice ===");

let locationInfo = document.getElementById(''locationInfo'');
let trackingInfo = document.getElementById(''trackingInfo'');
let watchId = null;

function displayLocation(position, element) {
    let html = `
        <h3>Location Information</h3>
        <p><strong>Latitude:</strong> ${position.coords.latitude.toFixed(6)}</p>
        <p><strong>Longitude:</strong> ${position.coords.longitude.toFixed(6)}</p>
        <p><strong>Accuracy:</strong> ${position.coords.accuracy.toFixed(2)} meters</p>
        <p><strong>Altitude:</strong> ${position.coords.altitude ? position.coords.altitude.toFixed(2) + '' meters'' : ''Not available''}</p>
        <p><strong>Heading:</strong> ${position.coords.heading ? position.coords.heading.toFixed(2) + '' degrees'' : ''Not available''}</p>
        <p><strong>Speed:</strong> ${position.coords.speed ? position.coords.speed.toFixed(2) + '' m/s'' : ''Not available''}</p>
        <p><strong>Timestamp:</strong> ${new Date(position.timestamp).toLocaleString()}</p>
    `;
    element.innerHTML = html;
    element.className = ''location-info success'';
}

function displayError(error, element) {
    let message = '''';
    switch(error.code) {
        case error.PERMISSION_DENIED:
            message = ''User denied geolocation permission'';
            break;
        case error.POSITION_UNAVAILABLE:
            message = ''Position information unavailable'';
            break;
        case error.TIMEOUT:
            message = ''Request timeout'';
            break;
        default:
            message = ''Unknown error occurred'';
    }
    
    element.innerHTML = `<p class="error">Error: ${message}</p>`;
    element.className = ''location-info error'';
}

console.log("\\n=== Check Geolocation Support ===");

if (navigator.geolocation) {
    console.log(''Geolocation is supported'');
} else {
    console.error(''Geolocation is not supported'');
    locationInfo.innerHTML = ''<p class="error">Geolocation is not supported in this browser</p>'';
}
console.log();

console.log("=== Get Current Location ===");

function getCurrentLocation() {
    if (!navigator.geolocation) {
        displayError({ code: -1 }, locationInfo);
        return;
    }
    
    locationInfo.innerHTML = ''<p>Getting location...</p>'';
    
    navigator.geolocation.getCurrentPosition(
        function(position) {
            console.log(''Position obtained:'', position);
            displayLocation(position, locationInfo);
            
            // Log coordinates
            console.log(''Latitude:'', position.coords.latitude);
            console.log(''Longitude:'', position.coords.longitude);
            console.log(''Accuracy:'', position.coords.accuracy, ''meters'');
        },
        function(error) {
            console.error(''Error getting position:'', error);
            displayError(error, locationInfo);
        },
        {
            enableHighAccuracy: true,
            timeout: 10000,
            maximumAge: 0
        }
    );
}
console.log();

console.log("=== Watch Position ===");

function startTracking() {
    if (!navigator.geolocation) {
        displayError({ code: -1 }, trackingInfo);
        return;
    }
    
    if (watchId !== null) {
        console.warn(''Already tracking'');
        return;
    }
    
    trackingInfo.innerHTML = ''<p>Starting to track location...</p>'';
    
    watchId = navigator.geolocation.watchPosition(
        function(position) {
            console.log(''Position updated:'', position);
            displayLocation(position, trackingInfo);
            
            // Calculate distance if previous position exists
            if (window.lastPosition) {
                let distance = calculateDistance(
                    window.lastPosition.coords.latitude,
                    window.lastPosition.coords.longitude,
                    position.coords.latitude,
                    position.coords.longitude
                );
                console.log(''Distance moved:'', distance.toFixed(2), ''km'');
            }
            window.lastPosition = position;
        },
        function(error) {
            console.error(''Error watching position:'', error);
            displayError(error, trackingInfo);
        },
        {
            enableHighAccuracy: true,
            timeout: 5000,
            maximumAge: 0
        }
    );
    
    console.log(''Tracking started, watch ID:'', watchId);
}

function stopTracking() {
    if (watchId !== null) {
        navigator.geolocation.clearWatch(watchId);
        watchId = null;
        trackingInfo.innerHTML = ''<p>Tracking stopped</p>'';
        console.log(''Tracking stopped'');
    } else {
        console.warn(''Not currently tracking'');
    }
}
console.log();

console.log("=== Distance Calculation ===");

function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371; // Earth''s radius in km
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    
    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
              Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
              Math.sin(dLon / 2) * Math.sin(dLon / 2);
    
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
    const distance = R * c;
    
    return distance;
}

function toRad(degrees) {
    return degrees * (Math.PI / 180);
}

// Test distance calculation
let distance = calculateDistance(40.7128, -74.0060, 34.0522, -118.2437);
console.log(''Distance between NYC and LA:'', distance.toFixed(2), ''km'');
console.log();

console.log("=== Position Options ===");

function getLocationWithOptions() {
    let options = {
        enableHighAccuracy: true,  // Use GPS
        timeout: 10000,            // 10 seconds
        maximumAge: 0              // No cache
    };
    
    navigator.geolocation.getCurrentPosition(
        function(position) {
            console.log(''High accuracy position:'', position);
        },
        function(error) {
            console.error(''Error:'', error);
        },
        options
    );
}
console.log();

console.log("=== Error Handling ===");

function handleGeolocationError(error) {
    let message = '''';
    let code = '''';
    
    switch(error.code) {
        case error.PERMISSION_DENIED:
            message = ''User denied the request for geolocation'';
            code = ''PERMISSION_DENIED (1)'';
            break;
        case error.POSITION_UNAVAILABLE:
            message = ''Location information is unavailable'';
            code = ''POSITION_UNAVAILABLE (2)'';
            break;
        case error.TIMEOUT:
            message = ''The request to get user location timed out'';
            code = ''TIMEOUT (3)'';
            break;
        default:
            message = ''An unknown error occurred'';
            code = ''UNKNOWN'';
    }
    
    console.error(''Error code:'', code);
    console.error(''Error message:'', message);
    return { code, message };
}
console.log();

console.log("=== Promise-based Wrapper ===");

function getCurrentLocationPromise() {
    return new Promise((resolve, reject) => {
        if (!navigator.geolocation) {
            reject(new Error(''Geolocation not supported''));
            return;
        }
        
        navigator.geolocation.getCurrentPosition(
            (position) => {
                resolve({
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy,
                    timestamp: position.timestamp
                });
            },
            (error) => {
                reject(error);
            },
            {
                enableHighAccuracy: true,
                timeout: 10000,
                maximumAge: 0
            }
        );
    });
}

// Usage example
getCurrentLocationPromise()
    .then(location => {
        console.log(''Location (promise):'', location);
    })
    .catch(error => {
        console.error(''Error (promise):'', error);
    });
console.log();

console.log("=== Location Tracker Class ===");

class LocationTracker {
    constructor() {
        this.watchId = null;
        this.callbacks = [];
        this.positions = [];
    }
    
    start(callback) {
        if (this.watchId !== null) {
            console.warn(''Already tracking'');
            return;
        }
        
        if (!navigator.geolocation) {
            throw new Error(''Geolocation not supported'');
        }
        
        this.watchId = navigator.geolocation.watchPosition(
            (position) => {
                let location = {
                    latitude: position.coords.latitude,
                    longitude: position.coords.longitude,
                    accuracy: position.coords.accuracy,
                    timestamp: position.timestamp
                };
                
                this.positions.push(location);
                this.callbacks.forEach(cb => cb(location));
            },
            (error) => {
                console.error(''Geolocation error:'', error);
            },
            {
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            }
        );
    }
    
    stop() {
        if (this.watchId !== null) {
            navigator.geolocation.clearWatch(this.watchId);
            this.watchId = null;
        }
    }
    
    onUpdate(callback) {
        this.callbacks.push(callback);
    }
    
    getPositions() {
        return this.positions;
    }
    
    clearPositions() {
        this.positions = [];
    }
}

// Demonstrate tracker
let tracker = new LocationTracker();
tracker.onUpdate((location) => {
    console.log(''Tracker update:'', location);
});
console.log();
```

**Expected Output** (in browser console):
```
=== Geolocation Practice ===

=== Check Geolocation Support ===
Geolocation is supported

=== Get Current Location ===
[On button click]
Position obtained: [Position object]
Latitude: [value]
Longitude: [value]
Accuracy: [value] meters

=== Watch Position ===
[On start tracking]
Tracking started, watch ID: [id]
Position updated: [Position object]
[On movement]
Distance moved: [value] km

=== Distance Calculation ===
Distance between NYC and LA: [value] km

=== Promise-based Wrapper ===
Location (promise): { latitude: [value], longitude: [value], ... }

=== Location Tracker Class ===
Tracker update: { latitude: [value], longitude: [value], ... }
```

**Challenge (Optional)**:
- Build a complete location tracking app
- Create a distance calculator
- Build a location history system
- Integrate with mapping services

---

## Common Mistakes

### 1. Not Checking Support

```javascript
// ⚠️ Problem: Might not be supported
navigator.geolocation.getCurrentPosition(callback);

// ✅ Solution: Check first
if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(callback);
} else {
    console.error(''Geolocation not supported'');
}
```

### 2. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
navigator.geolocation.getCurrentPosition(success);

// ✅ Solution: Handle errors
navigator.geolocation.getCurrentPosition(success, error);
```

### 3. Not Clearing Watch

```javascript
// ⚠️ Problem: Watch continues after component unmounts
let watchId = navigator.geolocation.watchPosition(callback);
// Never cleared!

// ✅ Solution: Clear when done
navigator.geolocation.clearWatch(watchId);
```

### 4. Using HTTP Instead of HTTPS

```javascript
// ⚠️ Problem: Geolocation requires HTTPS (except localhost)
// Won''t work on HTTP sites

// ✅ Solution: Use HTTPS or localhost
```

---

## Key Takeaways

1. **Geolocation API**: Access user location
2. **getCurrentPosition()**: Get position once
3. **watchPosition()**: Track position continuously
4. **Error Handling**: Always handle errors
5. **Privacy**: Requires user permission, HTTPS required
6. **Options**: enableHighAccuracy, timeout, maximumAge
7. **Best Practice**: Check support, handle errors, clear watches
8. **Use Cases**: Maps, navigation, location-based services

---

## Quiz: Geolocation

Test your understanding with these questions:

1. **Geolocation requires:**
   - A) HTTP
   - B) HTTPS (or localhost)
   - C) No connection
   - D) Nothing

2. **getCurrentPosition() gets:**
   - A) Position once
   - B) Position continuously
   - C) Both
   - D) Nothing

3. **watchPosition() returns:**
   - A) Position
   - B) Watch ID
   - C) Error
   - D) Nothing

4. **PERMISSION_DENIED means:**
   - A) Position unavailable
   - B) User denied permission
   - C) Timeout
   - D) Unknown error

5. **enableHighAccuracy:**
   - A) Uses GPS
   - B) Uses network
   - C) Both
   - D) Neither

6. **clearWatch() stops:**
   - A) getCurrentPosition
   - B) watchPosition
   - C) Both
   - D) Nothing

7. **Geolocation is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

**Answers**:
1. B) HTTPS (or localhost)
2. A) Position once
3. B) Watch ID
4. B) User denied permission
5. A) Uses GPS
6. B) watchPosition
7. B) Asynchronous

---

## Next Steps

Congratulations! You''ve learned the Geolocation API. You now know:
- How to get user location
- How to track position changes
- How to handle errors
- How to calculate distances

**What''s Next?**
- Lesson 17.2: Web Storage and File APIs
- Learn FileReader API
- Work with file uploads
- Implement drag and drop

---

## Additional Resources

- **MDN: Geolocation API**: [developer.mozilla.org/en-US/docs/Web/API/Geolocation_API](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API)
- **MDN: Using Geolocation**: [developer.mozilla.org/en-US/docs/Web/API/Geolocation_API/Using_the_Geolocation_API](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API/Using_the_Geolocation_API)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:54:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the Geolocation API
- Get user''s current position
- Watch position changes
- Handle geolocation errors
- Calculate distances between coordinates
- Build location-based applications
- Respect user privacy');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (153, 57, 13, 'Canvas API', 'canvas-api', '# Lesson 17.2: Web Storage and File APIs

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the FileReader API
- Read files from user input
- Handle different file types
- Implement drag and drop
- Work with file objects
- Validate file types and sizes
- Build file upload interfaces

---

## Introduction to File APIs

File APIs allow web applications to read files from the user''s device.

### Why File APIs?

- **File Uploads**: Upload files to server
- **File Processing**: Process files client-side
- **Image Preview**: Show image before upload
- **File Validation**: Validate before upload
- **Drag and Drop**: Better UX for file selection
- **Modern Web**: Essential for web applications

---

## FileReader API

### Basic File Reading

```javascript
let fileInput = document.getElementById(''fileInput'');

fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    
    if (file) {
        let reader = new FileReader();
        
        reader.onload = function(e) {
            console.log(''File content:'', e.target.result);
        };
        
        reader.readAsText(file);
    }
});
```

### FileReader Methods

```javascript
let reader = new FileReader();

// Read as text
reader.readAsText(file);

// Read as data URL (base64)
reader.readAsDataURL(file);

// Read as array buffer
reader.readAsArrayBuffer(file);

// Read as binary string
reader.readAsBinaryString(file);
```

### FileReader Events

```javascript
let reader = new FileReader();

reader.onload = function(event) {
    console.log(''File loaded:'', event.target.result);
};

reader.onerror = function(event) {
    console.error(''Error reading file:'', event.target.error);
};

reader.onprogress = function(event) {
    if (event.lengthComputable) {
        let percentLoaded = (event.loaded / event.total) * 100;
        console.log(''Progress:'', percentLoaded + ''%'');
    }
};

reader.onloadstart = function() {
    console.log(''Reading started'');
};

reader.onloadend = function() {
    console.log(''Reading finished'');
};

reader.onabort = function() {
    console.log(''Reading aborted'');
};
```

---

## Reading Different File Types

### Reading Text Files

```javascript
function readTextFile(file) {
    return new Promise((resolve, reject) => {
        let reader = new FileReader();
        
        reader.onload = function(event) {
            resolve(event.target.result);
        };
        
        reader.onerror = function(event) {
            reject(event.target.error);
        };
        
        reader.readAsText(file);
    });
}

// Usage
let fileInput = document.getElementById(''fileInput'');
fileInput.addEventListener(''change'', async function(event) {
    let file = event.target.files[0];
    if (file) {
        try {
            let content = await readTextFile(file);
            console.log(''File content:'', content);
        } catch (error) {
            console.error(''Error:'', error);
        }
    }
});
```

### Reading Images

```javascript
function readImageFile(file) {
    return new Promise((resolve, reject) => {
        let reader = new FileReader();
        
        reader.onload = function(event) {
            let img = new Image();
            img.src = event.target.result;
            img.onload = function() {
                resolve({
                    dataURL: event.target.result,
                    width: img.width,
                    height: img.height
                });
            };
        };
        
        reader.onerror = function(event) {
            reject(event.target.error);
        };
        
        reader.readAsDataURL(file);
    });
}

// Usage
let fileInput = document.getElementById(''imageInput'');
fileInput.addEventListener(''change'', async function(event) {
    let file = event.target.files[0];
    if (file) {
        try {
            let imageData = await readImageFile(file);
            document.getElementById(''preview'').src = imageData.dataURL;
            console.log(''Image size:'', imageData.width, ''x'', imageData.height);
        } catch (error) {
            console.error(''Error:'', error);
        }
    }
});
```

### Reading JSON Files

```javascript
function readJSONFile(file) {
    return new Promise((resolve, reject) => {
        let reader = new FileReader();
        
        reader.onload = function(event) {
            try {
                let json = JSON.parse(event.target.result);
                resolve(json);
            } catch (error) {
                reject(new Error(''Invalid JSON''));
            }
        };
        
        reader.onerror = function(event) {
            reject(event.target.error);
        };
        
        reader.readAsText(file);
    });
}
```

### Reading Binary Files

```javascript
function readBinaryFile(file) {
    return new Promise((resolve, reject) => {
        let reader = new FileReader();
        
        reader.onload = function(event) {
            resolve(event.target.result);  // ArrayBuffer
        };
        
        reader.onerror = function(event) {
            reject(event.target.error);
        };
        
        reader.readAsArrayBuffer(file);
    });
}
```

---

## File Object Properties

### Accessing File Information

```javascript
let fileInput = document.getElementById(''fileInput'');

fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    
    if (file) {
        console.log(''File name:'', file.name);
        console.log(''File size:'', file.size, ''bytes'');
        console.log(''File type:'', file.type);
        console.log(''Last modified:'', new Date(file.lastModified));
    }
});
```

### File Validation

```javascript
function validateFile(file, options = {}) {
    let errors = [];
    
    // Check file type
    if (options.allowedTypes && !options.allowedTypes.includes(file.type)) {
        errors.push(''File type not allowed'');
    }
    
    // Check file size
    if (options.maxSize && file.size > options.maxSize) {
        errors.push(''File too large'');
    }
    
    // Check file name
    if (options.allowedExtensions) {
        let extension = file.name.split(''.'').pop().toLowerCase();
        if (!options.allowedExtensions.includes(extension)) {
            errors.push(''File extension not allowed'');
        }
    }
    
    return {
        valid: errors.length === 0,
        errors: errors
    };
}

// Usage
let fileInput = document.getElementById(''fileInput'');
fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    if (file) {
        let validation = validateFile(file, {
            allowedTypes: [''image/jpeg'', ''image/png''],
            maxSize: 5 * 1024 * 1024,  // 5MB
            allowedExtensions: [''jpg'', ''jpeg'', ''png'']
        });
        
        if (!validation.valid) {
            console.error(''Validation errors:'', validation.errors);
        }
    }
});
```

---

## Drag and Drop API

### Basic Drag and Drop

```javascript
let dropZone = document.getElementById(''dropZone'');

// Prevent default drag behaviors
[''dragenter'', ''dragover'', ''dragleave'', ''drop''].forEach(eventName => {
    dropZone.addEventListener(eventName, preventDefaults, false);
});

function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
}

// Highlight drop zone
[''dragenter'', ''dragover''].forEach(eventName => {
    dropZone.addEventListener(eventName, highlight, false);
});

[''dragleave'', ''drop''].forEach(eventName => {
    dropZone.addEventListener(eventName, unhighlight, false);
});

function highlight(e) {
    dropZone.classList.add(''drag-over'');
}

function unhighlight(e) {
    dropZone.classList.remove(''drag-over'');
}

// Handle drop
dropZone.addEventListener(''drop'', handleDrop, false);

function handleDrop(e) {
    let dt = e.dataTransfer;
    let files = dt.files;
    
    handleFiles(files);
}
```

### Handling Dropped Files

```javascript
function handleFiles(files) {
    [...files].forEach(file => {
        processFile(file);
    });
}

function processFile(file) {
    if (file.type.startsWith(''image/'')) {
        readImageFile(file).then(imageData => {
            displayImage(imageData.dataURL);
        });
    } else if (file.type === ''text/plain'') {
        readTextFile(file).then(content => {
            displayText(content);
        });
    }
}
```

### Drag Events

```javascript
let dropZone = document.getElementById(''dropZone'');

// dragenter: Item enters drop zone
dropZone.addEventListener(''dragenter'', function(e) {
    console.log(''Drag enter'');
});

// dragover: Item over drop zone
dropZone.addEventListener(''dragover'', function(e) {
    console.log(''Drag over'');
    e.preventDefault();  // Allow drop
});

// dragleave: Item leaves drop zone
dropZone.addEventListener(''dragleave'', function(e) {
    console.log(''Drag leave'');
});

// drop: Item dropped
dropZone.addEventListener(''drop'', function(e) {
    console.log(''Drop'');
    let files = e.dataTransfer.files;
    handleFiles(files);
});
```

---

## Practical Examples

### Example 1: Image Preview

```javascript
let fileInput = document.getElementById(''imageInput'');
let preview = document.getElementById(''preview'');

fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    
    if (file && file.type.startsWith(''image/'')) {
        let reader = new FileReader();
        
        reader.onload = function(e) {
            preview.src = e.target.result;
            preview.style.display = ''block'';
        };
        
        reader.readAsDataURL(file);
    }
});
```

### Example 2: File Upload with Progress

```javascript
function uploadFile(file) {
    return new Promise((resolve, reject) => {
        let formData = new FormData();
        formData.append(''file'', file);
        
        let xhr = new XMLHttpRequest();
        
        xhr.upload.onprogress = function(e) {
            if (e.lengthComputable) {
                let percentComplete = (e.loaded / e.total) * 100;
                updateProgress(percentComplete);
            }
        };
        
        xhr.onload = function() {
            if (xhr.status === 200) {
                resolve(xhr.response);
            } else {
                reject(new Error(''Upload failed''));
            }
        };
        
        xhr.onerror = function() {
            reject(new Error(''Upload error''));
        };
        
        xhr.open(''POST'', ''/upload'');
        xhr.send(formData);
    });
}

function updateProgress(percent) {
    document.getElementById(''progress'').style.width = percent + ''%'';
}
```

### Example 3: Multiple File Upload

```javascript
let fileInput = document.getElementById(''fileInput'');
fileInput.multiple = true;  // Allow multiple files

fileInput.addEventListener(''change'', function(event) {
    let files = Array.from(event.target.files);
    
    files.forEach((file, index) => {
        uploadFile(file).then(response => {
            console.log(`File ${index + 1} uploaded:`, response);
        }).catch(error => {
            console.error(`File ${index + 1} error:`, error);
        });
    });
});
```

### Example 4: Complete File Handler

```javascript
class FileHandler {
    constructor(options = {}) {
        this.options = {
            maxSize: options.maxSize || 10 * 1024 * 1024,  // 10MB
            allowedTypes: options.allowedTypes || [],
            onProgress: options.onProgress || null,
            onComplete: options.onComplete || null,
            onError: options.onError || null
        };
    }
    
    validate(file) {
        if (this.options.allowedTypes.length > 0) {
            if (!this.options.allowedTypes.includes(file.type)) {
                throw new Error(''File type not allowed'');
            }
        }
        
        if (file.size > this.options.maxSize) {
            throw new Error(''File too large'');
        }
        
        return true;
    }
    
    readAsText(file) {
        return new Promise((resolve, reject) => {
            this.validate(file);
            
            let reader = new FileReader();
            
            reader.onprogress = (e) => {
                if (this.options.onProgress) {
                    this.options.onProgress(e.loaded / e.total);
                }
            };
            
            reader.onload = (e) => {
                if (this.options.onComplete) {
                    this.options.onComplete(e.target.result);
                }
                resolve(e.target.result);
            };
            
            reader.onerror = (e) => {
                if (this.options.onError) {
                    this.options.onError(e.target.error);
                }
                reject(e.target.error);
            };
            
            reader.readAsText(file);
        });
    }
    
    readAsDataURL(file) {
        return new Promise((resolve, reject) => {
            this.validate(file);
            
            let reader = new FileReader();
            
            reader.onload = (e) => {
                resolve(e.target.result);
            };
            
            reader.onerror = (e) => {
                reject(e.target.error);
            };
            
            reader.readAsDataURL(file);
        });
    }
}

// Usage
let handler = new FileHandler({
    maxSize: 5 * 1024 * 1024,
    allowedTypes: [''image/jpeg'', ''image/png''],
    onProgress: (percent) => console.log(''Progress:'', percent),
    onComplete: (result) => console.log(''Complete:'', result)
});
```

---

## Practice Exercise

### Exercise: File Handling

**Objective**: Practice using FileReader API and drag and drop to handle files.

**Instructions**:

1. Create an HTML file with file input and drop zone
2. Create a JavaScript file for file handling
3. Practice:
   - Reading different file types
   - Image preview
   - File validation
   - Drag and drop
   - Progress tracking

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>File APIs Practice</title>
    <style>
        .container {
            max-width: 800px;
            margin: 20px;
        }
        .drop-zone {
            border: 2px dashed #ccc;
            border-radius: 5px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            transition: border-color 0.3s;
        }
        .drop-zone.drag-over {
            border-color: #007bff;
            background-color: #f0f8ff;
        }
        .preview {
            max-width: 100%;
            margin-top: 20px;
        }
        .file-info {
            margin-top: 20px;
            padding: 15px;
            background-color: #f0f0f0;
            border-radius: 5px;
        }
        .progress {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }
        .progress-bar {
            height: 100%;
            background-color: #007bff;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>File APIs Practice</h1>
        
        <h2>File Input</h2>
        <input type="file" id="fileInput" accept="image/*,text/*">
        
        <h2>Drag and Drop Zone</h2>
        <div id="dropZone" class="drop-zone">
            <p>Drag and drop files here or click to select</p>
        </div>
        
        <div id="fileInfo" class="file-info"></div>
        <div id="preview"></div>
        <div id="progress" class="progress" style="display: none;">
            <div id="progressBar" class="progress-bar" style="width: 0%"></div>
        </div>
        
        <div id="output"></div>
    </div>
    
    <script src="file-apis-practice.js"></script>
</body>
</html>
```

```javascript
// file-apis-practice.js
console.log("=== File APIs Practice ===");

let fileInput = document.getElementById(''fileInput'');
let dropZone = document.getElementById(''dropZone'');
let fileInfo = document.getElementById(''fileInfo'');
let preview = document.getElementById(''preview'');
let progress = document.getElementById(''progress'');
let progressBar = document.getElementById(''progressBar'');
let output = document.getElementById(''output'');

function log(message) {
    console.log(message);
    output.innerHTML += ''<p>'' + message + ''</p>'';
}

console.log("\\n=== FileReader Basics ===");

fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    if (file) {
        handleFile(file);
    }
});

function handleFile(file) {
    console.log(''File selected:'', file.name);
    displayFileInfo(file);
    
    if (file.type.startsWith(''image/'')) {
        readImageFile(file);
    } else if (file.type === ''text/plain'' || file.type === ''text/csv'') {
        readTextFile(file);
    } else {
        log(''File type not supported for preview'');
    }
}

function displayFileInfo(file) {
    let info = `
        <h3>File Information</h3>
        <p><strong>Name:</strong> ${file.name}</p>
        <p><strong>Size:</strong> ${(file.size / 1024).toFixed(2)} KB</p>
        <p><strong>Type:</strong> ${file.type || ''Unknown''}</p>
        <p><strong>Last Modified:</strong> ${new Date(file.lastModified).toLocaleString()}</p>
    `;
    fileInfo.innerHTML = info;
}
console.log();

console.log("=== Reading Text Files ===");

function readTextFile(file) {
    let reader = new FileReader();
    
    reader.onloadstart = function() {
        log(''Reading text file...'');
        progress.style.display = ''block'';
    };
    
    reader.onprogress = function(event) {
        if (event.lengthComputable) {
            let percent = (event.loaded / event.total) * 100;
            progressBar.style.width = percent + ''%'';
            console.log(''Progress:'', percent.toFixed(2) + ''%'');
        }
    };
    
    reader.onload = function(event) {
        log(''Text file loaded'');
        progress.style.display = ''none'';
        progressBar.style.width = ''0%'';
        
        let content = event.target.result;
        preview.innerHTML = ''<pre>'' + content.substring(0, 1000) + (content.length > 1000 ? ''...'' : '''') + ''</pre>'';
        console.log(''File content (first 100 chars):'', content.substring(0, 100));
    };
    
    reader.onerror = function(event) {
        log(''Error reading file: '' + event.target.error);
        progress.style.display = ''none'';
    };
    
    reader.readAsText(file);
}
console.log();

console.log("=== Reading Image Files ===");

function readImageFile(file) {
    let reader = new FileReader();
    
    reader.onload = function(event) {
        log(''Image file loaded'');
        let img = document.createElement(''img'');
        img.src = event.target.result;
        img.className = ''preview'';
        preview.innerHTML = '''';
        preview.appendChild(img);
        
        // Get image dimensions
        let image = new Image();
        image.src = event.target.result;
        image.onload = function() {
            console.log(''Image dimensions:'', image.width, ''x'', image.height);
            log(''Image dimensions: '' + image.width + '' x '' + image.height);
        };
    };
    
    reader.onerror = function(event) {
        log(''Error reading image: '' + event.target.error);
    };
    
    reader.readAsDataURL(file);
}
console.log();

console.log("=== Drag and Drop ===");

// Prevent default drag behaviors
[''dragenter'', ''dragover'', ''dragleave'', ''drop''].forEach(eventName => {
    dropZone.addEventListener(eventName, preventDefaults, false);
    document.body.addEventListener(eventName, preventDefaults, false);
});

function preventDefaults(e) {
    e.preventDefault();
    e.stopPropagation();
}

// Highlight drop zone
[''dragenter'', ''dragover''].forEach(eventName => {
    dropZone.addEventListener(eventName, function() {
        dropZone.classList.add(''drag-over'');
    }, false);
});

[''dragleave'', ''drop''].forEach(eventName => {
    dropZone.addEventListener(eventName, function() {
        dropZone.classList.remove(''drag-over'');
    }, false);
});

// Handle drop
dropZone.addEventListener(''drop'', function(e) {
    let dt = e.dataTransfer;
    let files = dt.files;
    
    log(''Files dropped: '' + files.length);
    
    handleFiles(files);
}, false);

// Click to select
dropZone.addEventListener(''click'', function() {
    fileInput.click();
});

function handleFiles(files) {
    [...files].forEach((file, index) => {
        log(`Processing file ${index + 1}: ${file.name}`);
        handleFile(file);
    });
}
console.log();

console.log("=== File Validation ===");

function validateFile(file) {
    let errors = [];
    
    // Check file size (max 10MB)
    const maxSize = 10 * 1024 * 1024;
    if (file.size > maxSize) {
        errors.push(''File too large (max 10MB)'');
    }
    
    // Check file type
    const allowedTypes = [''image/jpeg'', ''image/png'', ''image/gif'', ''text/plain'', ''text/csv''];
    if (allowedTypes.length > 0 && !allowedTypes.includes(file.type)) {
        errors.push(''File type not allowed'');
    }
    
    return {
        valid: errors.length === 0,
        errors: errors
    };
}

fileInput.addEventListener(''change'', function(event) {
    let file = event.target.files[0];
    if (file) {
        let validation = validateFile(file);
        if (!validation.valid) {
            log(''Validation errors: '' + validation.errors.join('', ''));
            fileInput.value = '''';  // Clear input
        }
    }
});
console.log();

console.log("=== Reading JSON Files ===");

function readJSONFile(file) {
    return new Promise((resolve, reject) => {
        let reader = new FileReader();
        
        reader.onload = function(event) {
            try {
                let json = JSON.parse(event.target.result);
                resolve(json);
            } catch (error) {
                reject(new Error(''Invalid JSON: '' + error.message));
            }
        };
        
        reader.onerror = function(event) {
            reject(event.target.error);
        };
        
        reader.readAsText(file);
    });
}

// Test with JSON file
fileInput.accept = ''application/json,text/json'';
console.log();

console.log("=== Multiple File Reading ===");

function readMultipleFiles(files) {
    let promises = Array.from(files).map(file => {
        return new Promise((resolve, reject) => {
            let reader = new FileReader();
            
            reader.onload = function(event) {
                resolve({
                    name: file.name,
                    content: event.target.result,
                    type: file.type
                });
            };
            
            reader.onerror = function(event) {
                reject(event.target.error);
            };
            
            if (file.type.startsWith(''image/'')) {
                reader.readAsDataURL(file);
            } else {
                reader.readAsText(file);
            }
        });
    });
    
    return Promise.all(promises);
}

// Allow multiple files
fileInput.multiple = true;
console.log();

console.log("=== File Handler Class ===");

class FileHandler {
    constructor(options = {}) {
        this.options = {
            maxSize: options.maxSize || 10 * 1024 * 1024,
            allowedTypes: options.allowedTypes || [],
            onProgress: options.onProgress || null
        };
    }
    
    validate(file) {
        if (this.options.maxSize && file.size > this.options.maxSize) {
            throw new Error(''File too large'');
        }
        
        if (this.options.allowedTypes.length > 0) {
            if (!this.options.allowedTypes.includes(file.type)) {
                throw new Error(''File type not allowed'');
            }
        }
        
        return true;
    }
    
    readAsText(file) {
        return new Promise((resolve, reject) => {
            try {
                this.validate(file);
            } catch (error) {
                reject(error);
                return;
            }
            
            let reader = new FileReader();
            
            reader.onprogress = (e) => {
                if (this.options.onProgress && e.lengthComputable) {
                    this.options.onProgress(e.loaded / e.total);
                }
            };
            
            reader.onload = (e) => resolve(e.target.result);
            reader.onerror = (e) => reject(e.target.error);
            
            reader.readAsText(file);
        });
    }
    
    readAsDataURL(file) {
        return new Promise((resolve, reject) => {
            try {
                this.validate(file);
            } catch (error) {
                reject(error);
                return;
            }
            
            let reader = new FileReader();
            
            reader.onload = (e) => resolve(e.target.result);
            reader.onerror = (e) => reject(e.target.error);
            
            reader.readAsDataURL(file);
        });
    }
}

// Demonstrate handler
let handler = new FileHandler({
    maxSize: 5 * 1024 * 1024,
    allowedTypes: [''image/jpeg'', ''image/png''],
    onProgress: (percent) => {
        console.log(''Progress:'', (percent * 100).toFixed(2) + ''%'');
    }
});
console.log();
```

**Expected Output** (in browser console):
```
=== File APIs Practice ===

=== FileReader Basics ===
[On file select]
File selected: [filename]
File Information displayed

=== Reading Text Files ===
Reading text file...
Progress: [percent]%
Text file loaded
File content (first 100 chars): [content]

=== Reading Image Files ===
[On image select]
Image file loaded
Image dimensions: [width] x [height]

=== Drag and Drop ===
[On drag]
[On drop]
Files dropped: [count]
Processing file 1: [filename]

=== File Validation ===
[On invalid file]
Validation errors: [errors]

=== File Handler Class ===
[On use]
Progress: [percent]%
```

**Challenge (Optional)**:
- Build a complete file upload system
- Create an image editor
- Build a file manager
- Create a drag-and-drop interface

---

## Common Mistakes

### 1. Not Checking File Exists

```javascript
// ⚠️ Problem: File might not exist
let file = fileInput.files[0];
let reader = new FileReader();
reader.readAsText(file);  // Error if no file

// ✅ Solution: Check first
if (fileInput.files.length > 0) {
    let file = fileInput.files[0];
    reader.readAsText(file);
}
```

### 2. Not Handling Errors

```javascript
// ⚠️ Problem: No error handling
reader.readAsText(file);

// ✅ Solution: Handle errors
reader.onerror = function(event) {
    console.error(''Error:'', event.target.error);
};
```

### 3. Not Preventing Default Drag Behavior

```javascript
// ⚠️ Problem: Default behavior prevents drop
dropZone.addEventListener(''drop'', handleDrop);

// ✅ Solution: Prevent default
dropZone.addEventListener(''dragover'', function(e) {
    e.preventDefault();
});
```

### 4. Not Validating File Type

```javascript
// ⚠️ Problem: Accepts any file
reader.readAsDataURL(file);

// ✅ Solution: Validate first
if (file.type.startsWith(''image/'')) {
    reader.readAsDataURL(file);
}
```

---

## Key Takeaways

1. **FileReader API**: Read files from user input
2. **Reading Methods**: readAsText, readAsDataURL, readAsArrayBuffer
3. **File Events**: onload, onerror, onprogress
4. **Drag and Drop**: Handle drag events, prevent defaults
5. **File Validation**: Check type, size, extension
6. **Best Practice**: Always validate, handle errors, show progress
7. **Use Cases**: File uploads, image preview, file processing

---

## Quiz: File APIs

Test your understanding with these questions:

1. **FileReader is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

2. **readAsDataURL returns:**
   - A) Text
   - B) Base64 string
   - C) ArrayBuffer
   - D) Binary

3. **Drag and drop requires:**
   - A) preventDefault on dragover
   - B) preventDefault on drop
   - C) Both
   - D) Neither

4. **file.type returns:**
   - A) File name
   - B) MIME type
   - C) File size
   - D) Nothing

5. **onprogress fires:**
   - A) Once
   - B) Multiple times
   - C) Never
   - D) On error

6. **Multiple files:**
   - A) Not supported
   - B) Use multiple attribute
   - C) Use array
   - D) Not possible

7. **File validation should check:**
   - A) Type only
   - B) Size only
   - C) Both
   - D) Neither

**Answers**:
1. B) Asynchronous
2. B) Base64 string
3. C) Both
4. B) MIME type
5. B) Multiple times
6. B) Use multiple attribute
7. C) Both

---

## Next Steps

Congratulations! You''ve learned File APIs. You now know:
- How to read files
- How to implement drag and drop
- How to validate files
- How to handle different file types

**What''s Next?**
- Lesson 17.3: Canvas and WebGL
- Learn Canvas API
- Draw on canvas
- Create animations

---

## Additional Resources

- **MDN: FileReader API**: [developer.mozilla.org/en-US/docs/Web/API/FileReader](https://developer.mozilla.org/en-US/docs/Web/API/FileReader)
- **MDN: Drag and Drop API**: [developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API](https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API)
- **MDN: File API**: [developer.mozilla.org/en-US/docs/Web/API/File](https://developer.mozilla.org/en-US/docs/Web/API/File)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:54:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the FileReader API
- Read files from user input
- Handle different file types
- Implement drag and drop
- Work with file objects
- Validate file types and sizes
- Build file upload interfaces');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (154, 57, 13, 'Web Audio API', 'web-audio-api', '# Lesson 17.3: Canvas and WebGL

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand the Canvas API
- Draw shapes and paths on canvas
- Work with colors and gradients
- Transform and animate canvas
- Handle canvas events
- Understand WebGL basics
- Build canvas-based applications

---

## Introduction to Canvas

The Canvas API provides a way to draw graphics using JavaScript and HTML.

### Why Canvas?

- **Graphics**: Draw shapes, images, text
- **Animations**: Create smooth animations
- **Games**: Build 2D games
- **Charts**: Create data visualizations
- **Image Processing**: Manipulate images
- **Modern Web**: Essential for graphics

---

## Canvas Basics

### Creating a Canvas

```html
<canvas id="myCanvas" width="800" height="600"></canvas>
```

```javascript
let canvas = document.getElementById(''myCanvas'');
let ctx = canvas.getContext(''2d'');
```

### Getting Context

```javascript
// 2D context (most common)
let ctx = canvas.getContext(''2d'');

// WebGL context (3D)
let gl = canvas.getContext(''webgl'');

// WebGL2 context
let gl2 = canvas.getContext(''webgl2'');
```

### Setting Canvas Size

```javascript
// Set size via attributes (recommended)
canvas.width = 800;
canvas.height = 600;

// Or via CSS (scales, doesn''t resize)
canvas.style.width = ''800px'';
canvas.style.height = ''600px'';
```

---

## Drawing Shapes

### Drawing Rectangles

```javascript
let ctx = canvas.getContext(''2d'');

// Fill rectangle
ctx.fillStyle = ''red'';
ctx.fillRect(10, 10, 100, 50);

// Stroke rectangle
ctx.strokeStyle = ''blue'';
ctx.lineWidth = 2;
ctx.strokeRect(120, 10, 100, 50);

// Clear rectangle
ctx.clearRect(60, 20, 50, 20);
```

### Drawing Paths

```javascript
let ctx = canvas.getContext(''2d'');

// Start path
ctx.beginPath();

// Move to point
ctx.moveTo(50, 50);

// Line to point
ctx.lineTo(150, 50);
ctx.lineTo(100, 150);

// Close path
ctx.closePath();

// Draw
ctx.stroke();
// or
ctx.fill();
```

### Drawing Circles and Arcs

```javascript
let ctx = canvas.getContext(''2d'');

// Arc (circle)
ctx.beginPath();
ctx.arc(100, 100, 50, 0, 2 * Math.PI);
ctx.fill();

// Partial arc
ctx.beginPath();
ctx.arc(200, 100, 50, 0, Math.PI);
ctx.stroke();
```

### Drawing Curves

```javascript
let ctx = canvas.getContext(''2d'');

// Quadratic curve
ctx.beginPath();
ctx.moveTo(50, 50);
ctx.quadraticCurveTo(100, 100, 150, 50);
ctx.stroke();

// Bezier curve
ctx.beginPath();
ctx.moveTo(50, 150);
ctx.bezierCurveTo(75, 100, 125, 200, 150, 150);
ctx.stroke();
```

---

## Colors and Styles

### Fill and Stroke Colors

```javascript
let ctx = canvas.getContext(''2d'');

// Named colors
ctx.fillStyle = ''red'';
ctx.strokeStyle = ''blue'';

// Hex colors
ctx.fillStyle = ''#FF0000'';
ctx.strokeStyle = ''#0000FF'';

// RGB colors
ctx.fillStyle = ''rgb(255, 0, 0)'';
ctx.strokeStyle = ''rgba(0, 0, 255, 0.5)'';
```

### Gradients

```javascript
let ctx = canvas.getContext(''2d'');

// Linear gradient
let gradient = ctx.createLinearGradient(0, 0, 200, 0);
gradient.addColorStop(0, ''red'');
gradient.addColorStop(1, ''blue'');
ctx.fillStyle = gradient;
ctx.fillRect(10, 10, 200, 100);

// Radial gradient
let radialGradient = ctx.createRadialGradient(100, 100, 0, 100, 100, 50);
radialGradient.addColorStop(0, ''white'');
radialGradient.addColorStop(1, ''black'');
ctx.fillStyle = radialGradient;
ctx.fillRect(50, 50, 100, 100);
```

### Patterns

```javascript
let ctx = canvas.getContext(''2d'');

// Create pattern from image
let img = new Image();
img.onload = function() {
    let pattern = ctx.createPattern(img, ''repeat'');
    ctx.fillStyle = pattern;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
};
img.src = ''pattern.png'';
```

---

## Text

### Drawing Text

```javascript
let ctx = canvas.getContext(''2d'');

// Font
ctx.font = ''30px Arial'';

// Fill text
ctx.fillStyle = ''black'';
ctx.fillText(''Hello Canvas'', 10, 50);

// Stroke text
ctx.strokeStyle = ''blue'';
ctx.strokeText(''Hello Canvas'', 10, 100);
```

### Text Properties

```javascript
let ctx = canvas.getContext(''2d'');

ctx.font = ''bold 30px Arial'';
ctx.textAlign = ''center'';
ctx.textBaseline = ''middle'';
ctx.fillText(''Centered Text'', canvas.width / 2, canvas.height / 2);
```

---

## Images

### Drawing Images

```javascript
let ctx = canvas.getContext(''2d'');
let img = new Image();

img.onload = function() {
    // Draw image
    ctx.drawImage(img, 10, 10);
    
    // Draw scaled
    ctx.drawImage(img, 10, 10, 100, 100);
    
    // Draw from source rectangle
    ctx.drawImage(img, 0, 0, 50, 50, 10, 10, 100, 100);
};

img.src = ''image.jpg'';
```

### Image Manipulation

```javascript
// Get image data
let imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
let data = imageData.data;

// Manipulate pixels
for (let i = 0; i < data.length; i += 4) {
    // Red
    data[i] = 255 - data[i];
    // Green
    data[i + 1] = 255 - data[i + 1];
    // Blue
    data[i + 2] = 255 - data[i + 2];
    // Alpha (unchanged)
}

// Put image data back
ctx.putImageData(imageData, 0, 0);
```

---

## Transformations

### Translate, Rotate, Scale

```javascript
let ctx = canvas.getContext(''2d'');

// Save state
ctx.save();

// Translate
ctx.translate(100, 100);

// Rotate
ctx.rotate(Math.PI / 4);

// Scale
ctx.scale(2, 2);

// Draw (will be transformed)
ctx.fillRect(-25, -25, 50, 50);

// Restore state
ctx.restore();
```

### Transform Matrix

```javascript
let ctx = canvas.getContext(''2d'');

// Transform using matrix
ctx.transform(1, 0, 0, 1, 100, 100);  // Translate
ctx.transform(2, 0, 0, 2, 0, 0);      // Scale

// Or set transform
ctx.setTransform(1, 0, 0, 1, 0, 0);  // Reset
```

---

## Animation

### Basic Animation Loop

```javascript
function animate() {
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw frame
    draw();
    
    // Next frame
    requestAnimationFrame(animate);
}

// Start animation
animate();
```

### Animation Example

```javascript
let x = 0;
let y = 0;
let dx = 2;
let dy = 2;

function animate() {
    // Clear
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Update position
    x += dx;
    y += dy;
    
    // Bounce
    if (x < 0 || x > canvas.width - 50) dx = -dx;
    if (y < 0 || y > canvas.height - 50) dy = -dy;
    
    // Draw
    ctx.fillRect(x, y, 50, 50);
    
    requestAnimationFrame(animate);
}

animate();
```

---

## WebGL Basics

### WebGL Context

```javascript
let canvas = document.getElementById(''myCanvas'');
let gl = canvas.getContext(''webgl'');

if (!gl) {
    console.error(''WebGL not supported'');
}
```

### Basic WebGL Setup

```javascript
// Clear color
gl.clearColor(0.0, 0.0, 0.0, 1.0);
gl.clear(gl.COLOR_BUFFER_BIT);

// Viewport
gl.viewport(0, 0, canvas.width, canvas.height);
```

### Shaders

```javascript
// Vertex shader
let vertexShaderSource = `
    attribute vec4 a_position;
    void main() {
        gl_Position = a_position;
    }
`;

// Fragment shader
let fragmentShaderSource = `
    precision mediump float;
    void main() {
        gl_FragColor = vec4(1, 0, 0, 1);
    }
`;
```

---

## Practical Examples

### Example 1: Drawing App

```javascript
class DrawingApp {
    constructor(canvas) {
        this.canvas = canvas;
        this.ctx = canvas.getContext(''2d'');
        this.isDrawing = false;
        this.currentPath = [];
        
        this.setupEventListeners();
    }
    
    setupEventListeners() {
        this.canvas.addEventListener(''mousedown'', (e) => {
            this.isDrawing = true;
            this.currentPath = [this.getMousePos(e)];
        });
        
        this.canvas.addEventListener(''mousemove'', (e) => {
            if (this.isDrawing) {
                this.currentPath.push(this.getMousePos(e));
                this.draw();
            }
        });
        
        this.canvas.addEventListener(''mouseup'', () => {
            this.isDrawing = false;
        });
    }
    
    getMousePos(e) {
        let rect = this.canvas.getBoundingClientRect();
        return {
            x: e.clientX - rect.left,
            y: e.clientY - rect.top
        };
    }
    
    draw() {
        if (this.currentPath.length < 2) return;
        
        this.ctx.beginPath();
        this.ctx.moveTo(this.currentPath[0].x, this.currentPath[0].y);
        
        for (let i = 1; i < this.currentPath.length; i++) {
            this.ctx.lineTo(this.currentPath[i].x, this.currentPath[i].y);
        }
        
        this.ctx.stroke();
    }
}

let app = new DrawingApp(document.getElementById(''canvas''));
```

### Example 2: Particle System

```javascript
class Particle {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 2;
        this.vy = (Math.random() - 0.5) * 2;
        this.life = 1.0;
    }
    
    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.life -= 0.01;
    }
    
    draw(ctx) {
        ctx.globalAlpha = this.life;
        ctx.fillRect(this.x, this.y, 2, 2);
    }
}

class ParticleSystem {
    constructor(canvas) {
        this.canvas = canvas;
        this.ctx = canvas.getContext(''2d'');
        this.particles = [];
    }
    
    addParticle(x, y) {
        this.particles.push(new Particle(x, y));
    }
    
    update() {
        this.particles = this.particles.filter(p => {
            p.update();
            return p.life > 0;
        });
    }
    
    draw() {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
        this.particles.forEach(p => p.draw(this.ctx));
        this.ctx.globalAlpha = 1.0;
    }
    
    animate() {
        this.update();
        this.draw();
        requestAnimationFrame(() => this.animate());
    }
}
```

---

## Practice Exercise

### Exercise: Canvas Drawing

**Objective**: Practice using Canvas API to draw shapes, create animations, and build interactive graphics.

**Instructions**:

1. Create an HTML file with canvas element
2. Create a JavaScript file for canvas operations
3. Practice:
   - Drawing shapes and paths
   - Using colors and gradients
   - Creating animations
   - Handling mouse events
   - Basic WebGL setup

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Practice</title>
    <style>
        canvas {
            border: 1px solid #000;
            display: block;
            margin: 20px auto;
        }
        .controls {
            text-align: center;
            margin: 20px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="drawShapes()">Draw Shapes</button>
        <button onclick="drawGradients()">Draw Gradients</button>
        <button onclick="startAnimation()">Start Animation</button>
        <button onclick="clearCanvas()">Clear</button>
    </div>
    <canvas id="myCanvas" width="800" height="600"></canvas>
    <script src="canvas-practice.js"></script>
</body>
</html>
```

```javascript
// canvas-practice.js
console.log("=== Canvas Practice ===");

let canvas = document.getElementById(''myCanvas'');
let ctx = canvas.getContext(''2d'');

console.log("\\n=== Canvas Setup ===");

console.log(''Canvas width:'', canvas.width);
console.log(''Canvas height:'', canvas.height);
console.log(''Context:'', ctx);
console.log();

console.log("=== Drawing Shapes ===");

function drawShapes() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Rectangles
    ctx.fillStyle = ''red'';
    ctx.fillRect(10, 10, 100, 50);
    
    ctx.strokeStyle = ''blue'';
    ctx.lineWidth = 3;
    ctx.strokeRect(120, 10, 100, 50);
    
    // Circles
    ctx.fillStyle = ''green'';
    ctx.beginPath();
    ctx.arc(200, 200, 50, 0, 2 * Math.PI);
    ctx.fill();
    
    ctx.strokeStyle = ''purple'';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.arc(350, 200, 50, 0, 2 * Math.PI);
    ctx.stroke();
    
    // Paths
    ctx.strokeStyle = ''orange'';
    ctx.lineWidth = 2;
    ctx.beginPath();
    ctx.moveTo(50, 300);
    ctx.lineTo(150, 300);
    ctx.lineTo(100, 400);
    ctx.closePath();
    ctx.stroke();
    
    // Curves
    ctx.strokeStyle = ''brown'';
    ctx.beginPath();
    ctx.moveTo(200, 300);
    ctx.quadraticCurveTo(250, 250, 300, 300);
    ctx.stroke();
    
    ctx.beginPath();
    ctx.moveTo(350, 300);
    ctx.bezierCurveTo(375, 250, 425, 350, 450, 300);
    ctx.stroke();
    
    console.log(''Shapes drawn'');
}

console.log();

console.log("=== Drawing Gradients ===");

function drawGradients() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Linear gradient
    let linearGradient = ctx.createLinearGradient(0, 0, 200, 0);
    linearGradient.addColorStop(0, ''red'');
    linearGradient.addColorStop(0.5, ''yellow'');
    linearGradient.addColorStop(1, ''green'');
    ctx.fillStyle = linearGradient;
    ctx.fillRect(10, 10, 200, 100);
    
    // Radial gradient
    let radialGradient = ctx.createRadialGradient(350, 150, 0, 350, 150, 100);
    radialGradient.addColorStop(0, ''white'');
    radialGradient.addColorStop(1, ''black'');
    ctx.fillStyle = radialGradient;
    ctx.fillRect(250, 50, 200, 200);
    
    console.log(''Gradients drawn'');
}

console.log();

console.log("=== Drawing Text ===");

function drawText() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    ctx.font = ''30px Arial'';
    ctx.fillStyle = ''black'';
    ctx.fillText(''Hello Canvas'', 10, 50);
    
    ctx.font = ''bold 40px Arial'';
    ctx.strokeStyle = ''blue'';
    ctx.strokeText(''Stroked Text'', 10, 100);
    
    ctx.font = ''20px Arial'';
    ctx.textAlign = ''center'';
    ctx.textBaseline = ''middle'';
    ctx.fillText(''Centered Text'', canvas.width / 2, canvas.height / 2);
    
    // Reset alignment
    ctx.textAlign = ''left'';
    ctx.textBaseline = ''alphabetic'';
    
    console.log(''Text drawn'');
}

console.log();

console.log("=== Animation ===");

let animationId = null;
let ball = {
    x: 100,
    y: 100,
    vx: 2,
    vy: 2,
    radius: 20
};

function startAnimation() {
    if (animationId) {
        cancelAnimationFrame(animationId);
    }
    
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Update position
        ball.x += ball.vx;
        ball.y += ball.vy;
        
        // Bounce
        if (ball.x - ball.radius < 0 || ball.x + ball.radius > canvas.width) {
            ball.vx = -ball.vx;
        }
        if (ball.y - ball.radius < 0 || ball.y + ball.radius > canvas.height) {
            ball.vy = -ball.vy;
        }
        
        // Draw ball
        ctx.fillStyle = ''red'';
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.radius, 0, 2 * Math.PI);
        ctx.fill();
        
        animationId = requestAnimationFrame(animate);
    }
    
    animate();
    console.log(''Animation started'');
}

function clearCanvas() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (animationId) {
        cancelAnimationFrame(animationId);
        animationId = null;
    }
    console.log(''Canvas cleared'');
}

console.log();

console.log("=== Transformations ===");

function drawTransformed() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Original
    ctx.fillStyle = ''blue'';
    ctx.fillRect(50, 50, 50, 50);
    
    // Translated
    ctx.save();
    ctx.translate(150, 0);
    ctx.fillStyle = ''red'';
    ctx.fillRect(50, 50, 50, 50);
    ctx.restore();
    
    // Rotated
    ctx.save();
    ctx.translate(250, 100);
    ctx.rotate(Math.PI / 4);
    ctx.fillStyle = ''green'';
    ctx.fillRect(-25, -25, 50, 50);
    ctx.restore();
    
    // Scaled
    ctx.save();
    ctx.translate(350, 100);
    ctx.scale(1.5, 1.5);
    ctx.fillStyle = ''purple'';
    ctx.fillRect(-25, -25, 50, 50);
    ctx.restore();
    
    console.log(''Transformed shapes drawn'');
}

console.log();

console.log("=== Mouse Interaction ===");

let isDrawing = false;
let lastX = 0;
let lastY = 0;

canvas.addEventListener(''mousedown'', function(e) {
    isDrawing = true;
    let rect = canvas.getBoundingClientRect();
    lastX = e.clientX - rect.left;
    lastY = e.clientY - rect.top;
});

canvas.addEventListener(''mousemove'', function(e) {
    if (isDrawing) {
        let rect = canvas.getBoundingClientRect();
        let x = e.clientX - rect.left;
        let y = e.clientY - rect.top;
        
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.strokeStyle = ''black'';
        ctx.lineWidth = 2;
        ctx.stroke();
        
        lastX = x;
        lastY = y;
    }
});

canvas.addEventListener(''mouseup'', function() {
    isDrawing = false;
});

canvas.addEventListener(''mouseleave'', function() {
    isDrawing = false;
});

console.log(''Mouse interaction enabled'');
console.log();

console.log("=== WebGL Basics ===");

function initWebGL() {
    let gl = canvas.getContext(''webgl'');
    
    if (!gl) {
        console.error(''WebGL not supported'');
        return null;
    }
    
    console.log(''WebGL context created'');
    
    // Clear color
    gl.clearColor(0.0, 0.0, 0.0, 1.0);
    gl.clear(gl.COLOR_BUFFER_BIT);
    
    // Viewport
    gl.viewport(0, 0, canvas.width, canvas.height);
    
    return gl;
}

// Uncomment to test WebGL
// let gl = initWebGL();
console.log();

console.log("=== Image Drawing ===");

function drawImage() {
    let img = new Image();
    
    img.onload = function() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 10, 10);
        ctx.drawImage(img, 200, 10, 100, 100);
        console.log(''Image drawn'');
    };
    
    img.onerror = function() {
        console.error(''Error loading image'');
    };
    
    // Use a placeholder or actual image URL
    img.src = ''data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0icmVkIi8+PC9zdmc+'';
}

console.log();

console.log("=== Particle System ===");

class Particle {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.vx = (Math.random() - 0.5) * 4;
        this.vy = (Math.random() - 0.5) * 4;
        this.life = 1.0;
        this.size = Math.random() * 3 + 1;
    }
    
    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.life -= 0.01;
    }
    
    draw() {
        ctx.globalAlpha = this.life;
        ctx.fillStyle = ''blue'';
        ctx.fillRect(this.x, this.y, this.size, this.size);
    }
}

let particles = [];

function createParticles(x, y, count = 50) {
    for (let i = 0; i < count; i++) {
        particles.push(new Particle(x, y));
    }
}

function updateParticles() {
    particles = particles.filter(p => {
        p.update();
        return p.life > 0;
    });
}

function drawParticles() {
    particles.forEach(p => p.draw());
    ctx.globalAlpha = 1.0;
}

canvas.addEventListener(''click'', function(e) {
    let rect = canvas.getBoundingClientRect();
    let x = e.clientX - rect.left;
    let y = e.clientY - rect.top;
    createParticles(x, y);
});

// Animate particles
function animateParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    updateParticles();
    drawParticles();
    requestAnimationFrame(animateParticles);
}

animateParticles();
console.log(''Particle system active - click to create particles'');
```

**Expected Output** (in browser):
- Canvas with various shapes
- Gradients
- Animated ball
- Drawing with mouse
- Particles on click

**Challenge (Optional)**:
- Build a complete drawing app
- Create a game
- Build a chart library
- Create an image editor

---

## Common Mistakes

### 1. Not Getting Context

```javascript
// ⚠️ Problem: No context
canvas.fillRect(10, 10, 50, 50);

// ✅ Solution: Get context first
let ctx = canvas.getContext(''2d'');
ctx.fillRect(10, 10, 50, 50);
```

### 2. Not Clearing Canvas

```javascript
// ⚠️ Problem: Draws over previous frames
function animate() {
    draw();
    requestAnimationFrame(animate);
}

// ✅ Solution: Clear first
function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    draw();
    requestAnimationFrame(animate);
}
```

### 3. Not Saving/Restoring State

```javascript
// ⚠️ Problem: Transformations persist
ctx.translate(100, 100);
draw();
// Translation still active

// ✅ Solution: Save and restore
ctx.save();
ctx.translate(100, 100);
draw();
ctx.restore();
```

---

## Key Takeaways

1. **Canvas API**: Draw graphics with JavaScript
2. **Context**: Get 2D or WebGL context
3. **Shapes**: Rectangles, paths, arcs, curves
4. **Colors**: Fill, stroke, gradients, patterns
5. **Animation**: Use requestAnimationFrame
6. **Transformations**: Translate, rotate, scale
7. **WebGL**: 3D graphics (advanced)
8. **Best Practice**: Clear canvas, save/restore state, use requestAnimationFrame

---

## Quiz: Canvas

Test your understanding with these questions:

1. **Canvas context is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

2. **fillRect() draws:**
   - A) Outlined rectangle
   - B) Filled rectangle
   - C) Both
   - D) Nothing

3. **beginPath() is:**
   - A) Required for paths
   - B) Optional
   - C) Not needed
   - D) Error

4. **requestAnimationFrame is:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

5. **save() and restore() are:**
   - A) For transformations
   - B) For colors
   - C) For state
   - D) Nothing

6. **WebGL is for:**
   - A) 2D graphics
   - B) 3D graphics
   - C) Both
   - D) Neither

7. **clearRect() clears:**
   - A) Entire canvas
   - B) Rectangle area
   - C) Both
   - D) Nothing

**Answers**:
1. A) Synchronous (drawing operations)
2. B) Filled rectangle
3. A) Required for paths
4. B) Asynchronous
5. C) For state
6. B) 3D graphics
7. B) Rectangle area

---

## Next Steps

Congratulations! You''ve completed Module 17: Browser APIs. You now know:
- Geolocation API
- File APIs
- Canvas API
- WebGL basics

**What''s Next?**
- Course 5: Advanced JavaScript
- Module 18: Functional Programming
- Learn functional programming concepts
- Work with higher-order functions

---

## Additional Resources

- **MDN: Canvas API**: [developer.mozilla.org/en-US/docs/Web/API/Canvas_API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API)
- **MDN: WebGL**: [developer.mozilla.org/en-US/docs/Web/API/WebGL_API](https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API)
- **Canvas Tutorial**: [developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial)

---

*Lesson completed! You''ve finished Module 17: Browser APIs. Ready for Course 5: Advanced JavaScript!*

', NULL, 3, '2026-01-03 09:54:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand the Canvas API
- Draw shapes and paths on canvas
- Work with colors and gradients
- Transform and animate canvas
- Handle canvas events
- Understand WebGL basics
- Build canvas-based applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (155, 58, 14, 'Functional Programming Concepts', 'functional-programming-concepts', '# Lesson 18.1: Functional Programming Concepts

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand functional programming principles
- Write pure functions
- Work with immutability
- Identify and avoid side effects
- Understand first-class functions
- Apply functional programming concepts
- Write more predictable code

---

## Introduction to Functional Programming

Functional Programming (FP) is a programming paradigm that treats computation as the evaluation of mathematical functions and avoids changing state and mutable data.

### Why Functional Programming?

- **Predictability**: Same input always produces same output
- **Testability**: Easier to test pure functions
- **Maintainability**: Code is easier to understand and modify
- **Concurrency**: Easier to reason about parallel code
- **Debugging**: Fewer bugs due to immutability
- **Modern JavaScript**: Many features support FP

### Core Principles

1. **Pure Functions**: No side effects
2. **Immutability**: Don''t modify data
3. **First-Class Functions**: Functions as values
4. **Higher-Order Functions**: Functions that operate on functions
5. **Function Composition**: Combine functions

---

## Pure Functions

### What are Pure Functions?

A pure function:
- Always returns the same output for the same input
- Has no side effects
- Doesn''t depend on external state

### Pure Function Example

```javascript
// Pure function
function add(a, b) {
    return a + b;
}

// Always returns same output for same input
console.log(add(2, 3));  // 5
console.log(add(2, 3));  // 5 (always)
```

### Impure Function Example

```javascript
// Impure function (depends on external state)
let counter = 0;

function increment() {
    counter++;  // Side effect: modifies external state
    return counter;
}

console.log(increment());  // 1
console.log(increment());  // 2 (different output)
```

### More Pure Function Examples

```javascript
// Pure: No side effects
function multiply(x, y) {
    return x * y;
}

// Pure: Doesn''t modify input
function square(x) {
    return x * x;
}

// Pure: Returns new array
function addItem(arr, item) {
    return [...arr, item];  // New array, doesn''t modify original
}

// Impure: Modifies input
function addItemImpure(arr, item) {
    arr.push(item);  // Modifies original array
    return arr;
}
```

### Benefits of Pure Functions

```javascript
// Easy to test
function calculateTotal(items) {
    return items.reduce((sum, item) => sum + item.price, 0);
}

// Easy to reason about
let items = [{ price: 10 }, { price: 20 }];
let total = calculateTotal(items);  // Always 30 for this input

// Can be memoized
// Can be parallelized
// Easier to debug
```

---

## Immutability

### What is Immutability?

Immutability means data cannot be changed after creation. Instead, create new data.

### Mutable vs Immutable

```javascript
// Mutable (bad)
let user = { name: ''Alice'', age: 30 };
user.age = 31;  // Modifies original

// Immutable (good)
let user = { name: ''Alice'', age: 30 };
let updatedUser = { ...user, age: 31 };  // New object
```

### Immutable Arrays

```javascript
// Mutable (bad)
let numbers = [1, 2, 3];
numbers.push(4);  // Modifies original

// Immutable (good)
let numbers = [1, 2, 3];
let newNumbers = [...numbers, 4];  // New array
```

### Immutable Objects

```javascript
// Mutable (bad)
let user = { name: ''Alice'', age: 30 };
user.age = 31;

// Immutable (good)
let user = { name: ''Alice'', age: 30 };
let updatedUser = { ...user, age: 31 };

// Nested objects
let user = {
    name: ''Alice'',
    address: { city: ''NYC'', zip: ''10001'' }
};

// Immutable update
let updatedUser = {
    ...user,
    address: {
        ...user.address,
        zip: ''10002''
    }
};
```

### Benefits of Immutability

```javascript
// Predictable
let original = [1, 2, 3];
let doubled = original.map(x => x * 2);
// original is still [1, 2, 3]

// Easier debugging
// Can track changes
// Better for React/Redux
```

---

## Side Effects

### What are Side Effects?

Side effects are changes to state outside the function:
- Modifying variables
- Console logging
- Network requests
- DOM manipulation
- File I/O

### Functions with Side Effects

```javascript
// Side effect: Modifies external variable
let count = 0;
function increment() {
    count++;  // Side effect
}

// Side effect: Console log
function logMessage(msg) {
    console.log(msg);  // Side effect
}

// Side effect: DOM manipulation
function updateDOM(element, text) {
    element.textContent = text;  // Side effect
}

// Side effect: Network request
async function fetchData() {
    let data = await fetch(''/api/data'');  // Side effect
    return data.json();
}
```

### Minimizing Side Effects

```javascript
// Separate pure logic from side effects
function calculateTotal(items) {
    // Pure function
    return items.reduce((sum, item) => sum + item.price, 0);
}

function displayTotal(total) {
    // Side effect isolated
    document.getElementById(''total'').textContent = total;
}

// Use together
let total = calculateTotal(items);
displayTotal(total);
```

### When Side Effects are Necessary

```javascript
// Side effects are sometimes necessary
// But isolate them and make them explicit

// Good: Isolated side effect
function saveUser(user) {
    // Side effect: Network request
    return fetch(''/api/users'', {
        method: ''POST'',
        body: JSON.stringify(user)
    });
}

// Bad: Hidden side effects
function processUser(user) {
    user.id = generateId();  // Side effect: modifies input
    saveToDatabase(user);     // Side effect: hidden
    updateUI(user);           // Side effect: hidden
    return user;
}
```

---

## First-Class Functions

### What are First-Class Functions?

In JavaScript, functions are first-class citizens:
- Can be assigned to variables
- Can be passed as arguments
- Can be returned from functions
- Can be stored in data structures

### Functions as Values

```javascript
// Assign to variable
let greet = function(name) {
    return `Hello, ${name}!`;
};

// Arrow function
let greet = (name) => `Hello, ${name}!`);

// Use function
console.log(greet(''Alice''));
```

### Functions as Arguments

```javascript
// Pass function as argument
function applyOperation(x, y, operation) {
    return operation(x, y);
}

let add = (a, b) => a + b;
let multiply = (a, b) => a * b;

console.log(applyOperation(5, 3, add));      // 8
console.log(applyOperation(5, 3, multiply)); // 15
```

### Functions as Return Values

```javascript
// Return function from function
function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);

console.log(double(5));  // 10
console.log(triple(5));  // 15
```

### Functions in Data Structures

```javascript
// Store functions in array
let operations = [
    (x) => x * 2,
    (x) => x + 1,
    (x) => x * x
];

let result = 5;
operations.forEach(op => {
    result = op(result);
});
console.log(result);  // 121
```

---

## Higher-Order Functions

### What are Higher-Order Functions?

Higher-order functions are functions that:
- Take functions as arguments, or
- Return functions

### Examples

```javascript
// Higher-order function: takes function as argument
function map(array, fn) {
    let result = [];
    for (let item of array) {
        result.push(fn(item));
    }
    return result;
}

let numbers = [1, 2, 3];
let doubled = map(numbers, x => x * 2);
console.log(doubled);  // [2, 4, 6]

// Higher-order function: returns function
function createValidator(rule) {
    return function(value) {
        return rule(value);
    };
}

let isPositive = createValidator(x => x > 0);
console.log(isPositive(5));   // true
console.log(isPositive(-5));  // false
```

---

## Practical Examples

### Example 1: Pure Data Transformation

```javascript
// Pure function: Transform data
function formatUsers(users) {
    return users.map(user => ({
        name: user.name.toUpperCase(),
        age: user.age,
        isAdult: user.age >= 18
    }));
}

let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 }
];

let formatted = formatUsers(users);
// Original users unchanged
// formatted is new array
```

### Example 2: Immutable Updates

```javascript
// Immutable update function
function updateUser(users, userId, updates) {
    return users.map(user =>
        user.id === userId
            ? { ...user, ...updates }
            : user
    );
}

let users = [
    { id: 1, name: ''Alice'', age: 30 },
    { id: 2, name: ''Bob'', age: 25 }
];

let updated = updateUser(users, 1, { age: 31 });
// users unchanged
// updated has new user object
```

### Example 3: Function Composition

```javascript
// Compose functions
function compose(...fns) {
    return function(value) {
        return fns.reduceRight((acc, fn) => fn(acc), value);
    };
}

let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = compose(square, double, addOne);
console.log(transform(5));  // ((5 + 1) * 2) ^ 2 = 144
```

---

## Practice Exercise

### Exercise: Functional Programming

**Objective**: Practice writing pure functions, working with immutability, and avoiding side effects.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Writing pure functions
   - Working with immutability
   - Identifying side effects
   - Using first-class functions

**Example Solution**:

```javascript
// functional-programming-practice.js
console.log("=== Functional Programming Practice ===");

console.log("\\n=== Pure Functions ===");

// Pure function: Always same output for same input
function add(a, b) {
    return a + b;
}

console.log(''add(2, 3):'', add(2, 3));  // 5
console.log(''add(2, 3):'', add(2, 3));  // 5 (always same)

// Pure function: No side effects
function multiply(x, y) {
    return x * y;
}

console.log(''multiply(4, 5):'', multiply(4, 5));  // 20

// Pure function: Returns new array
function addItem(arr, item) {
    return [...arr, item];
}

let numbers = [1, 2, 3];
let newNumbers = addItem(numbers, 4);
console.log(''Original:'', numbers);      // [1, 2, 3]
console.log(''New:'', newNumbers);        // [1, 2, 3, 4]
console.log();

console.log("=== Impure Functions (for comparison) ===");

// Impure: Depends on external state
let counter = 0;
function increment() {
    counter++;
    return counter;
}

console.log(''increment():'', increment());  // 1
console.log(''increment():'', increment());  // 2 (different)

// Impure: Modifies input
function addItemImpure(arr, item) {
    arr.push(item);
    return arr;
}

let arr1 = [1, 2, 3];
let arr2 = addItemImpure(arr1, 4);
console.log(''arr1:'', arr1);  // [1, 2, 3, 4] (modified!)
console.log(''arr2:'', arr2);  // [1, 2, 3, 4]
console.log();

console.log("=== Immutability ===");

// Immutable: Create new objects
let user = { name: ''Alice'', age: 30 };
let updatedUser = { ...user, age: 31 };

console.log(''Original user:'', user);         // { name: ''Alice'', age: 30 }
console.log(''Updated user:'', updatedUser);  // { name: ''Alice'', age: 31 }

// Immutable: Create new arrays
let items = [1, 2, 3];
let newItems = [...items, 4];

console.log(''Original items:'', items);    // [1, 2, 3]
console.log(''New items:'', newItems);      // [1, 2, 3, 4]

// Immutable: Nested objects
let person = {
    name: ''Alice'',
    address: { city: ''NYC'', zip: ''10001'' }
};

let updatedPerson = {
    ...person,
    address: {
        ...person.address,
        zip: ''10002''
    }
};

console.log(''Original person:'', person);
console.log(''Updated person:'', updatedPerson);
console.log();

console.log("=== Side Effects ===");

// Function with side effect
function logMessage(msg) {
    console.log(''Logging:'', msg);  // Side effect: console.log
}

logMessage(''Hello'');

// Function with side effect: DOM manipulation
function updateDOM(elementId, text) {
    // Side effect: DOM manipulation
    // (commented out for this example)
    // document.getElementById(elementId).textContent = text;
    console.log(''Would update DOM:'', elementId, text);
}

updateDOM(''output'', ''Hello World'');

// Isolate side effects
function calculateTotal(items) {
    // Pure function
    return items.reduce((sum, item) => sum + item.price, 0);
}

function displayTotal(total) {
    // Side effect isolated
    console.log(''Total:'', total);
}

let cart = [
    { name: ''Apple'', price: 1.00 },
    { name: ''Banana'', price: 0.50 }
];

let total = calculateTotal(cart);
displayTotal(total);
console.log();

console.log("=== First-Class Functions ===");

// Functions as values
let greet = function(name) {
    return `Hello, ${name}!`;
};

console.log(''greet("Alice"):'', greet(''Alice''));

// Arrow function
let add = (a, b) => a + b;
console.log(''add(2, 3):'', add(2, 3));

// Functions as arguments
function applyOperation(x, y, operation) {
    return operation(x, y);
}

let multiply = (a, b) => a * b;
console.log(''applyOperation(5, 3, multiply):'', applyOperation(5, 3, multiply));

// Functions as return values
function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);

console.log(''double(5):'', double(5));   // 10
console.log(''triple(5):'', triple(5));  // 15

// Functions in data structures
let operations = [
    x => x * 2,
    x => x + 1,
    x => x * x
];

let result = 5;
operations.forEach(op => {
    result = op(result);
});
console.log(''Result after operations:'', result);
console.log();

console.log("=== Higher-Order Functions ===");

// Higher-order function: takes function as argument
function map(array, fn) {
    let result = [];
    for (let item of array) {
        result.push(fn(item));
    }
    return result;
}

let numbers = [1, 2, 3, 4, 5];
let doubled = map(numbers, x => x * 2);
console.log(''Doubled:'', doubled);  // [2, 4, 6, 8, 10]

// Higher-order function: returns function
function createValidator(rule) {
    return function(value) {
        return rule(value);
    };
}

let isPositive = createValidator(x => x > 0);
let isEven = createValidator(x => x % 2 === 0);

console.log(''isPositive(5):'', isPositive(5));   // true
console.log(''isPositive(-5):'', isPositive(-5)); // false
console.log(''isEven(4):'', isEven(4));            // true
console.log(''isEven(5):'', isEven(5));            // false
console.log();

console.log("=== Practical Examples ===");

// Pure data transformation
function formatUsers(users) {
    return users.map(user => ({
        name: user.name.toUpperCase(),
        age: user.age,
        isAdult: user.age >= 18
    }));
}

let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 },
    { name: ''Charlie'', age: 25 }
];

let formatted = formatUsers(users);
console.log(''Formatted users:'', formatted);

// Immutable update
function updateUser(users, userId, updates) {
    return users.map(user =>
        user.id === userId
            ? { ...user, ...updates }
            : user
    );
}

let usersWithId = [
    { id: 1, name: ''Alice'', age: 30 },
    { id: 2, name: ''Bob'', age: 25 }
];

let updated = updateUser(usersWithId, 1, { age: 31 });
console.log(''Original users:'', usersWithId);
console.log(''Updated users:'', updated);

// Function composition
function compose(...fns) {
    return function(value) {
        return fns.reduceRight((acc, fn) => fn(acc), value);
    };
}

let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = compose(square, double, addOne);
console.log(''transform(5):'', transform(5));  // ((5 + 1) * 2) ^ 2 = 144
console.log();

console.log("=== Benefits of Functional Programming ===");

// Easy to test
function calculateTotal(items) {
    return items.reduce((sum, item) => sum + item.price, 0);
}

let testItems = [
    { price: 10 },
    { price: 20 },
    { price: 30 }
];

let total = calculateTotal(testItems);
console.log(''Total:'', total);  // Always 60 for this input

// Predictable
let numbers2 = [1, 2, 3];
let doubled2 = numbers2.map(x => x * 2);
console.log(''Original:'', numbers2);  // [1, 2, 3] (unchanged)
console.log(''Doubled:'', doubled2);   // [2, 4, 6]
```

**Expected Output**:
```
=== Functional Programming Practice ===

=== Pure Functions ===
add(2, 3): 5
add(2, 3): 5
multiply(4, 5): 20
Original: [1, 2, 3]
New: [1, 2, 3, 4]

=== Impure Functions (for comparison) ===
increment(): 1
increment(): 2
arr1: [1, 2, 3, 4]
arr2: [1, 2, 3, 4]

=== Immutability ===
Original user: { name: ''Alice'', age: 30 }
Updated user: { name: ''Alice'', age: 31 }
Original items: [1, 2, 3]
New items: [1, 2, 3, 4]

=== Side Effects ===
Logging: Hello
Would update DOM: output Hello World
Total: 1.5

=== First-Class Functions ===
greet("Alice"): Hello, Alice!
add(2, 3): 5
applyOperation(5, 3, multiply): 15
double(5): 10
triple(5): 15
Result after operations: 121

=== Higher-Order Functions ===
Doubled: [2, 4, 6, 8, 10]
isPositive(5): true
isPositive(-5): false
isEven(4): true
isEven(5): false

=== Practical Examples ===
Formatted users: [array]
Original users: [array]
Updated users: [array]
transform(5): 144

=== Benefits of Functional Programming ===
Total: 60
Original: [1, 2, 3]
Doubled: [2, 4, 6]
```

**Challenge (Optional)**:
- Refactor existing code to be more functional
- Build a functional programming library
- Create immutable data structures
- Practice function composition

---

## Common Mistakes

### 1. Modifying Input Parameters

```javascript
// ⚠️ Problem: Modifies input
function addItem(arr, item) {
    arr.push(item);
    return arr;
}

// ✅ Solution: Return new array
function addItem(arr, item) {
    return [...arr, item];
}
```

### 2. Using External State

```javascript
// ⚠️ Problem: Depends on external state
let multiplier = 2;
function multiply(x) {
    return x * multiplier;  // Depends on external state
}

// ✅ Solution: Pass as parameter
function multiply(x, multiplier) {
    return x * multiplier;
}
```

### 3. Mixing Side Effects with Logic

```javascript
// ⚠️ Problem: Side effects mixed with logic
function processUser(user) {
    user.id = generateId();  // Side effect
    saveToDB(user);           // Side effect
    return user;
}

// ✅ Solution: Separate concerns
function processUser(user) {
    return { ...user, id: generateId() };
}

let processed = processUser(user);
saveToDB(processed);
```

---

## Key Takeaways

1. **Pure Functions**: Same input → same output, no side effects
2. **Immutability**: Don''t modify data, create new data
3. **Side Effects**: Isolate and minimize
4. **First-Class Functions**: Functions are values
5. **Higher-Order Functions**: Functions that work with functions
6. **Benefits**: Predictable, testable, maintainable code
7. **Best Practice**: Prefer pure functions, use immutability, isolate side effects

---

## Quiz: Functional Programming Basics

Test your understanding with these questions:

1. **Pure function:**
   - A) Always same output
   - B) Can have side effects
   - C) Modifies input
   - D) Uses global variables

2. **Immutability means:**
   - A) Can modify data
   - B) Create new data
   - C) Delete data
   - D) Nothing

3. **Side effects include:**
   - A) Return values
   - B) Console.log, DOM, network
   - C) Calculations
   - D) Nothing

4. **First-class functions:**
   - A) Can be values
   - B) Can be arguments
   - C) Can be returned
   - D) All of the above

5. **Higher-order function:**
   - A) Takes function as argument
   - B) Returns function
   - C) Both
   - D) Neither

6. **Pure function benefits:**
   - A) Testable
   - B) Predictable
   - C) Both
   - D) Neither

7. **Immutability helps:**
   - A) Debugging
   - B) Predictability
   - C) Both
   - D) Neither

**Answers**:
1. A) Always same output
2. B) Create new data
3. B) Console.log, DOM, network
4. D) All of the above
5. C) Both
6. C) Both
7. C) Both

---

## Next Steps

Congratulations! You''ve learned functional programming concepts. You now know:
- What pure functions are
- How to work with immutability
- How to identify side effects
- How to use first-class functions

**What''s Next?**
- Lesson 18.2: Array Methods for Functional Programming
- Learn map, filter, reduce
- Work with functional array methods
- Build functional data pipelines

---

## Additional Resources

- **MDN: Functional Programming**: [developer.mozilla.org/en-US/docs/Glossary/Functional_programming](https://developer.mozilla.org/en-US/docs/Glossary/Functional_programming)
- **JavaScript.info: Functional Programming**: [javascript.info/functional-programming](https://javascript.info/functional-programming)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:59:25', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand functional programming principles
- Write pure functions
- Work with immutability
- Identify and avoid side effects
- Understand first-class functions
- Apply functional programming concepts
- Write more predictable code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (156, 58, 14, 'Higher-Order Functions', 'higher-order-functions', '# Lesson 18.2: Array Methods for Functional Programming

## Learning Objectives

By the end of this lesson, you will be able to:
- Use map() to transform arrays
- Use filter() to select elements
- Use reduce() to accumulate values
- Use find() and findIndex() to search
- Use some() and every() to test conditions
- Chain array methods
- Build functional data pipelines
- Write more declarative code

---

## Introduction to Functional Array Methods

JavaScript provides powerful array methods that support functional programming. These methods are pure, immutable, and chainable.

### Why Functional Array Methods?

- **Declarative**: Say what you want, not how
- **Immutable**: Don''t modify original arrays
- **Chainable**: Can combine multiple operations
- **Readable**: Code is easier to understand
- **Testable**: Easier to test pure functions
- **Modern JavaScript**: Standard approach

---

## map()

### What is map()?

`map()` creates a new array by transforming each element.

### Basic Syntax

```javascript
let newArray = array.map(function(element, index, array) {
    // Return transformed element
    return transformedElement;
});
```

### Basic Examples

```javascript
// Double each number
let numbers = [1, 2, 3, 4, 5];
let doubled = numbers.map(x => x * 2);
console.log(doubled);  // [2, 4, 6, 8, 10]

// Convert to strings
let numbers = [1, 2, 3];
let strings = numbers.map(x => x.toString());
console.log(strings);  // [''1'', ''2'', ''3'']

// Extract property
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let names = users.map(user => user.name);
console.log(names);  // [''Alice'', ''Bob'']
```

### More map() Examples

```javascript
// Transform objects
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];

let formatted = users.map(user => ({
    name: user.name.toUpperCase(),
    age: user.age,
    isAdult: user.age >= 18
}));
console.log(formatted);
// [{ name: ''ALICE'', age: 30, isAdult: true }, ...]

// With index
let numbers = [10, 20, 30];
let indexed = numbers.map((x, i) => x + i);
console.log(indexed);  // [10, 21, 32]
```

---

## filter()

### What is filter()?

`filter()` creates a new array with elements that pass a test.

### Basic Syntax

```javascript
let newArray = array.filter(function(element, index, array) {
    // Return true to keep, false to remove
    return condition;
});
```

### Basic Examples

```javascript
// Filter even numbers
let numbers = [1, 2, 3, 4, 5, 6];
let evens = numbers.filter(x => x % 2 === 0);
console.log(evens);  // [2, 4, 6]

// Filter by property
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 },
    { name: ''Charlie'', age: 25 }
];
let adults = users.filter(user => user.age >= 18);
console.log(adults);  // [{ name: ''Alice'', age: 30 }, { name: ''Charlie'', age: 25 }]

// Filter by condition
let words = [''apple'', ''banana'', ''cherry'', ''date''];
let longWords = words.filter(word => word.length > 5);
console.log(longWords);  // [''banana'', ''cherry'']
```

### More filter() Examples

```javascript
// Filter truthy values
let values = [0, 1, '''', ''hello'', null, undefined, 42];
let truthy = values.filter(Boolean);
console.log(truthy);  // [1, ''hello'', 42]

// Filter unique values
let numbers = [1, 2, 2, 3, 3, 3, 4];
let unique = numbers.filter((value, index, self) => {
    return self.indexOf(value) === index;
});
console.log(unique);  // [1, 2, 3, 4]
```

---

## reduce()

### What is reduce()?

`reduce()` reduces an array to a single value by applying a function.

### Basic Syntax

```javascript
let result = array.reduce(function(accumulator, currentValue, index, array) {
    // Return new accumulator
    return newAccumulator;
}, initialValue);
```

### Basic Examples

```javascript
// Sum numbers
let numbers = [1, 2, 3, 4, 5];
let sum = numbers.reduce((acc, x) => acc + x, 0);
console.log(sum);  // 15

// Product
let numbers = [2, 3, 4];
let product = numbers.reduce((acc, x) => acc * x, 1);
console.log(product);  // 24

// Count occurrences
let words = [''apple'', ''banana'', ''apple'', ''cherry'', ''banana''];
let counts = words.reduce((acc, word) => {
    acc[word] = (acc[word] || 0) + 1;
    return acc;
}, {});
console.log(counts);  // { apple: 2, banana: 2, cherry: 1 }
```

### More reduce() Examples

```javascript
// Flatten array
let nested = [[1, 2], [3, 4], [5, 6]];
let flat = nested.reduce((acc, arr) => acc.concat(arr), []);
console.log(flat);  // [1, 2, 3, 4, 5, 6]

// Group by property
let users = [
    { name: ''Alice'', age: 30, city: ''NYC'' },
    { name: ''Bob'', age: 25, city: ''LA'' },
    { name: ''Charlie'', age: 30, city: ''NYC'' }
];
let grouped = users.reduce((acc, user) => {
    if (!acc[user.city]) {
        acc[user.city] = [];
    }
    acc[user.city].push(user);
    return acc;
}, {});
console.log(grouped);
// { NYC: [...], LA: [...] }

// Find max
let numbers = [5, 2, 8, 1, 9];
let max = numbers.reduce((acc, x) => x > acc ? x : acc, numbers[0]);
console.log(max);  // 9
```

---

## find() and findIndex()

### find()

`find()` returns the first element that passes a test.

```javascript
// Find first even number
let numbers = [1, 3, 4, 5, 6];
let firstEven = numbers.find(x => x % 2 === 0);
console.log(firstEven);  // 4

// Find user by name
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 },
    { name: ''Charlie'', age: 35 }
];
let user = users.find(u => u.name === ''Bob'');
console.log(user);  // { name: ''Bob'', age: 25 }

// Returns undefined if not found
let notFound = users.find(u => u.name === ''David'');
console.log(notFound);  // undefined
```

### findIndex()

`findIndex()` returns the index of the first element that passes a test.

```javascript
// Find index of first even number
let numbers = [1, 3, 4, 5, 6];
let index = numbers.findIndex(x => x % 2 === 0);
console.log(index);  // 2

// Find index of user
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let index = users.findIndex(u => u.name === ''Bob'');
console.log(index);  // 1

// Returns -1 if not found
let notFound = users.findIndex(u => u.name === ''David'');
console.log(notFound);  // -1
```

---

## some() and every()

### some()

`some()` returns true if at least one element passes a test.

```javascript
// Check if any number is even
let numbers = [1, 3, 5, 6, 7];
let hasEven = numbers.some(x => x % 2 === 0);
console.log(hasEven);  // true

// Check if any user is adult
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 }
];
let hasAdult = users.some(u => u.age >= 18);
console.log(hasAdult);  // true
```

### every()

`every()` returns true if all elements pass a test.

```javascript
// Check if all numbers are positive
let numbers = [1, 2, 3, 4, 5];
let allPositive = numbers.every(x => x > 0);
console.log(allPositive);  // true

// Check if all users are adults
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let allAdults = users.every(u => u.age >= 18);
console.log(allAdults);  // true

let mixed = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 }
];
let allAdults2 = mixed.every(u => u.age >= 18);
console.log(allAdults2);  // false
```

---

## Chaining Methods

### Method Chaining

You can chain array methods together:

```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

let result = numbers
    .filter(x => x % 2 === 0)  // [2, 4, 6, 8, 10]
    .map(x => x * 2)            // [4, 8, 12, 16, 20]
    .reduce((acc, x) => acc + x, 0);  // 60

console.log(result);  // 60
```

### Complex Chaining Example

```javascript
let users = [
    { name: ''Alice'', age: 30, score: 85 },
    { name: ''Bob'', age: 25, score: 92 },
    { name: ''Charlie'', age: 35, score: 78 },
    { name: ''David'', age: 20, score: 95 }
];

let result = users
    .filter(user => user.age >= 25)        // Adults only
    .map(user => ({                        // Transform
        name: user.name.toUpperCase(),
        score: user.score
    }))
    .filter(user => user.score >= 80)      // High scores
    .reduce((acc, user) => {               // Group by score range
        let range = user.score >= 90 ? ''A'' : ''B'';
        if (!acc[range]) acc[range] = [];
        acc[range].push(user);
        return acc;
    }, {});

console.log(result);
// { B: [{ name: ''ALICE'', score: 85 }] }
```

---

## Practical Examples

### Example 1: Data Processing Pipeline

```javascript
let products = [
    { name: ''Laptop'', price: 1000, category: ''Electronics'' },
    { name: ''Book'', price: 20, category: ''Education'' },
    { name: ''Phone'', price: 800, category: ''Electronics'' },
    { name: ''Pen'', price: 2, category: ''Education'' }
];

// Get expensive electronics
let expensiveElectronics = products
    .filter(p => p.category === ''Electronics'')
    .filter(p => p.price > 500)
    .map(p => ({
        name: p.name,
        price: p.price,
        discountedPrice: p.price * 0.9
    }));

console.log(expensiveElectronics);
```

### Example 2: Statistics

```javascript
let scores = [85, 92, 78, 95, 88, 90, 82];

// Calculate statistics
let stats = {
    count: scores.length,
    sum: scores.reduce((a, b) => a + b, 0),
    average: scores.reduce((a, b) => a + b, 0) / scores.length,
    max: scores.reduce((a, b) => Math.max(a, b)),
    min: scores.reduce((a, b) => Math.min(a, b)),
    passed: scores.filter(s => s >= 80).length
};

console.log(stats);
```

### Example 3: Data Transformation

```javascript
let orders = [
    { id: 1, items: [{ name: ''Apple'', price: 1 }, { name: ''Banana'', price: 0.5 }] },
    { id: 2, items: [{ name: ''Orange'', price: 1.5 }] },
    { id: 3, items: [{ name: ''Apple'', price: 1 }, { name: ''Orange'', price: 1.5 }] }
];

// Get all items with order info
let allItems = orders.flatMap(order =>
    order.items.map(item => ({
        orderId: order.id,
        ...item
    }))
);

// Calculate total per order
let orderTotals = orders.map(order => ({
    id: order.id,
    total: order.items.reduce((sum, item) => sum + item.price, 0)
}));

console.log(allItems);
console.log(orderTotals);
```

---

## Practice Exercise

### Exercise: Functional Array Methods

**Objective**: Practice using map, filter, reduce, find, findIndex, some, and every to process data.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Transforming arrays with map
   - Filtering arrays
   - Reducing arrays
   - Finding elements
   - Testing conditions
   - Chaining methods

**Example Solution**:

```javascript
// functional-array-methods-practice.js
console.log("=== Functional Array Methods Practice ===");

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let users = [
    { id: 1, name: ''Alice'', age: 30, score: 85, active: true },
    { id: 2, name: ''Bob'', age: 25, score: 92, active: true },
    { id: 3, name: ''Charlie'', age: 35, score: 78, active: false },
    { id: 4, name: ''David'', age: 20, score: 95, active: true },
    { id: 5, name: ''Eve'', age: 28, score: 88, active: true }
];

console.log("\\n=== map() ===");

// Double each number
let doubled = numbers.map(x => x * 2);
console.log(''Doubled:'', doubled);  // [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]

// Get user names
let names = users.map(user => user.name);
console.log(''Names:'', names);  // [''Alice'', ''Bob'', ''Charlie'', ''David'', ''Eve'']

// Transform users
let formatted = users.map(user => ({
    name: user.name.toUpperCase(),
    age: user.age,
    isAdult: user.age >= 18
}));
console.log(''Formatted users:'', formatted);

// With index
let indexed = numbers.map((x, i) => x + i);
console.log(''Indexed:'', indexed);
console.log();

console.log("=== filter() ===");

// Filter even numbers
let evens = numbers.filter(x => x % 2 === 0);
console.log(''Even numbers:'', evens);  // [2, 4, 6, 8, 10]

// Filter adults
let adults = users.filter(user => user.age >= 18);
console.log(''Adults:'', adults.length, ''users'');

// Filter active users
let activeUsers = users.filter(user => user.active);
console.log(''Active users:'', activeUsers.length, ''users'');

// Filter high scores
let highScores = users.filter(user => user.score >= 85);
console.log(''High scores:'', highScores.length, ''users'');

// Filter truthy values
let values = [0, 1, '''', ''hello'', null, undefined, 42, false];
let truthy = values.filter(Boolean);
console.log(''Truthy values:'', truthy);
console.log();

console.log("=== reduce() ===");

// Sum numbers
let sum = numbers.reduce((acc, x) => acc + x, 0);
console.log(''Sum:'', sum);  // 55

// Product
let product = numbers.slice(0, 5).reduce((acc, x) => acc * x, 1);
console.log(''Product of first 5:'', product);  // 120

// Count occurrences
let words = [''apple'', ''banana'', ''apple'', ''cherry'', ''banana'', ''apple''];
let counts = words.reduce((acc, word) => {
    acc[word] = (acc[word] || 0) + 1;
    return acc;
}, {});
console.log(''Word counts:'', counts);

// Group by age range
let grouped = users.reduce((acc, user) => {
    let range = user.age < 25 ? ''young'' : user.age < 30 ? ''adult'' : ''senior'';
    if (!acc[range]) acc[range] = [];
    acc[range].push(user);
    return acc;
}, {});
console.log(''Grouped by age:'', grouped);

// Find max score
let maxScore = users.reduce((max, user) => 
    user.score > max ? user.score : max, 0
);
console.log(''Max score:'', maxScore);

// Flatten array
let nested = [[1, 2], [3, 4], [5, 6]];
let flat = nested.reduce((acc, arr) => acc.concat(arr), []);
console.log(''Flattened:'', flat);
console.log();

console.log("=== find() and findIndex() ===");

// Find first even number
let firstEven = numbers.find(x => x % 2 === 0);
console.log(''First even:'', firstEven);  // 2

// Find user by name
let alice = users.find(user => user.name === ''Alice'');
console.log(''Found Alice:'', alice);

// Find user by score
let highScorer = users.find(user => user.score >= 90);
console.log(''High scorer:'', highScorer);

// Find index
let index = users.findIndex(user => user.name === ''Charlie'');
console.log(''Charlie index:'', index);  // 2

// Not found
let notFound = users.find(user => user.name === ''Frank'');
console.log(''Not found:'', notFound);  // undefined
console.log();

console.log("=== some() and every() ===");

// Check if any number is even
let hasEven = numbers.some(x => x % 2 === 0);
console.log(''Has even:'', hasEven);  // true

// Check if any user is inactive
let hasInactive = users.some(user => !user.active);
console.log(''Has inactive:'', hasInactive);  // true

// Check if all numbers are positive
let allPositive = numbers.every(x => x > 0);
console.log(''All positive:'', allPositive);  // true

// Check if all users are adults
let allAdults = users.every(user => user.age >= 18);
console.log(''All adults:'', allAdults);  // true

// Check if all users are active
let allActive = users.every(user => user.active);
console.log(''All active:'', allActive);  // false
console.log();

console.log("=== Method Chaining ===");

// Chain: filter -> map -> reduce
let result = numbers
    .filter(x => x % 2 === 0)      // [2, 4, 6, 8, 10]
    .map(x => x * 2)                // [4, 8, 12, 16, 20]
    .reduce((acc, x) => acc + x, 0); // 60
console.log(''Chained result:'', result);  // 60

// Complex chain
let complexResult = users
    .filter(user => user.active)           // Active users
    .filter(user => user.age >= 25)        // Age >= 25
    .map(user => ({                        // Transform
        name: user.name.toUpperCase(),
        score: user.score
    }))
    .filter(user => user.score >= 85)      // High scores
    .reduce((acc, user) => {               // Group by score
        let grade = user.score >= 90 ? ''A'' : ''B'';
        if (!acc[grade]) acc[grade] = [];
        acc[grade].push(user);
        return acc;
    }, {});
console.log(''Complex chain result:'', complexResult);

// Calculate average score of active adults
let avgScore = users
    .filter(user => user.active)
    .filter(user => user.age >= 25)
    .map(user => user.score)
    .reduce((acc, score, index, array) => {
        acc += score;
        if (index === array.length - 1) {
            return acc / array.length;
        }
        return acc;
    }, 0);
console.log(''Average score:'', avgScore.toFixed(2));
console.log();

console.log("=== Practical Examples ===");

// Example 1: Data Processing Pipeline
let products = [
    { name: ''Laptop'', price: 1000, category: ''Electronics'', inStock: true },
    { name: ''Book'', price: 20, category: ''Education'', inStock: true },
    { name: ''Phone'', price: 800, category: ''Electronics'', inStock: false },
    { name: ''Pen'', price: 2, category: ''Education'', inStock: true }
];

let expensiveElectronics = products
    .filter(p => p.category === ''Electronics'')
    .filter(p => p.price > 500)
    .filter(p => p.inStock)
    .map(p => ({
        name: p.name,
        price: p.price,
        discountedPrice: p.price * 0.9
    }));
console.log(''Expensive electronics:'', expensiveElectronics);

// Example 2: Statistics
let scores = users.map(u => u.score);
let stats = {
    count: scores.length,
    sum: scores.reduce((a, b) => a + b, 0),
    average: scores.reduce((a, b) => a + b, 0) / scores.length,
    max: scores.reduce((a, b) => Math.max(a, b)),
    min: scores.reduce((a, b) => Math.min(a, b)),
    passed: scores.filter(s => s >= 80).length
};
console.log(''Score statistics:'', stats);

// Example 3: Data Transformation
let orders = [
    { id: 1, items: [{ name: ''Apple'', price: 1 }, { name: ''Banana'', price: 0.5 }] },
    { id: 2, items: [{ name: ''Orange'', price: 1.5 }] },
    { id: 3, items: [{ name: ''Apple'', price: 1 }, { name: ''Orange'', price: 1.5 }] }
];

let allItems = orders.flatMap(order =>
    order.items.map(item => ({
        orderId: order.id,
        ...item
    }))
);
console.log(''All items:'', allItems);

let orderTotals = orders.map(order => ({
    id: order.id,
    total: order.items.reduce((sum, item) => sum + item.price, 0)
}));
console.log(''Order totals:'', orderTotals);
```

**Expected Output**:
```
=== Functional Array Methods Practice ===

=== map() ===
Doubled: [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
Names: [''Alice'', ''Bob'', ''Charlie'', ''David'', ''Eve'']
Formatted users: [array]
Indexed: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19]

=== filter() ===
Even numbers: [2, 4, 6, 8, 10]
Adults: 5 users
Active users: 4 users
High scores: 4 users
Truthy values: [1, ''hello'', 42]

=== reduce() ===
Sum: 55
Product of first 5: 120
Word counts: { apple: 3, banana: 2, cherry: 1 }
Grouped by age: { object }
Max score: 95
Flattened: [1, 2, 3, 4, 5, 6]

=== find() and findIndex() ===
First even: 2
Found Alice: { id: 1, name: ''Alice'', ... }
High scorer: { id: 2, name: ''Bob'', ... }
Charlie index: 2
Not found: undefined

=== some() and every() ===
Has even: true
Has inactive: true
All positive: true
All adults: true
All active: false

=== Method Chaining ===
Chained result: 60
Complex chain result: { object }
Average score: [value]

=== Practical Examples ===
Expensive electronics: [array]
Score statistics: { object }
All items: [array]
Order totals: [array]
```

**Challenge (Optional)**:
- Build a complete data processing pipeline
- Create reusable transformation functions
- Build a query builder
- Practice complex method chaining

---

## Common Mistakes

### 1. Forgetting Return in map()

```javascript
// ⚠️ Problem: Returns undefined
let doubled = numbers.map(x => {
    x * 2;  // Missing return
});

// ✅ Solution: Return value
let doubled = numbers.map(x => x * 2);
```

### 2. Modifying Original Array

```javascript
// ⚠️ Problem: Modifies original
let filtered = numbers.filter(x => {
    numbers.push(x * 2);  // Modifies original
    return x > 5;
});

// ✅ Solution: Don''t modify in callbacks
let filtered = numbers.filter(x => x > 5);
```

### 3. Not Providing Initial Value in reduce()

```javascript
// ⚠️ Problem: Might fail with empty array
let sum = numbers.reduce((acc, x) => acc + x);

// ✅ Solution: Provide initial value
let sum = numbers.reduce((acc, x) => acc + x, 0);
```

---

## Key Takeaways

1. **map()**: Transform each element
2. **filter()**: Select elements that pass test
3. **reduce()**: Accumulate to single value
4. **find()**: Find first matching element
5. **findIndex()**: Find index of first match
6. **some()**: Test if any element passes
7. **every()**: Test if all elements pass
8. **Chaining**: Combine methods for powerful pipelines

---

## Quiz: Functional Array Methods

Test your understanding with these questions:

1. **map() returns:**
   - A) Modified original array
   - B) New array
   - C) Single value
   - D) Nothing

2. **filter() keeps elements where:**
   - A) Condition is false
   - B) Condition is true
   - C) Always
   - D) Never

3. **reduce() needs:**
   - A) Accumulator
   - B) Current value
   - C) Initial value (optional)
   - D) All of the above

4. **find() returns:**
   - A) First match
   - B) All matches
   - C) Index
   - D) Nothing

5. **some() returns:**
   - A) true if any pass
   - B) true if all pass
   - C) false always
   - D) undefined

6. **every() returns:**
   - A) true if any pass
   - B) true if all pass
   - C) false always
   - D) undefined

7. **Methods can be:**
   - A) Chained
   - B) Used separately
   - C) Both
   - D) Neither

**Answers**:
1. B) New array
2. B) Condition is true
3. D) All of the above
4. A) First match
5. A) true if any pass
6. B) true if all pass
7. C) Both

---

## Next Steps

Congratulations! You''ve learned functional array methods. You now know:
- How to transform arrays with map
- How to filter arrays
- How to reduce arrays
- How to find elements
- How to test conditions
- How to chain methods

**What''s Next?**
- Lesson 18.3: Advanced Functional Patterns
- Learn function composition
- Understand currying
- Work with memoization
- Build higher-order functions

---

## Additional Resources

- **MDN: Array Methods**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)
- **JavaScript.info: Array Methods**: [javascript.info/array-methods](https://javascript.info/array-methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:59:25', '2026-01-03 09:59:25', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use map() to transform arrays
- Use filter() to select elements
- Use reduce() to accumulate values
- Use find() and findIndex() to search
- Use some() and every() to test conditions
- Chain array methods
- Build functional data pipelines
- Write more declarative code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (160, 58, 14, 'Array Methods for Functional Programming', 'array-methods-for-functional-programming', '# Lesson 18.2: Array Methods for Functional Programming

## Learning Objectives

By the end of this lesson, you will be able to:
- Use map() to transform arrays
- Use filter() to select elements
- Use reduce() to accumulate values
- Use find() and findIndex() to search
- Use some() and every() to test conditions
- Chain array methods
- Build functional data pipelines
- Write more declarative code

---

## Introduction to Functional Array Methods

JavaScript provides powerful array methods that support functional programming. These methods are pure, immutable, and chainable.

### Why Functional Array Methods?

- **Declarative**: Say what you want, not how
- **Immutable**: Don''t modify original arrays
- **Chainable**: Can combine multiple operations
- **Readable**: Code is easier to understand
- **Testable**: Easier to test pure functions
- **Modern JavaScript**: Standard approach

---

## map()

### What is map()?

`map()` creates a new array by transforming each element.

### Basic Syntax

```javascript
let newArray = array.map(function(element, index, array) {
    // Return transformed element
    return transformedElement;
});
```

### Basic Examples

```javascript
// Double each number
let numbers = [1, 2, 3, 4, 5];
let doubled = numbers.map(x => x * 2);
console.log(doubled);  // [2, 4, 6, 8, 10]

// Convert to strings
let numbers = [1, 2, 3];
let strings = numbers.map(x => x.toString());
console.log(strings);  // [''1'', ''2'', ''3'']

// Extract property
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let names = users.map(user => user.name);
console.log(names);  // [''Alice'', ''Bob'']
```

### More map() Examples

```javascript
// Transform objects
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];

let formatted = users.map(user => ({
    name: user.name.toUpperCase(),
    age: user.age,
    isAdult: user.age >= 18
}));
console.log(formatted);
// [{ name: ''ALICE'', age: 30, isAdult: true }, ...]

// With index
let numbers = [10, 20, 30];
let indexed = numbers.map((x, i) => x + i);
console.log(indexed);  // [10, 21, 32]
```

---

## filter()

### What is filter()?

`filter()` creates a new array with elements that pass a test.

### Basic Syntax

```javascript
let newArray = array.filter(function(element, index, array) {
    // Return true to keep, false to remove
    return condition;
});
```

### Basic Examples

```javascript
// Filter even numbers
let numbers = [1, 2, 3, 4, 5, 6];
let evens = numbers.filter(x => x % 2 === 0);
console.log(evens);  // [2, 4, 6]

// Filter by property
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 },
    { name: ''Charlie'', age: 25 }
];
let adults = users.filter(user => user.age >= 18);
console.log(adults);  // [{ name: ''Alice'', age: 30 }, { name: ''Charlie'', age: 25 }]

// Filter by condition
let words = [''apple'', ''banana'', ''cherry'', ''date''];
let longWords = words.filter(word => word.length > 5);
console.log(longWords);  // [''banana'', ''cherry'']
```

### More filter() Examples

```javascript
// Filter truthy values
let values = [0, 1, '''', ''hello'', null, undefined, 42];
let truthy = values.filter(Boolean);
console.log(truthy);  // [1, ''hello'', 42]

// Filter unique values
let numbers = [1, 2, 2, 3, 3, 3, 4];
let unique = numbers.filter((value, index, self) => {
    return self.indexOf(value) === index;
});
console.log(unique);  // [1, 2, 3, 4]
```

---

## reduce()

### What is reduce()?

`reduce()` reduces an array to a single value by applying a function.

### Basic Syntax

```javascript
let result = array.reduce(function(accumulator, currentValue, index, array) {
    // Return new accumulator
    return newAccumulator;
}, initialValue);
```

### Basic Examples

```javascript
// Sum numbers
let numbers = [1, 2, 3, 4, 5];
let sum = numbers.reduce((acc, x) => acc + x, 0);
console.log(sum);  // 15

// Product
let numbers = [2, 3, 4];
let product = numbers.reduce((acc, x) => acc * x, 1);
console.log(product);  // 24

// Count occurrences
let words = [''apple'', ''banana'', ''apple'', ''cherry'', ''banana''];
let counts = words.reduce((acc, word) => {
    acc[word] = (acc[word] || 0) + 1;
    return acc;
}, {});
console.log(counts);  // { apple: 2, banana: 2, cherry: 1 }
```

### More reduce() Examples

```javascript
// Flatten array
let nested = [[1, 2], [3, 4], [5, 6]];
let flat = nested.reduce((acc, arr) => acc.concat(arr), []);
console.log(flat);  // [1, 2, 3, 4, 5, 6]

// Group by property
let users = [
    { name: ''Alice'', age: 30, city: ''NYC'' },
    { name: ''Bob'', age: 25, city: ''LA'' },
    { name: ''Charlie'', age: 30, city: ''NYC'' }
];
let grouped = users.reduce((acc, user) => {
    if (!acc[user.city]) {
        acc[user.city] = [];
    }
    acc[user.city].push(user);
    return acc;
}, {});
console.log(grouped);
// { NYC: [...], LA: [...] }

// Find max
let numbers = [5, 2, 8, 1, 9];
let max = numbers.reduce((acc, x) => x > acc ? x : acc, numbers[0]);
console.log(max);  // 9
```

---

## find() and findIndex()

### find()

`find()` returns the first element that passes a test.

```javascript
// Find first even number
let numbers = [1, 3, 4, 5, 6];
let firstEven = numbers.find(x => x % 2 === 0);
console.log(firstEven);  // 4

// Find user by name
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 },
    { name: ''Charlie'', age: 35 }
];
let user = users.find(u => u.name === ''Bob'');
console.log(user);  // { name: ''Bob'', age: 25 }

// Returns undefined if not found
let notFound = users.find(u => u.name === ''David'');
console.log(notFound);  // undefined
```

### findIndex()

`findIndex()` returns the index of the first element that passes a test.

```javascript
// Find index of first even number
let numbers = [1, 3, 4, 5, 6];
let index = numbers.findIndex(x => x % 2 === 0);
console.log(index);  // 2

// Find index of user
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let index = users.findIndex(u => u.name === ''Bob'');
console.log(index);  // 1

// Returns -1 if not found
let notFound = users.findIndex(u => u.name === ''David'');
console.log(notFound);  // -1
```

---

## some() and every()

### some()

`some()` returns true if at least one element passes a test.

```javascript
// Check if any number is even
let numbers = [1, 3, 5, 6, 7];
let hasEven = numbers.some(x => x % 2 === 0);
console.log(hasEven);  // true

// Check if any user is adult
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 }
];
let hasAdult = users.some(u => u.age >= 18);
console.log(hasAdult);  // true
```

### every()

`every()` returns true if all elements pass a test.

```javascript
// Check if all numbers are positive
let numbers = [1, 2, 3, 4, 5];
let allPositive = numbers.every(x => x > 0);
console.log(allPositive);  // true

// Check if all users are adults
let users = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 25 }
];
let allAdults = users.every(u => u.age >= 18);
console.log(allAdults);  // true

let mixed = [
    { name: ''Alice'', age: 30 },
    { name: ''Bob'', age: 15 }
];
let allAdults2 = mixed.every(u => u.age >= 18);
console.log(allAdults2);  // false
```

---

## Chaining Methods

### Method Chaining

You can chain array methods together:

```javascript
let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

let result = numbers
    .filter(x => x % 2 === 0)  // [2, 4, 6, 8, 10]
    .map(x => x * 2)            // [4, 8, 12, 16, 20]
    .reduce((acc, x) => acc + x, 0);  // 60

console.log(result);  // 60
```

### Complex Chaining Example

```javascript
let users = [
    { name: ''Alice'', age: 30, score: 85 },
    { name: ''Bob'', age: 25, score: 92 },
    { name: ''Charlie'', age: 35, score: 78 },
    { name: ''David'', age: 20, score: 95 }
];

let result = users
    .filter(user => user.age >= 25)        // Adults only
    .map(user => ({                        // Transform
        name: user.name.toUpperCase(),
        score: user.score
    }))
    .filter(user => user.score >= 80)      // High scores
    .reduce((acc, user) => {               // Group by score range
        let range = user.score >= 90 ? ''A'' : ''B'';
        if (!acc[range]) acc[range] = [];
        acc[range].push(user);
        return acc;
    }, {});

console.log(result);
// { B: [{ name: ''ALICE'', score: 85 }] }
```

---

## Practical Examples

### Example 1: Data Processing Pipeline

```javascript
let products = [
    { name: ''Laptop'', price: 1000, category: ''Electronics'' },
    { name: ''Book'', price: 20, category: ''Education'' },
    { name: ''Phone'', price: 800, category: ''Electronics'' },
    { name: ''Pen'', price: 2, category: ''Education'' }
];

// Get expensive electronics
let expensiveElectronics = products
    .filter(p => p.category === ''Electronics'')
    .filter(p => p.price > 500)
    .map(p => ({
        name: p.name,
        price: p.price,
        discountedPrice: p.price * 0.9
    }));

console.log(expensiveElectronics);
```

### Example 2: Statistics

```javascript
let scores = [85, 92, 78, 95, 88, 90, 82];

// Calculate statistics
let stats = {
    count: scores.length,
    sum: scores.reduce((a, b) => a + b, 0),
    average: scores.reduce((a, b) => a + b, 0) / scores.length,
    max: scores.reduce((a, b) => Math.max(a, b)),
    min: scores.reduce((a, b) => Math.min(a, b)),
    passed: scores.filter(s => s >= 80).length
};

console.log(stats);
```

### Example 3: Data Transformation

```javascript
let orders = [
    { id: 1, items: [{ name: ''Apple'', price: 1 }, { name: ''Banana'', price: 0.5 }] },
    { id: 2, items: [{ name: ''Orange'', price: 1.5 }] },
    { id: 3, items: [{ name: ''Apple'', price: 1 }, { name: ''Orange'', price: 1.5 }] }
];

// Get all items with order info
let allItems = orders.flatMap(order =>
    order.items.map(item => ({
        orderId: order.id,
        ...item
    }))
);

// Calculate total per order
let orderTotals = orders.map(order => ({
    id: order.id,
    total: order.items.reduce((sum, item) => sum + item.price, 0)
}));

console.log(allItems);
console.log(orderTotals);
```

---

## Practice Exercise

### Exercise: Functional Array Methods

**Objective**: Practice using map, filter, reduce, find, findIndex, some, and every to process data.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Transforming arrays with map
   - Filtering arrays
   - Reducing arrays
   - Finding elements
   - Testing conditions
   - Chaining methods

**Example Solution**:

```javascript
// functional-array-methods-practice.js
console.log("=== Functional Array Methods Practice ===");

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
let users = [
    { id: 1, name: ''Alice'', age: 30, score: 85, active: true },
    { id: 2, name: ''Bob'', age: 25, score: 92, active: true },
    { id: 3, name: ''Charlie'', age: 35, score: 78, active: false },
    { id: 4, name: ''David'', age: 20, score: 95, active: true },
    { id: 5, name: ''Eve'', age: 28, score: 88, active: true }
];

console.log("\\n=== map() ===");

// Double each number
let doubled = numbers.map(x => x * 2);
console.log(''Doubled:'', doubled);  // [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]

// Get user names
let names = users.map(user => user.name);
console.log(''Names:'', names);  // [''Alice'', ''Bob'', ''Charlie'', ''David'', ''Eve'']

// Transform users
let formatted = users.map(user => ({
    name: user.name.toUpperCase(),
    age: user.age,
    isAdult: user.age >= 18
}));
console.log(''Formatted users:'', formatted);

// With index
let indexed = numbers.map((x, i) => x + i);
console.log(''Indexed:'', indexed);
console.log();

console.log("=== filter() ===");

// Filter even numbers
let evens = numbers.filter(x => x % 2 === 0);
console.log(''Even numbers:'', evens);  // [2, 4, 6, 8, 10]

// Filter adults
let adults = users.filter(user => user.age >= 18);
console.log(''Adults:'', adults.length, ''users'');

// Filter active users
let activeUsers = users.filter(user => user.active);
console.log(''Active users:'', activeUsers.length, ''users'');

// Filter high scores
let highScores = users.filter(user => user.score >= 85);
console.log(''High scores:'', highScores.length, ''users'');

// Filter truthy values
let values = [0, 1, '''', ''hello'', null, undefined, 42, false];
let truthy = values.filter(Boolean);
console.log(''Truthy values:'', truthy);
console.log();

console.log("=== reduce() ===");

// Sum numbers
let sum = numbers.reduce((acc, x) => acc + x, 0);
console.log(''Sum:'', sum);  // 55

// Product
let product = numbers.slice(0, 5).reduce((acc, x) => acc * x, 1);
console.log(''Product of first 5:'', product);  // 120

// Count occurrences
let words = [''apple'', ''banana'', ''apple'', ''cherry'', ''banana'', ''apple''];
let counts = words.reduce((acc, word) => {
    acc[word] = (acc[word] || 0) + 1;
    return acc;
}, {});
console.log(''Word counts:'', counts);

// Group by age range
let grouped = users.reduce((acc, user) => {
    let range = user.age < 25 ? ''young'' : user.age < 30 ? ''adult'' : ''senior'';
    if (!acc[range]) acc[range] = [];
    acc[range].push(user);
    return acc;
}, {});
console.log(''Grouped by age:'', grouped);

// Find max score
let maxScore = users.reduce((max, user) => 
    user.score > max ? user.score : max, 0
);
console.log(''Max score:'', maxScore);

// Flatten array
let nested = [[1, 2], [3, 4], [5, 6]];
let flat = nested.reduce((acc, arr) => acc.concat(arr), []);
console.log(''Flattened:'', flat);
console.log();

console.log("=== find() and findIndex() ===");

// Find first even number
let firstEven = numbers.find(x => x % 2 === 0);
console.log(''First even:'', firstEven);  // 2

// Find user by name
let alice = users.find(user => user.name === ''Alice'');
console.log(''Found Alice:'', alice);

// Find user by score
let highScorer = users.find(user => user.score >= 90);
console.log(''High scorer:'', highScorer);

// Find index
let index = users.findIndex(user => user.name === ''Charlie'');
console.log(''Charlie index:'', index);  // 2

// Not found
let notFound = users.find(user => user.name === ''Frank'');
console.log(''Not found:'', notFound);  // undefined
console.log();

console.log("=== some() and every() ===");

// Check if any number is even
let hasEven = numbers.some(x => x % 2 === 0);
console.log(''Has even:'', hasEven);  // true

// Check if any user is inactive
let hasInactive = users.some(user => !user.active);
console.log(''Has inactive:'', hasInactive);  // true

// Check if all numbers are positive
let allPositive = numbers.every(x => x > 0);
console.log(''All positive:'', allPositive);  // true

// Check if all users are adults
let allAdults = users.every(user => user.age >= 18);
console.log(''All adults:'', allAdults);  // true

// Check if all users are active
let allActive = users.every(user => user.active);
console.log(''All active:'', allActive);  // false
console.log();

console.log("=== Method Chaining ===");

// Chain: filter -> map -> reduce
let result = numbers
    .filter(x => x % 2 === 0)      // [2, 4, 6, 8, 10]
    .map(x => x * 2)                // [4, 8, 12, 16, 20]
    .reduce((acc, x) => acc + x, 0); // 60
console.log(''Chained result:'', result);  // 60

// Complex chain
let complexResult = users
    .filter(user => user.active)           // Active users
    .filter(user => user.age >= 25)        // Age >= 25
    .map(user => ({                        // Transform
        name: user.name.toUpperCase(),
        score: user.score
    }))
    .filter(user => user.score >= 85)      // High scores
    .reduce((acc, user) => {               // Group by score
        let grade = user.score >= 90 ? ''A'' : ''B'';
        if (!acc[grade]) acc[grade] = [];
        acc[grade].push(user);
        return acc;
    }, {});
console.log(''Complex chain result:'', complexResult);

// Calculate average score of active adults
let avgScore = users
    .filter(user => user.active)
    .filter(user => user.age >= 25)
    .map(user => user.score)
    .reduce((acc, score, index, array) => {
        acc += score;
        if (index === array.length - 1) {
            return acc / array.length;
        }
        return acc;
    }, 0);
console.log(''Average score:'', avgScore.toFixed(2));
console.log();

console.log("=== Practical Examples ===");

// Example 1: Data Processing Pipeline
let products = [
    { name: ''Laptop'', price: 1000, category: ''Electronics'', inStock: true },
    { name: ''Book'', price: 20, category: ''Education'', inStock: true },
    { name: ''Phone'', price: 800, category: ''Electronics'', inStock: false },
    { name: ''Pen'', price: 2, category: ''Education'', inStock: true }
];

let expensiveElectronics = products
    .filter(p => p.category === ''Electronics'')
    .filter(p => p.price > 500)
    .filter(p => p.inStock)
    .map(p => ({
        name: p.name,
        price: p.price,
        discountedPrice: p.price * 0.9
    }));
console.log(''Expensive electronics:'', expensiveElectronics);

// Example 2: Statistics
let scores = users.map(u => u.score);
let stats = {
    count: scores.length,
    sum: scores.reduce((a, b) => a + b, 0),
    average: scores.reduce((a, b) => a + b, 0) / scores.length,
    max: scores.reduce((a, b) => Math.max(a, b)),
    min: scores.reduce((a, b) => Math.min(a, b)),
    passed: scores.filter(s => s >= 80).length
};
console.log(''Score statistics:'', stats);

// Example 3: Data Transformation
let orders = [
    { id: 1, items: [{ name: ''Apple'', price: 1 }, { name: ''Banana'', price: 0.5 }] },
    { id: 2, items: [{ name: ''Orange'', price: 1.5 }] },
    { id: 3, items: [{ name: ''Apple'', price: 1 }, { name: ''Orange'', price: 1.5 }] }
];

let allItems = orders.flatMap(order =>
    order.items.map(item => ({
        orderId: order.id,
        ...item
    }))
);
console.log(''All items:'', allItems);

let orderTotals = orders.map(order => ({
    id: order.id,
    total: order.items.reduce((sum, item) => sum + item.price, 0)
}));
console.log(''Order totals:'', orderTotals);
```

**Expected Output**:
```
=== Functional Array Methods Practice ===

=== map() ===
Doubled: [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]
Names: [''Alice'', ''Bob'', ''Charlie'', ''David'', ''Eve'']
Formatted users: [array]
Indexed: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19]

=== filter() ===
Even numbers: [2, 4, 6, 8, 10]
Adults: 5 users
Active users: 4 users
High scores: 4 users
Truthy values: [1, ''hello'', 42]

=== reduce() ===
Sum: 55
Product of first 5: 120
Word counts: { apple: 3, banana: 2, cherry: 1 }
Grouped by age: { object }
Max score: 95
Flattened: [1, 2, 3, 4, 5, 6]

=== find() and findIndex() ===
First even: 2
Found Alice: { id: 1, name: ''Alice'', ... }
High scorer: { id: 2, name: ''Bob'', ... }
Charlie index: 2
Not found: undefined

=== some() and every() ===
Has even: true
Has inactive: true
All positive: true
All adults: true
All active: false

=== Method Chaining ===
Chained result: 60
Complex chain result: { object }
Average score: [value]

=== Practical Examples ===
Expensive electronics: [array]
Score statistics: { object }
All items: [array]
Order totals: [array]
```

**Challenge (Optional)**:
- Build a complete data processing pipeline
- Create reusable transformation functions
- Build a query builder
- Practice complex method chaining

---

## Common Mistakes

### 1. Forgetting Return in map()

```javascript
// ⚠️ Problem: Returns undefined
let doubled = numbers.map(x => {
    x * 2;  // Missing return
});

// ✅ Solution: Return value
let doubled = numbers.map(x => x * 2);
```

### 2. Modifying Original Array

```javascript
// ⚠️ Problem: Modifies original
let filtered = numbers.filter(x => {
    numbers.push(x * 2);  // Modifies original
    return x > 5;
});

// ✅ Solution: Don''t modify in callbacks
let filtered = numbers.filter(x => x > 5);
```

### 3. Not Providing Initial Value in reduce()

```javascript
// ⚠️ Problem: Might fail with empty array
let sum = numbers.reduce((acc, x) => acc + x);

// ✅ Solution: Provide initial value
let sum = numbers.reduce((acc, x) => acc + x, 0);
```

---

## Key Takeaways

1. **map()**: Transform each element
2. **filter()**: Select elements that pass test
3. **reduce()**: Accumulate to single value
4. **find()**: Find first matching element
5. **findIndex()**: Find index of first match
6. **some()**: Test if any element passes
7. **every()**: Test if all elements pass
8. **Chaining**: Combine methods for powerful pipelines

---

## Quiz: Functional Array Methods

Test your understanding with these questions:

1. **map() returns:**
   - A) Modified original array
   - B) New array
   - C) Single value
   - D) Nothing

2. **filter() keeps elements where:**
   - A) Condition is false
   - B) Condition is true
   - C) Always
   - D) Never

3. **reduce() needs:**
   - A) Accumulator
   - B) Current value
   - C) Initial value (optional)
   - D) All of the above

4. **find() returns:**
   - A) First match
   - B) All matches
   - C) Index
   - D) Nothing

5. **some() returns:**
   - A) true if any pass
   - B) true if all pass
   - C) false always
   - D) undefined

6. **every() returns:**
   - A) true if any pass
   - B) true if all pass
   - C) false always
   - D) undefined

7. **Methods can be:**
   - A) Chained
   - B) Used separately
   - C) Both
   - D) Neither

**Answers**:
1. B) New array
2. B) Condition is true
3. D) All of the above
4. A) First match
5. A) true if any pass
6. B) true if all pass
7. C) Both

---

## Next Steps

Congratulations! You''ve learned functional array methods. You now know:
- How to transform arrays with map
- How to filter arrays
- How to reduce arrays
- How to find elements
- How to test conditions
- How to chain methods

**What''s Next?**
- Lesson 18.3: Advanced Functional Patterns
- Learn function composition
- Understand currying
- Work with memoization
- Build higher-order functions

---

## Additional Resources

- **MDN: Array Methods**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)
- **JavaScript.info: Array Methods**: [javascript.info/array-methods](https://javascript.info/array-methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:59:58', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use map() to transform arrays
- Use filter() to select elements
- Use reduce() to accumulate values
- Use find() and findIndex() to search
- Use some() and every() to test conditions
- Chain array methods
- Build functional data pipelines
- Write more declarative code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (161, 58, 14, 'Advanced Functional Patterns', 'advanced-functional-patterns', '# Lesson 18.3: Advanced Functional Patterns

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand function composition
- Implement currying
- Use memoization for performance
- Build higher-order functions
- Combine functional patterns
- Write more reusable code
- Optimize function performance

---

## Introduction to Advanced Functional Patterns

Advanced functional patterns help you write more elegant, reusable, and performant code.

### Why Advanced Patterns?

- **Reusability**: Write functions that work in many contexts
- **Composability**: Combine small functions into larger ones
- **Performance**: Optimize with memoization
- **Readability**: More declarative code
- **Maintainability**: Easier to modify and extend
- **Modern JavaScript**: Common in modern codebases

---

## Function Composition

### What is Function Composition?

Function composition combines multiple functions into a single function.

### Basic Composition

```javascript
// Compose functions: f(g(x))
function compose(f, g) {
    return function(x) {
        return f(g(x));
    };
}

// Example
let addOne = x => x + 1;
let double = x => x * 2;

let addOneThenDouble = compose(double, addOne);
console.log(addOneThenDouble(5));  // (5 + 1) * 2 = 12
```

### Multiple Functions

```javascript
// Compose multiple functions
function compose(...fns) {
    return function(value) {
        return fns.reduceRight((acc, fn) => fn(acc), value);
    };
}

// Example
let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = compose(square, double, addOne);
console.log(transform(5));  // ((5 + 1) * 2) ^ 2 = 144
```

### Pipe (Left to Right)

```javascript
// Pipe: Apply functions left to right
function pipe(...fns) {
    return function(value) {
        return fns.reduce((acc, fn) => fn(acc), value);
    };
}

// Example
let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = pipe(addOne, double, square);
console.log(transform(5));  // ((5 + 1) * 2) ^ 2 = 144
```

### Practical Composition Example

```javascript
// Helper functions
let trim = str => str.trim();
let toLowerCase = str => str.toLowerCase();
let capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);

// Compose
let normalizeName = pipe(trim, toLowerCase, capitalize);

console.log(normalizeName(''  ALICE  ''));  // ''Alice''
```

---

## Currying

### What is Currying?

Currying transforms a function with multiple arguments into a sequence of functions, each taking one argument.

### Basic Currying

```javascript
// Regular function
function add(a, b) {
    return a + b;
}

// Curried function
function addCurried(a) {
    return function(b) {
        return a + b;
    };
}

// Usage
let add5 = addCurried(5);
console.log(add5(3));  // 8
```

### Arrow Function Currying

```javascript
// Curried with arrow functions
let add = a => b => a + b;

// Usage
let add5 = add(5);
console.log(add5(3));  // 8

// Or call directly
console.log(add(5)(3));  // 8
```

### Multiple Arguments

```javascript
// Curry function with multiple arguments
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        } else {
            return function(...nextArgs) {
                return curried.apply(this, args.concat(nextArgs));
            };
        }
    };
}

// Example
function multiply(a, b, c) {
    return a * b * c;
}

let curriedMultiply = curry(multiply);

console.log(curriedMultiply(2)(3)(4));     // 24
console.log(curriedMultiply(2, 3)(4));     // 24
console.log(curriedMultiply(2)(3, 4));     // 24
console.log(curriedMultiply(2, 3, 4));     // 24
```

### Practical Currying Example

```javascript
// Curried filter
let filter = predicate => array => array.filter(predicate);

let isEven = x => x % 2 === 0;
let filterEven = filter(isEven);

let numbers = [1, 2, 3, 4, 5, 6];
console.log(filterEven(numbers));  // [2, 4, 6]

// Curried map
let map = fn => array => array.map(fn);

let double = x => x * 2;
let mapDouble = map(double);

console.log(mapDouble(numbers));  // [2, 4, 6, 8, 10, 12]
```

---

## Memoization

### What is Memoization?

Memoization caches function results to avoid recomputation.

### Basic Memoization

```javascript
// Simple memoization
function memoize(fn) {
    let cache = {};
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache[key]) {
            return cache[key];
        }
        let result = fn.apply(this, args);
        cache[key] = result;
        return result;
    };
}

// Example: Fibonacci
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}

let memoizedFibonacci = memoize(fibonacci);
console.log(memoizedFibonacci(40));  // Fast!
```

### Memoization with Map

```javascript
// Memoization with Map (better for object keys)
function memoize(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache.has(key)) {
            return cache.get(key);
        }
        let result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}
```

### Memoization Example

```javascript
// Expensive calculation
function expensiveOperation(n) {
    console.log(''Calculating...'', n);
    // Simulate expensive operation
    let result = 0;
    for (let i = 0; i < n * 1000000; i++) {
        result += i;
    }
    return result;
}

let memoized = memoize(expensiveOperation);

console.log(memoized(10));  // Calculates
console.log(memoized(10));  // Uses cache (fast!)
```

---

## Higher-Order Functions

### What are Higher-Order Functions?

Higher-order functions are functions that operate on other functions.

### Function that Takes Function

```javascript
// Higher-order function: takes function as argument
function withLogging(fn) {
    return function(...args) {
        console.log(''Calling function with:'', args);
        let result = fn.apply(this, args);
        console.log(''Result:'', result);
        return result;
    };
}

// Usage
let add = (a, b) => a + b;
let loggedAdd = withLogging(add);

loggedAdd(2, 3);
// Calling function with: [2, 3]
// Result: 5
```

### Function that Returns Function

```javascript
// Higher-order function: returns function
function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);

console.log(double(5));   // 10
console.log(triple(5));   // 15
```

### Advanced Higher-Order Functions

```javascript
// Retry function
function retry(fn, times = 3) {
    return async function(...args) {
        for (let i = 0; i < times; i++) {
            try {
                return await fn.apply(this, args);
            } catch (error) {
                if (i === times - 1) throw error;
                console.log(`Retry ${i + 1}/${times}`);
            }
        }
    };
}

// Debounce
function debounce(fn, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
}

// Throttle
function throttle(fn, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            fn.apply(this, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    };
}
```

---

## Combining Patterns

### Composition + Currying

```javascript
// Curried functions
let add = a => b => a + b;
let multiply = a => b => a * b;

// Compose curried functions
let addThenMultiply = pipe(
    add(5),
    multiply(2)
);

console.log(addThenMultiply(3));  // (3 + 5) * 2 = 16
```

### Memoization + Composition

```javascript
// Compose functions
let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = pipe(addOne, double, square);

// Memoize the composition
let memoizedTransform = memoize(transform);

console.log(memoizedTransform(5));  // Calculates
console.log(memoizedTransform(5));  // Uses cache
```

### Higher-Order + Currying

```javascript
// Curried higher-order function
let map = fn => array => array.map(fn);
let filter = predicate => array => array.filter(predicate);

// Compose curried functions
let process = pipe(
    filter(x => x > 5),
    map(x => x * 2)
);

let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
console.log(process(numbers));  // [12, 14, 16, 18, 20]
```

---

## Practical Examples

### Example 1: Data Processing Pipeline

```javascript
// Helper functions
let trim = str => str.trim();
let toLowerCase = str => str.toLowerCase();
let capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);
let removeSpecial = str => str.replace(/[^a-z0-9\\s]/gi, '''');

// Compose
let normalize = pipe(trim, toLowerCase, removeSpecial, capitalize);

let names = [''  ALICE!  '', ''  bob@example  '', ''  Charlie123  ''];
let normalized = names.map(normalize);
console.log(normalized);  // [''Alice'', ''Bobexample'', ''Charlie123'']
```

### Example 2: API Request Builder

```javascript
// Curried API builder
let apiRequest = method => url => data => {
    return fetch(url, {
        method: method,
        headers: { ''Content-Type'': ''application/json'' },
        body: JSON.stringify(data)
    });
};

// Create specific request functions
let get = apiRequest(''GET'');
let post = apiRequest(''POST'');
let put = apiRequest(''PUT'');

// Use
let getUser = get(''/api/users'');
let createUser = post(''/api/users'');
```

### Example 3: Validation Pipeline

```javascript
// Validators
let isRequired = value => value !== null && value !== undefined && value !== '''';
let minLength = length => value => value.length >= length;
let isEmail = value => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value);

// Combine validators
function validate(...validators) {
    return function(value) {
        return validators.every(validator => validator(value));
    };
}

// Create validators
let validateEmail = validate(isRequired, isEmail);
let validatePassword = validate(isRequired, minLength(8));

console.log(validateEmail(''alice@example.com''));  // true
console.log(validatePassword(''password123''));     // true
```

---

## Practice Exercise

### Exercise: Advanced Functional Patterns

**Objective**: Practice function composition, currying, memoization, and higher-order functions.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Composing functions
   - Creating curried functions
   - Implementing memoization
   - Building higher-order functions
   - Combining patterns

**Example Solution**:

```javascript
// advanced-functional-patterns-practice.js
console.log("=== Advanced Functional Patterns Practice ===");

console.log("\\n=== Function Composition ===");

// Basic composition
function compose(f, g) {
    return function(x) {
        return f(g(x));
    };
}

let addOne = x => x + 1;
let double = x => x * 2;

let addOneThenDouble = compose(double, addOne);
console.log(''addOneThenDouble(5):'', addOneThenDouble(5));  // 12

// Multiple functions
function compose(...fns) {
    return function(value) {
        return fns.reduceRight((acc, fn) => fn(acc), value);
    };
}

let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = compose(square, double, addOne);
console.log(''transform(5):'', transform(5));  // 144

// Pipe (left to right)
function pipe(...fns) {
    return function(value) {
        return fns.reduce((acc, fn) => fn(acc), value);
    };
}

let transform2 = pipe(addOne, double, square);
console.log(''transform2(5):'', transform2(5));  // 144

// Practical: String normalization
let trim = str => str.trim();
let toLowerCase = str => str.toLowerCase();
let capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);

let normalizeName = pipe(trim, toLowerCase, capitalize);
console.log(''normalizeName("  ALICE  "):'', normalizeName(''  ALICE  ''));  // ''Alice''
console.log();

console.log("=== Currying ===");

// Basic currying
function addCurried(a) {
    return function(b) {
        return a + b;
    };
}

let add5 = addCurried(5);
console.log(''add5(3):'', add5(3));  // 8

// Arrow function currying
let add = a => b => a + b;
let add10 = add(10);
console.log(''add10(5):'', add10(5));  // 15

// Generic curry function
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        } else {
            return function(...nextArgs) {
                return curried.apply(this, args.concat(nextArgs));
            };
        }
    };
}

function multiply(a, b, c) {
    return a * b * c;
}

let curriedMultiply = curry(multiply);
console.log(''curriedMultiply(2)(3)(4):'', curriedMultiply(2)(3)(4));     // 24
console.log(''curriedMultiply(2, 3)(4):'', curriedMultiply(2, 3)(4));     // 24
console.log(''curriedMultiply(2)(3, 4):'', curriedMultiply(2)(3, 4));     // 24

// Practical: Curried array methods
let filter = predicate => array => array.filter(predicate);
let map = fn => array => array.map(fn);

let isEven = x => x % 2 === 0;
let filterEven = filter(isEven);
let double = x => x * 2;
let mapDouble = map(double);

let numbers = [1, 2, 3, 4, 5, 6];
console.log(''filterEven(numbers):'', filterEven(numbers));  // [2, 4, 6]
console.log(''mapDouble(numbers):'', mapDouble(numbers));    // [2, 4, 6, 8, 10, 12]
console.log();

console.log("=== Memoization ===");

// Basic memoization
function memoize(fn) {
    let cache = {};
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache[key]) {
            console.log(''Cache hit for:'', key);
            return cache[key];
        }
        console.log(''Cache miss, calculating...'');
        let result = fn.apply(this, args);
        cache[key] = result;
        return result;
    };
}

// Expensive function
function expensiveOperation(n) {
    let result = 0;
    for (let i = 0; i < n * 1000000; i++) {
        result += i;
    }
    return result;
}

let memoized = memoize(expensiveOperation);
console.log(''memoized(10):'', memoized(10));  // Calculates
console.log(''memoized(10):'', memoized(10));  // Uses cache

// Fibonacci with memoization
function fibonacci(n) {
    if (n <= 1) return n;
    return fibonacci(n - 1) + fibonacci(n - 2);
}

let memoizedFib = memoize(fibonacci);
console.log(''memoizedFib(40):'', memoizedFib(40));  // Fast with memoization
console.log();

console.log("=== Higher-Order Functions ===");

// Function that takes function
function withLogging(fn) {
    return function(...args) {
        console.log(''Calling function with:'', args);
        let result = fn.apply(this, args);
        console.log(''Result:'', result);
        return result;
    };
}

let add = (a, b) => a + b;
let loggedAdd = withLogging(add);
loggedAdd(2, 3);

// Function that returns function
function createMultiplier(factor) {
    return function(number) {
        return number * factor;
    };
}

let double = createMultiplier(2);
let triple = createMultiplier(3);
console.log(''double(5):'', double(5));   // 10
console.log(''triple(5):'', triple(5));   // 15

// Retry function
function retry(fn, times = 3) {
    return async function(...args) {
        for (let i = 0; i < times; i++) {
            try {
                return await fn.apply(this, args);
            } catch (error) {
                if (i === times - 1) throw error;
                console.log(`Retry ${i + 1}/${times}`);
            }
        }
    };
}

// Debounce
function debounce(fn, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            fn.apply(this, args);
        }, delay);
    };
}

// Throttle
function throttle(fn, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            fn.apply(this, args);
            inThrottle = true;
            setTimeout(() => inThrottle = false, limit);
        }
    };
}
console.log();

console.log("=== Combining Patterns ===");

// Composition + Currying
let add = a => b => a + b;
let multiply = a => b => a * b;

let addThenMultiply = pipe(
    add(5),
    multiply(2)
);
console.log(''addThenMultiply(3):'', addThenMultiply(3));  // 16

// Memoization + Composition
let addOne = x => x + 1;
let double = x => x * 2;
let square = x => x * x;

let transform = pipe(addOne, double, square);
let memoizedTransform = memoize(transform);

console.log(''memoizedTransform(5):'', memoizedTransform(5));  // Calculates
console.log(''memoizedTransform(5):'', memoizedTransform(5));  // Uses cache

// Higher-Order + Currying
let map = fn => array => array.map(fn);
let filter = predicate => array => array.filter(predicate);

let process = pipe(
    filter(x => x > 5),
    map(x => x * 2)
);

let numbers2 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
console.log(''process(numbers2):'', process(numbers2));  // [12, 14, 16, 18, 20]
console.log();

console.log("=== Practical Examples ===");

// Example 1: Data Processing Pipeline
let trim = str => str.trim();
let toLowerCase = str => str.toLowerCase();
let capitalize = str => str.charAt(0).toUpperCase() + str.slice(1);
let removeSpecial = str => str.replace(/[^a-z0-9\\s]/gi, '''');

let normalize = pipe(trim, toLowerCase, removeSpecial, capitalize);

let names = [''  ALICE!  '', ''  bob@example  '', ''  Charlie123  ''];
let normalized = names.map(normalize);
console.log(''Normalized names:'', normalized);

// Example 2: Validation Pipeline
let isRequired = value => value !== null && value !== undefined && value !== '''';
let minLength = length => value => value.length >= length;
let isEmail = value => /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(value);

function validate(...validators) {
    return function(value) {
        return validators.every(validator => validator(value));
    };
}

let validateEmail = validate(isRequired, isEmail);
let validatePassword = validate(isRequired, minLength(8));

console.log(''validateEmail("alice@example.com"):'', validateEmail(''alice@example.com''));  // true
console.log(''validatePassword("password123"):'', validatePassword(''password123''));          // true
```

**Expected Output**:
```
=== Advanced Functional Patterns Practice ===

=== Function Composition ===
addOneThenDouble(5): 12
transform(5): 144
transform2(5): 144
normalizeName("  ALICE  "): Alice

=== Currying ===
add5(3): 8
add10(5): 15
curriedMultiply(2)(3)(4): 24
curriedMultiply(2, 3)(4): 24
curriedMultiply(2)(3, 4): 24
filterEven(numbers): [2, 4, 6]
mapDouble(numbers): [2, 4, 6, 8, 10, 12]

=== Memoization ===
Cache miss, calculating...
memoized(10): [result]
Cache hit for: [10]
memoized(10): [result]
memoizedFib(40): [result]

=== Higher-Order Functions ===
Calling function with: [2, 3]
Result: 5
double(5): 10
triple(5): 15

=== Combining Patterns ===
addThenMultiply(3): 16
memoizedTransform(5): [result]
memoizedTransform(5): [result]
process(numbers2): [12, 14, 16, 18, 20]

=== Practical Examples ===
Normalized names: [''Alice'', ''Bobexample'', ''Charlie123'']
validateEmail("alice@example.com"): true
validatePassword("password123"): true
```

**Challenge (Optional)**:
- Build a complete functional programming library
- Create reusable composition utilities
- Build a validation framework
- Practice combining all patterns

---

## Common Mistakes

### 1. Wrong Composition Order

```javascript
// ⚠️ Problem: Wrong order
let result = compose(addOne, double)(5);  // (5 * 2) + 1 = 11

// ✅ Solution: Understand order
let result = compose(double, addOne)(5);  // (5 + 1) * 2 = 12
```

### 2. Not Handling Arguments in Curry

```javascript
// ⚠️ Problem: Doesn''t handle partial application
function curry(fn) {
    return function(a) {
        return function(b) {
            return fn(a, b);
        };
    };
}

// ✅ Solution: Handle any number of arguments
function curry(fn) {
    return function curried(...args) {
        if (args.length >= fn.length) {
            return fn.apply(this, args);
        } else {
            return function(...nextArgs) {
                return curried.apply(this, args.concat(nextArgs));
            };
        }
    };
}
```

### 3. Memoization with Non-Serializable Keys

```javascript
// ⚠️ Problem: Objects can''t be stringified properly
function memoize(fn) {
    let cache = {};
    return function(...args) {
        let key = JSON.stringify(args);  // Might fail with functions
        // ...
    };
}

// ✅ Solution: Use Map or better key generation
function memoize(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        // Or use a better key generation strategy
    };
}
```

---

## Key Takeaways

1. **Function Composition**: Combine functions into pipelines
2. **Currying**: Transform multi-argument functions
3. **Memoization**: Cache results for performance
4. **Higher-Order Functions**: Functions that work with functions
5. **Combining Patterns**: Use patterns together for power
6. **Best Practice**: Start simple, compose for complexity
7. **Performance**: Memoization can significantly improve performance

---

## Quiz: Advanced Functional Programming

Test your understanding with these questions:

1. **Function composition:**
   - A) Combines functions
   - B) Separates functions
   - C) Deletes functions
   - D) Nothing

2. **Currying transforms:**
   - A) One argument to many
   - B) Many arguments to one
   - C) Functions to values
   - D) Nothing

3. **Memoization:**
   - A) Caches results
   - B) Deletes results
   - C) Modifies results
   - D) Nothing

4. **Higher-order function:**
   - A) Takes function as argument
   - B) Returns function
   - C) Both
   - D) Neither

5. **compose applies functions:**
   - A) Left to right
   - B) Right to left
   - C) Random
   - D) Never

6. **pipe applies functions:**
   - A) Left to right
   - B) Right to left
   - C) Random
   - D) Never

7. **Memoization helps:**
   - A) Performance
   - B) Readability
   - C) Both
   - D) Neither

**Answers**:
1. A) Combines functions
2. B) Many arguments to one
3. A) Caches results
4. C) Both
5. B) Right to left
6. A) Left to right
7. A) Performance

---

## Next Steps

Congratulations! You''ve completed Module 18: Functional Programming. You now know:
- Functional programming concepts
- Array methods for FP
- Advanced functional patterns
- Function composition, currying, memoization

**What''s Next?**
- Module 19: Design Patterns
- Lesson 19.1: Creational Patterns
- Learn design patterns
- Build reusable solutions

---

## Additional Resources

- **MDN: Functions**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Functions)
- **JavaScript.info: Advanced Functions**: [javascript.info/advanced-functions](https://javascript.info/advanced-functions)

---

*Lesson completed! You''ve finished Module 18: Functional Programming. Ready for Module 19: Design Patterns!*

', NULL, 3, '2026-01-03 09:59:58', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand function composition
- Implement currying
- Use memoization for performance
- Build higher-order functions
- Combine functional patterns
- Write more reusable code
- Optimize function performance');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (157, 59, 14, 'Creational Patterns', 'creational-patterns', '# Lesson 19.1: Creational Patterns

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand creational design patterns
- Implement the Singleton pattern
- Implement the Factory pattern
- Implement the Builder pattern
- Choose appropriate patterns
- Apply patterns to solve problems
- Build reusable object creation solutions

---

## Introduction to Creational Patterns

Creational patterns provide ways to create objects while hiding the creation logic.

### Why Creational Patterns?

- **Flexibility**: Control how objects are created
- **Reusability**: Reuse object creation logic
- **Maintainability**: Centralize creation logic
- **Testability**: Easier to test and mock
- **Best Practices**: Proven solutions to common problems
- **Code Quality**: Better organized code

### Common Creational Patterns

1. **Singleton**: Single instance
2. **Factory**: Create objects without specifying exact class
3. **Builder**: Construct complex objects step by step

---

## Singleton Pattern

### What is Singleton?

Singleton ensures a class has only one instance and provides global access.

### Basic Singleton

```javascript
class Singleton {
    constructor() {
        if (Singleton.instance) {
            return Singleton.instance;
        }
        Singleton.instance = this;
        return this;
    }
}

let instance1 = new Singleton();
let instance2 = new Singleton();
console.log(instance1 === instance2);  // true
```

### Singleton with Private Constructor

```javascript
class Singleton {
    static instance = null;
    
    constructor() {
        if (Singleton.instance) {
            return Singleton.instance;
        }
        Singleton.instance = this;
    }
    
    static getInstance() {
        if (!Singleton.instance) {
            Singleton.instance = new Singleton();
        }
        return Singleton.instance;
    }
}

let instance1 = Singleton.getInstance();
let instance2 = Singleton.getInstance();
console.log(instance1 === instance2);  // true
```

### Singleton with Module Pattern

```javascript
const Singleton = (function() {
    let instance;
    
    function createInstance() {
        return {
            data: ''Singleton data'',
            getData: function() {
                return this.data;
            }
        };
    }
    
    return {
        getInstance: function() {
            if (!instance) {
                instance = createInstance();
            }
            return instance;
        }
    };
})();

let instance1 = Singleton.getInstance();
let instance2 = Singleton.getInstance();
console.log(instance1 === instance2);  // true
```

### Practical Singleton Example

```javascript
class DatabaseConnection {
    static instance = null;
    
    constructor() {
        if (DatabaseConnection.instance) {
            return DatabaseConnection.instance;
        }
        
        this.connection = this.connect();
        DatabaseConnection.instance = this;
    }
    
    connect() {
        console.log(''Connecting to database...'');
        // Simulate connection
        return { connected: true };
    }
    
    query(sql) {
        console.log(''Executing query:'', sql);
        return { results: [] };
    }
    
    static getInstance() {
        if (!DatabaseConnection.instance) {
            DatabaseConnection.instance = new DatabaseConnection();
        }
        return DatabaseConnection.instance;
    }
}

// Usage
let db1 = DatabaseConnection.getInstance();
let db2 = DatabaseConnection.getInstance();
console.log(db1 === db2);  // true
```

---

## Factory Pattern

### What is Factory?

Factory creates objects without specifying the exact class.

### Basic Factory

```javascript
class Car {
    constructor(type) {
        this.type = type;
    }
}

class Truck {
    constructor(type) {
        this.type = type;
    }
}

class VehicleFactory {
    createVehicle(type) {
        switch(type) {
            case ''car'':
                return new Car(''car'');
            case ''truck'':
                return new Truck(''truck'');
            default:
                throw new Error(''Unknown vehicle type'');
        }
    }
}

let factory = new VehicleFactory();
let car = factory.createVehicle(''car'');
let truck = factory.createVehicle(''truck'');
```

### Factory with Classes

```javascript
class Shape {
    draw() {
        throw new Error(''Method must be implemented'');
    }
}

class Circle extends Shape {
    draw() {
        console.log(''Drawing circle'');
    }
}

class Rectangle extends Shape {
    draw() {
        console.log(''Drawing rectangle'');
    }
}

class ShapeFactory {
    createShape(type) {
        switch(type) {
            case ''circle'':
                return new Circle();
            case ''rectangle'':
                return new Rectangle();
            default:
                throw new Error(''Unknown shape type'');
        }
    }
}

let factory = new ShapeFactory();
let circle = factory.createShape(''circle'');
let rectangle = factory.createShape(''rectangle'');
circle.draw();      // Drawing circle
rectangle.draw();  // Drawing rectangle
```

### Factory Function

```javascript
function createUser(type, name) {
    switch(type) {
        case ''admin'':
            return {
                name: name,
                role: ''admin'',
                permissions: [''read'', ''write'', ''delete'']
            };
        case ''user'':
            return {
                name: name,
                role: ''user'',
                permissions: [''read'']
            };
        default:
            throw new Error(''Unknown user type'');
    }
}

let admin = createUser(''admin'', ''Alice'');
let user = createUser(''user'', ''Bob'');
```

### Practical Factory Example

```javascript
class NotificationFactory {
    createNotification(type, message) {
        switch(type) {
            case ''email'':
                return new EmailNotification(message);
            case ''sms'':
                return new SMSNotification(message);
            case ''push'':
                return new PushNotification(message);
            default:
                throw new Error(''Unknown notification type'');
        }
    }
}

class EmailNotification {
    constructor(message) {
        this.message = message;
        this.type = ''email'';
    }
    
    send() {
        console.log(''Sending email:'', this.message);
    }
}

class SMSNotification {
    constructor(message) {
        this.message = message;
        this.type = ''sms'';
    }
    
    send() {
        console.log(''Sending SMS:'', this.message);
    }
}

class PushNotification {
    constructor(message) {
        this.message = message;
        this.type = ''push'';
    }
    
    send() {
        console.log(''Sending push notification:'', this.message);
    }
}

// Usage
let factory = new NotificationFactory();
let email = factory.createNotification(''email'', ''Hello'');
let sms = factory.createNotification(''sms'', ''Hello'');
email.send();
sms.send();
```

---

## Builder Pattern

### What is Builder?

Builder constructs complex objects step by step.

### Basic Builder

```javascript
class PizzaBuilder {
    constructor() {
        this.pizza = {};
    }
    
    setSize(size) {
        this.pizza.size = size;
        return this;
    }
    
    setCrust(crust) {
        this.pizza.crust = crust;
        return this;
    }
    
    addTopping(topping) {
        if (!this.pizza.toppings) {
            this.pizza.toppings = [];
        }
        this.pizza.toppings.push(topping);
        return this;
    }
    
    build() {
        return this.pizza;
    }
}

// Usage
let pizza = new PizzaBuilder()
    .setSize(''large'')
    .setCrust(''thin'')
    .addTopping(''pepperoni'')
    .addTopping(''cheese'')
    .build();
```

### Builder with Validation

```javascript
class UserBuilder {
    constructor() {
        this.user = {};
    }
    
    setName(name) {
        if (!name || name.trim() === '''') {
            throw new Error(''Name is required'');
        }
        this.user.name = name;
        return this;
    }
    
    setEmail(email) {
        if (!email || !email.includes(''@'')) {
            throw new Error(''Valid email is required'');
        }
        this.user.email = email;
        return this;
    }
    
    setAge(age) {
        if (age < 0 || age > 150) {
            throw new Error(''Invalid age'');
        }
        this.user.age = age;
        return this;
    }
    
    build() {
        if (!this.user.name || !this.user.email) {
            throw new Error(''Name and email are required'');
        }
        return this.user;
    }
}

// Usage
let user = new UserBuilder()
    .setName(''Alice'')
    .setEmail(''alice@example.com'')
    .setAge(30)
    .build();
```

### Builder with Director

```javascript
class QueryBuilder {
    constructor() {
        this.query = {
            select: [],
            from: '''',
            where: [],
            orderBy: []
        };
    }
    
    select(fields) {
        this.query.select = Array.isArray(fields) ? fields : [fields];
        return this;
    }
    
    from(table) {
        this.query.from = table;
        return this;
    }
    
    where(condition) {
        this.query.where.push(condition);
        return this;
    }
    
    orderBy(field, direction = ''ASC'') {
        this.query.orderBy.push({ field, direction });
        return this;
    }
    
    build() {
        let sql = ''SELECT '' + this.query.select.join('', '');
        sql += '' FROM '' + this.query.from;
        
        if (this.query.where.length > 0) {
            sql += '' WHERE '' + this.query.where.join('' AND '');
        }
        
        if (this.query.orderBy.length > 0) {
            let order = this.query.orderBy.map(o => `${o.field} ${o.direction}`).join('', '');
            sql += '' ORDER BY '' + order;
        }
        
        return sql;
    }
}

// Usage
let query = new QueryBuilder()
    .select([''name'', ''email''])
    .from(''users'')
    .where(''age > 18'')
    .where(''active = true'')
    .orderBy(''name'', ''ASC'')
    .build();

console.log(query);
// SELECT name, email FROM users WHERE age > 18 AND active = true ORDER BY name ASC
```

### Practical Builder Example

```javascript
class HTTPRequestBuilder {
    constructor() {
        this.request = {
            method: ''GET'',
            url: '''',
            headers: {},
            body: null
        };
    }
    
    method(method) {
        this.request.method = method.toUpperCase();
        return this;
    }
    
    url(url) {
        this.request.url = url;
        return this;
    }
    
    header(key, value) {
        this.request.headers[key] = value;
        return this;
    }
    
    body(data) {
        this.request.body = JSON.stringify(data);
        this.header(''Content-Type'', ''application/json'');
        return this;
    }
    
    build() {
        return this.request;
    }
    
    async execute() {
        return fetch(this.request.url, {
            method: this.request.method,
            headers: this.request.headers,
            body: this.request.body
        });
    }
}

// Usage
let request = new HTTPRequestBuilder()
    .method(''POST'')
    .url(''/api/users'')
    .header(''Authorization'', ''Bearer token'')
    .body({ name: ''Alice'', email: ''alice@example.com'' })
    .build();
```

---

## Practice Exercise

### Exercise: Creational Patterns

**Objective**: Practice implementing Singleton, Factory, and Builder patterns.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Implementing Singleton pattern
   - Creating Factory pattern
   - Building Builder pattern
   - Applying patterns to real problems

**Example Solution**:

```javascript
// creational-patterns-practice.js
console.log("=== Creational Patterns Practice ===");

console.log("\\n=== Singleton Pattern ===");

// Basic Singleton
class Singleton {
    static instance = null;
    
    constructor() {
        if (Singleton.instance) {
            return Singleton.instance;
        }
        Singleton.instance = this;
        this.data = ''Singleton data'';
    }
    
    static getInstance() {
        if (!Singleton.instance) {
            Singleton.instance = new Singleton();
        }
        return Singleton.instance;
    }
    
    getData() {
        return this.data;
    }
}

let instance1 = Singleton.getInstance();
let instance2 = Singleton.getInstance();
console.log(''instance1 === instance2:'', instance1 === instance2);  // true
console.log(''instance1.getData():'', instance1.getData());

// Singleton with Module Pattern
const Config = (function() {
    let instance;
    
    function createInstance() {
        return {
            apiUrl: ''https://api.example.com'',
            timeout: 5000,
            getConfig: function() {
                return {
                    apiUrl: this.apiUrl,
                    timeout: this.timeout
                };
            }
        };
    }
    
    return {
        getInstance: function() {
            if (!instance) {
                instance = createInstance();
            }
            return instance;
        }
    };
})();

let config1 = Config.getInstance();
let config2 = Config.getInstance();
console.log(''config1 === config2:'', config1 === config2);  // true
console.log();

console.log("=== Factory Pattern ===");

// Basic Factory
class VehicleFactory {
    createVehicle(type, brand) {
        switch(type) {
            case ''car'':
                return new Car(brand);
            case ''truck'':
                return new Truck(brand);
            case ''motorcycle'':
                return new Motorcycle(brand);
            default:
                throw new Error(''Unknown vehicle type'');
        }
    }
}

class Car {
    constructor(brand) {
        this.type = ''car'';
        this.brand = brand;
    }
    
    drive() {
        console.log(`Driving ${this.brand} car`);
    }
}

class Truck {
    constructor(brand) {
        this.type = ''truck'';
        this.brand = brand;
    }
    
    drive() {
        console.log(`Driving ${this.brand} truck`);
    }
}

class Motorcycle {
    constructor(brand) {
        this.type = ''motorcycle'';
        this.brand = brand;
    }
    
    drive() {
        console.log(`Riding ${this.brand} motorcycle`);
    }
}

let factory = new VehicleFactory();
let car = factory.createVehicle(''car'', ''Toyota'');
let truck = factory.createVehicle(''truck'', ''Ford'');
car.drive();
truck.drive();

// Factory Function
function createUser(type, name, email) {
    const userTypes = {
        admin: {
            role: ''admin'',
            permissions: [''read'', ''write'', ''delete'', ''manage'']
        },
        editor: {
            role: ''editor'',
            permissions: [''read'', ''write'']
        },
        viewer: {
            role: ''viewer'',
            permissions: [''read'']
        }
    };
    
    const userType = userTypes[type];
    if (!userType) {
        throw new Error(''Unknown user type'');
    }
    
    return {
        name: name,
        email: email,
        role: userType.role,
        permissions: userType.permissions,
        hasPermission: function(permission) {
            return this.permissions.includes(permission);
        }
    };
}

let admin = createUser(''admin'', ''Alice'', ''alice@example.com'');
let viewer = createUser(''viewer'', ''Bob'', ''bob@example.com'');
console.log(''Admin permissions:'', admin.permissions);
console.log(''Viewer can write:'', viewer.hasPermission(''write''));  // false
console.log();

console.log("=== Builder Pattern ===");

// Basic Builder
class PizzaBuilder {
    constructor() {
        this.pizza = {
            size: ''medium'',
            crust: ''regular'',
            toppings: []
        };
    }
    
    setSize(size) {
        this.pizza.size = size;
        return this;
    }
    
    setCrust(crust) {
        this.pizza.crust = crust;
        return this;
    }
    
    addTopping(topping) {
        this.pizza.toppings.push(topping);
        return this;
    }
    
    build() {
        return this.pizza;
    }
}

let pizza = new PizzaBuilder()
    .setSize(''large'')
    .setCrust(''thin'')
    .addTopping(''pepperoni'')
    .addTopping(''cheese'')
    .addTopping(''mushrooms'')
    .build();

console.log(''Pizza:'', pizza);

// Builder with Validation
class UserBuilder {
    constructor() {
        this.user = {};
    }
    
    setName(name) {
        if (!name || name.trim() === '''') {
            throw new Error(''Name is required'');
        }
        this.user.name = name;
        return this;
    }
    
    setEmail(email) {
        if (!email || !email.includes(''@'')) {
            throw new Error(''Valid email is required'');
        }
        this.user.email = email;
        return this;
    }
    
    setAge(age) {
        if (age < 0 || age > 150) {
            throw new Error(''Invalid age'');
        }
        this.user.age = age;
        return this;
    }
    
    setAddress(address) {
        this.user.address = address;
        return this;
    }
    
    build() {
        if (!this.user.name || !this.user.email) {
            throw new Error(''Name and email are required'');
        }
        return this.user;
    }
}

let user = new UserBuilder()
    .setName(''Alice'')
    .setEmail(''alice@example.com'')
    .setAge(30)
    .setAddress(''123 Main St'')
    .build();

console.log(''User:'', user);

// Query Builder
class QueryBuilder {
    constructor() {
        this.query = {
            select: [],
            from: '''',
            where: [],
            orderBy: []
        };
    }
    
    select(fields) {
        this.query.select = Array.isArray(fields) ? fields : [fields];
        return this;
    }
    
    from(table) {
        this.query.from = table;
        return this;
    }
    
    where(condition) {
        this.query.where.push(condition);
        return this;
    }
    
    orderBy(field, direction = ''ASC'') {
        this.query.orderBy.push({ field, direction });
        return this;
    }
    
    build() {
        let sql = ''SELECT '' + (this.query.select.length > 0 ? this.query.select.join('', '') : ''*'');
        sql += '' FROM '' + this.query.from;
        
        if (this.query.where.length > 0) {
            sql += '' WHERE '' + this.query.where.join('' AND '');
        }
        
        if (this.query.orderBy.length > 0) {
            let order = this.query.orderBy.map(o => `${o.field} ${o.direction}`).join('', '');
            sql += '' ORDER BY '' + order;
        }
        
        return sql;
    }
}

let query = new QueryBuilder()
    .select([''name'', ''email'', ''age''])
    .from(''users'')
    .where(''age >= 18'')
    .where(''active = true'')
    .orderBy(''name'', ''ASC'')
    .build();

console.log(''SQL Query:'', query);
console.log();

console.log("=== Practical Examples ===");

// Example 1: Logger Singleton
class Logger {
    static instance = null;
    logs = [];
    
    constructor() {
        if (Logger.instance) {
            return Logger.instance;
        }
        Logger.instance = this;
    }
    
    log(message) {
        let logEntry = {
            timestamp: new Date().toISOString(),
            message: message
        };
        this.logs.push(logEntry);
        console.log(`[${logEntry.timestamp}] ${message}`);
    }
    
    getLogs() {
        return this.logs;
    }
    
    static getInstance() {
        if (!Logger.instance) {
            Logger.instance = new Logger();
        }
        return Logger.instance;
    }
}

let logger1 = Logger.getInstance();
let logger2 = Logger.getInstance();
logger1.log(''First log'');
logger2.log(''Second log'');
console.log(''Logs:'', logger1.getLogs());

// Example 2: Notification Factory
class NotificationFactory {
    createNotification(type, message, recipient) {
        switch(type) {
            case ''email'':
                return new EmailNotification(message, recipient);
            case ''sms'':
                return new SMSNotification(message, recipient);
            case ''push'':
                return new PushNotification(message, recipient);
            default:
                throw new Error(''Unknown notification type'');
        }
    }
}

class EmailNotification {
    constructor(message, recipient) {
        this.type = ''email'';
        this.message = message;
        this.recipient = recipient;
    }
    
    send() {
        console.log(`Sending email to ${this.recipient}: ${this.message}`);
    }
}

class SMSNotification {
    constructor(message, recipient) {
        this.type = ''sms'';
        this.message = message;
        this.recipient = recipient;
    }
    
    send() {
        console.log(`Sending SMS to ${this.recipient}: ${this.message}`);
    }
}

class PushNotification {
    constructor(message, recipient) {
        this.type = ''push'';
        this.message = message;
        this.recipient = recipient;
    }
    
    send() {
        console.log(`Sending push to ${this.recipient}: ${this.message}`);
    }
}

let notificationFactory = new NotificationFactory();
let email = notificationFactory.createNotification(''email'', ''Hello'', ''alice@example.com'');
let sms = notificationFactory.createNotification(''sms'', ''Hello'', ''1234567890'');
email.send();
sms.send();
```

**Expected Output**:
```
=== Creational Patterns Practice ===

=== Singleton Pattern ===
instance1 === instance2: true
instance1.getData(): Singleton data
config1 === config2: true

=== Factory Pattern ===
Driving Toyota car
Driving Ford truck
Admin permissions: [''read'', ''write'', ''delete'', ''manage'']
Viewer can write: false

=== Builder Pattern ===
Pizza: { size: ''large'', crust: ''thin'', toppings: [...] }
User: { name: ''Alice'', email: ''alice@example.com'', ... }
SQL Query: SELECT name, email, age FROM users WHERE age >= 18 AND active = true ORDER BY name ASC

=== Practical Examples ===
[timestamp] First log
[timestamp] Second log
Logs: [array]
Sending email to alice@example.com: Hello
Sending SMS to 1234567890: Hello
```

**Challenge (Optional)**:
- Build a complete application using all three patterns
- Create a configuration management system
- Build a form builder
- Practice combining patterns

---

## Common Mistakes

### 1. Not Preventing Multiple Instances in Singleton

```javascript
// ⚠️ Problem: Can create multiple instances
class Singleton {
    constructor() {
        // No check
    }
}

// ✅ Solution: Check for existing instance
class Singleton {
    static instance = null;
    constructor() {
        if (Singleton.instance) {
            return Singleton.instance;
        }
        Singleton.instance = this;
    }
}
```

### 2. Factory Without Error Handling

```javascript
// ⚠️ Problem: No error handling
class Factory {
    create(type) {
        switch(type) {
            case ''type1'':
                return new Type1();
            // Missing default
        }
    }
}

// ✅ Solution: Handle unknown types
class Factory {
    create(type) {
        switch(type) {
            case ''type1'':
                return new Type1();
            default:
                throw new Error(''Unknown type'');
        }
    }
}
```

### 3. Builder Not Returning this

```javascript
// ⚠️ Problem: Can''t chain
class Builder {
    setValue(value) {
        this.value = value;
        // Missing return this
    }
}

// ✅ Solution: Return this for chaining
class Builder {
    setValue(value) {
        this.value = value;
        return this;
    }
}
```

---

## Key Takeaways

1. **Singleton**: Ensures single instance, global access
2. **Factory**: Creates objects without specifying exact class
3. **Builder**: Constructs complex objects step by step
4. **When to Use**: Choose based on problem requirements
5. **Best Practice**: Keep patterns simple, add validation
6. **Chaining**: Builders should return this for method chaining
7. **Error Handling**: Always handle edge cases

---

## Quiz: Creational Patterns

Test your understanding with these questions:

1. **Singleton ensures:**
   - A) Multiple instances
   - B) Single instance
   - C) No instances
   - D) Random instances

2. **Factory pattern:**
   - A) Creates objects
   - B) Destroys objects
   - C) Modifies objects
   - D) Nothing

3. **Builder pattern:**
   - A) Builds step by step
   - B) Builds all at once
   - C) Doesn''t build
   - D) Random

4. **Singleton getInstance():**
   - A) Creates new instance always
   - B) Returns existing instance
   - C) Deletes instance
   - D) Nothing

5. **Factory is useful for:**
   - A) Single object
   - B) Multiple object types
   - C) No objects
   - D) Random

6. **Builder methods should:**
   - A) Return this
   - B) Return void
   - C) Return null
   - D) Nothing

7. **Creational patterns help:**
   - A) Object creation
   - B) Object destruction
   - C) Object modification
   - D) Nothing

**Answers**:
1. B) Single instance
2. A) Creates objects
3. A) Builds step by step
4. B) Returns existing instance
5. B) Multiple object types
6. A) Return this
7. A) Object creation

---

## Next Steps

Congratulations! You''ve learned creational patterns. You now know:
- How to implement Singleton
- How to create Factory pattern
- How to build Builder pattern
- When to use each pattern

**What''s Next?**
- Lesson 19.2: Structural Patterns
- Learn Module pattern
- Understand Facade pattern
- Work with Decorator pattern

---

## Additional Resources

- **MDN: Classes**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes)
- **Design Patterns**: [refactoring.guru/design-patterns](https://refactoring.guru/design-patterns)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 09:59:25', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand creational design patterns
- Implement the Singleton pattern
- Implement the Factory pattern
- Implement the Builder pattern
- Choose appropriate patterns
- Apply patterns to solve problems
- Build reusable object creation solutions');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (158, 59, 14, 'Structural Patterns', 'structural-patterns', '# Lesson 19.2: Structural Patterns

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand structural design patterns
- Implement the Module pattern
- Implement the Facade pattern
- Implement the Decorator pattern
- Choose appropriate patterns
- Apply patterns to organize code
- Build maintainable code structures

---

## Introduction to Structural Patterns

Structural patterns focus on how classes and objects are composed to form larger structures.

### Why Structural Patterns?

- **Organization**: Better code organization
- **Reusability**: Reuse existing code
- **Flexibility**: Easier to modify and extend
- **Maintainability**: Clearer code structure
- **Separation of Concerns**: Better code separation
- **Best Practices**: Proven structural solutions

### Common Structural Patterns

1. **Module**: Encapsulate code
2. **Facade**: Simplify complex interfaces
3. **Decorator**: Add behavior dynamically

---

## Module Pattern

### What is Module Pattern?

Module pattern provides a way to create private and public members.

### Basic Module Pattern

```javascript
const Module = (function() {
    // Private variables
    let privateVar = ''private'';
    
    // Private functions
    function privateFunction() {
        return ''private function'';
    }
    
    // Public API
    return {
        publicVar: ''public'',
        publicFunction: function() {
            return ''public function'';
        },
        getPrivateVar: function() {
            return privateVar;
        }
    };
})();

console.log(Module.publicVar);           // ''public''
console.log(Module.publicFunction());     // ''public function''
console.log(Module.getPrivateVar());      // ''private''
// console.log(Module.privateVar);        // undefined
```

### Module with Revealing Pattern

```javascript
const Calculator = (function() {
    // Private
    function add(a, b) {
        return a + b;
    }
    
    function subtract(a, b) {
        return a - b;
    }
    
    function multiply(a, b) {
        return a * b;
    }
    
    function divide(a, b) {
        if (b === 0) {
            throw new Error(''Division by zero'');
        }
        return a / b;
    }
    
    // Public API
    return {
        add: add,
        subtract: subtract,
        multiply: multiply,
        divide: divide
    };
})();

console.log(Calculator.add(5, 3));        // 8
console.log(Calculator.multiply(4, 2));   // 8
```

### ES6 Module Pattern

```javascript
// Using ES6 classes with private fields
class Calculator {
    #history = [];
    
    add(a, b) {
        let result = a + b;
        this.#history.push(`add(${a}, ${b}) = ${result}`);
        return result;
    }
    
    subtract(a, b) {
        let result = a - b;
        this.#history.push(`subtract(${a}, ${b}) = ${result}`);
        return result;
    }
    
    getHistory() {
        return [...this.#history];
    }
    
    clearHistory() {
        this.#history = [];
    }
}

let calc = new Calculator();
calc.add(5, 3);
calc.subtract(10, 4);
console.log(calc.getHistory());
```

### Practical Module Example

```javascript
const UserModule = (function() {
    let users = [];
    let nextId = 1;
    
    function findUser(id) {
        return users.find(u => u.id === id);
    }
    
    return {
        create: function(name, email) {
            let user = {
                id: nextId++,
                name: name,
                email: email,
                createdAt: new Date()
            };
            users.push(user);
            return user;
        },
        
        findById: function(id) {
            return findUser(id);
        },
        
        findAll: function() {
            return [...users];
        },
        
        update: function(id, updates) {
            let user = findUser(id);
            if (user) {
                Object.assign(user, updates);
                return user;
            }
            return null;
        },
        
        delete: function(id) {
            let index = users.findIndex(u => u.id === id);
            if (index !== -1) {
                return users.splice(index, 1)[0];
            }
            return null;
        }
    };
})();

// Usage
let user1 = UserModule.create(''Alice'', ''alice@example.com'');
let user2 = UserModule.create(''Bob'', ''bob@example.com'');
console.log(UserModule.findAll());
```

---

## Facade Pattern

### What is Facade?

Facade provides a simplified interface to a complex subsystem.

### Basic Facade

```javascript
// Complex subsystem
class CPU {
    start() {
        console.log(''CPU starting...'');
    }
}

class Memory {
    load() {
        console.log(''Memory loading...'');
    }
}

class HardDrive {
    read() {
        console.log(''Hard drive reading...'');
    }
}

// Facade
class ComputerFacade {
    constructor() {
        this.cpu = new CPU();
        this.memory = new Memory();
        this.hardDrive = new HardDrive();
    }
    
    start() {
        this.cpu.start();
        this.memory.load();
        this.hardDrive.read();
        console.log(''Computer started'');
    }
}

// Usage
let computer = new ComputerFacade();
computer.start();
// Simple interface instead of calling each component
```

### Facade for API

```javascript
// Complex API calls
class UserAPI {
    async getUser(id) {
        return fetch(`/api/users/${id}`).then(r => r.json());
    }
    
    async updateUser(id, data) {
        return fetch(`/api/users/${id}`, {
            method: ''PUT'',
            body: JSON.stringify(data)
        }).then(r => r.json());
    }
}

class PostAPI {
    async getPosts(userId) {
        return fetch(`/api/users/${userId}/posts`).then(r => r.json());
    }
}

class CommentAPI {
    async getComments(postId) {
        return fetch(`/api/posts/${postId}/comments`).then(r => r.json());
    }
}

// Facade
class SocialMediaFacade {
    constructor() {
        this.userAPI = new UserAPI();
        this.postAPI = new PostAPI();
        this.commentAPI = new CommentAPI();
    }
    
    async getUserProfile(userId) {
        let user = await this.userAPI.getUser(userId);
        let posts = await this.postAPI.getPosts(userId);
        
        for (let post of posts) {
            post.comments = await this.commentAPI.getComments(post.id);
        }
        
        return {
            user: user,
            posts: posts
        };
    }
}

// Usage
let facade = new SocialMediaFacade();
facade.getUserProfile(1).then(profile => {
    console.log(profile);
});
```

### Facade for DOM

```javascript
// Facade for DOM manipulation
class DOMFacade {
    static createElement(tag, attributes = {}, children = []) {
        let element = document.createElement(tag);
        
        Object.keys(attributes).forEach(key => {
            if (key === ''className'') {
                element.className = attributes[key];
            } else if (key === ''textContent'') {
                element.textContent = attributes[key];
            } else {
                element.setAttribute(key, attributes[key]);
            }
        });
        
        children.forEach(child => {
            if (typeof child === ''string'') {
                element.appendChild(document.createTextNode(child));
            } else {
                element.appendChild(child);
            }
        });
        
        return element;
    }
    
    static append(parent, child) {
        if (typeof child === ''string'') {
            parent.appendChild(document.createTextNode(child));
        } else {
            parent.appendChild(child);
        }
    }
    
    static remove(element) {
        element.parentNode.removeChild(element);
    }
}

// Usage
let div = DOMFacade.createElement(''div'', {
    className: ''container'',
    id: ''main''
}, [
    DOMFacade.createElement(''h1'', { textContent: ''Hello'' }),
    DOMFacade.createElement(''p'', { textContent: ''World'' })
]);
```

---

## Decorator Pattern

### What is Decorator?

Decorator adds behavior to objects dynamically without modifying their structure.

### Basic Decorator

```javascript
// Base class
class Coffee {
    getCost() {
        return 5;
    }
    
    getDescription() {
        return ''Coffee'';
    }
}

// Decorator
class CoffeeDecorator {
    constructor(coffee) {
        this.coffee = coffee;
    }
    
    getCost() {
        return this.coffee.getCost();
    }
    
    getDescription() {
        return this.coffee.getDescription();
    }
}

// Concrete decorators
class MilkDecorator extends CoffeeDecorator {
    getCost() {
        return this.coffee.getCost() + 1;
    }
    
    getDescription() {
        return this.coffee.getDescription() + '', Milk'';
    }
}

class SugarDecorator extends CoffeeDecorator {
    getCost() {
        return this.coffee.getCost() + 0.5;
    }
    
    getDescription() {
        return this.coffee.getDescription() + '', Sugar'';
    }
}

// Usage
let coffee = new Coffee();
coffee = new MilkDecorator(coffee);
coffee = new SugarDecorator(coffee);

console.log(coffee.getDescription());  // ''Coffee, Milk, Sugar''
console.log(coffee.getCost());         // 6.5
```

### Function Decorator

```javascript
// Function decorator
function withLogging(fn) {
    return function(...args) {
        console.log(`Calling ${fn.name} with:`, args);
        let result = fn.apply(this, args);
        console.log(`Result:`, result);
        return result;
    };
}

function add(a, b) {
    return a + b;
}

let loggedAdd = withLogging(add);
loggedAdd(2, 3);
// Calling add with: [2, 3]
// Result: 5
```

### Multiple Decorators

```javascript
// Timing decorator
function withTiming(fn) {
    return function(...args) {
        let start = performance.now();
        let result = fn.apply(this, args);
        let end = performance.now();
        console.log(`${fn.name} took ${end - start}ms`);
        return result;
    };
}

// Caching decorator
function withCache(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache.has(key)) {
            console.log(''Cache hit'');
            return cache.get(key);
        }
        let result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

// Combine decorators
function expensiveOperation(n) {
    let result = 0;
    for (let i = 0; i < n * 1000000; i++) {
        result += i;
    }
    return result;
}

let decorated = withTiming(withCache(expensiveOperation));
decorated(10);  // Calculates and times
decorated(10);  // Uses cache and times
```

### Class Decorator

```javascript
// Class decorator
function withValidation(target) {
    return class extends target {
        constructor(...args) {
            super(...args);
            this.validate();
        }
        
        validate() {
            if (!this.name || this.name.trim() === '''') {
                throw new Error(''Name is required'');
            }
        }
    };
}

@withValidation
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
}

// Usage (requires decorator support)
let user = new User(''Alice'', ''alice@example.com'');
```

### Practical Decorator Example

```javascript
// HTTP Request decorator
function withRetry(fn, maxRetries = 3) {
    return async function(...args) {
        for (let i = 0; i < maxRetries; i++) {
            try {
                return await fn.apply(this, args);
            } catch (error) {
                if (i === maxRetries - 1) throw error;
                console.log(`Retry ${i + 1}/${maxRetries}`);
            }
        }
    };
}

function withTimeout(fn, timeout = 5000) {
    return function(...args) {
        return Promise.race([
            fn.apply(this, args),
            new Promise((_, reject) =>
                setTimeout(() => reject(new Error(''Timeout'')), timeout)
            )
        ]);
    };
}

async function fetchData(url) {
    let response = await fetch(url);
    return response.json();
}

let decoratedFetch = withRetry(withTimeout(fetchData, 5000), 3);
```

---

## Practice Exercise

### Exercise: Structural Patterns

**Objective**: Practice implementing Module, Facade, and Decorator patterns.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Creating modules
   - Building facades
   - Implementing decorators
   - Applying patterns to real problems

**Example Solution**:

```javascript
// structural-patterns-practice.js
console.log("=== Structural Patterns Practice ===");

console.log("\\n=== Module Pattern ===");

// Basic Module
const Calculator = (function() {
    let history = [];
    
    function add(a, b) {
        return a + b;
    }
    
    function subtract(a, b) {
        return a - b;
    }
    
    function multiply(a, b) {
        return a * b;
    }
    
    function divide(a, b) {
        if (b === 0) {
            throw new Error(''Division by zero'');
        }
        return a / b;
    }
    
    return {
        add: function(a, b) {
            let result = add(a, b);
            history.push(`add(${a}, ${b}) = ${result}`);
            return result;
        },
        subtract: function(a, b) {
            let result = subtract(a, b);
            history.push(`subtract(${a}, ${b}) = ${result}`);
            return result;
        },
        multiply: function(a, b) {
            let result = multiply(a, b);
            history.push(`multiply(${a}, ${b}) = ${result}`);
            return result;
        },
        divide: function(a, b) {
            let result = divide(a, b);
            history.push(`divide(${a}, ${b}) = ${result}`);
            return result;
        },
        getHistory: function() {
            return [...history];
        },
        clearHistory: function() {
            history = [];
        }
    };
})();

Calculator.add(5, 3);
Calculator.multiply(4, 2);
console.log(''Calculator history:'', Calculator.getHistory());

// ES6 Module with private fields
class UserModule {
    #users = [];
    #nextId = 1;
    
    #findUser(id) {
        return this.#users.find(u => u.id === id);
    }
    
    create(name, email) {
        let user = {
            id: this.#nextId++,
            name: name,
            email: email,
            createdAt: new Date()
        };
        this.#users.push(user);
        return user;
    }
    
    findById(id) {
        return this.#findUser(id);
    }
    
    findAll() {
        return [...this.#users];
    }
    
    update(id, updates) {
        let user = this.#findUser(id);
        if (user) {
            Object.assign(user, updates);
            return user;
        }
        return null;
    }
    
    delete(id) {
        let index = this.#users.findIndex(u => u.id === id);
        if (index !== -1) {
            return this.#users.splice(index, 1)[0];
        }
        return null;
    }
}

let userModule = new UserModule();
userModule.create(''Alice'', ''alice@example.com'');
userModule.create(''Bob'', ''bob@example.com'');
console.log(''Users:'', userModule.findAll());
console.log();

console.log("=== Facade Pattern ===");

// Complex subsystem
class CPU {
    start() {
        console.log(''CPU starting...'');
    }
}

class Memory {
    load() {
        console.log(''Memory loading...'');
    }
}

class HardDrive {
    read() {
        console.log(''Hard drive reading...'');
    }
}

// Facade
class ComputerFacade {
    constructor() {
        this.cpu = new CPU();
        this.memory = new Memory();
        this.hardDrive = new HardDrive();
    }
    
    start() {
        this.cpu.start();
        this.memory.load();
        this.hardDrive.read();
        console.log(''Computer started'');
    }
}

let computer = new ComputerFacade();
computer.start();

// API Facade
class API {
    async get(url) {
        return fetch(url).then(r => r.json());
    }
    
    async post(url, data) {
        return fetch(url, {
            method: ''POST'',
            headers: { ''Content-Type'': ''application/json'' },
            body: JSON.stringify(data)
        }).then(r => r.json());
    }
}

class UserService {
    constructor() {
        this.api = new API();
    }
    
    async getUser(id) {
        return this.api.get(`/api/users/${id}`);
    }
    
    async createUser(data) {
        return this.api.post(''/api/users'', data);
    }
}

class PostService {
    constructor() {
        this.api = new API();
    }
    
    async getPosts(userId) {
        return this.api.get(`/api/users/${userId}/posts`);
    }
}

// Facade
class SocialMediaFacade {
    constructor() {
        this.userService = new UserService();
        this.postService = new PostService();
    }
    
    async getUserProfile(userId) {
        let user = await this.userService.getUser(userId);
        let posts = await this.postService.getPosts(userId);
        return { user, posts };
    }
}

let facade = new SocialMediaFacade();
// facade.getUserProfile(1).then(profile => console.log(profile));
console.log();

console.log("=== Decorator Pattern ===");

// Base class
class Coffee {
    getCost() {
        return 5;
    }
    
    getDescription() {
        return ''Coffee'';
    }
}

// Decorator base
class CoffeeDecorator {
    constructor(coffee) {
        this.coffee = coffee;
    }
    
    getCost() {
        return this.coffee.getCost();
    }
    
    getDescription() {
        return this.coffee.getDescription();
    }
}

// Concrete decorators
class MilkDecorator extends CoffeeDecorator {
    getCost() {
        return this.coffee.getCost() + 1;
    }
    
    getDescription() {
        return this.coffee.getDescription() + '', Milk'';
    }
}

class SugarDecorator extends CoffeeDecorator {
    getCost() {
        return this.coffee.getCost() + 0.5;
    }
    
    getDescription() {
        return this.coffee.getDescription() + '', Sugar'';
    }
}

let coffee = new Coffee();
coffee = new MilkDecorator(coffee);
coffee = new SugarDecorator(coffee);

console.log(''Coffee description:'', coffee.getDescription());
console.log(''Coffee cost:'', coffee.getCost());

// Function decorators
function withLogging(fn) {
    return function(...args) {
        console.log(`Calling ${fn.name} with:`, args);
        let result = fn.apply(this, args);
        console.log(`Result:`, result);
        return result;
    };
}

function withTiming(fn) {
    return function(...args) {
        let start = performance.now();
        let result = fn.apply(this, args);
        let end = performance.now();
        console.log(`${fn.name} took ${(end - start).toFixed(2)}ms`);
        return result;
    };
}

function add(a, b) {
    return a + b;
}

let loggedAdd = withLogging(add);
let timedLoggedAdd = withTiming(loggedAdd);
timedLoggedAdd(2, 3);

// Caching decorator
function withCache(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache.has(key)) {
            console.log(''Cache hit'');
            return cache.get(key);
        }
        console.log(''Cache miss'');
        let result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

function expensiveOperation(n) {
    let result = 0;
    for (let i = 0; i < n * 100000; i++) {
        result += i;
    }
    return result;
}

let cachedOperation = withCache(expensiveOperation);
cachedOperation(10);
cachedOperation(10);  // Uses cache
```

**Expected Output**:
```
=== Structural Patterns Practice ===

=== Module Pattern ===
Calculator history: [array]
Users: [array]

=== Facade Pattern ===
CPU starting...
Memory loading...
Hard drive reading...
Computer started

=== Decorator Pattern ===
Coffee description: Coffee, Milk, Sugar
Coffee cost: 6.5
Calling add with: [2, 3]
Result: 5
add took [time]ms
Cache miss
Cache hit
```

**Challenge (Optional)**:
- Build a complete application using all three patterns
- Create a plugin system
- Build a middleware system
- Practice combining patterns

---

## Common Mistakes

### 1. Exposing Private Members

```javascript
// ⚠️ Problem: Private members exposed
const Module = (function() {
    let private = ''secret'';
    return {
        private: private  // Exposed!
    };
})();

// ✅ Solution: Keep private
const Module = (function() {
    let private = ''secret'';
    return {
        getPrivate: function() {
            return private;  // Controlled access
        }
    };
})();
```

### 2. Facade Too Complex

```javascript
// ⚠️ Problem: Facade is too complex
class Facade {
    // Too many responsibilities
}

// ✅ Solution: Keep facade simple
class Facade {
    // Simple interface to complex system
}
```

### 3. Decorator Not Preserving Interface

```javascript
// ⚠️ Problem: Changes interface
class Decorator {
    newMethod() { }  // Adds new method
}

// ✅ Solution: Preserve interface
class Decorator {
    // Same interface as decorated object
}
```

---

## Key Takeaways

1. **Module**: Encapsulate private and public members
2. **Facade**: Simplify complex interfaces
3. **Decorator**: Add behavior dynamically
4. **When to Use**: Choose based on organization needs
5. **Best Practice**: Keep patterns simple and focused
6. **Privacy**: Use closures or private fields for privacy
7. **Interface**: Decorators should preserve interface

---

## Quiz: Structural Patterns

Test your understanding with these questions:

1. **Module pattern provides:**
   - A) Public members only
   - B) Private and public members
   - C) No members
   - D) Random

2. **Facade pattern:**
   - A) Simplifies interface
   - B) Complicates interface
   - C) Removes interface
   - D) Nothing

3. **Decorator pattern:**
   - A) Adds behavior
   - B) Removes behavior
   - C) Modifies structure
   - D) Nothing

4. **Module uses:**
   - A) Closures
   - B) Classes only
   - C) Functions only
   - D) Nothing

5. **Facade hides:**
   - A) Complexity
   - B) Simplicity
   - C) Nothing
   - D) Everything

6. **Decorator preserves:**
   - A) Interface
   - B) Implementation
   - C) Both
   - D) Neither

7. **Structural patterns help:**
   - A) Code organization
   - B) Code destruction
   - C) Code modification
   - D) Nothing

**Answers**:
1. B) Private and public members
2. A) Simplifies interface
3. A) Adds behavior
4. A) Closures
5. A) Complexity
6. A) Interface
7. A) Code organization

---

## Next Steps

Congratulations! You''ve learned structural patterns. You now know:
- How to create modules
- How to build facades
- How to implement decorators
- When to use each pattern

**What''s Next?**
- Lesson 19.3: Behavioral Patterns
- Learn Observer pattern
- Understand Strategy pattern
- Work with Command pattern

---

## Additional Resources

- **MDN: Closures**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Closures](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures)
- **Design Patterns**: [refactoring.guru/design-patterns](https://refactoring.guru/design-patterns)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 09:59:25', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand structural design patterns
- Implement the Module pattern
- Implement the Facade pattern
- Implement the Decorator pattern
- Choose appropriate patterns
- Apply patterns to organize code
- Build maintainable code structures');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (159, 59, 14, 'Behavioral Patterns', 'behavioral-patterns', '# Lesson 19.3: Behavioral Patterns

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand behavioral design patterns
- Implement the Observer pattern
- Implement the Strategy pattern
- Implement the Command pattern
- Choose appropriate patterns
- Apply patterns to solve problems
- Build flexible communication systems

---

## Introduction to Behavioral Patterns

Behavioral patterns focus on communication between objects and how responsibilities are distributed.

### Why Behavioral Patterns?

- **Communication**: Better object communication
- **Flexibility**: Easier to change behavior
- **Reusability**: Reuse communication patterns
- **Maintainability**: Clearer responsibilities
- **Decoupling**: Reduce dependencies
- **Best Practices**: Proven communication solutions

### Common Behavioral Patterns

1. **Observer**: Notify multiple objects of changes
2. **Strategy**: Encapsulate algorithms
3. **Command**: Encapsulate requests

---

## Observer Pattern

### What is Observer?

Observer defines a one-to-many dependency between objects so when one changes, all dependents are notified.

### Basic Observer

```javascript
class Subject {
    constructor() {
        this.observers = [];
    }
    
    subscribe(observer) {
        this.observers.push(observer);
    }
    
    unsubscribe(observer) {
        this.observers = this.observers.filter(obs => obs !== observer);
    }
    
    notify(data) {
        this.observers.forEach(observer => observer.update(data));
    }
}

class Observer {
    constructor(name) {
        this.name = name;
    }
    
    update(data) {
        console.log(`${this.name} received:`, data);
    }
}

// Usage
let subject = new Subject();
let observer1 = new Observer(''Observer 1'');
let observer2 = new Observer(''Observer 2'');

subject.subscribe(observer1);
subject.subscribe(observer2);

subject.notify(''Hello'');
// Observer 1 received: Hello
// Observer 2 received: Hello
```

### Observer with Events

```javascript
class EventEmitter {
    constructor() {
        this.events = {};
    }
    
    on(event, callback) {
        if (!this.events[event]) {
            this.events[event] = [];
        }
        this.events[event].push(callback);
    }
    
    off(event, callback) {
        if (this.events[event]) {
            this.events[event] = this.events[event].filter(cb => cb !== callback);
        }
    }
    
    emit(event, data) {
        if (this.events[event]) {
            this.events[event].forEach(callback => callback(data));
        }
    }
}

// Usage
let emitter = new EventEmitter();

emitter.on(''userLogin'', (user) => {
    console.log(''User logged in:'', user);
});

emitter.on(''userLogin'', (user) => {
    console.log(''Sending welcome email to:'', user.email);
});

emitter.emit(''userLogin'', { name: ''Alice'', email: ''alice@example.com'' });
```

### Practical Observer Example

```javascript
class Stock {
    constructor(symbol, price) {
        this.symbol = symbol;
        this.price = price;
        this.observers = [];
    }
    
    subscribe(observer) {
        this.observers.push(observer);
    }
    
    unsubscribe(observer) {
        this.observers = this.observers.filter(obs => obs !== observer);
    }
    
    setPrice(price) {
        if (this.price !== price) {
            this.price = price;
            this.notify();
        }
    }
    
    notify() {
        this.observers.forEach(observer => {
            observer.update(this.symbol, this.price);
        });
    }
}

class PriceDisplay {
    constructor() {
        this.prices = {};
    }
    
    update(symbol, price) {
        this.prices[symbol] = price;
        console.log(`${symbol}: $${price}`);
    }
    
    getPrice(symbol) {
        return this.prices[symbol];
    }
}

// Usage
let stock = new Stock(''AAPL'', 150);
let display = new PriceDisplay();

stock.subscribe(display);
stock.setPrice(155);  // AAPL: $155
stock.setPrice(160);  // AAPL: $160
```

---

## Strategy Pattern

### What is Strategy?

Strategy defines a family of algorithms, encapsulates each, and makes them interchangeable.

### Basic Strategy

```javascript
// Strategy interface
class PaymentStrategy {
    pay(amount) {
        throw new Error(''Method must be implemented'');
    }
}

// Concrete strategies
class CreditCardStrategy extends PaymentStrategy {
    constructor(cardNumber, cvv) {
        super();
        this.cardNumber = cardNumber;
        this.cvv = cvv;
    }
    
    pay(amount) {
        console.log(`Paid $${amount} using credit card ${this.cardNumber}`);
    }
}

class PayPalStrategy extends PaymentStrategy {
    constructor(email) {
        super();
        this.email = email;
    }
    
    pay(amount) {
        console.log(`Paid $${amount} using PayPal ${this.email}`);
    }
}

class BitcoinStrategy extends PaymentStrategy {
    constructor(walletAddress) {
        super();
        this.walletAddress = walletAddress;
    }
    
    pay(amount) {
        console.log(`Paid $${amount} using Bitcoin ${this.walletAddress}`);
    }
}

// Context
class PaymentProcessor {
    constructor(strategy) {
        this.strategy = strategy;
    }
    
    setStrategy(strategy) {
        this.strategy = strategy;
    }
    
    processPayment(amount) {
        this.strategy.pay(amount);
    }
}

// Usage
let processor = new PaymentProcessor(new CreditCardStrategy(''1234-5678'', ''123''));
processor.processPayment(100);

processor.setStrategy(new PayPalStrategy(''alice@example.com''));
processor.processPayment(200);
```

### Strategy with Functions

```javascript
// Strategy as functions
let strategies = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => {
        if (b === 0) throw new Error(''Division by zero'');
        return a / b;
    }
};

class Calculator {
    constructor() {
        this.strategy = strategies.add;
    }
    
    setStrategy(operation) {
        if (strategies[operation]) {
            this.strategy = strategies[operation];
        } else {
            throw new Error(''Unknown operation'');
        }
    }
    
    calculate(a, b) {
        return this.strategy(a, b);
    }
}

// Usage
let calc = new Calculator();
console.log(calc.calculate(10, 5));  // 15

calc.setStrategy(''multiply'');
console.log(calc.calculate(10, 5));  // 50
```

### Practical Strategy Example

```javascript
// Sorting strategies
class SortStrategy {
    sort(array) {
        throw new Error(''Method must be implemented'');
    }
}

class BubbleSort extends SortStrategy {
    sort(array) {
        let arr = [...array];
        for (let i = 0; i < arr.length; i++) {
            for (let j = 0; j < arr.length - i - 1; j++) {
                if (arr[j] > arr[j + 1]) {
                    [arr[j], arr[j + 1]] = [arr[j + 1], arr[j]];
                }
            }
        }
        return arr;
    }
}

class QuickSort extends SortStrategy {
    sort(array) {
        if (array.length <= 1) return array;
        let pivot = array[Math.floor(array.length / 2)];
        let left = array.filter(x => x < pivot);
        let middle = array.filter(x => x === pivot);
        let right = array.filter(x => x > pivot);
        return [...this.sort(left), ...middle, ...this.sort(right)];
    }
}

class Sorter {
    constructor(strategy) {
        this.strategy = strategy;
    }
    
    setStrategy(strategy) {
        this.strategy = strategy;
    }
    
    sort(array) {
        return this.strategy.sort(array);
    }
}

// Usage
let numbers = [64, 34, 25, 12, 22, 11, 90];
let sorter = new Sorter(new BubbleSort());
console.log(''Bubble sort:'', sorter.sort(numbers));

sorter.setStrategy(new QuickSort());
console.log(''Quick sort:'', sorter.sort(numbers));
```

---

## Command Pattern

### What is Command?

Command encapsulates a request as an object, allowing parameterization and queuing of requests.

### Basic Command

```javascript
// Command interface
class Command {
    execute() {
        throw new Error(''Method must be implemented'');
    }
    
    undo() {
        throw new Error(''Method must be implemented'');
    }
}

// Concrete commands
class LightOnCommand extends Command {
    constructor(light) {
        super();
        this.light = light;
    }
    
    execute() {
        this.light.turnOn();
    }
    
    undo() {
        this.light.turnOff();
    }
}

class LightOffCommand extends Command {
    constructor(light) {
        super();
        this.light = light;
    }
    
    execute() {
        this.light.turnOff();
    }
    
    undo() {
        this.light.turnOn();
    }
}

// Receiver
class Light {
    turnOn() {
        console.log(''Light is ON'');
    }
    
    turnOff() {
        console.log(''Light is OFF'');
    }
}

// Invoker
class RemoteControl {
    constructor() {
        this.command = null;
        this.history = [];
    }
    
    setCommand(command) {
        this.command = command;
    }
    
    pressButton() {
        if (this.command) {
            this.command.execute();
            this.history.push(this.command);
        }
    }
    
    undo() {
        if (this.history.length > 0) {
            let lastCommand = this.history.pop();
            lastCommand.undo();
        }
    }
}

// Usage
let light = new Light();
let lightOn = new LightOnCommand(light);
let lightOff = new LightOffCommand(light);

let remote = new RemoteControl();
remote.setCommand(lightOn);
remote.pressButton();  // Light is ON

remote.setCommand(lightOff);
remote.pressButton();  // Light is OFF

remote.undo();  // Light is ON
```

### Command with Queue

```javascript
class CommandQueue {
    constructor() {
        this.queue = [];
        this.executing = false;
    }
    
    add(command) {
        this.queue.push(command);
        if (!this.executing) {
            this.executeNext();
        }
    }
    
    async executeNext() {
        if (this.queue.length === 0) {
            this.executing = false;
            return;
        }
        
        this.executing = true;
        let command = this.queue.shift();
        await command.execute();
        this.executeNext();
    }
}

// Usage
class DelayCommand {
    constructor(delay, message) {
        this.delay = delay;
        this.message = message;
    }
    
    async execute() {
        return new Promise(resolve => {
            setTimeout(() => {
                console.log(this.message);
                resolve();
            }, this.delay);
        });
    }
}

let queue = new CommandQueue();
queue.add(new DelayCommand(1000, ''First''));
queue.add(new DelayCommand(500, ''Second''));
queue.add(new DelayCommand(200, ''Third''));
// Executes in order
```

### Practical Command Example

```javascript
// Text editor commands
class TextEditor {
    constructor() {
        this.content = '''';
        this.history = [];
    }
    
    write(text) {
        this.content += text;
    }
    
    delete(length) {
        this.content = this.content.slice(0, -length);
    }
    
    getContent() {
        return this.content;
    }
}

class WriteCommand {
    constructor(editor, text) {
        this.editor = editor;
        this.text = text;
    }
    
    execute() {
        this.editor.write(this.text);
        this.editor.history.push(this);
    }
    
    undo() {
        this.editor.delete(this.text.length);
    }
}

class DeleteCommand {
    constructor(editor, length) {
        this.editor = editor;
        this.length = length;
        this.deletedText = '''';
    }
    
    execute() {
        this.deletedText = this.editor.content.slice(-this.length);
        this.editor.delete(this.length);
        this.editor.history.push(this);
    }
    
    undo() {
        this.editor.write(this.deletedText);
    }
}

// Usage
let editor = new TextEditor();
let writeHello = new WriteCommand(editor, ''Hello'');
let writeWorld = new WriteCommand(editor, '' World'');

writeHello.execute();
writeWorld.execute();
console.log(editor.getContent());  // ''Hello World''

let lastCommand = editor.history.pop();
lastCommand.undo();
console.log(editor.getContent());  // ''Hello''
```

---

## Practice Exercise

### Exercise: Behavioral Patterns

**Objective**: Practice implementing Observer, Strategy, and Command patterns.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Creating observers
   - Implementing strategies
   - Building commands
   - Applying patterns to real problems

**Example Solution**:

```javascript
// behavioral-patterns-practice.js
console.log("=== Behavioral Patterns Practice ===");

console.log("\\n=== Observer Pattern ===");

// Basic Observer
class Subject {
    constructor() {
        this.observers = [];
    }
    
    subscribe(observer) {
        this.observers.push(observer);
    }
    
    unsubscribe(observer) {
        this.observers = this.observers.filter(obs => obs !== observer);
    }
    
    notify(data) {
        this.observers.forEach(observer => observer.update(data));
    }
}

class Observer {
    constructor(name) {
        this.name = name;
    }
    
    update(data) {
        console.log(`${this.name} received:`, data);
    }
}

let subject = new Subject();
let observer1 = new Observer(''Observer 1'');
let observer2 = new Observer(''Observer 2'');

subject.subscribe(observer1);
subject.subscribe(observer2);

subject.notify(''Hello'');
subject.unsubscribe(observer1);
subject.notify(''World'');

// Event Emitter
class EventEmitter {
    constructor() {
        this.events = {};
    }
    
    on(event, callback) {
        if (!this.events[event]) {
            this.events[event] = [];
        }
        this.events[event].push(callback);
    }
    
    off(event, callback) {
        if (this.events[event]) {
            this.events[event] = this.events[event].filter(cb => cb !== callback);
        }
    }
    
    emit(event, data) {
        if (this.events[event]) {
            this.events[event].forEach(callback => callback(data));
        }
    }
}

let emitter = new EventEmitter();

emitter.on(''userLogin'', (user) => {
    console.log(''User logged in:'', user.name);
});

emitter.on(''userLogin'', (user) => {
    console.log(''Sending email to:'', user.email);
});

emitter.emit(''userLogin'', { name: ''Alice'', email: ''alice@example.com'' });
console.log();

console.log("=== Strategy Pattern ===");

// Payment strategies
class PaymentStrategy {
    pay(amount) {
        throw new Error(''Method must be implemented'');
    }
}

class CreditCardStrategy extends PaymentStrategy {
    constructor(cardNumber) {
        super();
        this.cardNumber = cardNumber;
    }
    
    pay(amount) {
        console.log(`Paid $${amount} using credit card ${this.cardNumber}`);
    }
}

class PayPalStrategy extends PaymentStrategy {
    constructor(email) {
        super();
        this.email = email;
    }
    
    pay(amount) {
        console.log(`Paid $${amount} using PayPal ${this.email}`);
    }
}

class PaymentProcessor {
    constructor(strategy) {
        this.strategy = strategy;
    }
    
    setStrategy(strategy) {
        this.strategy = strategy;
    }
    
    processPayment(amount) {
        this.strategy.pay(amount);
    }
}

let processor = new PaymentProcessor(new CreditCardStrategy(''1234-5678''));
processor.processPayment(100);

processor.setStrategy(new PayPalStrategy(''alice@example.com''));
processor.processPayment(200);

// Function strategies
let strategies = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => {
        if (b === 0) throw new Error(''Division by zero'');
        return a / b;
    }
};

class Calculator {
    constructor() {
        this.strategy = strategies.add;
    }
    
    setStrategy(operation) {
        if (strategies[operation]) {
            this.strategy = strategies[operation];
        } else {
            throw new Error(''Unknown operation'');
        }
    }
    
    calculate(a, b) {
        return this.strategy(a, b);
    }
}

let calc = new Calculator();
console.log(''10 + 5 ='', calc.calculate(10, 5));

calc.setStrategy(''multiply'');
console.log(''10 * 5 ='', calc.calculate(10, 5));
console.log();

console.log("=== Command Pattern ===");

// Basic Command
class Command {
    execute() {
        throw new Error(''Method must be implemented'');
    }
    
    undo() {
        throw new Error(''Method must be implemented'');
    }
}

class LightOnCommand extends Command {
    constructor(light) {
        super();
        this.light = light;
    }
    
    execute() {
        this.light.turnOn();
    }
    
    undo() {
        this.light.turnOff();
    }
}

class LightOffCommand extends Command {
    constructor(light) {
        super();
        this.light = light;
    }
    
    execute() {
        this.light.turnOff();
    }
    
    undo() {
        this.light.turnOn();
    }
}

class Light {
    turnOn() {
        console.log(''Light is ON'');
    }
    
    turnOff() {
        console.log(''Light is OFF'');
    }
}

class RemoteControl {
    constructor() {
        this.history = [];
    }
    
    executeCommand(command) {
        command.execute();
        this.history.push(command);
    }
    
    undo() {
        if (this.history.length > 0) {
            let lastCommand = this.history.pop();
            lastCommand.undo();
        }
    }
}

let light = new Light();
let remote = new RemoteControl();

remote.executeCommand(new LightOnCommand(light));
remote.executeCommand(new LightOffCommand(light));
remote.undo();

// Text Editor Commands
class TextEditor {
    constructor() {
        this.content = '''';
        this.history = [];
    }
    
    write(text) {
        this.content += text;
    }
    
    delete(length) {
        this.content = this.content.slice(0, -length);
    }
    
    getContent() {
        return this.content;
    }
}

class WriteCommand {
    constructor(editor, text) {
        this.editor = editor;
        this.text = text;
    }
    
    execute() {
        this.editor.write(this.text);
        this.editor.history.push(this);
    }
    
    undo() {
        this.editor.delete(this.text.length);
    }
}

let editor = new TextEditor();
let writeHello = new WriteCommand(editor, ''Hello'');
let writeWorld = new WriteCommand(editor, '' World'');

writeHello.execute();
writeWorld.execute();
console.log(''Content:'', editor.getContent());

let lastCommand = editor.history.pop();
lastCommand.undo();
console.log(''After undo:'', editor.getContent());
```

**Expected Output**:
```
=== Behavioral Patterns Practice ===

=== Observer Pattern ===
Observer 1 received: Hello
Observer 2 received: Hello
Observer 2 received: World
User logged in: Alice
Sending email to: alice@example.com

=== Strategy Pattern ===
Paid $100 using credit card 1234-5678
Paid $200 using PayPal alice@example.com
10 + 5 = 15
10 * 5 = 50

=== Command Pattern ===
Light is ON
Light is OFF
Light is ON
Content: Hello World
After undo: Hello
```

**Challenge (Optional)**:
- Build a complete application using all three patterns
- Create an event system
- Build a plugin system
- Practice combining patterns

---

## Common Mistakes

### 1. Observer Memory Leaks

```javascript
// ⚠️ Problem: Observers not removed
subject.subscribe(observer);
// Observer never unsubscribed

// ✅ Solution: Always unsubscribe
subject.subscribe(observer);
// Later...
subject.unsubscribe(observer);
```

### 2. Strategy Not Swappable

```javascript
// ⚠️ Problem: Strategy hardcoded
class Processor {
    process() {
        // Hardcoded strategy
    }
}

// ✅ Solution: Make strategy swappable
class Processor {
    constructor(strategy) {
        this.strategy = strategy;
    }
    
    setStrategy(strategy) {
        this.strategy = strategy;
    }
}
```

### 3. Command Without Undo

```javascript
// ⚠️ Problem: No undo capability
class Command {
    execute() { }
    // Missing undo
}

// ✅ Solution: Implement undo
class Command {
    execute() { }
    undo() { }
}
```

---

## Key Takeaways

1. **Observer**: Notify multiple objects of changes
2. **Strategy**: Encapsulate interchangeable algorithms
3. **Command**: Encapsulate requests as objects
4. **When to Use**: Choose based on communication needs
5. **Best Practice**: Keep patterns simple and focused
6. **Memory**: Unsubscribe observers to prevent leaks
7. **Flexibility**: Patterns enable runtime behavior changes

---

## Quiz: Behavioral Patterns

Test your understanding with these questions:

1. **Observer pattern:**
   - A) One-to-many dependency
   - B) Many-to-one dependency
   - C) One-to-one
   - D) None

2. **Strategy pattern:**
   - A) Encapsulates algorithms
   - B) Encapsulates data
   - C) Encapsulates nothing
   - D) Random

3. **Command pattern:**
   - A) Encapsulates requests
   - B) Encapsulates responses
   - C) Encapsulates nothing
   - D) Random

4. **Observer subscribe:**
   - A) Adds observer
   - B) Removes observer
   - C) Notifies observer
   - D) Nothing

5. **Strategy is:**
   - A) Swappable
   - B) Fixed
   - C) Random
   - D) None

6. **Command can:**
   - A) Execute
   - B) Undo
   - C) Both
   - D) Neither

7. **Behavioral patterns focus on:**
   - A) Communication
   - B) Creation
   - C) Structure
   - D) Nothing

**Answers**:
1. A) One-to-many dependency
2. A) Encapsulates algorithms
3. A) Encapsulates requests
4. A) Adds observer
5. A) Swappable
6. C) Both
7. A) Communication

---

## Next Steps

Congratulations! You''ve completed Module 19: Design Patterns. You now know:
- Creational patterns (Singleton, Factory, Builder)
- Structural patterns (Module, Facade, Decorator)
- Behavioral patterns (Observer, Strategy, Command)
- When to use each pattern

**What''s Next?**
- Module 20: Error Handling and Debugging
- Lesson 20.1: Advanced Error Handling
- Learn error types and handling strategies
- Build robust error handling

---

## Additional Resources

- **MDN: Error Handling**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Control_flow_and_error_handling](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Control_flow_and_error_handling)
- **Design Patterns**: [refactoring.guru/design-patterns](https://refactoring.guru/design-patterns)

---

*Lesson completed! You''ve finished Module 19: Design Patterns. Ready for Module 20: Error Handling and Debugging!*

', NULL, 3, '2026-01-03 09:59:25', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand behavioral design patterns
- Implement the Observer pattern
- Implement the Strategy pattern
- Implement the Command pattern
- Choose appropriate patterns
- Apply patterns to solve problems
- Build flexible communication systems');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (162, 60, 14, 'Advanced Error Handling', 'advanced-error-handling', '# Lesson 20.1: Advanced Error Handling

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand different error types
- Create custom error classes
- Implement error handling strategies
- Set up global error handling
- Handle errors in async code
- Build robust error handling systems
- Write more reliable code

---

## Introduction to Error Handling

Error handling is crucial for building robust applications. Proper error handling improves user experience and makes debugging easier.

### Why Error Handling?

- **User Experience**: Graceful error messages
- **Debugging**: Easier to find and fix issues
- **Reliability**: Applications don''t crash unexpectedly
- **Maintainability**: Clear error information
- **Best Practices**: Professional code quality
- **Production Ready**: Handle edge cases

---

## Error Types

### Built-in Error Types

```javascript
// Error (base class)
try {
    throw new Error(''Something went wrong'');
} catch (error) {
    console.log(error.name);      // ''Error''
    console.log(error.message);    // ''Something went wrong''
    console.log(error.stack);      // Stack trace
}

// TypeError
try {
    null.someProperty;
} catch (error) {
    console.log(error.name);      // ''TypeError''
}

// ReferenceError
try {
    console.log(undefinedVariable);
} catch (error) {
    console.log(error.name);      // ''ReferenceError''
}

// SyntaxError
try {
    eval(''invalid syntax {'');
} catch (error) {
    console.log(error.name);      // ''SyntaxError''
}

// RangeError
try {
    let arr = new Array(-1);
} catch (error) {
    console.log(error.name);      // ''RangeError''
}
```

### Common Error Types

```javascript
// TypeError: Wrong type
let num = ''hello'';
num.toUpperCase();  // Works
num.toFixed();      // TypeError: num.toFixed is not a function

// ReferenceError: Variable doesn''t exist
console.log(undefinedVar);  // ReferenceError

// SyntaxError: Invalid syntax
// let x = {;  // SyntaxError

// RangeError: Out of range
let arr = new Array(-1);  // RangeError

// URIError: Invalid URI
decodeURIComponent(''%'');  // URIError
```

---

## Custom Errors

### Basic Custom Error

```javascript
class CustomError extends Error {
    constructor(message) {
        super(message);
        this.name = ''CustomError'';
        Error.captureStackTrace(this, this.constructor);
    }
}

try {
    throw new CustomError(''Custom error message'');
} catch (error) {
    console.log(error.name);      // ''CustomError''
    console.log(error.message);    // ''Custom error message''
}
```

### Custom Error with Additional Properties

```javascript
class ValidationError extends Error {
    constructor(message, field, value) {
        super(message);
        this.name = ''ValidationError'';
        this.field = field;
        this.value = value;
        Error.captureStackTrace(this, this.constructor);
    }
}

try {
    throw new ValidationError(''Invalid email'', ''email'', ''invalid'');
} catch (error) {
    if (error instanceof ValidationError) {
        console.log(`Field: ${error.field}`);
        console.log(`Value: ${error.value}`);
        console.log(`Message: ${error.message}`);
    }
}
```

### Multiple Custom Error Types

```javascript
class NetworkError extends Error {
    constructor(message, statusCode) {
        super(message);
        this.name = ''NetworkError'';
        this.statusCode = statusCode;
    }
}

class AuthenticationError extends Error {
    constructor(message) {
        super(message);
        this.name = ''AuthenticationError'';
    }
}

class NotFoundError extends Error {
    constructor(resource) {
        super(`${resource} not found`);
        this.name = ''NotFoundError'';
        this.resource = resource;
    }
}

// Usage
try {
    throw new NetworkError(''Connection failed'', 500);
} catch (error) {
    if (error instanceof NetworkError) {
        console.log(`Network error: ${error.message} (${error.statusCode})`);
    } else if (error instanceof AuthenticationError) {
        console.log(''Authentication failed'');
    } else if (error instanceof NotFoundError) {
        console.log(`${error.resource} not found`);
    }
}
```

---

## Error Handling Strategies

### Try-Catch-Finally

```javascript
function riskyOperation() {
    try {
        // Code that might throw
        let result = someFunction();
        return result;
    } catch (error) {
        // Handle error
        console.error(''Error occurred:'', error.message);
        throw error;  // Re-throw if needed
    } finally {
        // Always executes
        console.log(''Cleanup code'');
    }
}
```

### Error Handling in Functions

```javascript
function divide(a, b) {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
}

function safeDivide(a, b) {
    try {
        return divide(a, b);
    } catch (error) {
        console.error(''Division error:'', error.message);
        return null;  // Or return default value
    }
}

console.log(safeDivide(10, 2));   // 5
console.log(safeDivide(10, 0));  // null (error handled)
```

### Error Handling in Async Code

```javascript
// Async function with try-catch
async function fetchData(url) {
    try {
        let response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return await response.json();
    } catch (error) {
        console.error(''Fetch error:'', error.message);
        throw error;
    }
}

// Promise with catch
fetchData(''/api/data'')
    .then(data => {
        console.log(''Data:'', data);
    })
    .catch(error => {
        console.error(''Error:'', error.message);
    });
```

### Error Handling Patterns

```javascript
// Pattern 1: Return error object
function safeOperation() {
    try {
        let result = riskyOperation();
        return { success: true, data: result };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

// Pattern 2: Throw and handle
function operation() {
    try {
        return riskyOperation();
    } catch (error) {
        // Log error
        console.error(error);
        // Re-throw or handle
        throw error;
    }
}

// Pattern 3: Default values
function getValue(key) {
    try {
        return getValueFromSource(key);
    } catch (error) {
        return defaultValue;  // Return default
    }
}
```

---

## Global Error Handling

### Window Error Handler

```javascript
// Global error handler
window.addEventListener(''error'', function(event) {
    console.error(''Global error:'', event.error);
    console.error(''Message:'', event.message);
    console.error(''Source:'', event.filename);
    console.error(''Line:'', event.lineno);
    console.error(''Column:'', event.colno);
    
    // Send to error tracking service
    // sendToErrorTracking(event.error);
    
    // Prevent default error handling
    // event.preventDefault();
});

// Unhandled promise rejection
window.addEventListener(''unhandledrejection'', function(event) {
    console.error(''Unhandled promise rejection:'', event.reason);
    
    // Send to error tracking
    // sendToErrorTracking(event.reason);
    
    // Prevent default handling
    // event.preventDefault();
});
```

### Node.js Error Handling

```javascript
// Node.js global handlers
process.on(''uncaughtException'', (error) => {
    console.error(''Uncaught exception:'', error);
    // Cleanup and exit
    process.exit(1);
});

process.on(''unhandledRejection'', (reason, promise) => {
    console.error(''Unhandled rejection:'', reason);
    // Handle or exit
});
```

### Error Boundary (React)

```javascript
class ErrorBoundary extends React.Component {
    constructor(props) {
        super(props);
        this.state = { hasError: false, error: null };
    }
    
    static getDerivedStateFromError(error) {
        return { hasError: true, error };
    }
    
    componentDidCatch(error, errorInfo) {
        console.error(''Error caught:'', error, errorInfo);
        // Log to error tracking service
    }
    
    render() {
        if (this.state.hasError) {
            return <h1>Something went wrong.</h1>;
        }
        return this.props.children;
    }
}
```

---

## Error Handling Best Practices

### 1. Be Specific

```javascript
// ❌ Bad: Generic error
throw new Error(''Error'');

// ✅ Good: Specific error
throw new ValidationError(''Email is required'', ''email'');
```

### 2. Don''t Swallow Errors

```javascript
// ❌ Bad: Swallowing error
try {
    riskyOperation();
} catch (error) {
    // Silent failure
}

// ✅ Good: Handle or log
try {
    riskyOperation();
} catch (error) {
    console.error(''Error:'', error);
    // Handle appropriately
}
```

### 3. Use Appropriate Error Types

```javascript
// ❌ Bad: Wrong error type
throw new Error(''Network error'');

// ✅ Good: Specific error type
throw new NetworkError(''Connection failed'', 500);
```

### 4. Provide Context

```javascript
// ❌ Bad: No context
throw new Error(''Failed'');

// ✅ Good: With context
throw new Error(`Failed to fetch user ${userId}: ${error.message}`);
```

### 5. Handle Errors at Appropriate Level

```javascript
// Handle at the right level
async function processUser(userId) {
    try {
        let user = await fetchUser(userId);
        return processUserData(user);
    } catch (error) {
        // Handle at this level
        if (error instanceof NotFoundError) {
            return null;  // User not found
        }
        throw error;  // Re-throw other errors
    }
}
```

---

## Practice Exercise

### Exercise: Error Handling

**Objective**: Practice creating custom errors, implementing error handling strategies, and setting up global error handling.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Creating custom error classes
   - Implementing error handling
   - Setting up global handlers
   - Handling async errors

**Example Solution**:

```javascript
// error-handling-practice.js
console.log("=== Error Handling Practice ===");

console.log("\\n=== Built-in Error Types ===");

// Error
try {
    throw new Error(''Something went wrong'');
} catch (error) {
    console.log(''Error:'', error.name, error.message);
}

// TypeError
try {
    let num = ''hello'';
    num.toFixed();
} catch (error) {
    console.log(''TypeError:'', error.name);
}

// ReferenceError
try {
    console.log(undefinedVar);
} catch (error) {
    console.log(''ReferenceError:'', error.name);
}
console.log();

console.log("=== Custom Errors ===");

// Basic custom error
class CustomError extends Error {
    constructor(message) {
        super(message);
        this.name = ''CustomError'';
        Error.captureStackTrace(this, this.constructor);
    }
}

try {
    throw new CustomError(''Custom error message'');
} catch (error) {
    console.log(''Custom error:'', error.name, error.message);
}

// Validation error
class ValidationError extends Error {
    constructor(message, field, value) {
        super(message);
        this.name = ''ValidationError'';
        this.field = field;
        this.value = value;
    }
}

try {
    throw new ValidationError(''Invalid email'', ''email'', ''invalid'');
} catch (error) {
    if (error instanceof ValidationError) {
        console.log(`Validation error: ${error.field} = ${error.value}`);
    }
}

// Network error
class NetworkError extends Error {
    constructor(message, statusCode) {
        super(message);
        this.name = ''NetworkError'';
        this.statusCode = statusCode;
    }
}

// Authentication error
class AuthenticationError extends Error {
    constructor(message) {
        super(message);
        this.name = ''AuthenticationError'';
    }
}

// Not found error
class NotFoundError extends Error {
    constructor(resource) {
        super(`${resource} not found`);
        this.name = ''NotFoundError'';
        this.resource = resource;
    }
}

// Error handler
function handleError(error) {
    if (error instanceof ValidationError) {
        console.log(`Validation error in ${error.field}: ${error.message}`);
    } else if (error instanceof NetworkError) {
        console.log(`Network error (${error.statusCode}): ${error.message}`);
    } else if (error instanceof AuthenticationError) {
        console.log(''Authentication failed:'', error.message);
    } else if (error instanceof NotFoundError) {
        console.log(`${error.resource} not found`);
    } else {
        console.log(''Unknown error:'', error.message);
    }
}

try {
    throw new NetworkError(''Connection failed'', 500);
} catch (error) {
    handleError(error);
}
console.log();

console.log("=== Error Handling Strategies ===");

// Try-catch-finally
function riskyOperation() {
    try {
        console.log(''Performing risky operation'');
        // Simulate error
        throw new Error(''Operation failed'');
    } catch (error) {
        console.error(''Error caught:'', error.message);
        throw error;
    } finally {
        console.log(''Cleanup code executed'');
    }
}

try {
    riskyOperation();
} catch (error) {
    console.log(''Error re-thrown and caught'');
}

// Safe operation with default
function safeDivide(a, b) {
    try {
        if (b === 0) {
            throw new Error(''Division by zero'');
        }
        return a / b;
    } catch (error) {
        console.error(''Division error:'', error.message);
        return null;
    }
}

console.log(''safeDivide(10, 2):'', safeDivide(10, 2));
console.log(''safeDivide(10, 0):'', safeDivide(10, 0));

// Return error object pattern
function safeOperation() {
    try {
        let result = 10 / 2;
        return { success: true, data: result };
    } catch (error) {
        return { success: false, error: error.message };
    }
}

let result = safeOperation();
console.log(''Safe operation result:'', result);
console.log();

console.log("=== Async Error Handling ===");

// Async function
async function fetchData(url) {
    try {
        // Simulate fetch
        if (url === ''error'') {
            throw new NetworkError(''Connection failed'', 500);
        }
        return { data: ''success'' };
    } catch (error) {
        console.error(''Fetch error:'', error.message);
        throw error;
    }
}

// Handle async errors
async function handleAsync() {
    try {
        let data = await fetchData(''error'');
        console.log(''Data:'', data);
    } catch (error) {
        handleError(error);
    }
}

handleAsync();

// Promise error handling
fetchData(''error'')
    .then(data => {
        console.log(''Data:'', data);
    })
    .catch(error => {
        handleError(error);
    });
console.log();

console.log("=== Global Error Handling ===");

// Window error handler
window.addEventListener(''error'', function(event) {
    console.error(''Global error:'', event.error);
    console.error(''Message:'', event.message);
    console.error(''Source:'', event.filename);
    console.error(''Line:'', event.lineno);
    
    // In production, send to error tracking
    // sendToErrorTracking({
    //     message: event.message,
    //     source: event.filename,
    //     line: event.lineno,
    //     error: event.error
    // });
});

// Unhandled promise rejection
window.addEventListener(''unhandledrejection'', function(event) {
    console.error(''Unhandled promise rejection:'', event.reason);
    
    // In production, send to error tracking
    // sendToErrorTracking({
    //     type: ''unhandledRejection'',
    //     reason: event.reason
    // });
});
console.log();

console.log("=== Error Handling Utilities ===");

// Error wrapper
function withErrorHandling(fn) {
    return function(...args) {
        try {
            return fn.apply(this, args);
        } catch (error) {
            console.error(`Error in ${fn.name}:`, error.message);
            throw error;
        }
    };
}

function divide(a, b) {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
}

let safeDivide2 = withErrorHandling(divide);
try {
    safeDivide2(10, 0);
} catch (error) {
    console.log(''Error handled by wrapper'');
}

// Retry with error handling
async function retryWithErrorHandling(fn, maxRetries = 3) {
    for (let i = 0; i < maxRetries; i++) {
        try {
            return await fn();
        } catch (error) {
            if (i === maxRetries - 1) {
                throw error;
            }
            console.log(`Retry ${i + 1}/${maxRetries}`);
        }
    }
}

// Error logger
class ErrorLogger {
    static log(error, context = {}) {
        let errorInfo = {
            name: error.name,
            message: error.message,
            stack: error.stack,
            context: context,
            timestamp: new Date().toISOString()
        };
        
        console.error(''Error logged:'', errorInfo);
        
        // In production, send to error tracking service
        // sendToErrorTracking(errorInfo);
    }
}

try {
    throw new ValidationError(''Invalid input'', ''email'', ''test'');
} catch (error) {
    ErrorLogger.log(error, { userId: 123, action: ''login'' });
}
```

**Expected Output**:
```
=== Error Handling Practice ===

=== Built-in Error Types ===
Error: Something went wrong
TypeError: TypeError
ReferenceError: ReferenceError

=== Custom Errors ===
Custom error: CustomError Custom error message
Validation error: email = invalid
Network error (500): Connection failed

=== Error Handling Strategies ===
Performing risky operation
Error caught: Operation failed
Cleanup code executed
Error re-thrown and caught
Division error: Division by zero
safeDivide(10, 2): 5
safeDivide(10, 0): null
Safe operation result: { success: true, data: 5 }

=== Async Error Handling ===
Fetch error: Connection failed
Network error (500): Connection failed
Network error (500): Connection failed

=== Global Error Handling ===
[Global handlers registered]

=== Error Handling Utilities ===
Error in divide: Division by zero
Error handled by wrapper
Error logged: { object }
```

**Challenge (Optional)**:
- Build a complete error handling system
- Create an error tracking service
- Build error recovery mechanisms
- Practice error handling in real applications

---

## Common Mistakes

### 1. Swallowing Errors

```javascript
// ❌ Bad: Error swallowed
try {
    riskyOperation();
} catch (error) {
    // Silent failure
}

// ✅ Good: Handle or log
try {
    riskyOperation();
} catch (error) {
    console.error(''Error:'', error);
    // Handle appropriately
}
```

### 2. Generic Error Messages

```javascript
// ❌ Bad: Generic
throw new Error(''Error'');

// ✅ Good: Specific
throw new ValidationError(''Email is required'', ''email'');
```

### 3. Not Handling Async Errors

```javascript
// ❌ Bad: Unhandled promise rejection
async function fetchData() {
    let response = await fetch(url);
    return response.json();
}
fetchData();  // Error not handled

// ✅ Good: Handle errors
async function fetchData() {
    try {
        let response = await fetch(url);
        return response.json();
    } catch (error) {
        console.error(''Error:'', error);
        throw error;
    }
}
```

---

## Key Takeaways

1. **Error Types**: Use appropriate built-in or custom error types
2. **Custom Errors**: Create specific error classes for better handling
3. **Try-Catch**: Use try-catch-finally for error handling
4. **Async Errors**: Handle errors in async/await and promises
5. **Global Handlers**: Set up global error handlers
6. **Best Practices**: Be specific, provide context, handle appropriately
7. **Error Tracking**: Log errors for debugging and monitoring

---

## Quiz: Error Handling

Test your understanding with these questions:

1. **Error base class:**
   - A) TypeError
   - B) Error
   - C) ReferenceError
   - D) None

2. **Custom errors should:**
   - A) Extend Error
   - B) Not extend anything
   - C) Extend Object
   - D) Nothing

3. **Finally block:**
   - A) Always executes
   - B) Sometimes executes
   - C) Never executes
   - D) Random

4. **Async errors handled with:**
   - A) try-catch
   - B) .catch()
   - C) Both
   - D) Neither

5. **Global error handler:**
   - A) window.addEventListener(''error'')
   - B) window.onerror
   - C) Both
   - D) Neither

6. **Error handling should:**
   - A) Be specific
   - B) Provide context
   - C) Both
   - D) Neither

7. **Swallowing errors:**
   - A) Good practice
   - B) Bad practice
   - C) Sometimes OK
   - D) Always OK

**Answers**:
1. B) Error
2. A) Extend Error
3. A) Always executes
4. C) Both
5. C) Both
6. C) Both
7. B) Bad practice

---

## Next Steps

Congratulations! You''ve learned advanced error handling. You now know:
- Different error types
- How to create custom errors
- Error handling strategies
- Global error handling

**What''s Next?**
- Lesson 20.2: Debugging Techniques
- Learn browser DevTools
- Understand debugging tools
- Master breakpoints and console methods

---

## Additional Resources

- **MDN: Error Handling**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Control_flow_and_error_handling](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Control_flow_and_error_handling)
- **MDN: Error**: [developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:03:01', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand different error types
- Create custom error classes
- Implement error handling strategies
- Set up global error handling
- Handle errors in async code
- Build robust error handling systems
- Write more reliable code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (163, 60, 14, 'Debugging Techniques', 'debugging-techniques', '# Lesson 20.2: Debugging Techniques

## Learning Objectives

By the end of this lesson, you will be able to:
- Use browser DevTools effectively
- Set and use breakpoints
- Use console methods for debugging
- Understand source maps
- Debug JavaScript code efficiently
- Use debugging tools and techniques
- Find and fix bugs faster

---

## Introduction to Debugging

Debugging is the process of finding and fixing bugs in code. Effective debugging skills are essential for every developer.

### Why Debugging Skills Matter?

- **Faster Development**: Find bugs quickly
- **Better Code**: Understand code behavior
- **Problem Solving**: Systematic approach to issues
- **Learning**: Understand how code works
- **Professional**: Essential skill for developers
- **Productivity**: Save time and effort

---

## Browser DevTools

### Opening DevTools

```javascript
// Keyboard shortcuts
// Chrome/Edge: F12 or Ctrl+Shift+I (Windows) / Cmd+Option+I (Mac)
// Firefox: F12 or Ctrl+Shift+I (Windows) / Cmd+Option+I (Mac)
// Safari: Cmd+Option+I (Mac)

// Or right-click → Inspect
```

### DevTools Panels

1. **Elements/Inspector**: HTML and CSS
2. **Console**: JavaScript console
3. **Sources/Debugger**: JavaScript debugging
4. **Network**: Network requests
5. **Application/Storage**: Storage and data
6. **Performance**: Performance profiling
7. **Memory**: Memory profiling

### Console Panel

```javascript
// Open console: Ctrl+Shift+J (Windows) / Cmd+Option+J (Mac)
// Or: F12 → Console tab

// Basic console usage
console.log(''Hello'');
console.error(''Error message'');
console.warn(''Warning message'');
```

---

## Console Methods

### Basic Console Methods

```javascript
// console.log() - General logging
console.log(''Hello'', ''World'', 123);
console.log({ name: ''Alice'', age: 30 });
console.log([1, 2, 3]);

// console.error() - Error messages
console.error(''Error occurred'');
console.error(new Error(''Something went wrong''));

// console.warn() - Warnings
console.warn(''This is a warning'');

// console.info() - Informational messages
console.info(''Information message'');

// console.debug() - Debug messages
console.debug(''Debug information'');
```

### Advanced Console Methods

```javascript
// console.table() - Display data as table
let users = [
    { name: ''Alice'', age: 30, city: ''NYC'' },
    { name: ''Bob'', age: 25, city: ''LA'' },
    { name: ''Charlie'', age: 35, city: ''Chicago'' }
];
console.table(users);

// console.group() - Group related logs
console.group(''User Data'');
console.log(''Name: Alice'');
console.log(''Age: 30'');
console.groupEnd();

// console.groupCollapsed() - Collapsed group
console.groupCollapsed(''Details'');
console.log(''Hidden by default'');
console.groupEnd();

// console.time() - Measure execution time
console.time(''operation'');
// ... code ...
console.timeEnd(''operation'');

// console.count() - Count occurrences
console.count(''counter'');
console.count(''counter'');
console.count(''counter'');  // counter: 3

// console.trace() - Stack trace
function a() {
    b();
}
function b() {
    c();
}
function c() {
    console.trace(''Trace'');
}
a();
```

### Console Formatting

```javascript
// String formatting
console.log(''%s is %d years old'', ''Alice'', 30);
console.log(''%cStyled text'', ''color: red; font-size: 20px'');

// Object formatting
console.log(''%O'', { name: ''Alice'' });  // Full object
console.log(''%o'', { name: ''Alice'' });  // Compact object

// Multiple styles
console.log(
    ''%cRed %cGreen %cBlue'',
    ''color: red'',
    ''color: green'',
    ''color: blue''
);
```

### Console Assertions

```javascript
// console.assert() - Assert conditions
console.assert(1 === 1, ''This will not log'');
console.assert(1 === 2, ''This will log'');  // Assertion failed

// Useful for debugging
function divide(a, b) {
    console.assert(b !== 0, ''Division by zero'');
    return a / b;
}
```

---

## Breakpoints

### Setting Breakpoints

```javascript
// Method 1: In DevTools Sources panel
// 1. Open Sources panel
// 2. Find your file
// 3. Click line number to set breakpoint

// Method 2: Using debugger statement
function myFunction() {
    let x = 10;
    debugger;  // Execution pauses here
    let y = x * 2;
    return y;
}

// Method 3: Conditional breakpoints
// Right-click line number → Add conditional breakpoint
// Enter condition: x > 10
```

### Breakpoint Types

```javascript
// 1. Line breakpoints
// Click line number in Sources panel

// 2. Conditional breakpoints
// Right-click → Add conditional breakpoint
// Condition: variable > value

// 3. Logpoints
// Right-click → Add logpoint
// Log: Variable value without pausing

// 4. DOM breakpoints
// Elements panel → Right-click element → Break on
// - Subtree modifications
// - Attribute modifications
// - Node removal

// 5. Event listener breakpoints
// Sources panel → Event Listener Breakpoints
// Select events to break on
```

### Using Breakpoints

```javascript
// When breakpoint hits:
// 1. Execution pauses
// 2. Inspect variables in Scope panel
// 3. Step through code
// 4. Evaluate expressions in Console

function calculateTotal(items) {
    let total = 0;
    for (let item of items) {
        total += item.price;  // Set breakpoint here
    }
    return total;
}

// Step controls:
// F8: Continue (resume execution)
// F10: Step over (next line)
// F11: Step into (enter function)
// Shift+F11: Step out (exit function)
```

---

## Debugging Techniques

### 1. Step Through Code

```javascript
function processData(data) {
    let processed = [];
    for (let item of data) {
        let result = transform(item);  // Step into here
        processed.push(result);
    }
    return processed;
}

// Use F10 to step over
// Use F11 to step into transform()
```

### 2. Inspect Variables

```javascript
function calculate(a, b, c) {
    let sum = a + b;      // Inspect: sum = 5
    let product = sum * c; // Inspect: product = 15
    return product;
}

// In DevTools:
// - Watch panel: Add variables to watch
// - Scope panel: See all variables in scope
// - Console: Evaluate expressions
```

### 3. Call Stack

```javascript
function a() {
    b();  // Call stack: a → b
}

function b() {
    c();  // Call stack: a → b → c
}

function c() {
    debugger;  // Inspect call stack
}

// Call stack shows:
// - Function call order
// - Where each function was called from
// - Click to navigate to source
```

### 4. Watch Expressions

```javascript
// In DevTools Watch panel:
// Add expressions to watch:
// - variable
// - object.property
// - array[index]
// - function calls

function process(items) {
    let total = 0;
    // Watch: total, items.length, items[0]
    for (let item of items) {
        total += item.value;
    }
    return total;
}
```

---

## Source Maps

### What are Source Maps?

Source maps map minified/transpiled code back to original source code.

### Using Source Maps

```javascript
// In build tools (webpack, babel, etc.)
// Generate source maps:
// webpack.config.js
module.exports = {
    devtool: ''source-map'',  // Generate source maps
    // ...
};

// Source maps allow:
// - Debug original source code
// - See original variable names
// - Set breakpoints in original code
// - See original line numbers
```

### Source Map Types

```javascript
// 1. source-map: Full source map file
// 2. inline-source-map: Inline in bundle
// 3. eval-source-map: Fastest, less accurate
// 4. cheap-source-map: Faster, no column info
// 5. cheap-module-source-map: For loader source maps
```

---

## Network Debugging

### Network Panel

```javascript
// Network panel shows:
// - All network requests
// - Request/response headers
// - Response data
// - Timing information
// - Request/response preview

// Filter requests:
// - By type (XHR, JS, CSS, etc.)
// - By domain
// - By status code
// - By search term

// Inspect request:
// - Click request to see details
// - Headers tab: Request/response headers
// - Preview tab: Formatted response
// - Response tab: Raw response
// - Timing tab: Request timing
```

### Network Debugging Tips

```javascript
// 1. Filter by XHR to see API calls
// 2. Check status codes (200, 404, 500, etc.)
// 3. Inspect request payload
// 4. Check response data
// 5. Look at timing (slow requests)
// 6. Check for CORS errors
// 7. Verify headers (Content-Type, Authorization, etc.)
```

---

## Performance Debugging

### Performance Panel

```javascript
// Performance panel:
// 1. Click Record
// 2. Perform actions
// 3. Stop recording
// 4. Analyze timeline

// Shows:
// - FPS (frames per second)
// - CPU usage
// - Memory usage
// - Function call stack
// - Long tasks
// - Layout shifts
```

### Memory Debugging

```javascript
// Memory panel:
// - Take heap snapshot
// - Compare snapshots
// - Find memory leaks
// - See object sizes
// - Find retained objects

// Common issues:
// - Memory leaks (objects not garbage collected)
// - Large objects
// - Circular references
// - Event listeners not removed
```

---

## Practice Exercise

### Exercise: Debugging Practice

**Objective**: Practice using DevTools, breakpoints, console methods, and debugging techniques.

**Instructions**:

1. Create an HTML file with JavaScript
2. Open DevTools
3. Practice:
   - Using console methods
   - Setting breakpoints
   - Stepping through code
   - Inspecting variables
   - Using network panel
   - Debugging issues

**Example Solution**:

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debugging Practice</title>
</head>
<body>
    <h1>Debugging Practice</h1>
    <button onclick="processData()">Process Data</button>
    <button onclick="fetchData()">Fetch Data</button>
    <div id="output"></div>
    
    <script src="debugging-practice.js"></script>
</body>
</html>
```

```javascript
// debugging-practice.js
console.log("=== Debugging Practice ===");

console.log("\\n=== Console Methods ===");

// Basic logging
console.log(''Hello World'');
console.log(''Number:'', 123);
console.log(''Object:'', { name: ''Alice'', age: 30 });
console.log(''Array:'', [1, 2, 3]);

// Error and warnings
console.error(''This is an error'');
console.warn(''This is a warning'');
console.info(''This is info'');
console.debug(''This is debug'');

// Table
let users = [
    { name: ''Alice'', age: 30, city: ''NYC'' },
    { name: ''Bob'', age: 25, city: ''LA'' },
    { name: ''Charlie'', age: 35, city: ''Chicago'' }
];
console.table(users);

// Grouping
console.group(''User Details'');
console.log(''Name: Alice'');
console.log(''Age: 30'');
console.log(''City: NYC'');
console.groupEnd();

console.groupCollapsed(''Hidden Details'');
console.log(''This is hidden by default'');
console.groupEnd();

// Timing
console.time(''loop'');
for (let i = 0; i < 1000000; i++) {
    // Some operation
}
console.timeEnd(''loop'');

// Counting
console.count(''counter'');
console.count(''counter'');
console.count(''counter'');
console.countReset(''counter'');
console.count(''counter'');

// Trace
function functionA() {
    functionB();
}

function functionB() {
    functionC();
}

function functionC() {
    console.trace(''Call stack trace'');
}

functionA();

// Assertions
console.assert(1 === 1, ''This will not log'');
console.assert(1 === 2, ''Assertion failed: 1 !== 2'');

// Styling
console.log(''%cRed text'', ''color: red; font-size: 20px'');
console.log(''%cRed %cGreen %cBlue'', ''color: red'', ''color: green'', ''color: blue'');
console.log();

console.log("=== Breakpoints ===");

function processData() {
    let data = [1, 2, 3, 4, 5];
    let result = [];
    
    // Set breakpoint here (line number in DevTools)
    for (let i = 0; i < data.length; i++) {
        let value = data[i];
        let doubled = value * 2;  // Set breakpoint here
        result.push(doubled);
    }
    
    // Or use debugger statement
    debugger;
    
    console.log(''Result:'', result);
    document.getElementById(''output'').textContent = result.join('', '');
}

// Conditional breakpoint example
function findMax(numbers) {
    let max = numbers[0];
    
    for (let i = 1; i < numbers.length; i++) {
        // Set conditional breakpoint: numbers[i] > 10
        if (numbers[i] > max) {
            max = numbers[i];
        }
    }
    
    return max;
}

let numbers = [5, 12, 3, 8, 15, 7];
console.log(''Max:'', findMax(numbers));
console.log();

console.log("=== Variable Inspection ===");

function calculateTotal(items) {
    let total = 0;
    let tax = 0.1;
    
    // Watch these variables in DevTools:
    // - total
    // - tax
    // - items.length
    // - items[0].price
    
    for (let item of items) {
        total += item.price;
    }
    
    let totalWithTax = total * (1 + tax);
    
    return {
        subtotal: total,
        tax: total * tax,
        total: totalWithTax
    };
}

let items = [
    { name: ''Apple'', price: 1.00 },
    { name: ''Banana'', price: 0.50 },
    { name: ''Orange'', price: 1.50 }
];

let result = calculateTotal(items);
console.log(''Total:'', result);
console.log();

console.log("=== Call Stack ===");

function level1() {
    console.log(''Level 1'');
    level2();
}

function level2() {
    console.log(''Level 2'');
    level3();
}

function level3() {
    console.log(''Level 3'');
    debugger;  // Inspect call stack here
    console.trace(''Call stack'');
}

level1();
console.log();

console.log("=== Network Debugging ===");

async function fetchData() {
    try {
        // Open Network panel to see this request
        let response = await fetch(''https://jsonplaceholder.typicode.com/posts/1'');
        let data = await response.json();
        console.log(''Fetched data:'', data);
        document.getElementById(''output'').textContent = JSON.stringify(data, null, 2);
    } catch (error) {
        console.error(''Fetch error:'', error);
    }
}

// Uncomment to test network debugging
// fetchData();
console.log();

console.log("=== Error Debugging ===");

function buggyFunction() {
    let x = 10;
    let y = 0;
    
    // This will cause an error
    try {
        let result = x / y;  // Division by zero
        return result;
    } catch (error) {
        console.error(''Error in buggyFunction:'', error);
        console.error(''Stack trace:'', error.stack);
        throw error;
    }
}

// Set breakpoint in catch block to inspect error
try {
    buggyFunction();
} catch (error) {
    console.error(''Caught error:'', error);
}
console.log();

console.log("=== Performance Debugging ===");

function slowOperation() {
    console.time(''slowOperation'');
    
    let result = 0;
    for (let i = 0; i < 10000000; i++) {
        result += i;
    }
    
    console.timeEnd(''slowOperation'');
    return result;
}

// Use Performance panel to profile this
slowOperation();
console.log();

console.log("=== Memory Debugging ===");

// Memory leak example (don''t do this in production)
let memoryLeak = [];

function addToMemoryLeak() {
    for (let i = 0; i < 1000; i++) {
        memoryLeak.push({
            data: new Array(1000).fill(0),
            timestamp: Date.now()
        });
    }
}

// Use Memory panel to take snapshots
// Call addToMemoryLeak() multiple times
// Compare snapshots to find memory leak
console.log(''Memory debugging: Use Memory panel to take snapshots'');
console.log();

console.log("=== Debugging Tips ===");
console.log(''1. Use console.log() strategically'');
console.log(''2. Set breakpoints at key points'');
console.log(''3. Step through code line by line'');
console.log(''4. Inspect variables in Scope panel'');
console.log(''5. Use Watch panel for expressions'');
console.log(''6. Check Call Stack for function flow'');
console.log(''7. Use Network panel for API debugging'');
console.log(''8. Use Performance panel for bottlenecks'');
console.log(''9. Use Memory panel for leaks'');
console.log(''10. Read error messages carefully'');
```

**Expected Output** (in browser console):
```
=== Debugging Practice ===

=== Console Methods ===
Hello World
Number: 123
Object: { name: ''Alice'', age: 30 }
Array: [1, 2, 3]
[Error, warning, info, debug messages]
[Table output]
[Grouped output]
loop: [time]ms
counter: 1
counter: 2
counter: 3
counter: 1
[Call stack trace]
[Assertion messages]
[Styled text]

=== Breakpoints ===
[When breakpoint hits, execution pauses]

=== Variable Inspection ===
Total: { subtotal: 3, tax: 0.3, total: 3.3 }

=== Call Stack ===
Level 1
Level 2
Level 3
[Call stack trace]

=== Network Debugging ===
[Network request visible in Network panel]

=== Error Debugging ===
Error in buggyFunction: [error]
Stack trace: [stack]

=== Performance Debugging ===
slowOperation: [time]ms

=== Memory Debugging ===
[Use Memory panel]

=== Debugging Tips ===
[Tips listed]
```

**Challenge (Optional)**:
- Debug a real application
- Find and fix bugs
- Profile performance
- Identify memory leaks
- Practice all debugging techniques

---

## Common Mistakes

### 1. Too Many console.log()

```javascript
// ❌ Bad: Too many logs
console.log(''Step 1'');
console.log(''Step 2'');
console.log(''Step 3'');
// ... many more

// ✅ Good: Strategic logging
console.log(''Processing started'');
// Use breakpoints instead
console.log(''Processing completed'');
```

### 2. Not Using Breakpoints

```javascript
// ❌ Bad: Only console.log
console.log(''Value:'', value);

// ✅ Good: Use breakpoints
// Set breakpoint and inspect in DevTools
```

### 3. Ignoring Error Messages

```javascript
// ❌ Bad: Ignore errors
try {
    riskyOperation();
} catch (error) {
    // Silent
}

// ✅ Good: Read and understand errors
try {
    riskyOperation();
} catch (error) {
    console.error(''Error:'', error.message);
    console.error(''Stack:'', error.stack);
}
```

---

## Key Takeaways

1. **DevTools**: Essential debugging tool
2. **Console Methods**: Use appropriate methods for logging
3. **Breakpoints**: Set breakpoints to pause execution
4. **Step Through**: Use step controls to debug
5. **Inspect Variables**: Use Scope and Watch panels
6. **Network Panel**: Debug API calls
7. **Performance Panel**: Find bottlenecks
8. **Memory Panel**: Find memory leaks
9. **Source Maps**: Debug original source code
10. **Best Practice**: Systematic debugging approach

---

## Quiz: Debugging

Test your understanding with these questions:

1. **DevTools opens with:**
   - A) F12
   - B) Ctrl+Shift+I
   - C) Both
   - D) Neither

2. **console.table() displays:**
   - A) Text
   - B) Table
   - C) Error
   - D) Nothing

3. **Breakpoint pauses:**
   - A) Execution
   - B) Nothing
   - C) Compilation
   - D) Loading

4. **F10 key:**
   - A) Step over
   - B) Step into
   - C) Step out
   - D) Continue

5. **Source maps:**
   - A) Map to original source
   - B) Map to minified code
   - C) Both
   - D) Neither

6. **Network panel shows:**
   - A) Requests
   - B) Responses
   - C) Both
   - D) Neither

7. **Memory panel helps find:**
   - A) Memory leaks
   - B) Performance issues
   - C) Network issues
   - D) Nothing

**Answers**:
1. C) Both
2. B) Table
3. A) Execution
4. A) Step over
5. A) Map to original source
6. C) Both
7. A) Memory leaks

---

## Next Steps

Congratulations! You''ve completed Module 20: Error Handling and Debugging. You now know:
- Advanced error handling
- Custom error classes
- Error handling strategies
- Global error handling
- Debugging techniques
- DevTools usage
- Breakpoints and console methods

**What''s Next?**
- Module 21: Performance Optimization
- Lesson 21.1: Performance Basics
- Learn performance metrics
- Understand profiling tools

---

## Additional Resources

- **Chrome DevTools**: [developer.chrome.com/docs/devtools](https://developer.chrome.com/docs/devtools)
- **Firefox DevTools**: [developer.mozilla.org/en-US/docs/Tools](https://developer.mozilla.org/en-US/docs/Tools)
- **MDN: Console API**: [developer.mozilla.org/en-US/docs/Web/API/Console](https://developer.mozilla.org/en-US/docs/Web/API/Console)

---

*Lesson completed! You''ve finished Module 20: Error Handling and Debugging. Ready for Module 21: Performance Optimization!*

', NULL, 2, '2026-01-03 10:03:01', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use browser DevTools effectively
- Set and use breakpoints
- Use console methods for debugging
- Understand source maps
- Debug JavaScript code efficiently
- Use debugging tools and techniques
- Find and fix bugs faster');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (164, 61, 14, 'Performance Optimization Basics', 'performance-optimization-basics', '# Lesson 21.1: Performance Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand performance concepts
- Measure performance metrics
- Use profiling tools
- Identify performance bottlenecks
- Analyze performance data
- Optimize based on metrics
- Build faster applications

---

## Introduction to Performance

Performance optimization is crucial for creating fast, responsive applications that provide a great user experience.

### Why Performance Matters?

- **User Experience**: Faster applications feel better
- **SEO**: Search engines favor fast sites
- **Conversion**: Faster sites convert better
- **Mobile**: Important for mobile users
- **Competitive**: Better than competitors
- **Professional**: Shows attention to detail

---

## Understanding Performance

### What is Performance?

Performance refers to how quickly and efficiently an application runs.

### Key Performance Areas

1. **Load Time**: How fast page loads
2. **Runtime Performance**: How fast code executes
3. **Memory Usage**: How much memory is used
4. **Network**: How fast data transfers
5. **Rendering**: How fast UI updates

### Performance Goals

```javascript
// Target metrics:
// - First Contentful Paint (FCP): < 1.8s
// - Largest Contentful Paint (LCP): < 2.5s
// - Time to Interactive (TTI): < 3.8s
// - Total Blocking Time (TBT): < 200ms
// - Cumulative Layout Shift (CLS): < 0.1
```

---

## Performance Metrics

### Web Vitals

```javascript
// Core Web Vitals
// 1. Largest Contentful Paint (LCP)
//    - Measures loading performance
//    - Target: < 2.5s

// 2. First Input Delay (FID)
//    - Measures interactivity
//    - Target: < 100ms

// 3. Cumulative Layout Shift (CLS)
//    - Measures visual stability
//    - Target: < 0.1
```

### Measuring Performance

```javascript
// Performance API
let startTime = performance.now();

// ... code to measure ...

let endTime = performance.now();
let duration = endTime - startTime;
console.log(`Execution took ${duration}ms`);

// Performance marks
performance.mark(''start'');
// ... code ...
performance.mark(''end'');
performance.measure(''duration'', ''start'', ''end'');
let measure = performance.getEntriesByName(''duration'')[0];
console.log(`Duration: ${measure.duration}ms`);
```

### Navigation Timing

```javascript
// Navigation timing
let timing = performance.timing;

let metrics = {
    // DNS lookup
    dns: timing.domainLookupEnd - timing.domainLookupStart,
    
    // Connection
    connection: timing.connectEnd - timing.connectStart,
    
    // Request
    request: timing.responseStart - timing.requestStart,
    
    // Response
    response: timing.responseEnd - timing.responseStart,
    
    // DOM processing
    domProcessing: timing.domComplete - timing.domLoading,
    
    // Page load
    pageLoad: timing.loadEventEnd - timing.navigationStart
};

console.log(''Performance metrics:'', metrics);
```

### Resource Timing

```javascript
// Resource timing
let resources = performance.getEntriesByType(''resource'');

resources.forEach(resource => {
    console.log(`${resource.name}:`);
    console.log(`  Duration: ${resource.duration}ms`);
    console.log(`  Size: ${resource.transferSize} bytes`);
    console.log(`  Type: ${resource.initiatorType}`);
});
```

---

## Profiling Tools

### Chrome DevTools Performance Panel

```javascript
// Using Performance panel:
// 1. Open DevTools → Performance
// 2. Click Record
// 3. Perform actions
// 4. Stop recording
// 5. Analyze timeline

// Shows:
// - FPS (frames per second)
// - CPU usage
// - Memory usage
// - Function call stack
// - Long tasks
// - Layout shifts
```

### Chrome DevTools Memory Panel

```javascript
// Using Memory panel:
// 1. Open DevTools → Memory
// 2. Take heap snapshot
// 3. Perform actions
// 4. Take another snapshot
// 5. Compare snapshots

// Helps find:
// - Memory leaks
// - Large objects
// - Retained objects
// - Object sizes
```

### Lighthouse

```javascript
// Lighthouse (built into Chrome):
// 1. Open DevTools → Lighthouse
// 2. Select categories
// 3. Click Analyze
// 4. View report

// Measures:
// - Performance score
// - Accessibility
// - Best practices
// - SEO
// - PWA

// Provides:
// - Metrics
// - Opportunities
// - Diagnostics
// - Recommendations
```

### Performance Observer API

```javascript
// Performance Observer
let observer = new PerformanceObserver((list) => {
    for (let entry of list.getEntries()) {
        console.log(''Performance entry:'', entry);
    }
});

// Observe different types
observer.observe({ entryTypes: [''measure'', ''navigation'', ''resource''] });

// Measure custom performance
performance.mark(''custom-start'');
// ... code ...
performance.mark(''custom-end'');
performance.measure(''custom'', ''custom-start'', ''custom-end'');
```

---

## Performance Bottlenecks

### Common Bottlenecks

```javascript
// 1. Inefficient loops
// ❌ Bad: O(n²)
function findDuplicates(arr) {
    let duplicates = [];
    for (let i = 0; i < arr.length; i++) {
        for (let j = i + 1; j < arr.length; j++) {
            if (arr[i] === arr[j]) {
                duplicates.push(arr[i]);
            }
        }
    }
    return duplicates;
}

// ✅ Good: O(n)
function findDuplicates(arr) {
    let seen = new Set();
    let duplicates = [];
    for (let item of arr) {
        if (seen.has(item)) {
            duplicates.push(item);
        } else {
            seen.add(item);
        }
    }
    return duplicates;
}
```

### DOM Manipulation

```javascript
// ❌ Bad: Multiple DOM updates
for (let i = 0; i < 1000; i++) {
    document.body.appendChild(document.createElement(''div''));
}

// ✅ Good: Batch DOM updates
let fragment = document.createDocumentFragment();
for (let i = 0; i < 1000; i++) {
    fragment.appendChild(document.createElement(''div''));
}
document.body.appendChild(fragment);
```

### Memory Leaks

```javascript
// ❌ Bad: Memory leak
let data = [];
function addData() {
    for (let i = 0; i < 10000; i++) {
        data.push(new Array(1000).fill(0));
    }
}
// data never cleared

// ✅ Good: Clean up
let data = [];
function addData() {
    for (let i = 0; i < 10000; i++) {
        data.push(new Array(1000).fill(0));
    }
}
function clearData() {
    data = [];
}
```

### Unnecessary Re-renders

```javascript
// ❌ Bad: Re-render on every change
function updateUI(data) {
    document.getElementById(''output'').innerHTML = '''';
    data.forEach(item => {
        let div = document.createElement(''div'');
        div.textContent = item;
        document.getElementById(''output'').appendChild(div);
    });
}

// ✅ Good: Update only changed items
function updateUI(data, previousData = []) {
    let output = document.getElementById(''output'');
    data.forEach((item, index) => {
        if (item !== previousData[index]) {
            if (output.children[index]) {
                output.children[index].textContent = item;
            } else {
                let div = document.createElement(''div'');
                div.textContent = item;
                output.appendChild(div);
            }
        }
    });
}
```

---

## Analyzing Performance

### Identifying Slow Code

```javascript
// Use console.time() to measure
console.time(''operation'');
// ... code ...
console.timeEnd(''operation'');

// Use performance.now()
let start = performance.now();
// ... code ...
let end = performance.now();
console.log(`Took ${end - start}ms`);

// Use performance marks
performance.mark(''start'');
// ... code ...
performance.mark(''end'');
performance.measure(''duration'', ''start'', ''end'');
let measure = performance.getEntriesByName(''duration'')[0];
console.log(`Duration: ${measure.duration}ms`);
```

### Profiling Functions

```javascript
// Profile function calls
function profileFunction(fn, ...args) {
    let start = performance.now();
    let result = fn(...args);
    let end = performance.now();
    console.log(`${fn.name} took ${end - start}ms`);
    return result;
}

function slowFunction(n) {
    let sum = 0;
    for (let i = 0; i < n * 1000000; i++) {
        sum += i;
    }
    return sum;
}

profileFunction(slowFunction, 10);
```

### Memory Profiling

```javascript
// Check memory usage
function getMemoryUsage() {
    if (performance.memory) {
        return {
            used: (performance.memory.usedJSHeapSize / 1048576).toFixed(2) + '' MB'',
            total: (performance.memory.totalJSHeapSize / 1048576).toFixed(2) + '' MB'',
            limit: (performance.memory.jsHeapSizeLimit / 1048576).toFixed(2) + '' MB''
        };
    }
    return null;
}

console.log(''Memory usage:'', getMemoryUsage());
```

---

## Practice Exercise

### Exercise: Performance Analysis

**Objective**: Practice measuring performance, using profiling tools, and identifying bottlenecks.

**Instructions**:

1. Create a JavaScript file with various operations
2. Use performance measurement tools
3. Practice:
   - Measuring execution time
   - Using performance marks
   - Analyzing bottlenecks
   - Profiling code

**Example Solution**:

```javascript
// performance-analysis-practice.js
console.log("=== Performance Analysis Practice ===");

console.log("\\n=== Performance Measurement ===");

// Basic timing
console.time(''basic-operation'');
let sum = 0;
for (let i = 0; i < 1000000; i++) {
    sum += i;
}
console.timeEnd(''basic-operation'');

// Performance.now()
let start = performance.now();
let result = 0;
for (let i = 0; i < 1000000; i++) {
    result += Math.sqrt(i);
}
let end = performance.now();
console.log(`Math.sqrt loop took ${(end - start).toFixed(2)}ms`);

// Performance marks
performance.mark(''mark-start'');
let data = [];
for (let i = 0; i < 10000; i++) {
    data.push(i * 2);
}
performance.mark(''mark-end'');
performance.measure(''data-creation'', ''mark-start'', ''mark-end'');
let measure = performance.getEntriesByName(''data-creation'')[0];
console.log(`Data creation took ${measure.duration.toFixed(2)}ms`);
console.log();

console.log("=== Navigation Timing ===");

function getNavigationTiming() {
    let timing = performance.timing;
    
    return {
        dns: timing.domainLookupEnd - timing.domainLookupStart,
        connection: timing.connectEnd - timing.connectStart,
        request: timing.responseStart - timing.requestStart,
        response: timing.responseEnd - timing.responseStart,
        domProcessing: timing.domComplete - timing.domLoading,
        pageLoad: timing.loadEventEnd - timing.navigationStart
    };
}

console.log(''Navigation timing:'', getNavigationTiming());
console.log();

console.log("=== Resource Timing ===");

function getResourceTiming() {
    let resources = performance.getEntriesByType(''resource'');
    
    return resources.map(resource => ({
        name: resource.name,
        duration: resource.duration.toFixed(2) + ''ms'',
        size: resource.transferSize + '' bytes'',
        type: resource.initiatorType
    }));
}

console.log(''Resource timing:'', getResourceTiming());
console.log();

console.log("=== Performance Bottlenecks ===");

// Inefficient loop
console.time(''inefficient-loop'');
function inefficientFind(arr, target) {
    for (let i = 0; i < arr.length; i++) {
        for (let j = 0; j < arr.length; j++) {
            if (arr[i] + arr[j] === target) {
                return [i, j];
            }
        }
    }
    return null;
}
let arr1 = Array.from({ length: 100 }, (_, i) => i);
inefficientFind(arr1, 50);
console.timeEnd(''inefficient-loop'');

// Efficient loop
console.time(''efficient-loop'');
function efficientFind(arr, target) {
    let map = new Map();
    for (let i = 0; i < arr.length; i++) {
        let complement = target - arr[i];
        if (map.has(complement)) {
            return [map.get(complement), i];
        }
        map.set(arr[i], i);
    }
    return null;
}
let arr2 = Array.from({ length: 100 }, (_, i) => i);
efficientFind(arr2, 50);
console.timeEnd(''efficient-loop'');
console.log();

console.log("=== DOM Performance ===");

// Slow DOM manipulation
console.time(''slow-dom'');
let container1 = document.createElement(''div'');
for (let i = 0; i < 1000; i++) {
    let div = document.createElement(''div'');
    div.textContent = `Item ${i}`;
    container1.appendChild(div);
}
console.timeEnd(''slow-dom'');

// Fast DOM manipulation
console.time(''fast-dom'');
let container2 = document.createElement(''div'');
let fragment = document.createDocumentFragment();
for (let i = 0; i < 1000; i++) {
    let div = document.createElement(''div'');
    div.textContent = `Item ${i}`;
    fragment.appendChild(div);
}
container2.appendChild(fragment);
console.timeEnd(''fast-dom'');
console.log();

console.log("=== Memory Usage ===");

function getMemoryUsage() {
    if (performance.memory) {
        return {
            used: (performance.memory.usedJSHeapSize / 1048576).toFixed(2) + '' MB'',
            total: (performance.memory.totalJSHeapSize / 1048576).toFixed(2) + '' MB'',
            limit: (performance.memory.jsHeapSizeLimit / 1048576).toFixed(2) + '' MB''
        };
    }
    return ''Memory API not available'';
}

console.log(''Memory usage:'', getMemoryUsage());

// Memory leak example
let memoryLeak = [];
function addToMemoryLeak() {
    for (let i = 0; i < 1000; i++) {
        memoryLeak.push(new Array(1000).fill(0));
    }
}

let memoryBefore = getMemoryUsage();
addToMemoryLeak();
let memoryAfter = getMemoryUsage();
console.log(''Memory before:'', memoryBefore);
console.log(''Memory after:'', memoryAfter);
console.log();

console.log("=== Function Profiling ===");

function profileFunction(fn, ...args) {
    let start = performance.now();
    let result = fn(...args);
    let end = performance.now();
    console.log(`${fn.name}(${args.join('', '')}) took ${(end - start).toFixed(2)}ms`);
    return result;
}

function slowCalculation(n) {
    let sum = 0;
    for (let i = 0; i < n * 100000; i++) {
        sum += Math.sqrt(i);
    }
    return sum;
}

function fastCalculation(n) {
    return n * (n + 1) / 2;
}

profileFunction(slowCalculation, 10);
profileFunction(fastCalculation, 10);
console.log();

console.log("=== Performance Observer ===");

let observer = new PerformanceObserver((list) => {
    for (let entry of list.getEntries()) {
        console.log(''Performance entry:'', {
            name: entry.name,
            type: entry.entryType,
            duration: entry.duration ? entry.duration.toFixed(2) + ''ms'' : ''N/A''
        });
    }
});

observer.observe({ entryTypes: [''measure'', ''mark''] });

// Create some performance entries
performance.mark(''observer-start'');
let sum = 0;
for (let i = 0; i < 100000; i++) {
    sum += i;
}
performance.mark(''observer-end'');
performance.measure(''observer-duration'', ''observer-start'', ''observer-end'');
console.log();

console.log("=== Web Vitals (Conceptual) ===");
console.log(''Core Web Vitals:'');
console.log(''  - LCP (Largest Contentful Paint): < 2.5s'');
console.log(''  - FID (First Input Delay): < 100ms'');
console.log(''  - CLS (Cumulative Layout Shift): < 0.1'');
console.log();
console.log(''Use Lighthouse in Chrome DevTools to measure Web Vitals'');
console.log(''Open DevTools → Lighthouse → Analyze'');
```

**Expected Output**:
```
=== Performance Analysis Practice ===

=== Performance Measurement ===
basic-operation: [time]ms
Math.sqrt loop took [time]ms
Data creation took [time]ms

=== Navigation Timing ===
Navigation timing: { object }

=== Resource Timing ===
Resource timing: [array]

=== Performance Bottlenecks ===
inefficient-loop: [time]ms
efficient-loop: [time]ms

=== DOM Performance ===
slow-dom: [time]ms
fast-dom: [time]ms

=== Memory Usage ===
Memory usage: { object }
Memory before: { object }
Memory after: { object }

=== Function Profiling ===
slowCalculation(10) took [time]ms
fastCalculation(10) took [time]ms

=== Performance Observer ===
Performance entry: { object }

=== Web Vitals (Conceptual) ===
[Web Vitals info]
```

**Challenge (Optional)**:
- Profile a real application
- Identify and fix bottlenecks
- Measure before and after optimizations
- Use Lighthouse to analyze performance
- Practice all profiling techniques

---

## Common Mistakes

### 1. Not Measuring Before Optimizing

```javascript
// ❌ Bad: Optimize without measuring
function optimize() {
    // Optimize blindly
}

// ✅ Good: Measure first
let before = performance.now();
// ... code ...
let after = performance.now();
console.log(`Took ${after - before}ms`);
// Then optimize based on data
```

### 2. Premature Optimization

```javascript
// ❌ Bad: Optimize too early
// Complex optimization for simple code

// ✅ Good: Optimize when needed
// Measure first, optimize bottlenecks
```

### 3. Ignoring Memory

```javascript
// ❌ Bad: Only measure speed
console.time(''operation'');
// ... code ...
console.timeEnd(''operation'');

// ✅ Good: Measure speed and memory
console.time(''operation'');
let memoryBefore = performance.memory.usedJSHeapSize;
// ... code ...
let memoryAfter = performance.memory.usedJSHeapSize;
console.timeEnd(''operation'');
console.log(`Memory used: ${(memoryAfter - memoryBefore) / 1048576}MB`);
```

---

## Key Takeaways

1. **Performance Metrics**: Measure load time, runtime, memory
2. **Web Vitals**: LCP, FID, CLS are key metrics
3. **Profiling Tools**: DevTools, Lighthouse, Performance API
4. **Bottlenecks**: Identify slow code, DOM operations, memory leaks
5. **Measurement**: Always measure before optimizing
6. **Analysis**: Use profiling data to guide optimization
7. **Best Practice**: Measure, identify, optimize, measure again

---

## Quiz: Performance Basics

Test your understanding with these questions:

1. **LCP target is:**
   - A) < 1.8s
   - B) < 2.5s
   - C) < 3.8s
   - D) < 5s

2. **performance.now() returns:**
   - A) Date
   - B) High-resolution timestamp
   - C) String
   - D) Nothing

3. **Lighthouse measures:**
   - A) Performance only
   - B) Multiple categories
   - C) Memory only
   - D) Nothing

4. **DocumentFragment helps:**
   - A) DOM performance
   - B) Memory
   - C) Network
   - D) Nothing

5. **Memory leaks:**
   - A) Objects not garbage collected
   - B) Fast code
   - C) Small objects
   - D) Nothing

6. **Performance Observer:**
   - A) Observes performance entries
   - B) Observes errors
   - C) Observes network
   - D) Nothing

7. **Measure before:**
   - A) Optimizing
   - B) Coding
   - C) Testing
   - D) Nothing

**Answers**:
1. B) < 2.5s
2. B) High-resolution timestamp
3. B) Multiple categories
4. A) DOM performance
5. A) Objects not garbage collected
6. A) Observes performance entries
7. A) Optimizing

---

## Next Steps

Congratulations! You''ve learned performance basics. You now know:
- How to measure performance
- Performance metrics and Web Vitals
- Profiling tools
- How to identify bottlenecks

**What''s Next?**
- Lesson 21.2: Optimization Techniques
- Learn debouncing and throttling
- Understand lazy loading
- Work with code splitting

---

## Additional Resources

- **Web Vitals**: [web.dev/vitals](https://web.dev/vitals)
- **Chrome DevTools Performance**: [developer.chrome.com/docs/devtools/performance](https://developer.chrome.com/docs/devtools/performance)
- **MDN: Performance API**: [developer.mozilla.org/en-US/docs/Web/API/Performance](https://developer.mozilla.org/en-US/docs/Web/API/Performance)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:03:01', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand performance concepts
- Measure performance metrics
- Use profiling tools
- Identify performance bottlenecks
- Analyze performance data
- Optimize based on metrics
- Build faster applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (165, 61, 14, 'Memory Management', 'memory-management', '# Lesson 21.2: Optimization Techniques

## Learning Objectives

By the end of this lesson, you will be able to:
- Implement debouncing and throttling
- Use lazy loading for images and code
- Implement code splitting
- Manage memory effectively
- Optimize code performance
- Apply optimization techniques
- Build faster applications

---

## Introduction to Optimization Techniques

Optimization techniques help improve application performance by reducing unnecessary work and improving resource usage.

### Why Optimization?

- **Faster Load Times**: Load only what''s needed
- **Better Runtime**: Reduce unnecessary operations
- **Lower Memory**: Efficient memory usage
- **Better UX**: Smoother interactions
- **Mobile Friendly**: Important for mobile devices
- **Cost Effective**: Lower server costs

---

## Debouncing and Throttling

### Debouncing

Debouncing delays function execution until after a pause in calls.

```javascript
// Basic debounce
function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
}

// Usage: Search input
let searchInput = document.getElementById(''search'');
let debouncedSearch = debounce(function(query) {
    console.log(''Searching for:'', query);
    // Perform search
}, 300);

searchInput.addEventListener(''input'', function(e) {
    debouncedSearch(e.target.value);
});
```

### Throttling

Throttling limits function execution to at most once per time period.

```javascript
// Basic throttle
function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            func.apply(this, args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}

// Usage: Scroll event
let throttledScroll = throttle(function() {
    console.log(''Scrolled'');
    // Handle scroll
}, 100);

window.addEventListener(''scroll'', throttledScroll);
```

### Debounce vs Throttle

```javascript
// Debounce: Wait for pause
// - Search input
// - Resize events
// - Form validation

// Throttle: Limit execution rate
// - Scroll events
// - Mouse move
// - Window resize (sometimes)
```

---

## Lazy Loading

### Image Lazy Loading

```javascript
// Native lazy loading
<img src="image.jpg" loading="lazy" alt="Image">

// JavaScript lazy loading
function lazyLoadImages() {
    let images = document.querySelectorAll(''img[data-src]'');
    
    let imageObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                let img = entry.target;
                img.src = img.dataset.src;
                img.removeAttribute(''data-src'');
                observer.unobserve(img);
            }
        });
    });
    
    images.forEach(img => imageObserver.observe(img));
}

// Usage
<img data-src="image.jpg" alt="Image">
lazyLoadImages();
```

### Code Lazy Loading

```javascript
// Dynamic import (lazy load modules)
async function loadModule() {
    let module = await import(''./heavy-module.js'');
    module.doSomething();
}

// Lazy load on demand
button.addEventListener(''click'', async () => {
    let { heavyFunction } = await import(''./heavy-module.js'');
    heavyFunction();
});

// React lazy loading
const LazyComponent = React.lazy(() => import(''./LazyComponent''));
```

### Component Lazy Loading

```javascript
// Lazy load components
function lazyLoadComponent(componentName) {
    return import(`./components/${componentName}.js`)
        .then(module => module.default)
        .catch(error => {
            console.error(''Failed to load component:'', error);
        });
}

// Usage
button.addEventListener(''click'', () => {
    lazyLoadComponent(''HeavyComponent'').then(Component => {
        // Render component
    });
});
```

---

## Code Splitting

### Dynamic Imports

```javascript
// Split code into chunks
// webpack.config.js
module.exports = {
    optimization: {
        splitChunks: {
            chunks: ''all'',
            cacheGroups: {
                vendor: {
                    test: /[\\\\/]node_modules[\\\\/]/,
                    name: ''vendors'',
                    chunks: ''all''
                }
            }
        }
    }
};

// Dynamic import
async function loadFeature() {
    let feature = await import(''./feature.js'');
    feature.init();
}
```

### Route-Based Splitting

```javascript
// Split by routes
const routes = {
    ''/'': () => import(''./pages/Home.js''),
    ''/about'': () => import(''./pages/About.js''),
    ''/contact'': () => import(''./pages/Contact.js'')
};

async function navigate(path) {
    let pageLoader = routes[path];
    if (pageLoader) {
        let Page = await pageLoader();
        render(Page);
    }
}
```

### Component-Based Splitting

```javascript
// Split by components
async function loadModal() {
    let Modal = await import(''./Modal.js'');
    return Modal.default;
}

// Load on demand
button.addEventListener(''click'', async () => {
    let Modal = await loadModal();
    showModal(Modal);
});
```

---

## Memory Management

### Avoiding Memory Leaks

```javascript
// ❌ Bad: Memory leak
let listeners = [];
function addListener() {
    let listener = () => console.log(''clicked'');
    document.addEventListener(''click'', listener);
    listeners.push(listener);
    // Never removed!
}

// ✅ Good: Clean up
let listeners = [];
function addListener() {
    let listener = () => console.log(''clicked'');
    document.addEventListener(''click'', listener);
    listeners.push(listener);
}

function removeListeners() {
    listeners.forEach(listener => {
        document.removeEventListener(''click'', listener);
    });
    listeners = [];
}
```

### WeakMap and WeakSet

```javascript
// WeakMap: Doesn''t prevent garbage collection
let weakMap = new WeakMap();
let obj = { data: ''test'' };
weakMap.set(obj, ''value'');

// When obj is garbage collected, weakMap entry is removed
obj = null;

// WeakSet: Similar to WeakMap
let weakSet = new WeakSet();
weakSet.add(obj);
```

### Clearing References

```javascript
// Clear large objects
let largeData = new Array(1000000).fill(0);

// When done, clear reference
largeData = null;

// Clear intervals/timeouts
let intervalId = setInterval(() => {
    // ...
}, 1000);

// Clear when done
clearInterval(intervalId);
```

### Object Pooling

```javascript
// Reuse objects instead of creating new ones
class ObjectPool {
    constructor(createFn, resetFn) {
        this.createFn = createFn;
        this.resetFn = resetFn;
        this.pool = [];
    }
    
    acquire() {
        if (this.pool.length > 0) {
            return this.pool.pop();
        }
        return this.createFn();
    }
    
    release(obj) {
        this.resetFn(obj);
        this.pool.push(obj);
    }
}

// Usage
let pool = new ObjectPool(
    () => ({ x: 0, y: 0 }),
    obj => { obj.x = 0; obj.y = 0; }
);

let obj = pool.acquire();
// Use obj
pool.release(obj);
```

---

## Additional Optimization Techniques

### Caching

```javascript
// Function result caching
function memoize(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache.has(key)) {
            return cache.get(key);
        }
        let result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

// Usage
let expensiveFunction = memoize(function(n) {
    // Expensive calculation
    let result = 0;
    for (let i = 0; i < n * 1000000; i++) {
        result += i;
    }
    return result;
});
```

### Virtual Scrolling

```javascript
// Only render visible items
function virtualScroll(items, containerHeight, itemHeight) {
    let visibleCount = Math.ceil(containerHeight / itemHeight);
    let scrollTop = container.scrollTop;
    let startIndex = Math.floor(scrollTop / itemHeight);
    let endIndex = startIndex + visibleCount;
    
    return items.slice(startIndex, endIndex);
}
```

### Request Batching

```javascript
// Batch multiple requests
class RequestBatcher {
    constructor(batchSize, delay) {
        this.batchSize = batchSize;
        this.delay = delay;
        this.queue = [];
        this.timeoutId = null;
    }
    
    add(request) {
        this.queue.push(request);
        
        if (this.queue.length >= this.batchSize) {
            this.flush();
        } else {
            this.scheduleFlush();
        }
    }
    
    scheduleFlush() {
        if (this.timeoutId) {
            clearTimeout(this.timeoutId);
        }
        this.timeoutId = setTimeout(() => {
            this.flush();
        }, this.delay);
    }
    
    flush() {
        if (this.queue.length === 0) return;
        
        let batch = this.queue.splice(0, this.batchSize);
        // Send batch request
        sendBatchRequest(batch);
        
        if (this.queue.length > 0) {
            this.scheduleFlush();
        }
    }
}
```

---

## Practice Exercise

### Exercise: Optimization

**Objective**: Practice implementing debouncing, throttling, lazy loading, and memory management.

**Instructions**:

1. Create a JavaScript file
2. Practice:
   - Implementing debounce and throttle
   - Lazy loading images
   - Code splitting
   - Memory management
   - Other optimization techniques

**Example Solution**:

```javascript
// optimization-practice.js
console.log("=== Optimization Techniques Practice ===");

console.log("\\n=== Debouncing ===");

function debounce(func, delay) {
    let timeoutId;
    return function(...args) {
        clearTimeout(timeoutId);
        timeoutId = setTimeout(() => {
            func.apply(this, args);
        }, delay);
    };
}

// Search example
let searchCount = 0;
function performSearch(query) {
    searchCount++;
    console.log(`Search ${searchCount} for: "${query}"`);
}

let debouncedSearch = debounce(performSearch, 300);

// Simulate typing
debouncedSearch(''h'');
debouncedSearch(''he'');
debouncedSearch(''hel'');
debouncedSearch(''hell'');
debouncedSearch(''hello'');
// Only one search executed after 300ms pause

// Resize example
let resizeCount = 0;
function handleResize() {
    resizeCount++;
    console.log(`Resize ${resizeCount}: ${window.innerWidth}x${window.innerHeight}`);
}

let debouncedResize = debounce(handleResize, 250);
// window.addEventListener(''resize'', debouncedResize);
console.log();

console.log("=== Throttling ===");

function throttle(func, limit) {
    let inThrottle;
    return function(...args) {
        if (!inThrottle) {
            func.apply(this, args);
            inThrottle = true;
            setTimeout(() => {
                inThrottle = false;
            }, limit);
        }
    };
}

// Scroll example
let scrollCount = 0;
function handleScroll() {
    scrollCount++;
    console.log(`Scroll ${scrollCount}: ${window.scrollY}`);
}

let throttledScroll = throttle(handleScroll, 100);
// window.addEventListener(''scroll'', throttledScroll);

// Mouse move example
let moveCount = 0;
function handleMouseMove(event) {
    moveCount++;
    console.log(`Mouse move ${moveCount}: (${event.clientX}, ${event.clientY})`);
}

let throttledMouseMove = throttle(handleMouseMove, 200);
// element.addEventListener(''mousemove'', throttledMouseMove);
console.log();

console.log("=== Lazy Loading ===");

// Image lazy loading
function lazyLoadImages() {
    let images = document.querySelectorAll(''img[data-src]'');
    
    if (''IntersectionObserver'' in window) {
        let imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    let img = entry.target;
                    img.src = img.dataset.src;
                    img.removeAttribute(''data-src'');
                    observer.unobserve(img);
                    console.log(''Image loaded:'', img.src);
                }
            });
        });
        
        images.forEach(img => imageObserver.observe(img));
    } else {
        // Fallback for older browsers
        images.forEach(img => {
            img.src = img.dataset.src;
        });
    }
}

// Code lazy loading
async function lazyLoadModule(modulePath) {
    try {
        let module = await import(modulePath);
        console.log(''Module loaded:'', modulePath);
        return module;
    } catch (error) {
        console.error(''Failed to load module:'', error);
        return null;
    }
}

// Usage example
// lazyLoadModule(''./heavy-module.js'').then(module => {
//     if (module) {
//         module.init();
//     }
// });
console.log();

console.log("=== Code Splitting ===");

// Dynamic import
async function loadFeature(featureName) {
    try {
        let feature = await import(`./features/${featureName}.js`);
        console.log(`Feature ${featureName} loaded`);
        return feature;
    } catch (error) {
        console.error(`Failed to load feature ${featureName}:`, error);
        return null;
    }
}

// Route-based splitting
const routes = {
    ''/'': () => import(''./pages/Home.js''),
    ''/about'': () => import(''./pages/About.js''),
    ''/contact'': () => import(''./pages/Contact.js'')
};

async function navigate(path) {
    let pageLoader = routes[path];
    if (pageLoader) {
        try {
            let Page = await pageLoader();
            console.log(`Page ${path} loaded`);
            return Page;
        } catch (error) {
            console.error(`Failed to load page ${path}:`, error);
            return null;
        }
    }
    return null;
}
console.log();

console.log("=== Memory Management ===");

// Avoiding memory leaks
class EventManager {
    constructor() {
        this.listeners = new Map();
    }
    
    add(element, event, handler) {
        if (!this.listeners.has(element)) {
            this.listeners.set(element, []);
        }
        element.addEventListener(event, handler);
        this.listeners.get(element).push({ event, handler });
    }
    
    remove(element, event, handler) {
        if (this.listeners.has(element)) {
            let handlers = this.listeners.get(element);
            let index = handlers.findIndex(h => h.event === event && h.handler === handler);
            if (index !== -1) {
                element.removeEventListener(event, handler);
                handlers.splice(index, 1);
            }
        }
    }
    
    removeAll(element) {
        if (this.listeners.has(element)) {
            let handlers = this.listeners.get(element);
            handlers.forEach(({ event, handler }) => {
                element.removeEventListener(event, handler);
            });
            this.listeners.delete(element);
        }
    }
}

let eventManager = new EventManager();
// Use eventManager to track and clean up listeners

// WeakMap for memory-efficient storage
let weakMap = new WeakMap();
function storeData(obj, data) {
    weakMap.set(obj, data);
}

let tempObj = { id: 1 };
storeData(tempObj, ''some data'');
tempObj = null;  // Can be garbage collected

// Clearing large objects
function clearLargeData() {
    let largeArray = new Array(1000000).fill(0);
    // Use largeArray
    largeArray = null;  // Clear reference
    console.log(''Large data cleared'');
}

clearLargeData();
console.log();

console.log("=== Caching ===");

// Memoization
function memoize(fn) {
    let cache = new Map();
    return function(...args) {
        let key = JSON.stringify(args);
        if (cache.has(key)) {
            console.log(''Cache hit'');
            return cache.get(key);
        }
        console.log(''Cache miss, calculating...'');
        let result = fn.apply(this, args);
        cache.set(key, result);
        return result;
    };
}

function expensiveCalculation(n) {
    let result = 0;
    for (let i = 0; i < n * 100000; i++) {
        result += i;
    }
    return result;
}

let memoizedCalc = memoize(expensiveCalculation);
memoizedCalc(10);  // Calculates
memoizedCalc(10);  // Uses cache
console.log();

console.log("=== Object Pooling ===");

class ObjectPool {
    constructor(createFn, resetFn, maxSize = 10) {
        this.createFn = createFn;
        this.resetFn = resetFn;
        this.maxSize = maxSize;
        this.pool = [];
    }
    
    acquire() {
        if (this.pool.length > 0) {
            return this.pool.pop();
        }
        return this.createFn();
    }
    
    release(obj) {
        if (this.pool.length < this.maxSize) {
            this.resetFn(obj);
            this.pool.push(obj);
        }
    }
}

let pool = new ObjectPool(
    () => ({ x: 0, y: 0, active: false }),
    obj => {
        obj.x = 0;
        obj.y = 0;
        obj.active = false;
    }
);

let obj1 = pool.acquire();
obj1.x = 10;
obj1.y = 20;
pool.release(obj1);

let obj2 = pool.acquire();
console.log(''Reused object:'', obj2);  // Same object, reset
console.log();

console.log("=== Request Batching ===");

class RequestBatcher {
    constructor(batchSize = 5, delay = 100) {
        this.batchSize = batchSize;
        this.delay = delay;
        this.queue = [];
        this.timeoutId = null;
    }
    
    add(request) {
        this.queue.push(request);
        
        if (this.queue.length >= this.batchSize) {
            this.flush();
        } else {
            this.scheduleFlush();
        }
    }
    
    scheduleFlush() {
        if (this.timeoutId) {
            clearTimeout(this.timeoutId);
        }
        this.timeoutId = setTimeout(() => {
            this.flush();
        }, this.delay);
    }
    
    flush() {
        if (this.queue.length === 0) return;
        
        let batch = this.queue.splice(0, this.batchSize);
        console.log(`Sending batch of ${batch.length} requests:`, batch);
        // sendBatchRequest(batch);
        
        if (this.queue.length > 0) {
            this.scheduleFlush();
        }
    }
}

let batcher = new RequestBatcher(3, 200);
for (let i = 0; i < 10; i++) {
    batcher.add({ id: i, data: `request ${i}` });
}
console.log();

console.log("=== Virtual Scrolling (Concept) ===");

function virtualScroll(items, containerHeight, itemHeight, scrollTop) {
    let visibleCount = Math.ceil(containerHeight / itemHeight);
    let startIndex = Math.floor(scrollTop / itemHeight);
    let endIndex = Math.min(startIndex + visibleCount, items.length);
    
    return {
        visibleItems: items.slice(startIndex, endIndex),
        startIndex: startIndex,
        endIndex: endIndex,
        totalHeight: items.length * itemHeight
    };
}

let items = Array.from({ length: 1000 }, (_, i) => `Item ${i}`);
let result = virtualScroll(items, 400, 50, 0);
console.log(`Showing items ${result.startIndex}-${result.endIndex} of ${items.length}`);
console.log(`Visible items: ${result.visibleItems.length}`);
```

**Expected Output**:
```
=== Optimization Techniques Practice ===

=== Debouncing ===
[After 300ms pause]
Search 1 for: "hello"

=== Throttling ===
[Throttled events logged]

=== Lazy Loading ===
[Lazy loading functions defined]

=== Code Splitting ===
[Code splitting functions defined]

=== Memory Management ===
Large data cleared

=== Caching ===
Cache miss, calculating...
Cache hit

=== Object Pooling ===
Reused object: { x: 0, y: 0, active: false }

=== Request Batching ===
Sending batch of 3 requests: [array]
Sending batch of 3 requests: [array]
...

=== Virtual Scrolling (Concept) ===
Showing items 0-8 of 1000
Visible items: 8
```

**Challenge (Optional)**:
- Optimize a real application
- Implement all optimization techniques
- Measure performance improvements
- Build a performance-optimized app

---

## Common Mistakes

### 1. Over-Optimization

```javascript
// ❌ Bad: Optimize too early
// Complex optimization for simple code

// ✅ Good: Optimize when needed
// Measure first, optimize bottlenecks
```

### 2. Not Cleaning Up

```javascript
// ❌ Bad: Memory leak
let intervalId = setInterval(() => {
    // ...
}, 1000);
// Never cleared

// ✅ Good: Clean up
let intervalId = setInterval(() => {
    // ...
}, 1000);
// Later...
clearInterval(intervalId);
```

### 3. Wrong Debounce/Throttle

```javascript
// ❌ Bad: Wrong choice
// Using throttle for search input

// ✅ Good: Right choice
// Debounce for search, throttle for scroll
```

---

## Key Takeaways

1. **Debouncing**: Delay execution until pause
2. **Throttling**: Limit execution rate
3. **Lazy Loading**: Load on demand
4. **Code Splitting**: Split code into chunks
5. **Memory Management**: Avoid leaks, clean up
6. **Caching**: Cache expensive operations
7. **Best Practice**: Measure, optimize, measure again

---

## Quiz: Optimization

Test your understanding with these questions:

1. **Debouncing:**
   - A) Limits rate
   - B) Waits for pause
   - C) Both
   - D) Neither

2. **Throttling:**
   - A) Limits rate
   - B) Waits for pause
   - C) Both
   - D) Neither

3. **Lazy loading:**
   - A) Loads immediately
   - B) Loads on demand
   - C) Never loads
   - D) Random

4. **Code splitting:**
   - A) Splits into chunks
   - B) Combines code
   - C) Deletes code
   - D) Nothing

5. **WeakMap:**
   - A) Prevents GC
   - B) Allows GC
   - C) Both
   - D) Neither

6. **Memoization:**
   - A) Caches results
   - B) Deletes results
   - C) Modifies results
   - D) Nothing

7. **Object pooling:**
   - A) Reuses objects
   - B) Creates new objects
   - C) Deletes objects
   - D) Nothing

**Answers**:
1. B) Waits for pause
2. A) Limits rate
3. B) Loads on demand
4. A) Splits into chunks
5. B) Allows GC
6. A) Caches results
7. A) Reuses objects

---

## Next Steps

Congratulations! You''ve completed Module 21: Performance Optimization. You now know:
- Performance basics and metrics
- Profiling tools
- Optimization techniques
- Debouncing and throttling
- Lazy loading and code splitting
- Memory management

**What''s Next?**
- Course 6: Testing and Tools
- Module 22: Testing
- Lesson 22.1: Testing Basics
- Learn why testing matters
- Understand test types

---

## Additional Resources

- **Web.dev Performance**: [web.dev/performance](https://web.dev/performance)
- **MDN: Performance**: [developer.mozilla.org/en-US/docs/Web/API/Performance](https://developer.mozilla.org/en-US/docs/Web/API/Performance)
- **Lazy Loading**: [web.dev/lazy-loading](https://web.dev/lazy-loading)

---

*Lesson completed! You''ve finished Module 21: Performance Optimization. Ready for Course 6: Testing and Tools!*

', NULL, 2, '2026-01-03 10:03:01', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Implement debouncing and throttling
- Use lazy loading for images and code
- Implement code splitting
- Manage memory effectively
- Optimize code performance
- Apply optimization techniques
- Build faster applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (166, 62, 15, 'Testing Basics', 'testing-basics', '# Lesson 22.1: Testing Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand why testing is important
- Know different types of testing
- Understand test-driven development (TDD)
- Write basic tests
- Structure test files
- Run tests
- Build confidence in your code

---

## Introduction to Testing

Testing is the process of verifying that code works as expected. It''s essential for building reliable applications.

### Why Test?

- **Confidence**: Know your code works
- **Documentation**: Tests document how code should work
- **Refactoring**: Safe to change code with tests
- **Bug Prevention**: Catch bugs early
- **Quality**: Ensures code quality
- **Professional**: Industry standard practice

### Benefits of Testing

```javascript
// Without tests: Unsure if code works
function add(a, b) {
    return a + b;
}
// Does it work? Maybe?

// With tests: Confident code works
function add(a, b) {
    return a + b;
}
// Test: add(2, 3) === 5 ✓
```

---

## Types of Testing

### Unit Testing

Tests individual units (functions, classes) in isolation.

```javascript
// Unit test example
function multiply(a, b) {
    return a * b;
}

// Test
test(''multiply should return product'', () => {
    expect(multiply(2, 3)).toBe(6);
    expect(multiply(0, 5)).toBe(0);
    expect(multiply(-1, 5)).toBe(-5);
});
```

### Integration Testing

Tests how multiple units work together.

```javascript
// Integration test example
class UserService {
    constructor(userRepository) {
        this.userRepository = userRepository;
    }
    
    async createUser(userData) {
        // Validate
        if (!userData.email) {
            throw new Error(''Email required'');
        }
        // Save
        return await this.userRepository.save(userData);
    }
}

// Test: UserService + UserRepository work together
test(''createUser should save user'', async () => {
    let userRepository = new UserRepository();
    let userService = new UserService(userRepository);
    
    let user = await userService.createUser({
        email: ''test@example.com'',
        name: ''Test User''
    });
    
    expect(user.email).toBe(''test@example.com'');
});
```

### End-to-End (E2E) Testing

Tests the entire application from user''s perspective.

```javascript
// E2E test example (conceptual)
test(''user can login and view dashboard'', async () => {
    // 1. Open browser
    await page.goto(''http://localhost:3000'');
    
    // 2. Login
    await page.fill(''#email'', ''user@example.com'');
    await page.fill(''#password'', ''password'');
    await page.click(''#login-button'');
    
    // 3. Verify dashboard
    await expect(page.locator(''#dashboard'')).toBeVisible();
});
```

### Test Pyramid

```
        /\\
       /E2E\\        Few, slow, expensive
      /------\\
     /Integration\\  Some, medium speed
    /------------\\
   /   Unit Tests  \\  Many, fast, cheap
  /----------------\\
```

- **Many Unit Tests**: Fast, test individual functions
- **Some Integration Tests**: Test components together
- **Few E2E Tests**: Test critical user flows

---

## Test-Driven Development (TDD)

### What is TDD?

TDD is a development approach where you write tests before writing code.

### TDD Cycle

```
1. Red: Write failing test
2. Green: Write minimal code to pass
3. Refactor: Improve code while keeping tests green
```

### TDD Example

```javascript
// Step 1: Red - Write failing test
test(''calculateTotal should sum prices'', () => {
    let items = [
        { price: 10 },
        { price: 20 },
        { price: 30 }
    ];
    expect(calculateTotal(items)).toBe(60);
});
// Test fails: calculateTotal is not defined

// Step 2: Green - Write minimal code
function calculateTotal(items) {
    return 60;  // Hardcoded to pass test
}
// Test passes

// Step 3: Refactor - Write real implementation
function calculateTotal(items) {
    return items.reduce((sum, item) => sum + item.price, 0);
}
// Test still passes, code is correct
```

### Benefits of TDD

- **Better Design**: Forces you to think about interface first
- **Confidence**: Know code works from start
- **Documentation**: Tests document expected behavior
- **Refactoring**: Safe to refactor with tests

---

## Writing Basic Tests

### Test Structure

```javascript
// Basic test structure
test(''test description'', () => {
    // Arrange: Set up test data
    let input = 5;
    
    // Act: Execute code being tested
    let result = double(input);
    
    // Assert: Verify result
    expect(result).toBe(10);
});
```

### Arrange-Act-Assert Pattern

```javascript
// Arrange: Set up
let numbers = [1, 2, 3, 4, 5];

// Act: Execute
let sum = numbers.reduce((a, b) => a + b, 0);

// Assert: Verify
expect(sum).toBe(15);
```

### Test Cases

```javascript
// Test different cases
test(''add handles positive numbers'', () => {
    expect(add(2, 3)).toBe(5);
});

test(''add handles zero'', () => {
    expect(add(5, 0)).toBe(5);
});

test(''add handles negative numbers'', () => {
    expect(add(-2, 3)).toBe(1);
});

test(''add handles decimals'', () => {
    expect(add(1.5, 2.5)).toBe(4);
});
```

### Edge Cases

```javascript
// Test edge cases
test(''divide handles division by zero'', () => {
    expect(() => divide(10, 0)).toThrow(''Division by zero'');
});

test(''findUser handles empty array'', () => {
    expect(findUser([], 1)).toBeNull();
});

test(''validateEmail handles null'', () => {
    expect(validateEmail(null)).toBe(false);
});
```

---

## Test Organization

### Test Files

```javascript
// math.test.js
// Tests for math.js

import { add, subtract, multiply, divide } from ''./math.js'';

describe(''Math functions'', () => {
    test(''add should sum numbers'', () => {
        expect(add(2, 3)).toBe(5);
    });
    
    test(''subtract should subtract numbers'', () => {
        expect(subtract(5, 3)).toBe(2);
    });
    
    test(''multiply should multiply numbers'', () => {
        expect(multiply(2, 3)).toBe(6);
    });
    
    test(''divide should divide numbers'', () => {
        expect(divide(10, 2)).toBe(5);
    });
});
```

### Test Suites

```javascript
// Group related tests
describe(''UserService'', () => {
    describe(''createUser'', () => {
        test(''should create user with valid data'', () => {
            // Test
        });
        
        test(''should throw error with invalid email'', () => {
            // Test
        });
    });
    
    describe(''getUser'', () => {
        test(''should return user by id'', () => {
            // Test
        });
        
        test(''should return null if not found'', () => {
            // Test
        });
    });
});
```

---

## Practice Exercise

### Exercise: Writing Basic Tests

**Objective**: Practice writing basic tests, understanding test structure, and TDD.

**Instructions**:

1. Create a JavaScript file with functions to test
2. Create a test file
3. Practice:
   - Writing unit tests
   - Testing different cases
   - Testing edge cases
   - Using TDD approach

**Example Solution**:

```javascript
// calculator.js
function add(a, b) {
    return a + b;
}

function subtract(a, b) {
    return a - b;
}

function multiply(a, b) {
    return a * b;
}

function divide(a, b) {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
}

function calculateTotal(items) {
    return items.reduce((sum, item) => sum + item.price, 0);
}

function validateEmail(email) {
    if (!email) return false;
    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);
}

function findUser(users, id) {
    return users.find(user => user.id === id) || null;
}

module.exports = {
    add,
    subtract,
    multiply,
    divide,
    calculateTotal,
    validateEmail,
    findUser
};
```

```javascript
// calculator.test.js
const {
    add,
    subtract,
    multiply,
    divide,
    calculateTotal,
    validateEmail,
    findUser
} = require(''./calculator'');

console.log("=== Testing Basics Practice ===");

console.log("\\n=== Basic Tests ===");

// Test add
function testAdd() {
    console.log(''Testing add...'');
    
    // Positive numbers
    if (add(2, 3) !== 5) {
        console.error(''FAIL: add(2, 3) should be 5'');
        return false;
    }
    
    // Zero
    if (add(5, 0) !== 5) {
        console.error(''FAIL: add(5, 0) should be 5'');
        return false;
    }
    
    // Negative numbers
    if (add(-2, 3) !== 1) {
        console.error(''FAIL: add(-2, 3) should be 1'');
        return false;
    }
    
    // Decimals
    if (add(1.5, 2.5) !== 4) {
        console.error(''FAIL: add(1.5, 2.5) should be 4'');
        return false;
    }
    
    console.log(''✓ add tests passed'');
    return true;
}

// Test subtract
function testSubtract() {
    console.log(''Testing subtract...'');
    
    if (subtract(5, 3) !== 2) {
        console.error(''FAIL: subtract(5, 3) should be 2'');
        return false;
    }
    
    if (subtract(0, 5) !== -5) {
        console.error(''FAIL: subtract(0, 5) should be -5'');
        return false;
    }
    
    console.log(''✓ subtract tests passed'');
    return true;
}

// Test multiply
function testMultiply() {
    console.log(''Testing multiply...'');
    
    if (multiply(2, 3) !== 6) {
        console.error(''FAIL: multiply(2, 3) should be 6'');
        return false;
    }
    
    if (multiply(0, 5) !== 0) {
        console.error(''FAIL: multiply(0, 5) should be 0'');
        return false;
    }
    
    if (multiply(-2, 3) !== -6) {
        console.error(''FAIL: multiply(-2, 3) should be -6'');
        return false;
    }
    
    console.log(''✓ multiply tests passed'');
    return true;
}

// Test divide
function testDivide() {
    console.log(''Testing divide...'');
    
    if (divide(10, 2) !== 5) {
        console.error(''FAIL: divide(10, 2) should be 5'');
        return false;
    }
    
    // Test division by zero
    try {
        divide(10, 0);
        console.error(''FAIL: divide(10, 0) should throw error'');
        return false;
    } catch (error) {
        if (error.message !== ''Division by zero'') {
            console.error(''FAIL: Error message should be "Division by zero"'');
            return false;
        }
    }
    
    console.log(''✓ divide tests passed'');
    return true;
}

console.log();

console.log("=== Edge Cases ===");

// Test calculateTotal
function testCalculateTotal() {
    console.log(''Testing calculateTotal...'');
    
    // Normal case
    let items1 = [
        { price: 10 },
        { price: 20 },
        { price: 30 }
    ];
    if (calculateTotal(items1) !== 60) {
        console.error(''FAIL: calculateTotal should be 60'');
        return false;
    }
    
    // Empty array
    if (calculateTotal([]) !== 0) {
        console.error(''FAIL: calculateTotal([]) should be 0'');
        return false;
    }
    
    // Single item
    if (calculateTotal([{ price: 5 }]) !== 5) {
        console.error(''FAIL: calculateTotal with single item should be 5'');
        return false;
    }
    
    console.log(''✓ calculateTotal tests passed'');
    return true;
}

// Test validateEmail
function testValidateEmail() {
    console.log(''Testing validateEmail...'');
    
    // Valid emails
    if (!validateEmail(''test@example.com'')) {
        console.error(''FAIL: "test@example.com" should be valid'');
        return false;
    }
    
    if (!validateEmail(''user.name@example.co.uk'')) {
        console.error(''FAIL: "user.name@example.co.uk" should be valid'');
        return false;
    }
    
    // Invalid emails
    if (validateEmail(''invalid'')) {
        console.error(''FAIL: "invalid" should be invalid'');
        return false;
    }
    
    if (validateEmail(''invalid@'')) {
        console.error(''FAIL: "invalid@" should be invalid'');
        return false;
    }
    
    if (validateEmail(''@example.com'')) {
        console.error(''FAIL: "@example.com" should be invalid'');
        return false;
    }
    
    // Edge cases
    if (validateEmail(null)) {
        console.error(''FAIL: null should be invalid'');
        return false;
    }
    
    if (validateEmail('''')) {
        console.error(''FAIL: empty string should be invalid'');
        return false;
    }
    
    console.log(''✓ validateEmail tests passed'');
    return true;
}

// Test findUser
function testFindUser() {
    console.log(''Testing findUser...'');
    
    let users = [
        { id: 1, name: ''Alice'' },
        { id: 2, name: ''Bob'' },
        { id: 3, name: ''Charlie'' }
    ];
    
    // Found
    let user = findUser(users, 2);
    if (!user || user.name !== ''Bob'') {
        console.error(''FAIL: findUser should find user with id 2'');
        return false;
    }
    
    // Not found
    if (findUser(users, 99) !== null) {
        console.error(''FAIL: findUser should return null for non-existent id'');
        return false;
    }
    
    // Empty array
    if (findUser([], 1) !== null) {
        console.error(''FAIL: findUser should return null for empty array'');
        return false;
    }
    
    console.log(''✓ findUser tests passed'');
    return true;
}

console.log();

console.log("=== TDD Example ===");

// TDD: Test first, then implement
function testReverseString() {
    console.log(''Testing reverseString (TDD example)...'');
    
    // Step 1: Red - Write failing test
    // We expect reverseString to exist and work
    try {
        if (reverseString(''hello'') !== ''olleh'') {
            console.error(''FAIL: reverseString("hello") should be "olleh"'');
            return false;
        }
    } catch (error) {
        console.log(''Function not implemented yet (expected in TDD)'');
        return false;
    }
    
    console.log(''✓ reverseString test passed'');
    return true;
}

// Step 2: Green - Implement function
function reverseString(str) {
    return str.split('''').reverse().join('''');
}

// Step 3: Refactor - Already good, but could optimize
// Current implementation is fine

console.log();

console.log("=== Running All Tests ===");

let allTestsPassed = true;

allTestsPassed = testAdd() && allTestsPassed;
allTestsPassed = testSubtract() && allTestsPassed;
allTestsPassed = testMultiply() && allTestsPassed;
allTestsPassed = testDivide() && allTestsPassed;
allTestsPassed = testCalculateTotal() && allTestsPassed;
allTestsPassed = testValidateEmail() && allTestsPassed;
allTestsPassed = testFindUser() && allTestsPassed;
allTestsPassed = testReverseString() && allTestsPassed;

console.log();
if (allTestsPassed) {
    console.log(''✓ All tests passed!'');
} else {
    console.log(''✗ Some tests failed'');
}
```

**Expected Output**:
```
=== Testing Basics Practice ===

=== Basic Tests ===
Testing add...
✓ add tests passed
Testing subtract...
✓ subtract tests passed
Testing multiply...
✓ multiply tests passed
Testing divide...
✓ divide tests passed

=== Edge Cases ===
Testing calculateTotal...
✓ calculateTotal tests passed
Testing validateEmail...
✓ validateEmail tests passed
Testing findUser...
✓ findUser tests passed

=== TDD Example ===
Testing reverseString (TDD example)...
✓ reverseString test passed

=== Running All Tests ===
✓ All tests passed!
```

**Challenge (Optional)**:
- Write tests for your own functions
- Practice TDD on a new feature
- Write tests for edge cases
- Build a test suite

---

## Common Mistakes

### 1. Not Testing Edge Cases

```javascript
// ❌ Bad: Only test happy path
test(''add works'', () => {
    expect(add(2, 3)).toBe(5);
});

// ✅ Good: Test edge cases
test(''add works with positive numbers'', () => {
    expect(add(2, 3)).toBe(5);
});

test(''add works with zero'', () => {
    expect(add(5, 0)).toBe(5);
});

test(''add works with negative numbers'', () => {
    expect(add(-2, 3)).toBe(1);
});
```

### 2. Testing Implementation Details

```javascript
// ❌ Bad: Test implementation
test(''should use reduce'', () => {
    // Test checks if reduce is used
});

// ✅ Good: Test behavior
test(''should calculate total'', () => {
    expect(calculateTotal(items)).toBe(60);
});
```

### 3. Not Cleaning Up

```javascript
// ❌ Bad: Tests affect each other
let globalData = [];

test(''test 1'', () => {
    globalData.push(1);
});

test(''test 2'', () => {
    // globalData might have data from test 1
});

// ✅ Good: Clean up between tests
beforeEach(() => {
    globalData = [];
});
```

---

## Key Takeaways

1. **Why Test**: Confidence, documentation, refactoring safety
2. **Test Types**: Unit, integration, E2E
3. **Test Pyramid**: Many unit, some integration, few E2E
4. **TDD**: Red-Green-Refactor cycle
5. **Test Structure**: Arrange-Act-Assert
6. **Edge Cases**: Test boundaries and errors
7. **Best Practice**: Test behavior, not implementation

---

## Quiz: Testing Basics

Test your understanding with these questions:

1. **Unit testing tests:**
   - A) Individual functions
   - B) Entire application
   - C) Both
   - D) Neither

2. **Integration testing tests:**
   - A) Single function
   - B) Multiple components together
   - C) Entire app
   - D) Nothing

3. **E2E testing tests:**
   - A) Single function
   - B) Components
   - C) Entire application
   - D) Nothing

4. **TDD cycle:**
   - A) Red-Green-Refactor
   - B) Green-Red-Refactor
   - C) Refactor-Red-Green
   - D) Random

5. **Test pyramid has:**
   - A) Many unit tests
   - B) Some integration tests
   - C) Few E2E tests
   - D) All of the above

6. **Tests should:**
   - A) Test behavior
   - B) Test implementation
   - C) Both
   - D) Neither

7. **Edge cases should:**
   - A) Be tested
   - B) Be ignored
   - C) Sometimes tested
   - D) Never tested

**Answers**:
1. A) Individual functions
2. B) Multiple components together
3. C) Entire application
4. A) Red-Green-Refactor
5. D) All of the above
6. A) Test behavior
7. A) Be tested

---

## Next Steps

Congratulations! You''ve learned testing basics. You now know:
- Why testing is important
- Different types of testing
- Test-driven development
- How to write basic tests

**What''s Next?**
- Lesson 22.2: Jest Framework
- Learn Jest testing framework
- Write tests with Jest
- Use matchers and mocking

---

## Additional Resources

- **Jest Documentation**: [jestjs.io](https://jestjs.io)
- **Testing Best Practices**: [testingjavascript.com](https://testingjavascript.com)
- **MDN: Testing**: [developer.mozilla.org/en-US/docs/Learn/Tools_and_testing](https://developer.mozilla.org/en-US/docs/Learn/Tools_and_testing)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand why testing is important
- Know different types of testing
- Understand test-driven development (TDD)
- Write basic tests
- Structure test files
- Run tests
- Build confidence in your code');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (167, 62, 15, 'Jest Framework', 'jest-framework', '# Lesson 22.2: Jest Framework

## Learning Objectives

By the end of this lesson, you will be able to:
- Install and set up Jest
- Write tests with Jest
- Use Jest matchers
- Test asynchronous code
- Mock functions and modules
- Use Jest features effectively
- Build comprehensive test suites

---

## Introduction to Jest

Jest is a JavaScript testing framework developed by Facebook. It''s popular, easy to use, and has many built-in features.

### Why Jest?

- **Zero Configuration**: Works out of the box
- **Fast**: Parallel test execution
- **Built-in Mocking**: Easy to mock functions
- **Snapshot Testing**: Test UI components
- **Coverage Reports**: Built-in coverage
- **Great Documentation**: Excellent docs
- **Popular**: Widely used in industry

---

## Installing Jest

### npm Installation

```bash
# Install Jest
npm install --save-dev jest

# Or with yarn
yarn add --dev jest
```

### package.json Configuration

```json
{
  "scripts": {
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage"
  },
  "devDependencies": {
    "jest": "^29.0.0"
  }
}
```

### Running Tests

```bash
# Run all tests
npm test

# Run in watch mode
npm test -- --watch

# Run with coverage
npm test -- --coverage
```

---

## Writing Tests

### Basic Test

```javascript
// math.js
function add(a, b) {
    return a + b;
}

module.exports = { add };
```

```javascript
// math.test.js
const { add } = require(''./math'');

test(''adds 1 + 2 to equal 3'', () => {
    expect(add(1, 2)).toBe(3);
});
```

### Test Structure

```javascript
// test(description, testFunction)
test(''should do something'', () => {
    // Test code
});

// or using describe
describe(''Math functions'', () => {
    test(''add should sum numbers'', () => {
        expect(add(2, 3)).toBe(5);
    });
});
```

### describe Blocks

```javascript
describe(''Calculator'', () => {
    describe(''add'', () => {
        test(''should add positive numbers'', () => {
            expect(add(2, 3)).toBe(5);
        });
        
        test(''should add negative numbers'', () => {
            expect(add(-2, -3)).toBe(-5);
        });
    });
    
    describe(''subtract'', () => {
        test(''should subtract numbers'', () => {
            expect(subtract(5, 3)).toBe(2);
        });
    });
});
```

---

## Matchers

### Common Matchers

```javascript
// toBe - Exact equality
expect(2 + 2).toBe(4);

// toEqual - Deep equality
expect({ a: 1 }).toEqual({ a: 1 });

// not - Negation
expect(2 + 2).not.toBe(5);

// toBeTruthy - Truthy value
expect(true).toBeTruthy();
expect(1).toBeTruthy();

// toBeFalsy - Falsy value
expect(false).toBeFalsy();
expect(0).toBeFalsy();
expect(null).toBeFalsy();

// toBeNull - Null
expect(null).toBeNull();

// toBeUndefined - Undefined
expect(undefined).toBeUndefined();

// toBeDefined - Not undefined
expect(5).toBeDefined();
```

### Number Matchers

```javascript
// toBeGreaterThan
expect(10).toBeGreaterThan(5);

// toBeGreaterThanOrEqual
expect(10).toBeGreaterThanOrEqual(10);

// toBeLessThan
expect(5).toBeLessThan(10);

// toBeLessThanOrEqual
expect(5).toBeLessThanOrEqual(5);

// toBeCloseTo - For floating point
expect(0.1 + 0.2).toBeCloseTo(0.3);
```

### String Matchers

```javascript
// toMatch - Regex
expect(''Hello World'').toMatch(/World/);

// toContain - Substring
expect(''Hello World'').toContain(''World'');
```

### Array Matchers

```javascript
// toContain
expect([''apple'', ''banana'', ''orange'']).toContain(''banana'');

// toHaveLength
expect([1, 2, 3]).toHaveLength(3);
```

### Object Matchers

```javascript
// toHaveProperty
expect({ name: ''Alice'', age: 30 }).toHaveProperty(''name'');
expect({ name: ''Alice'', age: 30 }).toHaveProperty(''age'', 30);

// toMatchObject
expect({ name: ''Alice'', age: 30 }).toMatchObject({ name: ''Alice'' });
```

### Exception Matchers

```javascript
// toThrow
expect(() => {
    throw new Error(''Error message'');
}).toThrow();

expect(() => {
    throw new Error(''Error message'');
}).toThrow(''Error message'');

expect(() => {
    throw new Error(''Error message'');
}).toThrow(Error);
```

---

## Async Testing

### Promises

```javascript
// Return promise
test(''fetches data'', () => {
    return fetchData().then(data => {
        expect(data).toBeDefined();
    });
});

// Or use async/await
test(''fetches data'', async () => {
    let data = await fetchData();
    expect(data).toBeDefined();
});
```

### Async/Await

```javascript
test(''async function works'', async () => {
    let result = await asyncFunction();
    expect(result).toBe(''expected value'');
});
```

### Resolves/Rejects

```javascript
// Resolves
test(''promise resolves'', async () => {
    await expect(fetchData()).resolves.toBe(''data'');
});

// Rejects
test(''promise rejects'', async () => {
    await expect(failingFunction()).rejects.toThrow(''Error'');
});
```

### Timeouts

```javascript
// Set timeout
test(''slow operation'', async () => {
    await slowOperation();
}, 10000);  // 10 second timeout
```

---

## Mocking

### Mock Functions

```javascript
// Create mock function
let mockFn = jest.fn();

// Use mock
mockFn(''arg1'', ''arg2'');

// Check calls
expect(mockFn).toHaveBeenCalled();
expect(mockFn).toHaveBeenCalledWith(''arg1'', ''arg2'');
expect(mockFn).toHaveBeenCalledTimes(1);

// Mock return value
let mockFn = jest.fn();
mockFn.mockReturnValue(42);
expect(mockFn()).toBe(42);

// Mock implementation
let mockFn = jest.fn((a, b) => a + b);
expect(mockFn(2, 3)).toBe(5);
```

### Mocking Modules

```javascript
// Mock entire module
jest.mock(''./api'');

// Mock specific function
jest.mock(''./api'', () => ({
    fetchUser: jest.fn(() => Promise.resolve({ id: 1, name: ''Test'' }))
}));
```

### Mock Implementation

```javascript
// Mock with implementation
let mockFn = jest.fn();
mockFn.mockImplementation((a, b) => a * b);
expect(mockFn(2, 3)).toBe(6);

// Different implementations per call
mockFn
    .mockImplementationOnce(() => 1)
    .mockImplementationOnce(() => 2);
expect(mockFn()).toBe(1);
expect(mockFn()).toBe(2);
```

### Spying

```javascript
// Spy on existing function
let obj = {
    method: () => ''original''
};

let spy = jest.spyOn(obj, ''method'');
obj.method();
expect(spy).toHaveBeenCalled();

// Restore original
spy.mockRestore();
```

---

## Setup and Teardown

### beforeEach and afterEach

```javascript
let database;

beforeEach(() => {
    database = new Database();
    database.connect();
});

afterEach(() => {
    database.disconnect();
});

test(''test 1'', () => {
    // database is available
});

test(''test 2'', () => {
    // database is fresh for each test
});
```

### beforeAll and afterAll

```javascript
let sharedResource;

beforeAll(() => {
    sharedResource = initializeResource();
});

afterAll(() => {
    cleanupResource(sharedResource);
});

test(''test 1'', () => {
    // Uses sharedResource
});

test(''test 2'', () => {
    // Uses same sharedResource
});
```

---

## Practice Exercise

### Exercise: Jest Practice

**Objective**: Practice writing tests with Jest, using matchers, testing async code, and mocking.

**Instructions**:

1. Install Jest
2. Create test files
3. Practice:
   - Writing tests with Jest
   - Using matchers
   - Testing async code
   - Mocking functions and modules

**Example Solution**:

```javascript
// utils.js
function add(a, b) {
    return a + b;
}

function multiply(a, b) {
    return a * b;
}

function divide(a, b) {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
}

async function fetchUser(id) {
    // Simulate API call
    return new Promise(resolve => {
        setTimeout(() => {
            resolve({ id, name: ''User '' + id });
        }, 100);
    });
}

function processItems(items, processor) {
    return items.map(processor);
}

module.exports = {
    add,
    multiply,
    divide,
    fetchUser,
    processItems
};
```

```javascript
// utils.test.js
const {
    add,
    multiply,
    divide,
    fetchUser,
    processItems
} = require(''./utils'');

describe(''Math functions'', () => {
    describe(''add'', () => {
        test(''should add positive numbers'', () => {
            expect(add(2, 3)).toBe(5);
        });
        
        test(''should add negative numbers'', () => {
            expect(add(-2, -3)).toBe(-5);
        });
        
        test(''should add zero'', () => {
            expect(add(5, 0)).toBe(5);
        });
        
        test(''should handle decimals'', () => {
            expect(add(1.5, 2.5)).toBe(4);
        });
    });
    
    describe(''multiply'', () => {
        test(''should multiply numbers'', () => {
            expect(multiply(2, 3)).toBe(6);
        });
        
        test(''should multiply by zero'', () => {
            expect(multiply(5, 0)).toBe(0);
        });
    });
    
    describe(''divide'', () => {
        test(''should divide numbers'', () => {
            expect(divide(10, 2)).toBe(5);
        });
        
        test(''should throw error on division by zero'', () => {
            expect(() => divide(10, 0)).toThrow(''Division by zero'');
        });
    });
});

describe(''Async functions'', () => {
    test(''fetchUser should return user'', async () => {
        let user = await fetchUser(1);
        expect(user).toEqual({ id: 1, name: ''User 1'' });
    });
    
    test(''fetchUser should resolve'', async () => {
        await expect(fetchUser(1)).resolves.toEqual({ id: 1, name: ''User 1'' });
    });
});

describe(''Mocking'', () => {
    test(''processItems should use processor function'', () => {
        let mockProcessor = jest.fn(x => x * 2);
        let items = [1, 2, 3];
        
        let result = processItems(items, mockProcessor);
        
        expect(result).toEqual([2, 4, 6]);
        expect(mockProcessor).toHaveBeenCalledTimes(3);
        expect(mockProcessor).toHaveBeenCalledWith(1);
        expect(mockProcessor).toHaveBeenCalledWith(2);
        expect(mockProcessor).toHaveBeenCalledWith(3);
    });
    
    test(''mock function with return value'', () => {
        let mockFn = jest.fn();
        mockFn.mockReturnValue(42);
        
        expect(mockFn()).toBe(42);
        expect(mockFn).toHaveBeenCalled();
    });
    
    test(''mock function with implementation'', () => {
        let mockFn = jest.fn((a, b) => a + b);
        
        expect(mockFn(2, 3)).toBe(5);
        expect(mockFn).toHaveBeenCalledWith(2, 3);
    });
    
    test(''mock function multiple calls'', () => {
        let mockFn = jest.fn();
        mockFn.mockReturnValueOnce(1);
        mockFn.mockReturnValueOnce(2);
        mockFn.mockReturnValue(3);
        
        expect(mockFn()).toBe(1);
        expect(mockFn()).toBe(2);
        expect(mockFn()).toBe(3);
        expect(mockFn()).toBe(3);
    });
});

describe(''Matchers'', () => {
    test(''toBe vs toEqual'', () => {
        expect(2 + 2).toBe(4);
        expect({ a: 1 }).toEqual({ a: 1 });
        expect({ a: 1 }).not.toBe({ a: 1 });  // Different objects
    });
    
    test(''truthiness'', () => {
        expect(true).toBeTruthy();
        expect(1).toBeTruthy();
        expect(false).toBeFalsy();
        expect(0).toBeFalsy();
        expect(null).toBeNull();
        expect(undefined).toBeUndefined();
    });
    
    test(''numbers'', () => {
        expect(10).toBeGreaterThan(5);
        expect(5).toBeLessThan(10);
        expect(0.1 + 0.2).toBeCloseTo(0.3);
    });
    
    test(''strings'', () => {
        expect(''Hello World'').toMatch(/World/);
        expect(''Hello World'').toContain(''World'');
    });
    
    test(''arrays'', () => {
        expect([1, 2, 3]).toContain(2);
        expect([1, 2, 3]).toHaveLength(3);
    });
    
    test(''objects'', () => {
        let obj = { name: ''Alice'', age: 30 };
        expect(obj).toHaveProperty(''name'');
        expect(obj).toHaveProperty(''age'', 30);
        expect(obj).toMatchObject({ name: ''Alice'' });
    });
});

describe(''Setup and Teardown'', () => {
    let data;
    
    beforeEach(() => {
        data = [];
    });
    
    afterEach(() => {
        data = null;
    });
    
    test(''test 1'', () => {
        data.push(1);
        expect(data).toHaveLength(1);
    });
    
    test(''test 2'', () => {
        // data is fresh (empty)
        expect(data).toHaveLength(0);
    });
});
```

**Expected Output** (when running `npm test`):
```
PASS  utils.test.js
  Math functions
    add
      ✓ should add positive numbers (2 ms)
      ✓ should add negative numbers
      ✓ should add zero
      ✓ should handle decimals
    multiply
      ✓ should multiply numbers
      ✓ should multiply by zero
    divide
      ✓ should divide numbers
      ✓ should throw error on division by zero
  Async functions
    ✓ fetchUser should return user (105 ms)
    ✓ fetchUser should resolves
  Mocking
    ✓ processItems should use processor function
    ✓ mock function with return value
    ✓ mock function with implementation
    ✓ mock function multiple calls
  Matchers
    ✓ toBe vs toEqual
    ✓ truthiness
    ✓ numbers
    ✓ strings
    ✓ arrays
    ✓ objects
  Setup and Teardown
    ✓ test 1
    ✓ test 2

Test Suites: 1 passed, 1 total
Tests:       20 passed, 20 total
```

**Challenge (Optional)**:
- Write tests for your own code
- Practice mocking complex dependencies
- Test async operations
- Build a complete test suite

---

## Common Mistakes

### 1. Not Awaiting Async

```javascript
// ❌ Bad: Not awaiting
test(''async test'', () => {
    fetchData().then(data => {
        expect(data).toBeDefined();
    });
    // Test might finish before promise resolves
});

// ✅ Good: Await
test(''async test'', async () => {
    let data = await fetchData();
    expect(data).toBeDefined();
});
```

### 2. Not Clearing Mocks

```javascript
// ❌ Bad: Mocks accumulate
test(''test 1'', () => {
    mockFn();
});

test(''test 2'', () => {
    mockFn();
    // mockFn has been called twice total
});

// ✅ Good: Clear between tests
beforeEach(() => {
    mockFn.mockClear();
});
```

### 3. Testing Implementation

```javascript
// ❌ Bad: Test implementation
test(''should use reduce'', () => {
    // Check if reduce is used
});

// ✅ Good: Test behavior
test(''should calculate total'', () => {
    expect(calculateTotal(items)).toBe(60);
});
```

---

## Key Takeaways

1. **Jest**: Popular, easy-to-use testing framework
2. **Matchers**: toBe, toEqual, toContain, etc.
3. **Async Testing**: Use async/await or promises
4. **Mocking**: Mock functions and modules
5. **Setup/Teardown**: beforeEach, afterEach, beforeAll, afterAll
6. **Best Practice**: Test behavior, clear mocks, await async
7. **Coverage**: Use --coverage for coverage reports

---

## Quiz: Jest

Test your understanding with these questions:

1. **Jest is:**
   - A) Testing framework
   - B) Build tool
   - C) Both
   - D) Neither

2. **toBe checks:**
   - A) Deep equality
   - B) Exact equality
   - C) Both
   - D) Neither

3. **toEqual checks:**
   - A) Deep equality
   - B) Exact equality
   - C) Both
   - D) Neither

4. **jest.fn() creates:**
   - A) Mock function
   - B) Real function
   - C) Both
   - D) Neither

5. **beforeEach runs:**
   - A) Once before all tests
   - B) Before each test
   - C) After each test
   - D) Never

6. **Async tests need:**
   - A) async/await
   - B) .then()
   - C) Both
   - D) Neither

7. **--coverage flag:**
   - A) Shows coverage
   - B) Runs faster
   - C) Both
   - D) Neither

**Answers**:
1. A) Testing framework
2. B) Exact equality
3. A) Deep equality
4. A) Mock function
5. B) Before each test
6. C) Both
7. A) Shows coverage

---

## Next Steps

Congratulations! You''ve learned Jest framework. You now know:
- How to install and use Jest
- How to write tests
- How to use matchers
- How to test async code
- How to mock functions

**What''s Next?**
- Lesson 22.3: Advanced Testing
- Learn React component testing
- Understand integration testing
- Work with E2E testing tools

---

## Additional Resources

- **Jest Documentation**: [jestjs.io/docs/getting-started](https://jestjs.io/docs/getting-started)
- **Jest Matchers**: [jestjs.io/docs/expect](https://jestjs.io/docs/expect)
- **Jest Mocking**: [jestjs.io/docs/mock-functions](https://jestjs.io/docs/mock-functions)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Install and set up Jest
- Write tests with Jest
- Use Jest matchers
- Test asynchronous code
- Mock functions and modules
- Use Jest features effectively
- Build comprehensive test suites');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (168, 62, 15, 'Advanced Testing', 'advanced-testing', '# Lesson 22.3: Advanced Testing

## Learning Objectives

By the end of this lesson, you will be able to:
- Test React components
- Write integration tests
- Use E2E testing tools (Cypress, Playwright)
- Generate and read coverage reports
- Test complex scenarios
- Build comprehensive test suites
- Ensure application quality

---

## Introduction to Advanced Testing

Advanced testing covers component testing, integration testing, E2E testing, and coverage analysis.

### Why Advanced Testing?

- **Component Testing**: Test UI components in isolation
- **Integration Testing**: Test how components work together
- **E2E Testing**: Test complete user flows
- **Coverage**: Ensure code is tested
- **Quality**: Higher confidence in application
- **Professional**: Industry standard practices

---

## Testing React Components

### Setting Up React Testing

```bash
# Install React Testing Library
npm install --save-dev @testing-library/react @testing-library/jest-dom

# Install React Test Renderer
npm install --save-dev react-test-renderer
```

### Basic Component Test

```javascript
// Button.jsx
import React from ''react'';

function Button({ onClick, children }) {
    return (
        <button onClick={onClick}>
            {children}
        </button>
    );
}

export default Button;
```

```javascript
// Button.test.jsx
import React from ''react'';
import { render, screen, fireEvent } from ''@testing-library/react'';
import Button from ''./Button'';

test(''renders button with text'', () => {
    render(<Button>Click me</Button>);
    let button = screen.getByText(''Click me'');
    expect(button).toBeInTheDocument();
});

test(''calls onClick when clicked'', () => {
    let handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    
    let button = screen.getByText(''Click me'');
    fireEvent.click(button);
    
    expect(handleClick).toHaveBeenCalledTimes(1);
});
```

### Testing User Interactions

```javascript
// Form.test.jsx
import { render, screen, fireEvent } from ''@testing-library/react'';
import Form from ''./Form'';

test(''submits form with data'', () => {
    let handleSubmit = jest.fn();
    render(<Form onSubmit={handleSubmit} />);
    
    let nameInput = screen.getByLabelText(''Name'');
    let emailInput = screen.getByLabelText(''Email'');
    let submitButton = screen.getByRole(''button'', { name: ''Submit'' });
    
    fireEvent.change(nameInput, { target: { value: ''Alice'' } });
    fireEvent.change(emailInput, { target: { value: ''alice@example.com'' } });
    fireEvent.click(submitButton);
    
    expect(handleSubmit).toHaveBeenCalledWith({
        name: ''Alice'',
        email: ''alice@example.com''
    });
});
```

### Testing Async Components

```javascript
// UserProfile.test.jsx
import { render, screen, waitFor } from ''@testing-library/react'';
import UserProfile from ''./UserProfile'';

test(''displays user data after loading'', async () => {
    render(<UserProfile userId={1} />);
    
    // Wait for loading to finish
    await waitFor(() => {
        expect(screen.getByText(''Alice'')).toBeInTheDocument();
    });
});
```

---

## Integration Testing

### What is Integration Testing?

Integration testing verifies that multiple components work together correctly.

### Integration Test Example

```javascript
// UserList.test.jsx
import { render, screen } from ''@testing-library/react'';
import UserList from ''./UserList'';
import UserService from ''./UserService'';

// Mock service
jest.mock(''./UserService'');

test(''displays list of users'', async () => {
    UserService.getUsers.mockResolvedValue([
        { id: 1, name: ''Alice'' },
        { id: 2, name: ''Bob'' }
    ]);
    
    render(<UserList />);
    
    await waitFor(() => {
        expect(screen.getByText(''Alice'')).toBeInTheDocument();
        expect(screen.getByText(''Bob'')).toBeInTheDocument();
    });
});
```

### Testing Component Integration

```javascript
// App.test.jsx
import { render, screen, fireEvent } from ''@testing-library/react'';
import App from ''./App'';

test(''complete user flow'', async () => {
    render(<App />);
    
    // 1. Login
    let emailInput = screen.getByLabelText(''Email'');
    let passwordInput = screen.getByLabelText(''Password'');
    let loginButton = screen.getByRole(''button'', { name: ''Login'' });
    
    fireEvent.change(emailInput, { target: { value: ''user@example.com'' } });
    fireEvent.change(passwordInput, { target: { value: ''password'' } });
    fireEvent.click(loginButton);
    
    // 2. Verify dashboard
    await waitFor(() => {
        expect(screen.getByText(''Dashboard'')).toBeInTheDocument();
    });
    
    // 3. Navigate to profile
    let profileLink = screen.getByText(''Profile'');
    fireEvent.click(profileLink);
    
    // 4. Verify profile page
    expect(screen.getByText(''User Profile'')).toBeInTheDocument();
});
```

---

## End-to-End (E2E) Testing

### Cypress

```bash
# Install Cypress
npm install --save-dev cypress
```

```javascript
// cypress/e2e/login.cy.js
describe(''Login Flow'', () => {
    it(''should login successfully'', () => {
        cy.visit(''http://localhost:3000'');
        
        cy.get(''[data-testid="email"]'').type(''user@example.com'');
        cy.get(''[data-testid="password"]'').type(''password'');
        cy.get(''[data-testid="login-button"]'').click();
        
        cy.url().should(''include'', ''/dashboard'');
        cy.get(''[data-testid="dashboard"]'').should(''be.visible'');
    });
});
```

### Playwright

```bash
# Install Playwright
npm install --save-dev @playwright/test
```

```javascript
// tests/login.spec.js
const { test, expect } = require(''@playwright/test'');

test(''should login successfully'', async ({ page }) => {
    await page.goto(''http://localhost:3000'');
    
    await page.fill(''[data-testid="email"]'', ''user@example.com'');
    await page.fill(''[data-testid="password"]'', ''password'');
    await page.click(''[data-testid="login-button"]'');
    
    await expect(page).toHaveURL(/.*dashboard/);
    await expect(page.locator(''[data-testid="dashboard"]'')).toBeVisible();
});
```

### E2E Test Best Practices

```javascript
// Use data-testid for selectors
<button data-testid="submit-button">Submit</button>

// Wait for elements
await page.waitForSelector(''[data-testid="element"]'');

// Use meaningful test descriptions
test(''user can add item to cart and checkout'', async () => {
    // Test steps
});

// Clean up between tests
afterEach(async () => {
    await page.close();
});
```

---

## Coverage Reports

### Generating Coverage

```bash
# Run tests with coverage
npm test -- --coverage

# Or in package.json
{
  "scripts": {
    "test:coverage": "jest --coverage"
  }
}
```

### Coverage Metrics

```javascript
// Coverage shows:
// - Statements: % of statements executed
// - Branches: % of branches executed
// - Functions: % of functions called
// - Lines: % of lines executed

// Example coverage output:
// File      | % Stmts | % Branch | % Funcs | % Lines
// ----------|---------|----------|---------|--------
// utils.js  |   85.71 |    66.67 |   83.33 |   85.71
```

### Coverage Configuration

```javascript
// jest.config.js
module.exports = {
    collectCoverageFrom: [
        ''src/**/*.{js,jsx}'',
        ''!src/**/*.test.{js,jsx}'',
        ''!src/index.js''
    ],
    coverageThresholds: {
        global: {
            branches: 80,
            functions: 80,
            lines: 80,
            statements: 80
        }
    }
};
```

---

## Practice Exercise

### Exercise: Advanced Testing

**Objective**: Practice testing React components, integration testing, E2E testing concepts, and coverage.

**Instructions**:

1. Set up testing environment
2. Create components to test
3. Practice:
   - Testing React components
   - Writing integration tests
   - Understanding E2E testing
   - Generating coverage reports

**Example Solution**:

```javascript
// components/Button.jsx
import React from ''react'';

function Button({ onClick, children, disabled = false }) {
    return (
        <button onClick={onClick} disabled={disabled}>
            {children}
        </button>
    );
}

export default Button;
```

```javascript
// components/Button.test.jsx
import React from ''react'';
import { render, screen, fireEvent } from ''@testing-library/react'';
import ''@testing-library/jest-dom'';
import Button from ''./Button'';

describe(''Button Component'', () => {
    test(''renders button with text'', () => {
        render(<Button>Click me</Button>);
        let button = screen.getByRole(''button'', { name: ''Click me'' });
        expect(button).toBeInTheDocument();
    });
    
    test(''calls onClick when clicked'', () => {
        let handleClick = jest.fn();
        render(<Button onClick={handleClick}>Click me</Button>);
        
        let button = screen.getByRole(''button'');
        fireEvent.click(button);
        
        expect(handleClick).toHaveBeenCalledTimes(1);
    });
    
    test(''is disabled when disabled prop is true'', () => {
        render(<Button disabled>Click me</Button>);
        let button = screen.getByRole(''button'');
        expect(button).toBeDisabled();
    });
    
    test(''does not call onClick when disabled'', () => {
        let handleClick = jest.fn();
        render(<Button onClick={handleClick} disabled>Click me</Button>);
        
        let button = screen.getByRole(''button'');
        fireEvent.click(button);
        
        expect(handleClick).not.toHaveBeenCalled();
    });
});
```

```javascript
// components/Form.jsx
import React, { useState } from ''react'';
import Button from ''./Button'';

function Form({ onSubmit }) {
    let [name, setName] = useState('''');
    let [email, setEmail] = useState('''');
    
    let handleSubmit = (e) => {
        e.preventDefault();
        onSubmit({ name, email });
    };
    
    return (
        <form onSubmit={handleSubmit}>
            <label>
                Name:
                <input
                    type="text"
                    value={name}
                    onChange={(e) => setName(e.target.value)}
                    data-testid="name-input"
                />
            </label>
            <label>
                Email:
                <input
                    type="email"
                    value={email}
                    onChange={(e) => setEmail(e.target.value)}
                    data-testid="email-input"
                />
            </label>
            <Button type="submit">Submit</Button>
        </form>
    );
}

export default Form;
```

```javascript
// components/Form.test.jsx
import React from ''react'';
import { render, screen, fireEvent } from ''@testing-library/react'';
import ''@testing-library/jest-dom'';
import Form from ''./Form'';

describe(''Form Component'', () => {
    test(''submits form with data'', () => {
        let handleSubmit = jest.fn();
        render(<Form onSubmit={handleSubmit} />);
        
        let nameInput = screen.getByTestId(''name-input'');
        let emailInput = screen.getByTestId(''email-input'');
        let submitButton = screen.getByRole(''button'', { name: ''Submit'' });
        
        fireEvent.change(nameInput, { target: { value: ''Alice'' } });
        fireEvent.change(emailInput, { target: { value: ''alice@example.com'' } });
        fireEvent.click(submitButton);
        
        expect(handleSubmit).toHaveBeenCalledWith({
            name: ''Alice'',
            email: ''alice@example.com''
        });
    });
    
    test(''updates input values'', () => {
        render(<Form onSubmit={jest.fn()} />);
        
        let nameInput = screen.getByTestId(''name-input'');
        fireEvent.change(nameInput, { target: { value: ''Bob'' } });
        
        expect(nameInput.value).toBe(''Bob'');
    });
});
```

```javascript
// Integration test example
// App.test.jsx
import React from ''react'';
import { render, screen, fireEvent, waitFor } from ''@testing-library/react'';
import ''@testing-library/jest-dom'';
import App from ''./App'';

// Mock API
jest.mock(''./api'', () => ({
    login: jest.fn(),
    getUser: jest.fn()
}));

import { login, getUser } from ''./api'';

describe(''App Integration'', () => {
    beforeEach(() => {
        login.mockClear();
        getUser.mockClear();
    });
    
    test(''complete login flow'', async () => {
        login.mockResolvedValue({ token: ''abc123'' });
        getUser.mockResolvedValue({ id: 1, name: ''Alice'' });
        
        render(<App />);
        
        // Login
        let emailInput = screen.getByLabelText(''Email'');
        let passwordInput = screen.getByLabelText(''Password'');
        let loginButton = screen.getByRole(''button'', { name: ''Login'' });
        
        fireEvent.change(emailInput, { target: { value: ''alice@example.com'' } });
        fireEvent.change(passwordInput, { target: { value: ''password'' } });
        fireEvent.click(loginButton);
        
        // Wait for dashboard
        await waitFor(() => {
            expect(screen.getByText(''Welcome, Alice'')).toBeInTheDocument();
        });
        
        expect(login).toHaveBeenCalledWith({
            email: ''alice@example.com'',
            password: ''password''
        });
    });
});
```

```javascript
// E2E test concepts (Cypress example)
// cypress/e2e/user-flow.cy.js
describe(''User Flow'', () => {
    it(''should complete registration and login'', () => {
        // 1. Visit registration page
        cy.visit(''http://localhost:3000/register'');
        
        // 2. Fill registration form
        cy.get(''[data-testid="name"]'').type(''Alice'');
        cy.get(''[data-testid="email"]'').type(''alice@example.com'');
        cy.get(''[data-testid="password"]'').type(''password123'');
        cy.get(''[data-testid="register-button"]'').click();
        
        // 3. Verify redirect to login
        cy.url().should(''include'', ''/login'');
        
        // 4. Login
        cy.get(''[data-testid="email"]'').type(''alice@example.com'');
        cy.get(''[data-testid="password"]'').type(''password123'');
        cy.get(''[data-testid="login-button"]'').click();
        
        // 5. Verify dashboard
        cy.url().should(''include'', ''/dashboard'');
        cy.get(''[data-testid="dashboard"]'').should(''be.visible'');
    });
});
```

```javascript
// Coverage example
// Run: npm test -- --coverage

// Coverage output shows:
// - Which files are tested
// - Which lines are covered
// - Which branches are covered
// - Which functions are called

// Example:
// File      | % Stmts | % Branch | % Funcs | % Lines
// ----------|---------|----------|---------|--------
// Button.js |   100   |   100    |   100   |   100
// Form.js   |    85   |    75    |    90   |    85
```

**Expected Output** (when running tests):
```
PASS  components/Button.test.jsx
  Button Component
    ✓ renders button with text
    ✓ calls onClick when clicked
    ✓ is disabled when disabled prop is true
    ✓ does not call onClick when disabled

PASS  components/Form.test.jsx
  Form Component
    ✓ submits form with data
    ✓ updates input values

PASS  App.test.jsx
  App Integration
    ✓ complete login flow

Test Suites: 3 passed, 3 total
Tests:       7 passed, 7 total
```

**Challenge (Optional)**:
- Test complex React components
- Write integration tests for your app
- Set up E2E testing
- Achieve high test coverage

---

## Common Mistakes

### 1. Testing Implementation Details

```javascript
// ❌ Bad: Test implementation
test(''should use useState'', () => {
    // Check if useState is called
});

// ✅ Good: Test behavior
test(''should update input value'', () => {
    // Test that input value updates
});
```

### 2. Not Waiting for Async

```javascript
// ❌ Bad: Not waiting
test(''displays data'', () => {
    render(<Component />);
    expect(screen.getByText(''Data'')).toBeInTheDocument();
    // Might fail if data loads asynchronously
});

// ✅ Good: Wait for async
test(''displays data'', async () => {
    render(<Component />);
    await waitFor(() => {
        expect(screen.getByText(''Data'')).toBeInTheDocument();
    });
});
```

### 3. Over-Mocking

```javascript
// ❌ Bad: Mock everything
jest.mock(''./api'');
jest.mock(''./utils'');
jest.mock(''./services'');

// ✅ Good: Mock only what''s needed
jest.mock(''./api'');
// Test real utils and services when possible
```

---

## Key Takeaways

1. **Component Testing**: Test React components in isolation
2. **Integration Testing**: Test components working together
3. **E2E Testing**: Test complete user flows
4. **Coverage**: Measure how much code is tested
5. **Tools**: React Testing Library, Cypress, Playwright
6. **Best Practice**: Test behavior, wait for async, mock wisely
7. **Quality**: Comprehensive testing ensures quality

---

## Quiz: Advanced Testing

Test your understanding with these questions:

1. **React Testing Library:**
   - A) Tests implementation
   - B) Tests behavior
   - C) Both
   - D) Neither

2. **Integration testing:**
   - A) Tests single component
   - B) Tests multiple components
   - C) Tests entire app
   - D) Nothing

3. **E2E testing:**
   - A) Tests from user perspective
   - B) Tests single function
   - C) Both
   - D) Neither

4. **Cypress is for:**
   - A) Unit testing
   - B) E2E testing
   - C) Both
   - D) Neither

5. **Coverage shows:**
   - A) What''s tested
   - B) What''s not tested
   - C) Both
   - D) Neither

6. **waitFor is used for:**
   - A) Async operations
   - B) Sync operations
   - C) Both
   - D) Neither

7. **data-testid is for:**
   - A) Styling
   - B) Testing selectors
   - C) Both
   - D) Neither

**Answers**:
1. B) Tests behavior
2. B) Tests multiple components
3. A) Tests from user perspective
4. B) E2E testing
5. C) Both
6. A) Async operations
7. B) Testing selectors

---

## Next Steps

Congratulations! You''ve completed Module 22: Testing. You now know:
- Testing basics and TDD
- Jest framework
- React component testing
- Integration testing
- E2E testing concepts
- Coverage reports

**What''s Next?**
- Module 23: Build Tools and Bundlers
- Lesson 23.1: npm and Package Management
- Learn npm basics
- Work with package management

---

## Additional Resources

- **React Testing Library**: [testing-library.com/react](https://testing-library.com/react)
- **Cypress**: [cypress.io](https://cypress.io)
- **Playwright**: [playwright.dev](https://playwright.dev)
- **Jest Coverage**: [jestjs.io/docs/cli#--coverage](https://jestjs.io/docs/cli#--coverage)

---

*Lesson completed! You''ve finished Module 22: Testing. Ready for Module 23: Build Tools and Bundlers!*

', NULL, 3, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Test React components
- Write integration tests
- Use E2E testing tools (Cypress, Playwright)
- Generate and read coverage reports
- Test complex scenarios
- Build comprehensive test suites
- Ensure application quality');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (169, 63, 15, 'Build Tools Overview', 'build-tools-overview', '# Lesson 23.1: npm and Package Management

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand npm basics
- Work with package.json
- Install and manage packages
- Use npm scripts
- Understand package versions
- Manage dependencies
- Build professional projects

---

## Introduction to npm

npm (Node Package Manager) is the package manager for JavaScript. It''s used to install, share, and manage code packages.

### Why npm?

- **Package Management**: Install and manage dependencies
- **Code Sharing**: Share your code as packages
- **Scripts**: Run build and development scripts
- **Standard**: Industry standard for JavaScript
- **Ecosystem**: Huge library of packages
- **Professional**: Essential for modern development

---

## npm Basics

### Installing npm

```bash
# npm comes with Node.js
# Download Node.js from nodejs.org

# Check if installed
node --version
npm --version
```

### Initializing a Project

```bash
# Initialize new project
npm init

# Or with defaults
npm init -y
```

### package.json

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "My project description",
  "main": "index.js",
  "scripts": {
    "test": "echo \\"Error: no test specified\\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
```

---

## Installing Packages

### Install Commands

```bash
# Install package (adds to dependencies)
npm install package-name

# Short form
npm i package-name

# Install specific version
npm install package-name@1.2.3

# Install latest version
npm install package-name@latest

# Install dev dependency
npm install --save-dev package-name
npm install -D package-name

# Install globally
npm install -g package-name
```

### Package Types

```json
{
  "dependencies": {
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "jest": "^29.0.0"
  },
  "peerDependencies": {
    "react": "^18.0.0"
  },
  "optionalDependencies": {
    "optional-package": "^1.0.0"
  }
}
```

### Installing from package.json

```bash
# Install all dependencies
npm install

# Or
npm i
```

---

## package.json

### Basic Structure

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "Project description",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "jest",
    "build": "webpack"
  },
  "keywords": ["keyword1", "keyword2"],
  "author": "Your Name",
  "license": "MIT",
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "jest": "^29.0.0"
  }
}
```

### Important Fields

```json
{
  "name": "package-name",        // Package name
  "version": "1.0.0",            // Version (semver)
  "description": "Description",  // Package description
  "main": "index.js",            // Entry point
  "scripts": {},                 // npm scripts
  "dependencies": {},            // Production dependencies
  "devDependencies": {},         // Development dependencies
  "engines": {                   // Node/npm version requirements
    "node": ">=14.0.0",
    "npm": ">=6.0.0"
  }
}
```

---

## npm Scripts

### Basic Scripts

```json
{
  "scripts": {
    "start": "node index.js",
    "test": "jest",
    "build": "webpack --mode production",
    "dev": "webpack --mode development"
  }
}
```

### Running Scripts

```bash
# Run script
npm run script-name

# Shortcuts (start, test, stop, restart)
npm start
npm test
npm stop
npm restart
```

### Common Scripts

```json
{
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js",
    "build": "webpack",
    "test": "jest",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage",
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "format": "prettier --write .",
    "prebuild": "npm run lint",
    "postbuild": "echo ''Build complete''"
  }
}
```

### Pre and Post Scripts

```json
{
  "scripts": {
    "prebuild": "npm run lint",      // Runs before build
    "build": "webpack",
    "postbuild": "echo ''Done''"       // Runs after build
  }
}
```

---

## Package Versions

### Semantic Versioning (Semver)

```javascript
// Version format: MAJOR.MINOR.PATCH
// 1.2.3
// ^1.2.3 - Compatible with 1.x.x (>=1.2.3 <2.0.0)
// ~1.2.3 - Compatible with 1.2.x (>=1.2.3 <1.3.0)
// 1.2.3  - Exact version
// *      - Any version
// latest - Latest version
```

### Version Ranges

```json
{
  "dependencies": {
    "package1": "^1.2.3",    // 1.2.3 to <2.0.0
    "package2": "~1.2.3",    // 1.2.3 to <1.3.0
    "package3": "1.2.3",     // Exact version
    "package4": ">=1.2.3",   // >= 1.2.3
    "package5": "<2.0.0",     // < 2.0.0
    "package6": "*"           // Any version
  }
}
```

### Updating Packages

```bash
# Check outdated packages
npm outdated

# Update package
npm update package-name

# Update all packages
npm update

# Install latest version
npm install package-name@latest
```

---

## Managing Dependencies

### Viewing Dependencies

```bash
# List installed packages
npm list

# List only top-level
npm list --depth=0

# Check package info
npm info package-name

# View package.json of package
npm view package-name
```

### Removing Packages

```bash
# Remove package
npm uninstall package-name

# Short form
npm uninstall package-name

# Remove from devDependencies
npm uninstall --save-dev package-name
```

### package-lock.json

```json
// package-lock.json locks exact versions
// Ensures consistent installs across environments
// Should be committed to version control
```

---

## npm Registry

### Using npm Registry

```bash
# Install from npm registry (default)
npm install package-name

# Install from specific registry
npm install --registry=https://registry.npmjs.org/

# Set registry
npm config set registry https://registry.npmjs.org/
```

### Publishing Packages

```bash
# Login to npm
npm login

# Publish package
npm publish

# Publish with specific version
npm publish --tag beta
```

---

## Practice Exercise

### Exercise: npm Practice

**Objective**: Practice using npm, managing packages, and working with package.json.

**Instructions**:

1. Initialize a new npm project
2. Install packages
3. Create scripts
4. Practice:
   - Installing packages
   - Managing dependencies
   - Using scripts
   - Understanding versions

**Example Solution**:

```bash
# 1. Initialize project
npm init -y

# 2. Install dependencies
npm install express
npm install --save-dev jest

# 3. Create package.json with scripts
```

```json
// package.json
{
  "name": "npm-practice",
  "version": "1.0.0",
  "description": "npm practice project",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "dev": "node index.js",
    "test": "jest",
    "test:watch": "jest --watch",
    "lint": "echo ''Linting...''",
    "build": "echo ''Building...''"
  },
  "keywords": ["practice", "npm"],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "jest": "^29.0.0"
  }
}
```

```javascript
// index.js
const express = require(''express'');
const app = express();

app.get(''/'', (req, res) => {
    res.send(''Hello from npm practice!'');
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

```javascript
// test.js
// Basic test example
function add(a, b) {
    return a + b;
}

// Run with: node test.js
console.log(''Testing add function:'');
console.log(''add(2, 3) ='', add(2, 3));
console.log(''add(5, 7) ='', add(5, 7));
```

```bash
# Commands to practice:

# Install packages
npm install lodash
npm install --save-dev nodemon

# View installed packages
npm list
npm list --depth=0

# Check outdated
npm outdated

# Update package
npm update lodash

# Remove package
npm uninstall lodash

# Run scripts
npm start
npm test
npm run dev

# Check package info
npm info express
npm view express version
```

**Expected Output** (when running commands):
```
# npm init -y
Wrote to package.json

# npm install express
added 1 package

# npm list
npm-practice@1.0.0
└── express@4.18.0

# npm start
Server running on port 3000
```

**Challenge (Optional)**:
- Create a complete project with npm
- Set up build scripts
- Manage multiple dependencies
- Publish your own package

---

## Common Mistakes

### 1. Not Using package-lock.json

```bash
# ❌ Bad: Delete package-lock.json
rm package-lock.json

# ✅ Good: Commit package-lock.json
git add package-lock.json
```

### 2. Installing Globally When Not Needed

```bash
# ❌ Bad: Install dev tools globally
npm install -g jest

# ✅ Good: Install as dev dependency
npm install --save-dev jest
```

### 3. Wrong Version Ranges

```json
// ❌ Bad: Too permissive
{
  "dependencies": {
    "package": "*"
  }
}

// ✅ Good: Specific range
{
  "dependencies": {
    "package": "^1.2.3"
  }
}
```

---

## Key Takeaways

1. **npm**: Node Package Manager for JavaScript
2. **package.json**: Project configuration file
3. **Dependencies**: Production and development
4. **Scripts**: Automate tasks with npm scripts
5. **Versions**: Use semantic versioning
6. **Best Practice**: Commit package-lock.json, use specific versions
7. **Ecosystem**: Huge library of packages available

---

## Quiz: npm

Test your understanding with these questions:

1. **npm stands for:**
   - A) Node Package Manager
   - B) Node Program Manager
   - C) New Package Manager
   - D) Nothing

2. **npm install adds to:**
   - A) dependencies
   - B) devDependencies
   - C) Both (depending on flag)
   - D) Neither

3. **package-lock.json:**
   - A) Should be committed
   - B) Should be ignored
   - C) Optional
   - D) Nothing

4. **^1.2.3 means:**
   - A) Exact version
   - B) Compatible with 1.x.x
   - C) Latest version
   - D) Nothing

5. **npm scripts run with:**
   - A) npm run script-name
   - B) npm script-name
   - C) Both (for some)
   - D) Neither

6. **devDependencies are:**
   - A) For production
   - B) For development
   - C) Both
   - D) Neither

7. **npm outdated shows:**
   - A) Outdated packages
   - B) All packages
   - C) Installed packages
   - D) Nothing

**Answers**:
1. A) Node Package Manager
2. C) Both (depending on flag)
3. A) Should be committed
4. B) Compatible with 1.x.x
5. C) Both (for some)
6. B) For development
7. A) Outdated packages

---

## Next Steps

Congratulations! You''ve learned npm and package management. You now know:
- How to use npm
- How to manage packages
- How to use scripts
- How to work with versions

**What''s Next?**
- Lesson 23.2: Webpack
- Learn webpack basics
- Configure webpack
- Use loaders and plugins

---

## Additional Resources

- **npm Documentation**: [docs.npmjs.com](https://docs.npmjs.com)
- **package.json Guide**: [docs.npmjs.com/cli/v8/configuring-npm/package-json](https://docs.npmjs.com/cli/v8/configuring-npm/package-json)
- **Semantic Versioning**: [semver.org](https://semver.org)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand npm basics
- Work with package.json
- Install and manage packages
- Use npm scripts
- Understand package versions
- Manage dependencies
- Build professional projects');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (170, 63, 15, 'Webpack', 'webpack', '# Lesson 23.2: Webpack

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand webpack basics
- Configure webpack
- Use loaders for different file types
- Use plugins for additional functionality
- Implement code splitting
- Optimize builds
- Bundle JavaScript applications

---

## Introduction to Webpack

Webpack is a module bundler that processes and bundles JavaScript modules and assets.

### Why Webpack?

- **Bundling**: Combines multiple files into bundles
- **Transformation**: Transpiles and transforms code
- **Optimization**: Optimizes for production
- **Code Splitting**: Splits code into chunks
- **Asset Management**: Handles images, CSS, etc.
- **Industry Standard**: Widely used in production

---

## Webpack Basics

### Installation

```bash
# Install webpack
npm install --save-dev webpack webpack-cli

# Or with yarn
yarn add --dev webpack webpack-cli
```

### Basic Setup

```javascript
// webpack.config.js
const path = require(''path'');

module.exports = {
    entry: ''./src/index.js'',
    output: {
        filename: ''bundle.js'',
        path: path.resolve(__dirname, ''dist'')
    }
};
```

### Entry and Output

```javascript
// Single entry
module.exports = {
    entry: ''./src/index.js'',
    output: {
        filename: ''bundle.js'',
        path: path.resolve(__dirname, ''dist'')
    }
};

// Multiple entry points
module.exports = {
    entry: {
        app: ''./src/app.js'',
        admin: ''./src/admin.js''
    },
    output: {
        filename: ''[name].bundle.js'',
        path: path.resolve(__dirname, ''dist'')
    }
};
```

---

## Configuration

### Basic Configuration

```javascript
// webpack.config.js
const path = require(''path'');

module.exports = {
    mode: ''development'',  // or ''production''
    entry: ''./src/index.js'',
    output: {
        filename: ''bundle.js'',
        path: path.resolve(__dirname, ''dist''),
        clean: true  // Clean output directory
    },
    devtool: ''source-map'',  // Source maps
    target: ''web''  // or ''node''
};
```

### Development vs Production

```javascript
// Development
module.exports = {
    mode: ''development'',
    devtool: ''eval-source-map'',
    optimization: {
        minimize: false
    }
};

// Production
module.exports = {
    mode: ''production'',
    devtool: ''source-map'',
    optimization: {
        minimize: true
    }
};
```

---

## Loaders

### What are Loaders?

Loaders transform files before bundling.

### Common Loaders

```javascript
// babel-loader: Transpile ES6+
module.exports = {
    module: {
        rules: [
            {
                test: /\\.js$/,
                exclude: /node_modules/,
                use: {
                    loader: ''babel-loader'',
                    options: {
                        presets: [''@babel/preset-env'']
                    }
                }
            }
        ]
    }
};
```

### CSS Loaders

```javascript
// css-loader and style-loader
module.exports = {
    module: {
        rules: [
            {
                test: /\\.css$/,
                use: [''style-loader'', ''css-loader'']
            }
        ]
    }
};
```

### File Loaders

```javascript
// file-loader: Handle images, fonts, etc.
module.exports = {
    module: {
        rules: [
            {
                test: /\\.(png|svg|jpg|jpeg|gif)$/i,
                type: ''asset/resource''
            },
            {
                test: /\\.(woff|woff2|eot|ttf|otf)$/i,
                type: ''asset/resource''
            }
        ]
    }
};
```

### Multiple Loaders

```javascript
module.exports = {
    module: {
        rules: [
            {
                test: /\\.scss$/,
                use: [
                    ''style-loader'',    // Injects CSS into DOM
                    ''css-loader'',      // Resolves CSS imports
                    ''sass-loader''      // Compiles Sass to CSS
                ]
            }
        ]
    }
};
```

---

## Plugins

### What are Plugins?

Plugins extend webpack functionality.

### Common Plugins

```javascript
const HtmlWebpackPlugin = require(''html-webpack-plugin'');
const { CleanWebpackPlugin } = require(''clean-webpack-plugin'');

module.exports = {
    plugins: [
        new CleanWebpackPlugin(),
        new HtmlWebpackPlugin({
            template: ''./src/index.html'',
            filename: ''index.html''
        })
    ]
};
```

### HTML Webpack Plugin

```javascript
const HtmlWebpackPlugin = require(''html-webpack-plugin'');

module.exports = {
    plugins: [
        new HtmlWebpackPlugin({
            template: ''./src/index.html'',
            filename: ''index.html'',
            inject: ''body'',
            minify: {
                removeComments: true,
                collapseWhitespace: true
            }
        })
    ]
};
```

### Mini CSS Extract Plugin

```javascript
const MiniCssExtractPlugin = require(''mini-css-extract-plugin'');

module.exports = {
    module: {
        rules: [
            {
                test: /\\.css$/,
                use: [MiniCssExtractPlugin.loader, ''css-loader'']
            }
        ]
    },
    plugins: [
        new MiniCssExtractPlugin({
            filename: ''styles.css''
        })
    ]
};
```

---

## Code Splitting

### Entry Points

```javascript
// Split by entry points
module.exports = {
    entry: {
        app: ''./src/app.js'',
        vendor: ''./src/vendor.js''
    },
    output: {
        filename: ''[name].bundle.js'',
        path: path.resolve(__dirname, ''dist'')
    }
};
```

### SplitChunks

```javascript
module.exports = {
    optimization: {
        splitChunks: {
            chunks: ''all'',
            cacheGroups: {
                vendor: {
                    test: /[\\\\/]node_modules[\\\\/]/,
                    name: ''vendors'',
                    chunks: ''all''
                }
            }
        }
    }
};
```

### Dynamic Imports

```javascript
// In your code
async function loadModule() {
    let module = await import(''./module.js'');
    module.doSomething();
}

// Webpack automatically splits this
```

---

## Development Server

### Webpack Dev Server

```bash
# Install
npm install --save-dev webpack-dev-server
```

```javascript
// webpack.config.js
module.exports = {
    devServer: {
        static: ''./dist'',
        port: 3000,
        hot: true,
        open: true
    }
};
```

```json
// package.json
{
  "scripts": {
    "dev": "webpack serve --mode development",
    "build": "webpack --mode production"
  }
}
```

---

## Practice Exercise

### Exercise: Webpack Setup

**Objective**: Practice setting up webpack, configuring loaders and plugins, and implementing code splitting.

**Instructions**:

1. Install webpack
2. Create webpack configuration
3. Set up loaders and plugins
4. Practice:
   - Basic webpack setup
   - Using loaders
   - Using plugins
   - Code splitting

**Example Solution**:

```bash
# 1. Initialize project
npm init -y

# 2. Install webpack
npm install --save-dev webpack webpack-cli

# 3. Install loaders
npm install --save-dev babel-loader @babel/core @babel/preset-env
npm install --save-dev css-loader style-loader
npm install --save-dev file-loader

# 4. Install plugins
npm install --save-dev html-webpack-plugin clean-webpack-plugin
npm install --save-dev webpack-dev-server
```

```javascript
// webpack.config.js
const path = require(''path'');
const HtmlWebpackPlugin = require(''html-webpack-plugin'');
const { CleanWebpackPlugin } = require(''clean-webpack-plugin'');

module.exports = {
    mode: ''development'',
    entry: ''./src/index.js'',
    output: {
        filename: ''bundle.js'',
        path: path.resolve(__dirname, ''dist''),
        clean: true
    },
    devtool: ''source-map'',
    devServer: {
        static: ''./dist'',
        port: 3000,
        hot: true,
        open: true
    },
    module: {
        rules: [
            {
                test: /\\.js$/,
                exclude: /node_modules/,
                use: {
                    loader: ''babel-loader'',
                    options: {
                        presets: [''@babel/preset-env'']
                    }
                }
            },
            {
                test: /\\.css$/,
                use: [''style-loader'', ''css-loader'']
            },
            {
                test: /\\.(png|svg|jpg|jpeg|gif)$/i,
                type: ''asset/resource''
            }
        ]
    },
    plugins: [
        new CleanWebpackPlugin(),
        new HtmlWebpackPlugin({
            template: ''./src/index.html'',
            filename: ''index.html''
        })
    ],
    optimization: {
        splitChunks: {
            chunks: ''all'',
            cacheGroups: {
                vendor: {
                    test: /[\\\\/]node_modules[\\\\/]/,
                    name: ''vendors'',
                    chunks: ''all''
                }
            }
        }
    }
};
```

```javascript
// src/index.js
import ''./styles.css'';
import { add, multiply } from ''./math'';

console.log(''Webpack is working!'');
console.log(''add(2, 3) ='', add(2, 3));
console.log(''multiply(4, 5) ='', multiply(4, 5));

// Dynamic import example
async function loadModule() {
    let module = await import(''./lazy-module.js'');
    module.default();
}

// Load on button click
document.getElementById(''load-btn'').addEventListener(''click'', loadModule);
```

```javascript
// src/math.js
export function add(a, b) {
    return a + b;
}

export function multiply(a, b) {
    return a * b;
}
```

```javascript
// src/lazy-module.js
export default function() {
    console.log(''Lazy module loaded!'');
}
```

```css
/* src/styles.css */
body {
    font-family: Arial, sans-serif;
    margin: 20px;
}

button {
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}
```

```html
<!-- src/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webpack Practice</title>
</head>
<body>
    <h1>Webpack Practice</h1>
    <button id="load-btn">Load Lazy Module</button>
    <div id="output"></div>
</body>
</html>
```

```json
// package.json
{
  "name": "webpack-practice",
  "version": "1.0.0",
  "scripts": {
    "dev": "webpack serve --mode development",
    "build": "webpack --mode production",
    "build:dev": "webpack --mode development"
  },
  "devDependencies": {
    "@babel/core": "^7.22.0",
    "@babel/preset-env": "^7.22.0",
    "babel-loader": "^9.1.0",
    "clean-webpack-plugin": "^4.0.0",
    "css-loader": "^6.8.0",
    "html-webpack-plugin": "^5.5.0",
    "style-loader": "^3.3.0",
    "webpack": "^5.88.0",
    "webpack-cli": "^5.1.0",
    "webpack-dev-server": "^4.15.0"
  }
}
```

**Expected Output** (when running `npm run dev`):
```
webpack compiled successfully
Server running on http://localhost:3000
```

**Challenge (Optional)**:
- Set up a complete webpack project
- Add more loaders (Sass, TypeScript)
- Optimize for production
- Implement advanced code splitting

---

## Common Mistakes

### 1. Wrong Loader Order

```javascript
// ❌ Bad: Wrong order
{
    test: /\\.scss$/,
    use: [''sass-loader'', ''css-loader'', ''style-loader'']
}

// ✅ Good: Right order (processes right to left)
{
    test: /\\.scss$/,
    use: [''style-loader'', ''css-loader'', ''sass-loader'']
}
```

### 2. Not Excluding node_modules

```javascript
// ❌ Bad: Process node_modules
{
    test: /\\.js$/,
    use: ''babel-loader''
}

// ✅ Good: Exclude node_modules
{
    test: /\\.js$/,
    exclude: /node_modules/,
    use: ''babel-loader''
}
```

### 3. Missing Output Path

```javascript
// ❌ Bad: Relative path might not work
output: {
    filename: ''bundle.js'',
    path: ''dist''
}

// ✅ Good: Absolute path
output: {
    filename: ''bundle.js'',
    path: path.resolve(__dirname, ''dist'')
}
```

---

## Key Takeaways

1. **Webpack**: Module bundler for JavaScript
2. **Entry**: Entry point(s) for bundling
3. **Output**: Where bundles are written
4. **Loaders**: Transform files before bundling
5. **Plugins**: Extend webpack functionality
6. **Code Splitting**: Split code into chunks
7. **Best Practice**: Use appropriate loaders, optimize for production

---

## Quiz: Webpack

Test your understanding with these questions:

1. **Webpack is:**
   - A) Module bundler
   - B) Package manager
   - C) Both
   - D) Neither

2. **Loaders:**
   - A) Transform files
   - B) Extend functionality
   - C) Both
   - D) Neither

3. **Plugins:**
   - A) Transform files
   - B) Extend functionality
   - C) Both
   - D) Neither

4. **entry specifies:**
   - A) Output location
   - B) Entry point
   - C) Both
   - D) Neither

5. **Loaders process:**
   - A) Left to right
   - B) Right to left
   - C) Random
   - D) Never

6. **Code splitting:**
   - A) Splits code into chunks
   - B) Combines code
   - C) Both
   - D) Neither

7. **webpack-dev-server:**
   - A) Development server
   - B) Production server
   - C) Both
   - D) Neither

**Answers**:
1. A) Module bundler
2. A) Transform files
3. B) Extend functionality
4. B) Entry point
5. B) Right to left
6. A) Splits code into chunks
7. A) Development server

---

## Next Steps

Congratulations! You''ve learned webpack. You now know:
- How to configure webpack
- How to use loaders
- How to use plugins
- How to implement code splitting

**What''s Next?**
- Lesson 23.3: Modern Build Tools
- Learn Vite
- Understand Parcel
- Work with esbuild

---

## Additional Resources

- **Webpack Documentation**: [webpack.js.org](https://webpack.js.org)
- **Webpack Concepts**: [webpack.js.org/concepts](https://webpack.js.org/concepts)
- **Webpack Loaders**: [webpack.js.org/loaders](https://webpack.js.org/loaders)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand webpack basics
- Configure webpack
- Use loaders for different file types
- Use plugins for additional functionality
- Implement code splitting
- Optimize builds
- Bundle JavaScript applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (171, 63, 15, 'Code Quality and Linting', 'code-quality-and-linting', '# Lesson 23.3: Modern Build Tools

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand modern build tools
- Use Vite for fast development
- Work with Parcel
- Understand esbuild
- Compare build tools
- Choose appropriate tool
- Set up modern build pipelines

---

## Introduction to Modern Build Tools

Modern build tools offer faster builds, better developer experience, and simpler configuration than traditional tools.

### Why Modern Build Tools?

- **Speed**: Much faster than webpack
- **Zero Config**: Work out of the box
- **Better DX**: Great developer experience
- **Modern**: Built for modern JavaScript
- **Hot Reload**: Fast hot module replacement
- **Simple**: Less configuration needed

### Popular Modern Tools

1. **Vite**: Fast, opinionated, great for modern frameworks
2. **Parcel**: Zero-config, fast, automatic
3. **esbuild**: Extremely fast, written in Go

---

## Vite

### What is Vite?

Vite is a next-generation frontend build tool that provides fast development and optimized production builds.

### Installation

```bash
# Create Vite project
npm create vite@latest my-project

# Or install manually
npm install --save-dev vite
```

### Basic Setup

```javascript
// vite.config.js
import { defineConfig } from ''vite'';

export default defineConfig({
    root: ''./src'',
    build: {
        outDir: ''../dist''
    }
});
```

### package.json Scripts

```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  }
}
```

### Vite Features

```javascript
// Automatic code splitting
// Fast HMR (Hot Module Replacement)
// Native ES modules in dev
// Optimized production builds
// Built-in TypeScript support
// CSS preprocessing support
```

### Vite with React

```bash
# Create React app with Vite
npm create vite@latest my-react-app -- --template react
```

### Vite Configuration

```javascript
// vite.config.js
import { defineConfig } from ''vite'';
import react from ''@vitejs/plugin-react'';

export default defineConfig({
    plugins: [react()],
    server: {
        port: 3000,
        open: true
    },
    build: {
        outDir: ''dist'',
        sourcemap: true
    }
});
```

---

## Parcel

### What is Parcel?

Parcel is a zero-configuration build tool that works out of the box.

### Installation

```bash
# Install Parcel
npm install --save-dev parcel

# Or globally
npm install -g parcel
```

### Basic Usage

```bash
# Development server
parcel index.html

# Production build
parcel build index.html
```

### package.json Scripts

```json
{
  "scripts": {
    "dev": "parcel index.html",
    "build": "parcel build index.html"
  }
}
```

### Parcel Features

```javascript
// Zero configuration
// Automatic code splitting
// Fast builds
// Built-in hot reload
// Automatic transforms
// Asset optimization
```

### Parcel Configuration

```json
// .parcelrc (optional)
{
  "extends": "@parcel/config-default",
  "transformers": {
    "*.js": ["@parcel/transformer-babel"]
  }
}
```

---

## esbuild

### What is esbuild?

esbuild is an extremely fast JavaScript bundler written in Go.

### Installation

```bash
# Install esbuild
npm install --save-dev esbuild
```

### Basic Usage

```javascript
// build.js
require(''esbuild'').build({
    entryPoints: [''src/index.js''],
    bundle: true,
    outfile: ''dist/bundle.js'',
    minify: true,
    sourcemap: true
}).catch(() => process.exit(1));
```

### Command Line

```bash
# Bundle
esbuild src/index.js --bundle --outfile=dist/bundle.js

# Watch mode
esbuild src/index.js --bundle --outfile=dist/bundle.js --watch

# Minify
esbuild src/index.js --bundle --outfile=dist/bundle.js --minify
```

### esbuild Features

```javascript
// Extremely fast (10-100x faster)
// TypeScript support
// JSX support
// Minification
// Source maps
// Code splitting
```

### esbuild Configuration

```javascript
// build.js
const esbuild = require(''esbuild'');

esbuild.build({
    entryPoints: [''src/index.js''],
    bundle: true,
    outdir: ''dist'',
    format: ''esm'',
    platform: ''browser'',
    target: ''es2020'',
    minify: true,
    sourcemap: true,
    splitting: true
}).then(() => {
    console.log(''Build complete'');
}).catch(() => process.exit(1));
```

---

## Comparison

### Speed Comparison

```
esbuild:  ⚡⚡⚡⚡⚡ (Fastest)
Vite:     ⚡⚡⚡⚡ (Very Fast)
Parcel:   ⚡⚡⚡ (Fast)
Webpack:  ⚡⚡ (Slower)
```

### Configuration

```javascript
// Vite: Minimal config needed
export default defineConfig({
    // Usually works with defaults
});

// Parcel: Zero config
// No config file needed

// esbuild: Simple config
esbuild.build({
    entryPoints: [''src/index.js''],
    bundle: true
});

// Webpack: More config
module.exports = {
    entry: ''./src/index.js'',
    // ... many options
};
```

### Use Cases

```javascript
// Vite: Best for
// - Modern frameworks (React, Vue, Svelte)
// - Fast development
// - Production builds

// Parcel: Best for
// - Quick setup
// - Zero config needed
// - Simple projects

// esbuild: Best for
// - Maximum speed
// - Simple bundling
// - Build scripts

// Webpack: Best for
// - Complex configurations
// - Legacy projects
// - Maximum flexibility
```

---

## Practice Exercise

### Exercise: Build Tool Setup

**Objective**: Practice setting up Vite, Parcel, and esbuild, and comparing their usage.

**Instructions**:

1. Set up projects with each tool
2. Compare build times
3. Practice:
   - Vite setup
   - Parcel setup
   - esbuild setup
   - Comparing tools

**Example Solution**:

```bash
# Vite Setup
npm create vite@latest vite-project -- --template vanilla
cd vite-project
npm install
npm run dev
```

```javascript
// vite-project/vite.config.js
import { defineConfig } from ''vite'';

export default defineConfig({
    server: {
        port: 3000,
        open: true
    },
    build: {
        outDir: ''dist'',
        sourcemap: true
    }
});
```

```json
// vite-project/package.json
{
  "name": "vite-project",
  "version": "1.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "devDependencies": {
    "vite": "^4.4.0"
  }
}
```

```bash
# Parcel Setup
mkdir parcel-project
cd parcel-project
npm init -y
npm install --save-dev parcel
```

```html
<!-- parcel-project/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parcel Project</title>
</head>
<body>
    <h1>Parcel Project</h1>
    <script type="module" src="./src/index.js"></script>
</body>
</html>
```

```javascript
// parcel-project/src/index.js
import ''./styles.css'';

console.log(''Parcel is working!'');

document.body.innerHTML += ''<p>Hello from Parcel!</p>'';
```

```css
/* parcel-project/src/styles.css */
body {
    font-family: Arial, sans-serif;
    margin: 20px;
}
```

```json
// parcel-project/package.json
{
  "name": "parcel-project",
  "version": "1.0.0",
  "scripts": {
    "dev": "parcel index.html",
    "build": "parcel build index.html"
  },
  "devDependencies": {
    "parcel": "^2.9.0"
  }
}
```

```bash
# esbuild Setup
mkdir esbuild-project
cd esbuild-project
npm init -y
npm install --save-dev esbuild
```

```javascript
// esbuild-project/build.js
const esbuild = require(''esbuild'');

// Development
if (process.argv[2] === ''dev'') {
    esbuild.build({
        entryPoints: [''src/index.js''],
        bundle: true,
        outfile: ''dist/bundle.js'',
        sourcemap: true,
        watch: {
            onRebuild(error, result) {
                if (error) console.error(''Build failed:'', error);
                else console.log(''Build succeeded'');
            }
        }
    }).then(() => {
        console.log(''Watching...'');
    });
}

// Production
else {
    esbuild.build({
        entryPoints: [''src/index.js''],
        bundle: true,
        outfile: ''dist/bundle.js'',
        minify: true,
        sourcemap: true
    }).then(() => {
        console.log(''Build complete'');
    }).catch(() => process.exit(1));
}
```

```javascript
// esbuild-project/src/index.js
console.log(''esbuild is working!'');

function add(a, b) {
    return a + b;
}

console.log(''add(2, 3) ='', add(2, 3));
```

```json
// esbuild-project/package.json
{
  "name": "esbuild-project",
  "version": "1.0.0",
  "scripts": {
    "dev": "node build.js dev",
    "build": "node build.js"
  },
  "devDependencies": {
    "esbuild": "^0.18.0"
  }
}
```

```javascript
// Comparison example
console.log("=== Build Tools Comparison ===");

console.log("\\n=== Vite ===");
console.log("Pros:");
console.log("- Very fast development");
console.log("- Great for modern frameworks");
console.log("- Optimized production builds");
console.log("- Built-in HMR");
console.log("Cons:");
console.log("- Opinionated");
console.log("- Less flexible than webpack");

console.log("\\n=== Parcel ===");
console.log("Pros:");
console.log("- Zero configuration");
console.log("- Fast builds");
console.log("- Automatic transforms");
console.log("Cons:");
console.log("- Less control");
console.log("- Can be slower than Vite/esbuild");

console.log("\\n=== esbuild ===");
console.log("Pros:");
console.log("- Extremely fast");
console.log("- Simple API");
console.log("- Good for scripts");
console.log("Cons:");
console.log("- Less features than webpack");
console.log("- Not as mature ecosystem");

console.log("\\n=== Webpack ===");
console.log("Pros:");
console.log("- Maximum flexibility");
console.log("- Huge ecosystem");
console.log("- Mature and stable");
console.log("Cons:");
console.log("- Slower than modern tools");
console.log("- More configuration needed");
```

**Expected Output** (when running each tool):
```
# Vite
VITE v4.4.0  ready in 500 ms
➜  Local:   http://localhost:5173/

# Parcel
Server running at http://localhost:1234

# esbuild
Watching...
Build succeeded
```

**Challenge (Optional)**:
- Set up projects with all three tools
- Compare build times
- Choose best tool for your use case
- Build a complete application

---

## Common Mistakes

### 1. Wrong Tool for Use Case

```javascript
// ❌ Bad: Using esbuild for complex React app
// esbuild lacks some React features

// ✅ Good: Use Vite for React
npm create vite@latest -- --template react
```

### 2. Not Using Modern Tools

```javascript
// ❌ Bad: Always using webpack
// Slower development experience

// ✅ Good: Consider modern tools
// Faster, better DX
```

### 3. Over-Configuring

```javascript
// ❌ Bad: Too much config for Parcel
// Parcel works with zero config

// ✅ Good: Start with defaults
// Add config only when needed
```

---

## Key Takeaways

1. **Vite**: Fast, great for modern frameworks
2. **Parcel**: Zero config, automatic
3. **esbuild**: Extremely fast, simple
4. **Comparison**: Each has strengths
5. **Choose**: Based on project needs
6. **Modern Tools**: Faster than webpack
7. **Best Practice**: Use right tool for job

---

## Quiz: Build Tools

Test your understanding with these questions:

1. **Vite is best for:**
   - A) Modern frameworks
   - B) Legacy projects
   - C) Both
   - D) Neither

2. **Parcel requires:**
   - A) Zero config
   - B) Lots of config
   - C) Some config
   - D) Random

3. **esbuild is:**
   - A) Fastest
   - B) Slowest
   - C) Medium speed
   - D) Unknown

4. **Vite uses:**
   - A) Native ES modules in dev
   - B) CommonJS in dev
   - C) Both
   - D) Neither

5. **Parcel:**
   - A) Zero config
   - B) Needs config
   - C) Optional config
   - D) Random

6. **esbuild is written in:**
   - A) JavaScript
   - B) Go
   - C) Rust
   - D) Python

7. **Modern tools are:**
   - A) Faster
   - B) Slower
   - C) Same speed
   - D) Unknown

**Answers**:
1. A) Modern frameworks
2. A) Zero config
3. A) Fastest
4. A) Native ES modules in dev
5. A) Zero config
6. B) Go
7. A) Faster

---

## Next Steps

Congratulations! You''ve completed Module 23: Build Tools and Bundlers. You now know:
- npm and package management
- Webpack configuration
- Modern build tools (Vite, Parcel, esbuild)
- How to choose the right tool

**What''s Next?**
- Module 24: Code Quality and Linting
- Lesson 24.1: ESLint
- Learn code linting
- Set up ESLint

---

## Additional Resources

- **Vite**: [vitejs.dev](https://vitejs.dev)
- **Parcel**: [parceljs.org](https://parceljs.org)
- **esbuild**: [esbuild.github.io](https://esbuild.github.io)

---

*Lesson completed! You''ve finished Module 23: Build Tools and Bundlers. Ready for Module 24: Code Quality and Linting!*

', NULL, 3, '2026-01-03 10:04:29', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand modern build tools
- Use Vite for fast development
- Work with Parcel
- Understand esbuild
- Compare build tools
- Choose appropriate tool
- Set up modern build pipelines');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (172, 64, 15, 'ESLint', 'eslint', '# Lesson 24.1: ESLint

## Learning Objectives

By the end of this lesson, you will be able to:
- Install and configure ESLint
- Understand ESLint rules
- Use ESLint plugins
- Integrate Prettier with ESLint
- Fix linting errors
- Set up ESLint in projects
- Maintain code quality

---

## Introduction to ESLint

ESLint is a tool for identifying and reporting on patterns in JavaScript code.

### Why ESLint?

- **Code Quality**: Enforces consistent code style
- **Bug Prevention**: Catches common errors
- **Best Practices**: Enforces best practices
- **Team Consistency**: Same rules for everyone
- **Automation**: Automatic error detection
- **Professional**: Industry standard tool

---

## Installing ESLint

### Basic Installation

```bash
# Install ESLint
npm install --save-dev eslint

# Initialize ESLint
npx eslint --init

# Or use npm
npm init @eslint/config
```

### Quick Setup

```bash
# Answer questions:
# - How would you like to use ESLint?
# - What type of modules?
# - Which framework?
# - Where does your code run?
# - Use TypeScript?
# - Format with?
```

---

## Configuration

### Configuration Files

```javascript
// .eslintrc.js
module.exports = {
    env: {
        browser: true,
        es2021: true,
        node: true
    },
    extends: [
        ''eslint:recommended''
    ],
    parserOptions: {
        ecmaVersion: ''latest'',
        sourceType: ''module''
    },
    rules: {
        // Your rules
    }
};
```

### package.json Configuration

```json
{
  "eslintConfig": {
    "extends": "eslint:recommended",
    "rules": {
      "no-console": "warn"
    }
  }
}
```

### .eslintrc.json

```json
{
  "env": {
    "browser": true,
    "es2021": true
  },
  "extends": "eslint:recommended",
  "parserOptions": {
    "ecmaVersion": "latest",
    "sourceType": "module"
  },
  "rules": {
    "no-console": "warn",
    "no-unused-vars": "error"
  }
}
```

### Environment Configuration

```javascript
module.exports = {
    env: {
        browser: true,   // Browser globals
        node: true,      // Node.js globals
        es6: true,      // ES6 features
        jest: true      // Jest globals
    }
};
```

---

## Rules

### Rule Levels

```javascript
// Rule levels:
// "off" or 0 - Turn rule off
// "warn" or 1 - Warning (doesn''t fail)
// "error" or 2 - Error (fails linting)

module.exports = {
    rules: {
        ''no-console'': ''warn'',        // Warning
        ''no-debugger'': ''error'',      // Error
        ''no-unused-vars'': ''off''      // Off
    }
};
```

### Common Rules

```javascript
module.exports = {
    rules: {
        // Best Practices
        ''no-console'': ''warn'',
        ''no-debugger'': ''error'',
        ''no-alert'': ''warn'',
        ''no-eval'': ''error'',
        
        // Variables
        ''no-unused-vars'': ''error'',
        ''no-undef'': ''error'',
        
        // Style
        ''semi'': [''error'', ''always''],
        ''quotes'': [''error'', ''single''],
        ''indent'': [''error'', 2],
        ''comma-dangle'': [''error'', ''never''],
        
        // ES6
        ''prefer-const'': ''error'',
        ''no-var'': ''error'',
        ''arrow-spacing'': ''error''
    }
};
```

### Rule Configuration

```javascript
module.exports = {
    rules: {
        // With options
        ''quotes'': [''error'', ''single'', { ''avoidEscape'': true }],
        ''indent'': [''error'', 2, { ''SwitchCase'': 1 }],
        ''max-len'': [''error'', { ''code'': 100 }],
        
        // Multiple options
        ''array-bracket-spacing'': [''error'', ''never'', {
            ''singleValue'': false,
            ''objectsInArrays'': false
        }]
    }
};
```

---

## Plugins

### Installing Plugins

```bash
# Install plugin
npm install --save-dev eslint-plugin-react

# Or for import rules
npm install --save-dev eslint-plugin-import
```

### Using Plugins

```javascript
// .eslintrc.js
module.exports = {
    plugins: [''react'', ''import''],
    extends: [
        ''eslint:recommended'',
        ''plugin:react/recommended'',
        ''plugin:import/recommended''
    ],
    rules: {
        ''react/prop-types'': ''warn'',
        ''import/no-unresolved'': ''error''
    }
};
```

### Popular Plugins

```javascript
// React
plugins: [''react'']
extends: [''plugin:react/recommended'']

// Import
plugins: [''import'']
extends: [''plugin:import/recommended'']

// Jest
plugins: [''jest'']
extends: [''plugin:jest/recommended'']

// Node
plugins: [''node'']
extends: [''plugin:node/recommended'']
```

---

## Prettier Integration

### Installing Prettier

```bash
# Install Prettier and ESLint config
npm install --save-dev prettier eslint-config-prettier eslint-plugin-prettier
```

### Configuration

```javascript
// .eslintrc.js
module.exports = {
    extends: [
        ''eslint:recommended'',
        ''plugin:prettier/recommended''  // Must be last
    ],
    plugins: [''prettier''],
    rules: {
        ''prettier/prettier'': ''error''
    }
};
```

### .prettierrc

```json
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "none",
  "printWidth": 100
}
```

### Disabling Conflicting Rules

```javascript
// eslint-config-prettier disables ESLint rules
// that conflict with Prettier
module.exports = {
    extends: [
        ''eslint:recommended'',
        ''prettier''  // Disables conflicting rules
    ]
};
```

---

## Using ESLint

### Command Line

```bash
# Lint files
npx eslint file.js

# Lint directory
npx eslint src/

# Fix auto-fixable issues
npx eslint --fix src/

# Use specific config
npx eslint --config .eslintrc.custom.js src/
```

### npm Scripts

```json
{
  "scripts": {
    "lint": "eslint .",
    "lint:fix": "eslint . --fix",
    "lint:watch": "eslint . --watch"
  }
}
```

### Ignoring Files

```javascript
// .eslintignore
node_modules/
dist/
build/
*.min.js
coverage/
```

### Inline Comments

```javascript
// Disable rule for line
console.log(''test''); // eslint-disable-line no-console

// Disable rule for next line
// eslint-disable-next-line no-console
console.log(''test'');

// Disable multiple rules
/* eslint-disable no-console, no-alert */
console.log(''test'');
alert(''test'');
/* eslint-enable no-console, no-alert */

// Disable for entire file
/* eslint-disable */
```

---

## Practice Exercise

### Exercise: ESLint Setup

**Objective**: Practice installing ESLint, configuring rules, using plugins, and integrating Prettier.

**Instructions**:

1. Install ESLint
2. Configure ESLint
3. Set up Prettier integration
4. Practice:
   - Configuring ESLint
   - Setting up rules
   - Using plugins
   - Fixing linting errors

**Example Solution**:

```bash
# 1. Initialize project
npm init -y

# 2. Install ESLint
npm install --save-dev eslint

# 3. Initialize ESLint
npx eslint --init
# Or create config manually
```

```javascript
// .eslintrc.js
module.exports = {
    env: {
        browser: true,
        es2021: true,
        node: true
    },
    extends: [
        ''eslint:recommended''
    ],
    parserOptions: {
        ecmaVersion: ''latest'',
        sourceType: ''module''
    },
    rules: {
        ''no-console'': ''warn'',
        ''no-debugger'': ''error'',
        ''no-unused-vars'': ''error'',
        ''semi'': [''error'', ''always''],
        ''quotes'': [''error'', ''single''],
        ''indent'': [''error'', 2],
        ''prefer-const'': ''error'',
        ''no-var'': ''error''
    }
};
```

```javascript
// src/index.js
// This file has intentional linting errors for practice

var x = 10;  // Should use const/let
console.log(''Hello'');  // console.log warning

function unusedFunction() {  // Unused function
    return ''unused'';
}

let y = 20;
y = 30;  // Should use const if not reassigned

// Missing semicolon
let z = 40

// Wrong quotes
let message = "Hello World";

// Wrong indentation
if (true) {
console.log(''test'');
}
```

```json
// package.json
{
  "name": "eslint-practice",
  "version": "1.0.0",
  "scripts": {
    "lint": "eslint src/",
    "lint:fix": "eslint src/ --fix"
  },
  "devDependencies": {
    "eslint": "^8.50.0"
  }
}
```

```bash
# Run ESLint
npm run lint

# Fix auto-fixable issues
npm run lint:fix
```

```javascript
// .eslintrc.js with React plugin example
module.exports = {
    env: {
        browser: true,
        es2021: true
    },
    extends: [
        ''eslint:recommended'',
        ''plugin:react/recommended''
    ],
    plugins: [''react''],
    parserOptions: {
        ecmaVersion: ''latest'',
        sourceType: ''module'',
        ecmaFeatures: {
            jsx: true
        }
    },
    settings: {
        react: {
            version: ''detect''
        }
    },
    rules: {
        ''react/prop-types'': ''warn'',
        ''react/react-in-jsx-scope'': ''off''  // Not needed in React 17+
    }
};
```

```javascript
// .eslintrc.js with Prettier integration
module.exports = {
    env: {
        browser: true,
        es2021: true
    },
    extends: [
        ''eslint:recommended'',
        ''plugin:prettier/recommended''
    ],
    plugins: [''prettier''],
    parserOptions: {
        ecmaVersion: ''latest'',
        sourceType: ''module''
    },
    rules: {
        ''prettier/prettier'': ''error'',
        ''no-console'': ''warn''
    }
};
```

```json
// .prettierrc
{
  "semi": true,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "none",
  "printWidth": 100,
  "arrowParens": "avoid"
}
```

```javascript
// .eslintignore
node_modules/
dist/
build/
*.min.js
coverage/
```

**Expected Output** (when running `npm run lint`):
```
/Users/.../src/index.js
  1:1   error  Unexpected var, use let or const  no-var
  2:1   warning  Unexpected console statement    no-console
  4:1   error  ''unusedFunction'' is defined but never used  no-unused-vars
  7:1   error  ''y'' is never reassigned. Use ''const'' instead  prefer-const
  9:1   error  Missing semicolon                            semi
  12:1  error  Strings must use singlequote                 quotes
  15:1  error  Expected indentation of 2 spaces but found 0  indent

✖ 7 problems (6 errors, 1 warning)
```

**Challenge (Optional)**:
- Set up ESLint for a real project
- Configure custom rules
- Integrate with your editor
- Set up pre-commit hooks

---

## Common Mistakes

### 1. Not Extending Recommended

```javascript
// ❌ Bad: No extends
module.exports = {
    rules: {
        // Only custom rules
    }
};

// ✅ Good: Extend recommended
module.exports = {
    extends: [''eslint:recommended''],
    rules: {
        // Custom rules on top
    }
};
```

### 2. Conflicting Prettier and ESLint

```javascript
// ❌ Bad: Both format
module.exports = {
    extends: [''eslint:recommended''],
    rules: {
        ''semi'': ''error'',  // Conflicts with Prettier
        ''quotes'': ''error''  // Conflicts with Prettier
    }
};

// ✅ Good: Use prettier config
module.exports = {
    extends: [''eslint:recommended'', ''prettier''],
    // Prettier handles formatting
};
```

### 3. Not Using --fix

```bash
# ❌ Bad: Manual fixes
# Fix all errors manually

# ✅ Good: Auto-fix
npm run lint:fix
```

---

## Key Takeaways

1. **ESLint**: Tool for code quality and consistency
2. **Configuration**: Use .eslintrc.js or package.json
3. **Rules**: Configure rules for your needs
4. **Plugins**: Extend functionality with plugins
5. **Prettier**: Integrate for code formatting
6. **Best Practice**: Extend recommended, use plugins, auto-fix
7. **Automation**: Use in CI/CD and pre-commit hooks

---

## Quiz: ESLint

Test your understanding with these questions:

1. **ESLint is:**
   - A) Code formatter
   - B) Code linter
   - C) Both
   - D) Neither

2. **Rule level "error":**
   - A) Fails linting
   - B) Warning only
   - C) Disabled
   - D) Nothing

3. **extends:**
   - A) Extends configs
   - B) Creates new config
   - C) Deletes config
   - D) Nothing

4. **plugins:**
   - A) Add rules
   - B) Remove rules
   - C) Both
   - D) Neither

5. **--fix flag:**
   - A) Auto-fixes issues
   - B) Shows issues
   - C) Both
   - D) Neither

6. **Prettier handles:**
   - A) Formatting
   - B) Linting
   - C) Both
   - D) Neither

7. **.eslintignore:**
   - A) Ignores files
   - B) Includes files
   - C) Both
   - D) Neither

**Answers**:
1. B) Code linter
2. A) Fails linting
3. A) Extends configs
4. A) Add rules
5. A) Auto-fixes issues
6. A) Formatting
7. A) Ignores files

---

## Next Steps

Congratulations! You''ve learned ESLint. You now know:
- How to install and configure ESLint
- How to use rules and plugins
- How to integrate Prettier
- How to maintain code quality

**What''s Next?**
- Lesson 24.2: TypeScript Introduction
- Learn TypeScript basics
- Understand types and interfaces
- Work with type annotations

---

## Additional Resources

- **ESLint Documentation**: [eslint.org](https://eslint.org)
- **ESLint Rules**: [eslint.org/docs/rules](https://eslint.org/docs/rules)
- **Prettier**: [prettier.io](https://prettier.io)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:07:13', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Install and configure ESLint
- Understand ESLint rules
- Use ESLint plugins
- Integrate Prettier with ESLint
- Fix linting errors
- Set up ESLint in projects
- Maintain code quality');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (173, 64, 15, 'Prettier and Code Formatting', 'prettier-and-code-formatting', '# Lesson 24.2: TypeScript Introduction

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand TypeScript basics
- Use types and interfaces
- Add type annotations
- Compile TypeScript to JavaScript
- Work with TypeScript features
- Build type-safe applications
- Understand type system benefits

---

## Introduction to TypeScript

TypeScript is a typed superset of JavaScript that compiles to plain JavaScript.

### Why TypeScript?

- **Type Safety**: Catch errors at compile time
- **Better IDE Support**: Autocomplete, refactoring
- **Documentation**: Types document code
- **Refactoring**: Safer to refactor
- **Large Projects**: Better for large codebases
- **Industry Standard**: Widely adopted
- **Modern JavaScript**: Supports latest features

---

## TypeScript Basics

### Installation

```bash
# Install TypeScript
npm install -g typescript

# Or locally
npm install --save-dev typescript

# Check version
tsc --version
```

### First TypeScript File

```typescript
// hello.ts
function greet(name: string): string {
    return `Hello, ${name}!`;
}

let message = greet(''World'');
console.log(message);
```

### Compiling TypeScript

```bash
# Compile TypeScript
tsc hello.ts

# Generates hello.js
```

---

## Types

### Basic Types

```typescript
// String
let name: string = ''Alice'';

// Number
let age: number = 30;

// Boolean
let isActive: boolean = true;

// Array
let numbers: number[] = [1, 2, 3];
let names: Array<string> = [''Alice'', ''Bob''];

// Tuple
let tuple: [string, number] = [''Alice'', 30];

// Any
let anything: any = ''can be anything'';

// Void
function log(message: string): void {
    console.log(message);
}

// Null and Undefined
let nullValue: null = null;
let undefinedValue: undefined = undefined;
```

### Union Types

```typescript
// Union type
let value: string | number;
value = ''hello'';
value = 42;

// Union with null
let name: string | null = null;
name = ''Alice'';
```

### Literal Types

```typescript
// Literal types
let direction: ''up'' | ''down'' | ''left'' | ''right'';
direction = ''up'';
// direction = ''diagonal'';  // Error

// Boolean literal
let isTrue: true = true;
```

---

## Type Annotations

### Function Types

```typescript
// Function with types
function add(a: number, b: number): number {
    return a + b;
}

// Arrow function
let multiply = (a: number, b: number): number => {
    return a * b;
};

// Function type
let operation: (a: number, b: number) => number;
operation = add;
operation = multiply;
```

### Variable Types

```typescript
// Explicit type
let count: number = 0;

// Type inference
let name = ''Alice'';  // Type: string
let age = 30;        // Type: number

// Type assertion
let value: any = ''hello'';
let length = (value as string).length;
```

### Object Types

```typescript
// Object type
let user: {
    name: string;
    age: number;
    email?: string;  // Optional
} = {
    name: ''Alice'',
    age: 30
};
```

---

## Interfaces

### Basic Interface

```typescript
// Define interface
interface User {
    name: string;
    age: number;
    email?: string;  // Optional property
}

// Use interface
let user: User = {
    name: ''Alice'',
    age: 30
};

// Function with interface
function getUser(): User {
    return {
        name: ''Bob'',
        age: 25,
        email: ''bob@example.com''
    };
}
```

### Interface with Methods

```typescript
interface Calculator {
    add(a: number, b: number): number;
    subtract(a: number, b: number): number;
}

let calc: Calculator = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b
};
```

### Extending Interfaces

```typescript
interface Person {
    name: string;
    age: number;
}

interface Employee extends Person {
    employeeId: string;
    department: string;
}

let employee: Employee = {
    name: ''Alice'',
    age: 30,
    employeeId: ''E001'',
    department: ''Engineering''
};
```

---

## Classes

### TypeScript Classes

```typescript
class User {
    name: string;
    age: number;
    
    constructor(name: string, age: number) {
        this.name = name;
        this.age = age;
    }
    
    greet(): string {
        return `Hello, I''m ${this.name}`;
    }
}

let user = new User(''Alice'', 30);
console.log(user.greet());
```

### Access Modifiers

```typescript
class User {
    public name: string;      // Public (default)
    private age: number;      // Private
    protected email: string;  // Protected
    
    constructor(name: string, age: number, email: string) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
}
```

---

## Generics

### Basic Generics

```typescript
// Generic function
function identity<T>(arg: T): T {
    return arg;
}

let number = identity<number>(42);
let string = identity<string>(''hello'');

// Generic interface
interface Box<T> {
    value: T;
}

let numberBox: Box<number> = { value: 42 };
let stringBox: Box<string> = { value: ''hello'' };
```

### Generic Constraints

```typescript
interface Lengthwise {
    length: number;
}

function logLength<T extends Lengthwise>(arg: T): T {
    console.log(arg.length);
    return arg;
}

logLength(''hello'');  // OK
logLength([1, 2, 3]);  // OK
// logLength(42);  // Error: number doesn''t have length
```

---

## Compiling TypeScript

### tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

### Compiler Options

```json
{
  "compilerOptions": {
    "target": "ES2020",           // JavaScript version
    "module": "ES2020",           // Module system
    "lib": ["ES2020"],            // Library files
    "outDir": "./dist",           // Output directory
    "rootDir": "./src",           // Root directory
    "strict": true,               // Strict type checking
    "noImplicitAny": true,        // Error on implicit any
    "strictNullChecks": true,     // Strict null checks
    "esModuleInterop": true,      // ES module interop
    "skipLibCheck": true,         // Skip lib checking
    "sourceMap": true             // Generate source maps
  }
}
```

### Compiling

```bash
# Compile TypeScript
tsc

# Watch mode
tsc --watch

# Compile specific file
tsc file.ts

# Compile with config
tsc --project tsconfig.json
```

---

## Practice Exercise

### Exercise: TypeScript Practice

**Objective**: Practice using TypeScript, working with types, interfaces, and compiling TypeScript.

**Instructions**:

1. Install TypeScript
2. Create TypeScript files
3. Practice:
   - Using basic types
   - Creating interfaces
   - Adding type annotations
   - Compiling TypeScript

**Example Solution**:

```bash
# 1. Install TypeScript
npm install --save-dev typescript

# 2. Initialize TypeScript
npx tsc --init
```

```json
// tsconfig.json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "sourceMap": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist"]
}
```

```typescript
// src/basics.ts
console.log("=== TypeScript Basics ===");

// Basic types
let name: string = ''Alice'';
let age: number = 30;
let isActive: boolean = true;

console.log(''Name:'', name);
console.log(''Age:'', age);
console.log(''Active:'', isActive);

// Arrays
let numbers: number[] = [1, 2, 3, 4, 5];
let names: Array<string> = [''Alice'', ''Bob'', ''Charlie''];

console.log(''Numbers:'', numbers);
console.log(''Names:'', names);

// Tuples
let tuple: [string, number] = [''Alice'', 30];
console.log(''Tuple:'', tuple);

// Union types
let value: string | number;
value = ''hello'';
console.log(''Value (string):'', value);
value = 42;
console.log(''Value (number):'', value);

// Any
let anything: any = ''can be anything'';
anything = 42;
anything = true;
console.log(''Anything:'', anything);
```

```typescript
// src/functions.ts
console.log("=== Functions ===");

// Function with types
function add(a: number, b: number): number {
    return a + b;
}

console.log(''add(2, 3):'', add(2, 3));

// Arrow function
let multiply = (a: number, b: number): number => {
    return a * b;
};

console.log(''multiply(4, 5):'', multiply(4, 5));

// Optional parameters
function greet(name: string, title?: string): string {
    if (title) {
        return `Hello, ${title} ${name}!`;
    }
    return `Hello, ${name}!`;
}

console.log(''greet("Alice"):'', greet(''Alice''));
console.log(''greet("Alice", "Dr."):'', greet(''Alice'', ''Dr.''));

// Default parameters
function createUser(name: string, age: number = 18): { name: string; age: number } {
    return { name, age };
}

console.log(''createUser("Bob"):'', createUser(''Bob''));
console.log(''createUser("Charlie", 25):'', createUser(''Charlie'', 25));

// Rest parameters
function sum(...numbers: number[]): number {
    return numbers.reduce((total, num) => total + num, 0);
}

console.log(''sum(1, 2, 3, 4, 5):'', sum(1, 2, 3, 4, 5));
```

```typescript
// src/interfaces.ts
console.log("=== Interfaces ===");

// Basic interface
interface User {
    name: string;
    age: number;
    email?: string;  // Optional
}

let user: User = {
    name: ''Alice'',
    age: 30,
    email: ''alice@example.com''
};

console.log(''User:'', user);

// Interface with methods
interface Calculator {
    add(a: number, b: number): number;
    subtract(a: number, b: number): number;
    multiply(a: number, b: number): number;
    divide(a: number, b: number): number;
}

let calc: Calculator = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => {
        if (b === 0) {
            throw new Error(''Division by zero'');
        }
        return a / b;
    }
};

console.log(''calc.add(10, 5):'', calc.add(10, 5));
console.log(''calc.subtract(10, 5):'', calc.subtract(10, 5));
console.log(''calc.multiply(10, 5):'', calc.multiply(10, 5));
console.log(''calc.divide(10, 5):'', calc.divide(10, 5));

// Extending interfaces
interface Person {
    name: string;
    age: number;
}

interface Employee extends Person {
    employeeId: string;
    department: string;
}

let employee: Employee = {
    name: ''Bob'',
    age: 25,
    employeeId: ''E001'',
    department: ''Engineering''
};

console.log(''Employee:'', employee);
```

```typescript
// src/classes.ts
console.log("=== Classes ===");

class User {
    name: string;
    age: number;
    private email: string;
    
    constructor(name: string, age: number, email: string) {
        this.name = name;
        this.age = age;
        this.email = email;
    }
    
    greet(): string {
        return `Hello, I''m ${this.name}`;
    }
    
    getEmail(): string {
        return this.email;
    }
}

let user = new User(''Alice'', 30, ''alice@example.com'');
console.log(''User:'', user.greet());
console.log(''Email:'', user.getEmail());

// Class with inheritance
class Admin extends User {
    permissions: string[];
    
    constructor(name: string, age: number, email: string, permissions: string[]) {
        super(name, age, email);
        this.permissions = permissions;
    }
    
    hasPermission(permission: string): boolean {
        return this.permissions.includes(permission);
    }
}

let admin = new Admin(''Admin'', 35, ''admin@example.com'', [''read'', ''write'', ''delete'']);
console.log(''Admin:'', admin.greet());
console.log(''Has write permission:'', admin.hasPermission(''write''));
```

```typescript
// src/generics.ts
console.log("=== Generics ===");

// Generic function
function identity<T>(arg: T): T {
    return arg;
}

let number = identity<number>(42);
let string = identity<string>(''hello'');
let boolean = identity<boolean>(true);

console.log(''Identity number:'', number);
console.log(''Identity string:'', string);
console.log(''Identity boolean:'', boolean);

// Generic interface
interface Box<T> {
    value: T;
    getValue(): T;
}

let numberBox: Box<number> = {
    value: 42,
    getValue: function() {
        return this.value;
    }
};

let stringBox: Box<string> = {
    value: ''hello'',
    getValue: function() {
        return this.value;
    }
};

console.log(''Number box:'', numberBox.getValue());
console.log(''String box:'', stringBox.getValue());

// Generic class
class Container<T> {
    private items: T[] = [];
    
    add(item: T): void {
        this.items.push(item);
    }
    
    get(index: number): T {
        return this.items[index];
    }
    
    getAll(): T[] {
        return this.items;
    }
}

let numberContainer = new Container<number>();
numberContainer.add(1);
numberContainer.add(2);
numberContainer.add(3);
console.log(''Number container:'', numberContainer.getAll());

let stringContainer = new Container<string>();
stringContainer.add(''a'');
stringContainer.add(''b'');
stringContainer.add(''c'');
console.log(''String container:'', stringContainer.getAll());
```

```typescript
// src/index.ts
import ''./basics'';
import ''./functions'';
import ''./interfaces'';
import ''./classes'';
import ''./generics'';
```

```json
// package.json
{
  "name": "typescript-practice",
  "version": "1.0.0",
  "scripts": {
    "build": "tsc",
    "watch": "tsc --watch",
    "start": "node dist/index.js"
  },
  "devDependencies": {
    "typescript": "^5.2.0"
  }
}
```

**Expected Output** (after compiling and running):
```
=== TypeScript Basics ===
Name: Alice
Age: 30
Active: true
Numbers: [1, 2, 3, 4, 5]
Names: [''Alice'', ''Bob'', ''Charlie'']
Tuple: [''Alice'', 30]
Value (string): hello
Value (number): 42
Anything: true

=== Functions ===
add(2, 3): 5
multiply(4, 5): 20
greet("Alice"): Hello, Alice!
greet("Alice", "Dr."): Hello, Dr. Alice!
createUser("Bob"): { name: ''Bob'', age: 18 }
createUser("Charlie", 25): { name: ''Charlie'', age: 25 }
sum(1, 2, 3, 4, 5): 15

=== Interfaces ===
User: { name: ''Alice'', age: 30, email: ''alice@example.com'' }
calc.add(10, 5): 15
calc.subtract(10, 5): 5
calc.multiply(10, 5): 50
calc.divide(10, 5): 2
Employee: { name: ''Bob'', age: 25, employeeId: ''E001'', department: ''Engineering'' }

=== Classes ===
User: Hello, I''m Alice
Email: alice@example.com
Admin: Hello, I''m Admin
Has write permission: true

=== Generics ===
Identity number: 42
Identity string: hello
Identity boolean: true
Number box: 42
String box: hello
Number container: [1, 2, 3]
String container: [''a'', ''b'', ''c'']
```

**Challenge (Optional)**:
- Convert JavaScript project to TypeScript
- Add types to existing code
- Create type definitions
- Build a complete TypeScript application

---

## Common Mistakes

### 1. Using any Too Much

```typescript
// ❌ Bad: Too much any
function process(data: any): any {
    return data;
}

// ✅ Good: Use specific types
function process<T>(data: T): T {
    return data;
}
```

### 2. Not Using Strict Mode

```json
// ❌ Bad: No strict mode
{
  "compilerOptions": {
    "strict": false
  }
}

// ✅ Good: Use strict mode
{
  "compilerOptions": {
    "strict": true
  }
}
```

### 3. Ignoring Type Errors

```typescript
// ❌ Bad: Ignore errors
// @ts-ignore
let value = undefinedValue.property;

// ✅ Good: Fix the error
let value = definedValue?.property;
```

---

## Key Takeaways

1. **TypeScript**: Typed superset of JavaScript
2. **Types**: string, number, boolean, arrays, etc.
3. **Interfaces**: Define object shapes
4. **Classes**: Type-safe classes with modifiers
5. **Generics**: Reusable type-safe code
6. **Compilation**: Compiles to JavaScript
7. **Best Practice**: Use strict mode, avoid any, leverage types

---

## Quiz: TypeScript

Test your understanding with these questions:

1. **TypeScript is:**
   - A) Typed superset of JavaScript
   - B) Different language
   - C) Both
   - D) Neither

2. **Type annotation uses:**
   - A) :
   - B) =
   - C) Both
   - D) Neither

3. **Interface defines:**
   - A) Object shape
   - B) Function
   - C) Both
   - D) Neither

4. **private modifier:**
   - A) Accessible anywhere
   - B) Accessible in class only
   - C) Accessible in subclasses
   - D) Nothing

5. **Generics use:**
   - A) <T>
   - B) {T}
   - C) [T]
   - D) (T)

6. **tsc compiles:**
   - A) TypeScript to JavaScript
   - B) JavaScript to TypeScript
   - C) Both
   - D) Neither

7. **strict mode:**
   - A) Enables strict checking
   - B) Disables checking
   - C) Both
   - D) Neither

**Answers**:
1. A) Typed superset of JavaScript
2. A) :
3. A) Object shape
4. B) Accessible in class only
5. A) <T>
6. A) TypeScript to JavaScript
7. A) Enables strict checking

---

## Next Steps

Congratulations! You''ve completed Module 24: Code Quality and Linting. You now know:
- ESLint for code quality
- TypeScript for type safety
- How to maintain code quality
- How to build type-safe applications

**What''s Next?**
- Course 7: Frontend Frameworks
- Module 25: React Basics
- Lesson 25.1: React Introduction
- Learn what React is
- Set up React projects

---

## Additional Resources

- **TypeScript Documentation**: [typescriptlang.org](https://www.typescriptlang.org)
- **TypeScript Handbook**: [typescriptlang.org/docs/handbook/intro.html](https://www.typescriptlang.org/docs/handbook/intro.html)
- **TypeScript Playground**: [typescriptlang.org/play](https://www.typescriptlang.org/play)

---

*Lesson completed! You''ve finished Module 24: Code Quality and Linting. Ready for Course 7: Frontend Frameworks!*

', NULL, 2, '2026-01-03 10:07:13', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand TypeScript basics
- Use types and interfaces
- Add type annotations
- Compile TypeScript to JavaScript
- Work with TypeScript features
- Build type-safe applications
- Understand type system benefits');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (174, 65, 16, 'React Introduction', 'react-introduction', '# Lesson 25.1: React Introduction

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what React is
- Know the React ecosystem
- Set up React projects
- Understand JSX syntax
- Create your first React app
- Work with React basics
- Build modern user interfaces

---

## Introduction to React

React is a JavaScript library for building user interfaces, particularly web applications.

### What is React?

- **Library**: Not a framework, but a library
- **Component-Based**: Build with reusable components
- **Declarative**: Describe what UI should look like
- **Virtual DOM**: Efficient updates
- **Unidirectional Data Flow**: Predictable data flow
- **Popular**: Most popular frontend library

### Why React?

- **Component Reusability**: Reuse components
- **Fast**: Virtual DOM for performance
- **Large Ecosystem**: Huge community and tools
- **Industry Standard**: Used by many companies
- **Great DX**: Excellent developer experience
- **Flexible**: Works with many tools

---

## React Ecosystem

### Core Libraries

```javascript
// React Core
react          // Core library
react-dom      // DOM rendering

// Routing
react-router   // Client-side routing

// State Management
redux          // Predictable state container
zustand        // Lightweight state management
recoil         // State management library

// UI Libraries
material-ui    // Material Design components
ant-design    // Enterprise UI components
chakra-ui     // Simple and modular
```

### Build Tools

```javascript
// Create React App
create-react-app

// Vite
vite

// Next.js (React framework)
next.js

// Remix (React framework)
remix
```

### Development Tools

```javascript
// React DevTools
// Browser extension for debugging

// Testing
@testing-library/react
jest

// Type Checking
TypeScript
PropTypes
```

---

## Setting Up React

### Create React App

```bash
# Create React app
npx create-react-app my-app

# Navigate to app
cd my-app

# Start development server
npm start
```

### Vite with React

```bash
# Create React app with Vite
npm create vite@latest my-app -- --template react

# Navigate to app
cd my-app

# Install dependencies
npm install

# Start development server
npm run dev
```

### Manual Setup

```bash
# Install React
npm install react react-dom

# Install build tools
npm install --save-dev @vitejs/plugin-react vite
```

```javascript
// vite.config.js
import { defineConfig } from ''vite'';
import react from ''@vitejs/plugin-react'';

export default defineConfig({
    plugins: [react()]
});
```

---

## JSX Syntax

### What is JSX?

JSX is a syntax extension that lets you write HTML-like code in JavaScript.

### Basic JSX

```javascript
// JSX
const element = <h1>Hello, World!</h1>;

// Equivalent JavaScript
const element = React.createElement(''h1'', null, ''Hello, World!'');
```

### JSX Expressions

```javascript
// Embedding expressions
const name = ''Alice'';
const element = <h1>Hello, {name}!</h1>;

// Expressions in attributes
const element = <img src={imageUrl} alt={imageAlt} />;

// Expressions in JSX
const element = (
    <div>
        <h1>{title}</h1>
        <p>{2 + 2}</p>
        <p>{user.name}</p>
    </div>
);
```

### JSX Rules

```javascript
// 1. Return single element
// ❌ Bad
function Component() {
    return (
        <h1>Title</h1>
        <p>Content</p>
    );
}

// ✅ Good: Wrap in fragment or div
function Component() {
    return (
        <>
            <h1>Title</h1>
            <p>Content</p>
        </>
    );
}

// 2. Use className instead of class
<div className="container">Content</div>

// 3. Self-closing tags
<img src="image.jpg" alt="Image" />
<br />
<input type="text" />

// 4. camelCase for attributes
<div tabIndex={0} onClick={handleClick}></div>
```

### JSX with JavaScript

```javascript
// Conditional rendering
function Greeting({ isLoggedIn }) {
    if (isLoggedIn) {
        return <h1>Welcome back!</h1>;
    }
    return <h1>Please sign in.</h1>;
}

// Ternary operator
function Greeting({ isLoggedIn }) {
    return (
        <div>
            {isLoggedIn ? <h1>Welcome back!</h1> : <h1>Please sign in.</h1>}
        </div>
    );
}

// Logical AND
function Mailbox({ unreadMessages }) {
    return (
        <div>
            <h1>Hello!</h1>
            {unreadMessages.length > 0 && (
                <h2>You have {unreadMessages.length} unread messages.</h2>
            )}
        </div>
    );
}

// Lists
function NumberList({ numbers }) {
    return (
        <ul>
            {numbers.map(number => (
                <li key={number}>{number}</li>
            ))}
        </ul>
    );
}
```

---

## Your First React App

### Simple Component

```javascript
// App.jsx
import React from ''react'';

function App() {
    return (
        <div className="App">
            <h1>Hello, React!</h1>
            <p>Welcome to React</p>
        </div>
    );
}

export default App;
```

### Rendering

```javascript
// index.js
import React from ''react'';
import ReactDOM from ''react-dom/client'';
import App from ''./App'';

const root = ReactDOM.createRoot(document.getElementById(''root''));
root.render(<App />);
```

### HTML Structure

```html
<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React App</title>
</head>
<body>
    <div id="root"></div>
</body>
</html>
```

---

## Practice Exercise

### Exercise: First React App

**Objective**: Practice setting up React, understanding JSX, and creating your first React application.

**Instructions**:

1. Set up a React project
2. Create components
3. Practice:
   - JSX syntax
   - Component creation
   - Rendering elements
   - Using expressions

**Example Solution**:

```bash
# Create React app with Vite
npm create vite@latest react-practice -- --template react
cd react-practice
npm install
```

```javascript
// src/App.jsx
import React from ''react'';
import ''./App.css'';

function App() {
    const name = ''React'';
    const version = ''18'';
    const features = [''Components'', ''JSX'', ''Virtual DOM'', ''Hooks''];
    
    return (
        <div className="App">
            <header className="App-header">
                <h1>Welcome to {name}!</h1>
                <p>Version {version}</p>
                
                <section>
                    <h2>About React</h2>
                    <p>
                        React is a JavaScript library for building user interfaces.
                        It''s component-based and uses JSX syntax.
                    </p>
                </section>
                
                <section>
                    <h2>Key Features</h2>
                    <ul>
                        {features.map((feature, index) => (
                            <li key={index}>{feature}</li>
                        ))}
                    </ul>
                </section>
                
                <section>
                    <h2>JSX Examples</h2>
                    <p>Math: 2 + 2 = {2 + 2}</p>
                    <p>Current time: {new Date().toLocaleTimeString()}</p>
                    <p>Conditional: {features.length > 0 ? ''Features available'' : ''No features''}</p>
                </section>
            </header>
        </div>
    );
}

export default App;
```

```css
/* src/App.css */
.App {
    text-align: center;
    padding: 20px;
}

.App-header {
    background-color: #282c34;
    padding: 20px;
    color: white;
    border-radius: 10px;
    margin: 20px auto;
    max-width: 800px;
}

.App-header h1 {
    color: #61dafb;
    margin-bottom: 10px;
}

.App-header section {
    margin: 20px 0;
    padding: 15px;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
}

.App-header ul {
    list-style: none;
    padding: 0;
}

.App-header li {
    padding: 5px;
    margin: 5px 0;
    background-color: rgba(97, 218, 251, 0.2);
    border-radius: 3px;
}
```

```javascript
// src/main.jsx
import React from ''react'';
import ReactDOM from ''react-dom/client'';
import App from ''./App'';
import ''./index.css'';

ReactDOM.createRoot(document.getElementById(''root'')).render(
    <React.StrictMode>
        <App />
    </React.StrictMode>
);
```

```css
/* src/index.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, ''Segoe UI'', ''Roboto'', ''Oxygen'',
        ''Ubuntu'', ''Cantarell'', ''Fira Sans'', ''Droid Sans'', ''Helvetica Neue'',
        sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background-color: #f5f5f5;
}

#root {
    min-height: 100vh;
}
```

```html
<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Practice</title>
</head>
<body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
</body>
</html>
```

```javascript
// Additional JSX examples
// src/components/JSXExamples.jsx
import React from ''react'';

function JSXExamples() {
    const user = {
        name: ''Alice'',
        age: 30,
        email: ''alice@example.com''
    };
    
    const isLoggedIn = true;
    const items = [''Apple'', ''Banana'', ''Orange''];
    
    return (
        <div className="jsx-examples">
            <h2>JSX Examples</h2>
            
            {/* Expressions */}
            <section>
                <h3>Expressions</h3>
                <p>Name: {user.name}</p>
                <p>Age: {user.age}</p>
                <p>Math: 5 + 3 = {5 + 3}</p>
            </section>
            
            {/* Conditional Rendering */}
            <section>
                <h3>Conditional Rendering</h3>
                {isLoggedIn ? (
                    <p>Welcome, {user.name}!</p>
                ) : (
                    <p>Please log in</p>
                )}
                
                {isLoggedIn && <p>You are logged in</p>}
            </section>
            
            {/* Lists */}
            <section>
                <h3>Lists</h3>
                <ul>
                    {items.map((item, index) => (
                        <li key={index}>{item}</li>
                    ))}
                </ul>
            </section>
            
            {/* Attributes */}
            <section>
                <h3>Attributes</h3>
                <div className="container" id="main">
                    <input type="text" placeholder="Enter text" />
                    <button onClick={() => alert(''Clicked!'')}>
                        Click Me
                    </button>
                </div>
            </section>
            
            {/* Fragments */}
            <section>
                <h3>Fragments</h3>
                <>
                    <p>First paragraph</p>
                    <p>Second paragraph</p>
                </>
            </section>
        </div>
    );
}

export default JSXExamples;
```

**Expected Output** (in browser):
- React app with header
- JSX examples displayed
- Interactive elements
- Styled components

**Challenge (Optional)**:
- Build a complete React app
- Create multiple components
- Add interactivity
- Style your components

---

## Common Mistakes

### 1. Not Returning Single Element

```javascript
// ❌ Bad: Multiple root elements
function Component() {
    return (
        <h1>Title</h1>
        <p>Content</p>
    );
}

// ✅ Good: Single root or fragment
function Component() {
    return (
        <>
            <h1>Title</h1>
            <p>Content</p>
        </>
    );
}
```

### 2. Using class Instead of className

```javascript
// ❌ Bad: HTML class
<div class="container">Content</div>

// ✅ Good: JSX className
<div className="container">Content</div>
```

### 3. Missing Keys in Lists

```javascript
// ❌ Bad: No key
{items.map(item => <li>{item}</li>)}

// ✅ Good: With key
{items.map((item, index) => <li key={index}>{item}</li>)}
```

---

## Key Takeaways

1. **React**: JavaScript library for building UIs
2. **Component-Based**: Build with reusable components
3. **JSX**: HTML-like syntax in JavaScript
4. **Virtual DOM**: Efficient updates
5. **Setup**: Create React App or Vite
6. **Best Practice**: Single root element, use className, add keys
7. **Ecosystem**: Large ecosystem of tools and libraries

---

## Quiz: React Basics

Test your understanding with these questions:

1. **React is:**
   - A) Framework
   - B) Library
   - C) Both
   - D) Neither

2. **JSX is:**
   - A) HTML
   - B) JavaScript syntax extension
   - C) CSS
   - D) Nothing

3. **JSX uses:**
   - A) class
   - B) className
   - C) Both
   - D) Neither

4. **React components return:**
   - A) Single element
   - B) Multiple elements
   - C) Both
   - D) Neither

5. **JSX expressions use:**
   - A) {}
   - B) []
   - C) Both
   - D) Neither

6. **React uses:**
   - A) Virtual DOM
   - B) Real DOM
   - C) Both
   - D) Neither

7. **Create React App:**
   - A) Sets up React project
   - B) Installs React only
   - C) Both
   - D) Neither

**Answers**:
1. B) Library
2. B) JavaScript syntax extension
3. B) className
4. A) Single element (or fragment)
5. A) {}
6. A) Virtual DOM
7. A) Sets up React project

---

## Next Steps

Congratulations! You''ve learned React introduction. You now know:
- What React is
- How to set up React
- JSX syntax
- How to create components

**What''s Next?**
- Lesson 25.2: Components and Props
- Learn functional and class components
- Understand props
- Build component composition

---

## Additional Resources

- **React Documentation**: [react.dev](https://react.dev)
- **React Tutorial**: [react.dev/learn](https://react.dev/learn)
- **JSX Guide**: [react.dev/learn/writing-markup-with-jsx](https://react.dev/learn/writing-markup-with-jsx)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:07:13', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what React is
- Know the React ecosystem
- Set up React projects
- Understand JSX syntax
- Create your first React app
- Work with React basics
- Build modern user interfaces');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (175, 65, 16, 'Components and JSX', 'components-and-jsx', '# Lesson 25.2: Components and Props

## Learning Objectives

By the end of this lesson, you will be able to:
- Create functional components
- Understand class components
- Work with props
- Compose components
- Build reusable components
- Pass data between components
- Structure React applications

---

## Introduction to Components

Components are the building blocks of React applications. They let you split the UI into independent, reusable pieces.

### What are Components?

- **Reusable**: Use components multiple times
- **Independent**: Each component manages its own logic
- **Composable**: Combine components to build UIs
- **Isolated**: Changes in one don''t affect others

---

## Functional Components

### Basic Functional Component

```javascript
// Simple functional component
function Welcome() {
    return <h1>Hello, World!</h1>;
}

// Arrow function component
const Welcome = () => {
    return <h1>Hello, World!</h1>;
};

// Usage
function App() {
    return <Welcome />;
}
```

### Component with Props

```javascript
// Component with props
function Welcome(props) {
    return <h1>Hello, {props.name}!</h1>;
}

// Usage
function App() {
    return <Welcome name="Alice" />;
}

// Arrow function with props
const Welcome = (props) => {
    return <h1>Hello, {props.name}!</h1>;
};
```

### Destructuring Props

```javascript
// Destructure props
function Welcome({ name, age }) {
    return (
        <div>
            <h1>Hello, {name}!</h1>
            <p>You are {age} years old</p>
        </div>
    );
}

// Usage
function App() {
    return <Welcome name="Alice" age={30} />;
}
```

---

## Class Components

### Basic Class Component

```javascript
import React, { Component } from ''react'';

class Welcome extends Component {
    render() {
        return <h1>Hello, World!</h1>;
    }
}

// Usage
function App() {
    return <Welcome />;
}
```

### Class Component with Props

```javascript
class Welcome extends Component {
    render() {
        return <h1>Hello, {this.props.name}!</h1>;
    }
}

// Usage
function App() {
    return <Welcome name="Alice" />;
}
```

### Note on Class Components

```javascript
// Class components are still supported but
// Functional components with hooks are preferred
// Most new code uses functional components
```

---

## Props

### What are Props?

Props (properties) are data passed from parent to child components.

### Passing Props

```javascript
// Parent component
function App() {
    return (
        <div>
            <User name="Alice" age={30} email="alice@example.com" />
            <User name="Bob" age={25} email="bob@example.com" />
        </div>
    );
}

// Child component
function User({ name, age, email }) {
    return (
        <div>
            <h2>{name}</h2>
            <p>Age: {age}</p>
            <p>Email: {email}</p>
        </div>
    );
}
```

### Props are Read-Only

```javascript
// ❌ Bad: Don''t modify props
function User({ name }) {
    name = ''Changed'';  // Error: Props are read-only
    return <h1>{name}</h1>;
}

// ✅ Good: Use props as-is
function User({ name }) {
    return <h1>{name}</h1>;
}
```

### Default Props

```javascript
// Default props
function Greeting({ name = ''Guest'' }) {
    return <h1>Hello, {name}!</h1>;
}

// Usage
<Greeting />           // Hello, Guest!
<Greeting name="Alice" />  // Hello, Alice!

// Or with defaultProps (class components)
class Greeting extends Component {
    static defaultProps = {
        name: ''Guest''
    };
    
    render() {
        return <h1>Hello, {this.props.name}!</h1>;
    }
}
```

### PropTypes (Type Checking)

```javascript
import PropTypes from ''prop-types'';

function User({ name, age, email }) {
    return (
        <div>
            <h2>{name}</h2>
            <p>Age: {age}</p>
            <p>Email: {email}</p>
        </div>
    );
}

User.propTypes = {
    name: PropTypes.string.isRequired,
    age: PropTypes.number.isRequired,
    email: PropTypes.string.isRequired
};
```

---

## Component Composition

### Composing Components

```javascript
// Small components
function Header({ title }) {
    return <header><h1>{title}</h1></header>;
}

function Content({ children }) {
    return <main>{children}</main>;
}

function Footer({ text }) {
    return <footer><p>{text}</p></footer>;
}

// Compose into larger component
function Page() {
    return (
        <div>
            <Header title="My Page" />
            <Content>
                <p>Page content goes here</p>
            </Content>
            <Footer text="Copyright 2024" />
        </div>
    );
}
```

### Children Prop

```javascript
// Component with children
function Container({ children, title }) {
    return (
        <div className="container">
            <h2>{title}</h2>
            {children}
        </div>
    );
}

// Usage
function App() {
    return (
        <Container title="My Container">
            <p>This is the content</p>
            <button>Click me</button>
        </Container>
    );
}
```

### Component Reusability

```javascript
// Reusable Button component
function Button({ text, onClick, variant = ''primary'' }) {
    return (
        <button 
            className={`btn btn-${variant}`}
            onClick={onClick}
        >
            {text}
        </button>
    );
}

// Usage
function App() {
    return (
        <div>
            <Button text="Submit" onClick={() => alert(''Submitted'')} />
            <Button text="Cancel" variant="secondary" onClick={() => alert(''Cancelled'')} />
            <Button text="Delete" variant="danger" onClick={() => alert(''Deleted'')} />
        </div>
    );
}
```

---

## Practical Examples

### Example 1: Card Component

```javascript
function Card({ title, description, image }) {
    return (
        <div className="card">
            {image && <img src={image} alt={title} />}
            <div className="card-content">
                <h3>{title}</h3>
                <p>{description}</p>
            </div>
        </div>
    );
}

// Usage
function App() {
    return (
        <div className="card-grid">
            <Card 
                title="React"
                description="A JavaScript library"
                image="/react-logo.png"
            />
            <Card 
                title="Vue"
                description="A progressive framework"
                image="/vue-logo.png"
            />
        </div>
    );
}
```

### Example 2: List Component

```javascript
function List({ items, renderItem }) {
    return (
        <ul>
            {items.map((item, index) => (
                <li key={index}>
                    {renderItem(item)}
                </li>
            ))}
        </ul>
    );
}

// Usage
function App() {
    let users = [
        { id: 1, name: ''Alice'', age: 30 },
        { id: 2, name: ''Bob'', age: 25 }
    ];
    
    return (
        <List 
            items={users}
            renderItem={(user) => (
                <div>
                    <strong>{user.name}</strong> - {user.age} years old
                </div>
            )}
        />
    );
}
```

### Example 3: Layout Component

```javascript
function Layout({ header, sidebar, main, footer }) {
    return (
        <div className="layout">
            <header>{header}</header>
            <div className="layout-body">
                <aside>{sidebar}</aside>
                <main>{main}</main>
            </div>
            <footer>{footer}</footer>
        </div>
    );
}

// Usage
function App() {
    return (
        <Layout
            header={<h1>My App</h1>}
            sidebar={<nav>Navigation</nav>}
            main={<div>Main content</div>}
            footer={<p>Footer</p>}
        />
    );
}
```

---

## Practice Exercise

### Exercise: Building Components

**Objective**: Practice creating functional components, working with props, and composing components.

**Instructions**:

1. Create a React project
2. Create multiple components
3. Practice:
   - Creating functional components
   - Passing and using props
   - Composing components
   - Building reusable components

**Example Solution**:

```javascript
// src/components/Button.jsx
import React from ''react'';

function Button({ text, onClick, variant = ''primary'', disabled = false }) {
    return (
        <button 
            className={`btn btn-${variant}`}
            onClick={onClick}
            disabled={disabled}
        >
            {text}
        </button>
    );
}

export default Button;
```

```javascript
// src/components/Card.jsx
import React from ''react'';

function Card({ title, description, image, children }) {
    return (
        <div className="card">
            {image && <img src={image} alt={title} className="card-image" />}
            <div className="card-content">
                <h3 className="card-title">{title}</h3>
                {description && <p className="card-description">{description}</p>}
                {children}
            </div>
        </div>
    );
}

export default Card;
```

```javascript
// src/components/UserCard.jsx
import React from ''react'';
import Card from ''./Card'';
import Button from ''./Button'';

function UserCard({ user, onEdit, onDelete }) {
    return (
        <Card 
            title={user.name}
            description={`Age: ${user.age} | Email: ${user.email}`}
        >
            <div className="card-actions">
                <Button text="Edit" onClick={() => onEdit(user.id)} variant="secondary" />
                <Button text="Delete" onClick={() => onDelete(user.id)} variant="danger" />
            </div>
        </Card>
    );
}

export default UserCard;
```

```javascript
// src/components/UserList.jsx
import React from ''react'';
import UserCard from ''./UserCard'';

function UserList({ users, onEdit, onDelete }) {
    if (users.length === 0) {
        return <p>No users found</p>;
    }
    
    return (
        <div className="user-list">
            {users.map(user => (
                <UserCard 
                    key={user.id}
                    user={user}
                    onEdit={onEdit}
                    onDelete={onDelete}
                />
            ))}
        </div>
    );
}

export default UserList;
```

```javascript
// src/components/Header.jsx
import React from ''react'';

function Header({ title, subtitle }) {
    return (
        <header className="header">
            <h1>{title}</h1>
            {subtitle && <p className="subtitle">{subtitle}</p>}
        </header>
    );
}

export default Header;
```

```javascript
// src/components/Layout.jsx
import React from ''react'';

function Layout({ header, children, footer }) {
    return (
        <div className="layout">
            {header && <header>{header}</header>}
            <main className="main-content">
                {children}
            </main>
            {footer && <footer>{footer}</footer>}
        </div>
    );
}

export default Layout;
```

```javascript
// src/App.jsx
import React from ''react'';
import Layout from ''./components/Layout'';
import Header from ''./components/Header'';
import UserList from ''./components/UserList'';
import Button from ''./components/Button'';
import ''./App.css'';

function App() {
    const users = [
        { id: 1, name: ''Alice'', age: 30, email: ''alice@example.com'' },
        { id: 2, name: ''Bob'', age: 25, email: ''bob@example.com'' },
        { id: 3, name: ''Charlie'', age: 35, email: ''charlie@example.com'' }
    ];
    
    const handleEdit = (userId) => {
        console.log(''Edit user:'', userId);
        alert(`Editing user ${userId}`);
    };
    
    const handleDelete = (userId) => {
        console.log(''Delete user:'', userId);
        if (confirm(''Are you sure?'')) {
            alert(`Deleting user ${userId}`);
        }
    };
    
    return (
        <Layout
            header={
                <Header 
                    title="User Management"
                    subtitle="Manage your users"
                />
            }
            footer={
                <div className="footer">
                    <p>&copy; 2024 My App</p>
                </div>
            }
        >
            <div className="app-content">
                <div className="actions">
                    <Button 
                        text="Add User" 
                        onClick={() => alert(''Add user'')}
                        variant="primary"
                    />
                </div>
                
                <UserList 
                    users={users}
                    onEdit={handleEdit}
                    onDelete={handleDelete}
                />
            </div>
        </Layout>
    );
}

export default App;
```

```css
/* src/App.css */
.layout {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.main-content {
    flex: 1;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

.header {
    background-color: #282c34;
    color: white;
    padding: 20px;
    text-align: center;
}

.header h1 {
    margin: 0;
    color: #61dafb;
}

.subtitle {
    margin: 10px 0 0 0;
    opacity: 0.8;
}

.app-content {
    padding: 20px;
}

.actions {
    margin-bottom: 20px;
}

.footer {
    background-color: #282c34;
    color: white;
    padding: 10px;
    text-align: center;
}

.user-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.card {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.2s;
}

.card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.card-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
}

.card-content {
    padding: 15px;
}

.card-title {
    margin: 0 0 10px 0;
    color: #333;
}

.card-description {
    margin: 0 0 15px 0;
    color: #666;
}

.card-actions {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-primary:hover {
    background-color: #0056b3;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-secondary:hover {
    background-color: #545b62;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn-danger:hover {
    background-color: #c82333;
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
```

**Expected Output** (in browser):
- Layout with header and footer
- User list with cards
- Interactive buttons
- Styled components

**Challenge (Optional)**:
- Build a complete component library
- Create complex component compositions
- Add PropTypes validation
- Build a real application

---

## Common Mistakes

### 1. Modifying Props

```javascript
// ❌ Bad: Modify props
function User({ name }) {
    name = name.toUpperCase();  // Error
    return <h1>{name}</h1>;
}

// ✅ Good: Use props as-is or create new variable
function User({ name }) {
    const upperName = name.toUpperCase();
    return <h1>{upperName}</h1>;
}
```

### 2. Missing Keys in Lists

```javascript
// ❌ Bad: No key
{users.map(user => <UserCard user={user} />)}

// ✅ Good: With key
{users.map(user => <UserCard key={user.id} user={user} />)}
```

### 3. Not Destructuring Props

```javascript
// ❌ Bad: Access via props object
function User(props) {
    return <h1>{props.name}</h1>;
}

// ✅ Good: Destructure props
function User({ name }) {
    return <h1>{name}</h1>;
}
```

---

## Key Takeaways

1. **Components**: Building blocks of React apps
2. **Functional Components**: Preferred way (with hooks)
3. **Props**: Data passed from parent to child
4. **Props are Read-Only**: Don''t modify props
5. **Composition**: Combine components to build UIs
6. **Reusability**: Create reusable components
7. **Best Practice**: Destructure props, add keys, use functional components

---

## Quiz: Components

Test your understanding with these questions:

1. **Components are:**
   - A) Reusable
   - B) Independent
   - C) Both
   - D) Neither

2. **Props are:**
   - A) Read-only
   - B) Mutable
   - C) Both
   - D) Neither

3. **Functional components:**
   - A) Preferred
   - B) Deprecated
   - C) Both
   - D) Neither

4. **Props passed:**
   - A) Parent to child
   - B) Child to parent
   - C) Both
   - D) Neither

5. **children prop:**
   - A) Special prop
   - B) Regular prop
   - C) Both
   - D) Neither

6. **Component composition:**
   - A) Combining components
   - B) Separating components
   - C) Both
   - D) Neither

7. **Keys in lists:**
   - A) Required
   - B) Optional
   - C) Both
   - D) Neither

**Answers**:
1. C) Both
2. A) Read-only
3. A) Preferred
4. A) Parent to child
5. A) Special prop
6. A) Combining components
7. A) Required

---

## Next Steps

Congratulations! You''ve learned components and props. You now know:
- How to create functional components
- How to work with props
- How to compose components
- How to build reusable components

**What''s Next?**
- Lesson 25.3: State and Events
- Learn useState hook
- Handle events in React
- Work with controlled components

---

## Additional Resources

- **React Components**: [react.dev/learn/your-first-component](https://react.dev/learn/your-first-component)
- **Props**: [react.dev/learn/passing-props-to-a-component](https://react.dev/learn/passing-props-to-a-component)
- **Component Composition**: [react.dev/learn/passing-data-deeply-with-context](https://react.dev/learn/passing-data-deeply-with-context)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:07:13', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create functional components
- Understand class components
- Work with props
- Compose components
- Build reusable components
- Pass data between components
- Structure React applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (176, 65, 16, 'Props and State', 'props-and-state', '# Lesson 25.3: State and Events

## Learning Objectives

By the end of this lesson, you will be able to:
- Use useState hook
- Handle events in React
- Create controlled components
- Lift state up
- Manage component state
- Build interactive components
- Create dynamic UIs

---

## Introduction to State

State is data that can change over time. When state changes, React re-renders the component.

### What is State?

- **Dynamic Data**: Data that can change
- **Component Memory**: Remembers values between renders
- **Triggers Re-render**: Component updates when state changes
- **Local to Component**: Each component has its own state

### State vs Props

```javascript
// Props: Passed from parent (read-only)
function User({ name }) {
    return <h1>{name}</h1>;  // name comes from props
}

// State: Managed by component (can change)
function Counter() {
    const [count, setCount] = useState(0);  // count is state
    return <h1>{count}</h1>;
}
```

---

## useState Hook

### Basic useState

```javascript
import { useState } from ''react'';

function Counter() {
    const [count, setCount] = useState(0);
    
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={() => setCount(count + 1)}>
                Increment
            </button>
        </div>
    );
}
```

### useState Syntax

```javascript
// useState returns array: [value, setter]
const [state, setState] = useState(initialValue);

// Example
const [name, setName] = useState(''Alice'');
const [age, setAge] = useState(30);
const [isActive, setIsActive] = useState(true);
```

### Updating State

```javascript
function Counter() {
    const [count, setCount] = useState(0);
    
    // Direct update
    const increment = () => {
        setCount(count + 1);
    };
    
    // Functional update (when new state depends on old)
    const increment = () => {
        setCount(prevCount => prevCount + 1);
    };
    
    // Multiple updates
    const reset = () => {
        setCount(0);
    };
    
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={increment}>Increment</button>
            <button onClick={reset}>Reset</button>
        </div>
    );
}
```

### Multiple State Variables

```javascript
function UserForm() {
    const [name, setName] = useState('''');
    const [email, setEmail] = useState('''');
    const [age, setAge] = useState(0);
    
    return (
        <form>
            <input 
                value={name}
                onChange={(e) => setName(e.target.value)}
                placeholder="Name"
            />
            <input 
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                placeholder="Email"
            />
            <input 
                type="number"
                value={age}
                onChange={(e) => setAge(parseInt(e.target.value))}
                placeholder="Age"
            />
        </form>
    );
}
```

### State with Objects

```javascript
function UserProfile() {
    const [user, setUser] = useState({
        name: '''',
        email: '''',
        age: 0
    });
    
    // Update object state
    const updateName = (name) => {
        setUser({ ...user, name });  // Spread operator
    };
    
    const updateEmail = (email) => {
        setUser(prevUser => ({ ...prevUser, email }));
    };
    
    return (
        <div>
            <input 
                value={user.name}
                onChange={(e) => updateName(e.target.value)}
            />
            <input 
                value={user.email}
                onChange={(e) => updateEmail(e.target.value)}
            />
        </div>
    );
}
```

### State with Arrays

```javascript
function TodoList() {
    const [todos, setTodos] = useState([]);
    const [input, setInput] = useState('''');
    
    const addTodo = () => {
        if (input.trim()) {
            setTodos([...todos, input]);
            setInput('''');
        }
    };
    
    const removeTodo = (index) => {
        setTodos(todos.filter((_, i) => i !== index));
    };
    
    return (
        <div>
            <input 
                value={input}
                onChange={(e) => setInput(e.target.value)}
            />
            <button onClick={addTodo}>Add</button>
            <ul>
                {todos.map((todo, index) => (
                    <li key={index}>
                        {todo}
                        <button onClick={() => removeTodo(index)}>Remove</button>
                    </li>
                ))}
            </ul>
        </div>
    );
}
```

---

## Event Handling

### Basic Event Handling

```javascript
function Button() {
    const handleClick = () => {
        console.log(''Button clicked!'');
    };
    
    return <button onClick={handleClick}>Click me</button>;
}
```

### Event Object

```javascript
function Input() {
    const handleChange = (event) => {
        console.log(''Value:'', event.target.value);
    };
    
    return <input onChange={handleChange} />;
}
```

### Common Events

```javascript
function EventExamples() {
    const handleClick = () => console.log(''Clicked'');
    const handleChange = (e) => console.log(''Changed:'', e.target.value);
    const handleSubmit = (e) => {
        e.preventDefault();
        console.log(''Submitted'');
    };
    const handleMouseEnter = () => console.log(''Mouse entered'');
    const handleMouseLeave = () => console.log(''Mouse left'');
    const handleFocus = () => console.log(''Focused'');
    const handleBlur = () => console.log(''Blurred'');
    
    return (
        <div>
            <button onClick={handleClick}>Click</button>
            <input onChange={handleChange} />
            <form onSubmit={handleSubmit}>
                <button type="submit">Submit</button>
            </form>
            <div 
                onMouseEnter={handleMouseEnter}
                onMouseLeave={handleMouseLeave}
            >
                Hover me
            </div>
            <input 
                onFocus={handleFocus}
                onBlur={handleBlur}
            />
        </div>
    );
}
```

### Passing Arguments

```javascript
function TodoList() {
    const [todos, setTodos] = useState([''Task 1'', ''Task 2'']);
    
    const handleRemove = (index) => {
        setTodos(todos.filter((_, i) => i !== index));
    };
    
    return (
        <ul>
            {todos.map((todo, index) => (
                <li key={index}>
                    {todo}
                    <button onClick={() => handleRemove(index)}>
                        Remove
                    </button>
                </li>
            ))}
        </ul>
    );
}
```

---

## Controlled Components

### What are Controlled Components?

Controlled components have their value controlled by React state.

### Input Example

```javascript
function ControlledInput() {
    const [value, setValue] = useState('''');
    
    const handleChange = (e) => {
        setValue(e.target.value);
    };
    
    return (
        <input 
            type="text"
            value={value}
            onChange={handleChange}
        />
    );
}
```

### Form Example

```javascript
function LoginForm() {
    const [email, setEmail] = useState('''');
    const [password, setPassword] = useState('''');
    
    const handleSubmit = (e) => {
        e.preventDefault();
        console.log(''Email:'', email);
        console.log(''Password:'', password);
        // Handle login
    };
    
    return (
        <form onSubmit={handleSubmit}>
            <input
                type="email"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
                placeholder="Email"
            />
            <input
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                placeholder="Password"
            />
            <button type="submit">Login</button>
        </form>
    );
}
```

### Select Example

```javascript
function SelectExample() {
    const [selected, setSelected] = useState('''');
    
    return (
        <select value={selected} onChange={(e) => setSelected(e.target.value)}>
            <option value="">Choose...</option>
            <option value="option1">Option 1</option>
            <option value="option2">Option 2</option>
            <option value="option3">Option 3</option>
        </select>
    );
}
```

---

## Lifting State Up

### What is Lifting State Up?

Moving state from child to parent component so multiple children can share it.

### Example: Temperature Converter

```javascript
// Child component
function TemperatureInput({ temperature, scale, onTemperatureChange }) {
    return (
        <fieldset>
            <legend>Enter temperature in {scale}:</legend>
            <input
                value={temperature}
                onChange={(e) => onTemperatureChange(e.target.value)}
            />
        </fieldset>
    );
}

// Parent component
function Calculator() {
    const [celsius, setCelsius] = useState('''');
    const [fahrenheit, setFahrenheit] = useState('''');
    
    const handleCelsiusChange = (value) => {
        setCelsius(value);
        setFahrenheit(value ? (parseFloat(value) * 9 / 5 + 32).toString() : '''');
    };
    
    const handleFahrenheitChange = (value) => {
        setFahrenheit(value);
        setCelsius(value ? ((parseFloat(value) - 32) * 5 / 9).toString() : '''');
    };
    
    return (
        <div>
            <TemperatureInput
                scale="celsius"
                temperature={celsius}
                onTemperatureChange={handleCelsiusChange}
            />
            <TemperatureInput
                scale="fahrenheit"
                temperature={fahrenheit}
                onTemperatureChange={handleFahrenheitChange}
            />
        </div>
    );
}
```

### Example: Shared Counter

```javascript
// Child component
function Counter({ count, onIncrement, onDecrement }) {
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={onIncrement}>+</button>
            <button onClick={onDecrement}>-</button>
        </div>
    );
}

// Parent component
function App() {
    const [count, setCount] = useState(0);
    
    return (
        <div>
            <Counter
                count={count}
                onIncrement={() => setCount(count + 1)}
                onDecrement={() => setCount(count - 1)}
            />
            <p>Total: {count}</p>
        </div>
    );
}
```

---

## Practice Exercise

### Exercise: State Management

**Objective**: Practice using useState, handling events, creating controlled components, and lifting state up.

**Instructions**:

1. Create a React project
2. Build interactive components
3. Practice:
   - Using useState hook
   - Handling events
   - Creating controlled components
   - Lifting state up

**Example Solution**:

```javascript
// src/components/Counter.jsx
import React, { useState } from ''react'';

function Counter() {
    const [count, setCount] = useState(0);
    
    const increment = () => setCount(count + 1);
    const decrement = () => setCount(count - 1);
    const reset = () => setCount(0);
    
    return (
        <div className="counter">
            <h2>Counter</h2>
            <p className="count-display">Count: {count}</p>
            <div className="buttons">
                <button onClick={decrement}>-</button>
                <button onClick={reset}>Reset</button>
                <button onClick={increment}>+</button>
            </div>
        </div>
    );
}

export default Counter;
```

```javascript
// src/components/Form.jsx
import React, { useState } from ''react'';

function Form({ onSubmit }) {
    const [formData, setFormData] = useState({
        name: '''',
        email: '''',
        message: ''''
    });
    
    const handleChange = (e) => {
        const { name, value } = e.target;
        setFormData(prev => ({
            ...prev,
            [name]: value
        }));
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        onSubmit(formData);
        setFormData({ name: '''', email: '''', message: '''' });
    };
    
    return (
        <form onSubmit={handleSubmit} className="form">
            <div className="form-group">
                <label>Name:</label>
                <input
                    type="text"
                    name="name"
                    value={formData.name}
                    onChange={handleChange}
                    required
                />
            </div>
            <div className="form-group">
                <label>Email:</label>
                <input
                    type="email"
                    name="email"
                    value={formData.email}
                    onChange={handleChange}
                    required
                />
            </div>
            <div className="form-group">
                <label>Message:</label>
                <textarea
                    name="message"
                    value={formData.message}
                    onChange={handleChange}
                    required
                />
            </div>
            <button type="submit">Submit</button>
        </form>
    );
}

export default Form;
```

```javascript
// src/components/TodoList.jsx
import React, { useState } from ''react'';

function TodoList() {
    const [todos, setTodos] = useState([]);
    const [input, setInput] = useState('''');
    
    const addTodo = (e) => {
        e.preventDefault();
        if (input.trim()) {
            setTodos([...todos, {
                id: Date.now(),
                text: input,
                completed: false
            }]);
            setInput('''');
        }
    };
    
    const toggleTodo = (id) => {
        setTodos(todos.map(todo =>
            todo.id === id ? { ...todo, completed: !todo.completed } : todo
        ));
    };
    
    const removeTodo = (id) => {
        setTodos(todos.filter(todo => todo.id !== id));
    };
    
    return (
        <div className="todo-list">
            <h2>Todo List</h2>
            <form onSubmit={addTodo}>
                <input
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    placeholder="Add todo..."
                />
                <button type="submit">Add</button>
            </form>
            <ul>
                {todos.map(todo => (
                    <li key={todo.id} className={todo.completed ? ''completed'' : ''''}>
                        <input
                            type="checkbox"
                            checked={todo.completed}
                            onChange={() => toggleTodo(todo.id)}
                        />
                        <span>{todo.text}</span>
                        <button onClick={() => removeTodo(todo.id)}>Remove</button>
                    </li>
                ))}
            </ul>
        </div>
    );
}

export default TodoList;
```

```javascript
// src/components/ColorPicker.jsx
import React, { useState } from ''react'';

function ColorPicker() {
    const [color, setColor] = useState(''#000000'');
    const [colors, setColors] = useState([]);
    
    const handleColorChange = (e) => {
        setColor(e.target.value);
    };
    
    const saveColor = () => {
        setColors([...colors, color]);
    };
    
    return (
        <div className="color-picker">
            <h2>Color Picker</h2>
            <div className="picker-controls">
                <input
                    type="color"
                    value={color}
                    onChange={handleColorChange}
                />
                <button onClick={saveColor}>Save Color</button>
            </div>
            <div 
                className="color-preview"
                style={{ backgroundColor: color }}
            >
                Selected Color
            </div>
            <div className="saved-colors">
                <h3>Saved Colors:</h3>
                {colors.map((c, index) => (
                    <div
                        key={index}
                        className="saved-color"
                        style={{ backgroundColor: c }}
                        onClick={() => setColor(c)}
                    />
                ))}
            </div>
        </div>
    );
}

export default ColorPicker;
```

```javascript
// src/components/SharedStateExample.jsx
import React, { useState } from ''react'';

// Child component
function Counter({ count, onIncrement, onDecrement, label }) {
    return (
        <div className="counter">
            <h3>{label}</h3>
            <p>Count: {count}</p>
            <button onClick={onIncrement}>+</button>
            <button onClick={onDecrement}>-</button>
        </div>
    );
}

// Parent component
function SharedStateExample() {
    const [count, setCount] = useState(0);
    
    return (
        <div className="shared-state">
            <h2>Shared State Example</h2>
            <p>Total: {count}</p>
            <div className="counters">
                <Counter
                    label="Counter 1"
                    count={count}
                    onIncrement={() => setCount(count + 1)}
                    onDecrement={() => setCount(count - 1)}
                />
                <Counter
                    label="Counter 2"
                    count={count}
                    onIncrement={() => setCount(count + 1)}
                    onDecrement={() => setCount(count - 1)}
                />
            </div>
        </div>
    );
}

export default SharedStateExample;
```

```javascript
// src/App.jsx
import React, { useState } from ''react'';
import Counter from ''./components/Counter'';
import Form from ''./components/Form'';
import TodoList from ''./components/TodoList'';
import ColorPicker from ''./components/ColorPicker'';
import SharedStateExample from ''./components/SharedStateExample'';
import ''./App.css'';

function App() {
    const [submissions, setSubmissions] = useState([]);
    
    const handleFormSubmit = (data) => {
        setSubmissions([...submissions, data]);
        alert(''Form submitted!'');
    };
    
    return (
        <div className="App">
            <header>
                <h1>React State and Events Practice</h1>
            </header>
            
            <main>
                <section>
                    <Counter />
                </section>
                
                <section>
                    <h2>Contact Form</h2>
                    <Form onSubmit={handleFormSubmit} />
                    {submissions.length > 0 && (
                        <div className="submissions">
                            <h3>Submissions:</h3>
                            {submissions.map((sub, index) => (
                                <div key={index} className="submission">
                                    <p><strong>{sub.name}</strong> ({sub.email})</p>
                                    <p>{sub.message}</p>
                                </div>
                            ))}
                        </div>
                    )}
                </section>
                
                <section>
                    <TodoList />
                </section>
                
                <section>
                    <ColorPicker />
                </section>
                
                <section>
                    <SharedStateExample />
                </section>
            </main>
        </div>
    );
}

export default App;
```

```css
/* src/App.css */
.App {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 30px;
}

section {
    margin-bottom: 40px;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
}

.counter {
    text-align: center;
}

.count-display {
    font-size: 24px;
    font-weight: bold;
    margin: 20px 0;
}

.buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
}

button {
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
}

button:hover {
    background-color: #0056b3;
}

.form {
    max-width: 400px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
}

.form-group input,
.form-group textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.todo-list ul {
    list-style: none;
    padding: 0;
}

.todo-list li {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    margin: 5px 0;
    background-color: #f5f5f5;
    border-radius: 4px;
}

.todo-list li.completed span {
    text-decoration: line-through;
    opacity: 0.6;
}

.color-picker {
    max-width: 400px;
}

.picker-controls {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.color-preview {
    width: 100%;
    height: 100px;
    border: 2px solid #ddd;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
}

.saved-colors {
    margin-top: 20px;
}

.saved-color {
    width: 50px;
    height: 50px;
    border: 2px solid #ddd;
    border-radius: 4px;
    display: inline-block;
    margin: 5px;
    cursor: pointer;
}

.shared-state .counters {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
}

.submissions {
    margin-top: 20px;
}

.submission {
    padding: 10px;
    margin: 10px 0;
    background-color: #f0f0f0;
    border-radius: 4px;
}
```

**Expected Output** (in browser):
- Interactive counter
- Working form with controlled inputs
- Todo list with add/remove/toggle
- Color picker with saved colors
- Shared state example

**Challenge (Optional)**:
- Build a complete interactive app
- Create complex state management
- Build forms with validation
- Practice lifting state up

---

## Common Mistakes

### 1. Mutating State Directly

```javascript
// ❌ Bad: Mutate state
const [items, setItems] = useState([1, 2, 3]);
items.push(4);  // Don''t do this!

// ✅ Good: Create new array
const [items, setItems] = useState([1, 2, 3]);
setItems([...items, 4]);
```

### 2. Not Using Functional Updates

```javascript
// ❌ Bad: When state depends on previous state
const increment = () => {
    setCount(count + 1);
    setCount(count + 1);  // Only increments once!
};

// ✅ Good: Use functional update
const increment = () => {
    setCount(prev => prev + 1);
    setCount(prev => prev + 1);  // Increments twice!
};
```

### 3. Forgetting to Prevent Default

```javascript
// ❌ Bad: Form submits and page reloads
const handleSubmit = () => {
    // Process form
};

// ✅ Good: Prevent default
const handleSubmit = (e) => {
    e.preventDefault();
    // Process form
};
```

---

## Key Takeaways

1. **useState**: Hook for managing state
2. **State Updates**: Trigger re-renders
3. **Events**: Handle user interactions
4. **Controlled Components**: Value controlled by state
5. **Lifting State**: Move state to common ancestor
6. **Best Practice**: Don''t mutate state, use functional updates
7. **Patterns**: Controlled inputs, event handlers, state lifting

---

## Quiz: State and Events

Test your understanding with these questions:

1. **useState returns:**
   - A) [value, setter]
   - B) {value, setter}
   - C) value only
   - D) Nothing

2. **State changes:**
   - A) Trigger re-render
   - B) Don''t trigger re-render
   - C) Both
   - D) Neither

3. **Controlled component:**
   - A) Value from state
   - B) Value from DOM
   - C) Both
   - D) Neither

4. **Event handlers:**
   - A) Handle user interactions
   - B) Handle state
   - C) Both
   - D) Neither

5. **Lifting state:**
   - A) Move to parent
   - B) Move to child
   - C) Both
   - D) Neither

6. **State should be:**
   - A) Immutable
   - B) Mutable
   - C) Both
   - D) Neither

7. **Functional update:**
   - A) Uses previous state
   - B) Uses current state
   - C) Both
   - D) Neither

**Answers**:
1. A) [value, setter]
2. A) Trigger re-render
3. A) Value from state
4. A) Handle user interactions
5. A) Move to parent
6. A) Immutable
7. A) Uses previous state

---

## Next Steps

Congratulations! You''ve completed Module 25: React Basics. You now know:
- React introduction and JSX
- Components and props
- State and events
- How to build interactive React apps

**What''s Next?**
- Module 26: React Advanced
- Lesson 26.1: React Hooks
- Learn useEffect, useContext, useReducer
- Build custom hooks

---

## Additional Resources

- **React State**: [react.dev/learn/state-a-components-memory](https://react.dev/learn/state-a-components-memory)
- **Events**: [react.dev/learn/responding-to-events](https://react.dev/learn/responding-to-events)
- **Controlled Components**: [react.dev/reference/react-dom/components/input#controlling-an-input-with-a-state-variable](https://react.dev/reference/react-dom/components/input#controlling-an-input-with-a-state-variable)

---

*Lesson completed! You''ve finished Module 25: React Basics. Ready for Module 26: React Advanced!*

', NULL, 3, '2026-01-03 10:07:13', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use useState hook
- Handle events in React
- Create controlled components
- Lift state up
- Manage component state
- Build interactive components
- Create dynamic UIs');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (177, 66, 16, 'React Hooks', 'react-hooks', '# Lesson 26.1: React Hooks

## Learning Objectives

By the end of this lesson, you will be able to:
- Use useEffect hook
- Use useContext hook
- Use useReducer hook
- Create custom hooks
- Manage side effects
- Share context across components
- Handle complex state logic
- Build reusable hook logic

---

## Introduction to Hooks

Hooks are functions that let you "hook into" React features from functional components.

### What are Hooks?

- **Functional Components**: Use state and lifecycle in functions
- **Reusable Logic**: Share stateful logic between components
- **No Classes**: Don''t need class components
- **Rules**: Only call at top level, only in React functions

### Built-in Hooks

```javascript
// State
useState        // Manage state
useReducer      // Complex state logic

// Effects
useEffect       // Side effects
useLayoutEffect // Synchronous effects

// Context
useContext      // Access context

// Refs
useRef          // DOM refs
useImperativeHandle // Custom refs

// Performance
useMemo         // Memoize values
useCallback     // Memoize functions

// Custom
// Create your own hooks
```

---

## useEffect Hook

### What is useEffect?

useEffect lets you perform side effects in functional components.

### Basic useEffect

```javascript
import { useState, useEffect } from ''react'';

function Counter() {
    const [count, setCount] = useState(0);
    
    // Runs after every render
    useEffect(() => {
        document.title = `Count: ${count}`;
    });
    
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={() => setCount(count + 1)}>Increment</button>
        </div>
    );
}
```

### useEffect with Dependencies

```javascript
// Runs only on mount
useEffect(() => {
    console.log(''Component mounted'');
}, []);  // Empty dependency array

// Runs when count changes
useEffect(() => {
    console.log(''Count changed:'', count);
}, [count]);  // Dependency array

// Runs when count or name changes
useEffect(() => {
    console.log(''Count or name changed'');
}, [count, name]);
```

### Cleanup Function

```javascript
function Timer() {
    const [seconds, setSeconds] = useState(0);
    
    useEffect(() => {
        const interval = setInterval(() => {
            setSeconds(prev => prev + 1);
        }, 1000);
        
        // Cleanup function
        return () => {
            clearInterval(interval);
        };
    }, []);  // Run once on mount
    
    return <div>Seconds: {seconds}</div>;
}
```

### Fetching Data

```javascript
function UserProfile({ userId }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        // Reset state
        setLoading(true);
        setError(null);
        
        // Fetch data
        fetch(`/api/users/${userId}`)
            .then(response => response.json())
            .then(data => {
                setUser(data);
                setLoading(false);
            })
            .catch(err => {
                setError(err.message);
                setLoading(false);
            });
    }, [userId]);  // Re-fetch when userId changes
    
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error}</div>;
    if (!user) return <div>No user found</div>;
    
    return (
        <div>
            <h1>{user.name}</h1>
            <p>{user.email}</p>
        </div>
    );
}
```

### Multiple useEffect Hooks

```javascript
function Component() {
    const [count, setCount] = useState(0);
    const [name, setName] = useState('''');
    
    // Separate effects for different concerns
    useEffect(() => {
        document.title = `Count: ${count}`;
    }, [count]);
    
    useEffect(() => {
        console.log(''Name changed:'', name);
    }, [name]);
    
    useEffect(() => {
        // Setup
        console.log(''Component mounted'');
        
        return () => {
            // Cleanup
            console.log(''Component unmounted'');
        };
    }, []);
    
    return <div>...</div>;
}
```

---

## useContext Hook

### What is useContext?

useContext lets you access context values without prop drilling.

### Creating Context

```javascript
import { createContext, useContext } from ''react'';

// Create context
const ThemeContext = createContext(''light'');

// Provider component
function ThemeProvider({ children }) {
    const [theme, setTheme] = useState(''light'');
    
    return (
        <ThemeContext.Provider value={{ theme, setTheme }}>
            {children}
        </ThemeContext.Provider>
    );
}

// Custom hook to use context
function useTheme() {
    const context = useContext(ThemeContext);
    if (!context) {
        throw new Error(''useTheme must be used within ThemeProvider'');
    }
    return context;
}
```

### Using Context

```javascript
// Child component
function Button() {
    const { theme, setTheme } = useTheme();
    
    return (
        <button 
            className={`btn btn-${theme}`}
            onClick={() => setTheme(theme === ''light'' ? ''dark'' : ''light'')}
        >
            Toggle Theme
        </button>
    );
}

// App component
function App() {
    return (
        <ThemeProvider>
            <Button />
        </ThemeProvider>
    );
}
```

### Multiple Contexts

```javascript
// Theme context
const ThemeContext = createContext();

// User context
const UserContext = createContext();

function App() {
    return (
        <ThemeProvider>
            <UserProvider>
                <Component />
            </UserProvider>
        </ThemeProvider>
    );
}

function Component() {
    const theme = useContext(ThemeContext);
    const user = useContext(UserContext);
    
    return <div>...</div>;
}
```

### Context Example: User Authentication

```javascript
// AuthContext.jsx
import { createContext, useContext, useState, useEffect } from ''react'';

const AuthContext = createContext();

export function AuthProvider({ children }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    
    useEffect(() => {
        // Check if user is logged in
        const savedUser = localStorage.getItem(''user'');
        if (savedUser) {
            setUser(JSON.parse(savedUser));
        }
        setLoading(false);
    }, []);
    
    const login = (userData) => {
        setUser(userData);
        localStorage.setItem(''user'', JSON.stringify(userData));
    };
    
    const logout = () => {
        setUser(null);
        localStorage.removeItem(''user'');
    };
    
    return (
        <AuthContext.Provider value={{ user, login, logout, loading }}>
            {children}
        </AuthContext.Provider>
    );
}

export function useAuth() {
    const context = useContext(AuthContext);
    if (!context) {
        throw new Error(''useAuth must be used within AuthProvider'');
    }
    return context;
}
```

```javascript
// Using AuthContext
function LoginButton() {
    const { user, login, logout } = useAuth();
    
    if (user) {
        return (
            <div>
                <p>Welcome, {user.name}!</p>
                <button onClick={logout}>Logout</button>
            </div>
        );
    }
    
    return (
        <button onClick={() => login({ name: ''Alice'', id: 1 })}>
            Login
        </button>
    );
}
```

---

## useReducer Hook

### What is useReducer?

useReducer is an alternative to useState for managing complex state logic.

### Basic useReducer

```javascript
import { useReducer } from ''react'';

// Reducer function
function counterReducer(state, action) {
    switch (action.type) {
        case ''increment'':
            return { count: state.count + 1 };
        case ''decrement'':
            return { count: state.count - 1 };
        case ''reset'':
            return { count: 0 };
        default:
            return state;
    }
}

function Counter() {
    const [state, dispatch] = useReducer(counterReducer, { count: 0 });
    
    return (
        <div>
            <p>Count: {state.count}</p>
            <button onClick={() => dispatch({ type: ''increment'' })}>+</button>
            <button onClick={() => dispatch({ type: ''decrement'' })}>-</button>
            <button onClick={() => dispatch({ type: ''reset'' })}>Reset</button>
        </div>
    );
}
```

### Complex State with useReducer

```javascript
// Reducer for todo list
function todoReducer(state, action) {
    switch (action.type) {
        case ''add'':
            return {
                ...state,
                todos: [...state.todos, {
                    id: Date.now(),
                    text: action.text,
                    completed: false
                }]
            };
        case ''toggle'':
            return {
                ...state,
                todos: state.todos.map(todo =>
                    todo.id === action.id
                        ? { ...todo, completed: !todo.completed }
                        : todo
                )
            };
        case ''delete'':
            return {
                ...state,
                todos: state.todos.filter(todo => todo.id !== action.id)
            };
        case ''setFilter'':
            return {
                ...state,
                filter: action.filter
            };
        default:
            return state;
    }
}

function TodoApp() {
    const [state, dispatch] = useReducer(todoReducer, {
        todos: [],
        filter: ''all''
    });
    
    const addTodo = (text) => {
        dispatch({ type: ''add'', text });
    };
    
    const toggleTodo = (id) => {
        dispatch({ type: ''toggle'', id });
    };
    
    const deleteTodo = (id) => {
        dispatch({ type: ''delete'', id });
    };
    
    const filteredTodos = state.todos.filter(todo => {
        if (state.filter === ''active'') return !todo.completed;
        if (state.filter === ''completed'') return todo.completed;
        return true;
    });
    
    return (
        <div>
            <input
                onKeyPress={(e) => {
                    if (e.key === ''Enter'') {
                        addTodo(e.target.value);
                        e.target.value = '''';
                    }
                }}
            />
            <div>
                <button onClick={() => dispatch({ type: ''setFilter'', filter: ''all'' })}>
                    All
                </button>
                <button onClick={() => dispatch({ type: ''setFilter'', filter: ''active'' })}>
                    Active
                </button>
                <button onClick={() => dispatch({ type: ''setFilter'', filter: ''completed'' })}>
                    Completed
                </button>
            </div>
            <ul>
                {filteredTodos.map(todo => (
                    <li key={todo.id}>
                        <input
                            type="checkbox"
                            checked={todo.completed}
                            onChange={() => toggleTodo(todo.id)}
                        />
                        {todo.text}
                        <button onClick={() => deleteTodo(todo.id)}>Delete</button>
                    </li>
                ))}
            </ul>
        </div>
    );
}
```

### useReducer vs useState

```javascript
// useState: Simple state
const [count, setCount] = useState(0);

// useReducer: Complex state logic
const [state, dispatch] = useReducer(reducer, initialState);

// When to use useReducer:
// - Complex state logic
// - Multiple sub-values
// - Next state depends on previous
// - Better for testing
```

---

## Custom Hooks

### What are Custom Hooks?

Custom hooks are functions that use other hooks to encapsulate reusable logic.

### Basic Custom Hook

```javascript
// Custom hook: useCounter
function useCounter(initialValue = 0) {
    const [count, setCount] = useState(initialValue);
    
    const increment = () => setCount(count + 1);
    const decrement = () => setCount(count - 1);
    const reset = () => setCount(initialValue);
    
    return { count, increment, decrement, reset };
}

// Using custom hook
function Counter() {
    const { count, increment, decrement, reset } = useCounter(0);
    
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={increment}>+</button>
            <button onClick={decrement}>-</button>
            <button onClick={reset}>Reset</button>
        </div>
    );
}
```

### Custom Hook: useFetch

```javascript
// Custom hook: useFetch
function useFetch(url) {
    const [data, setData] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        setLoading(true);
        setError(null);
        
        fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error(''Network response was not ok'');
                }
                return response.json();
            })
            .then(data => {
                setData(data);
                setLoading(false);
            })
            .catch(err => {
                setError(err.message);
                setLoading(false);
            });
    }, [url]);
    
    return { data, loading, error };
}

// Using custom hook
function UserProfile({ userId }) {
    const { data: user, loading, error } = useFetch(`/api/users/${userId}`);
    
    if (loading) return <div>Loading...</div>;
    if (error) return <div>Error: {error}</div>;
    if (!user) return <div>No user found</div>;
    
    return (
        <div>
            <h1>{user.name}</h1>
            <p>{user.email}</p>
        </div>
    );
}
```

### Custom Hook: useLocalStorage

```javascript
// Custom hook: useLocalStorage
function useLocalStorage(key, initialValue) {
    const [storedValue, setStoredValue] = useState(() => {
        try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
        } catch (error) {
            console.error(error);
            return initialValue;
        }
    });
    
    const setValue = (value) => {
        try {
            setStoredValue(value);
            window.localStorage.setItem(key, JSON.stringify(value));
        } catch (error) {
            console.error(error);
        }
    };
    
    return [storedValue, setValue];
}

// Using custom hook
function Settings() {
    const [theme, setTheme] = useLocalStorage(''theme'', ''light'');
    const [language, setLanguage] = useLocalStorage(''language'', ''en'');
    
    return (
        <div>
            <select value={theme} onChange={(e) => setTheme(e.target.value)}>
                <option value="light">Light</option>
                <option value="dark">Dark</option>
            </select>
            <select value={language} onChange={(e) => setLanguage(e.target.value)}>
                <option value="en">English</option>
                <option value="es">Spanish</option>
            </select>
        </div>
    );
}
```

### Custom Hook: useDebounce

```javascript
// Custom hook: useDebounce
function useDebounce(value, delay) {
    const [debouncedValue, setDebouncedValue] = useState(value);
    
    useEffect(() => {
        const handler = setTimeout(() => {
            setDebouncedValue(value);
        }, delay);
        
        return () => {
            clearTimeout(handler);
        };
    }, [value, delay]);
    
    return debouncedValue;
}

// Using custom hook
function SearchInput() {
    const [searchTerm, setSearchTerm] = useState('''');
    const debouncedSearchTerm = useDebounce(searchTerm, 500);
    const [results, setResults] = useState([]);
    
    useEffect(() => {
        if (debouncedSearchTerm) {
            // Perform search
            fetch(`/api/search?q=${debouncedSearchTerm}`)
                .then(res => res.json())
                .then(data => setResults(data));
        } else {
            setResults([]);
        }
    }, [debouncedSearchTerm]);
    
    return (
        <div>
            <input
                value={searchTerm}
                onChange={(e) => setSearchTerm(e.target.value)}
                placeholder="Search..."
            />
            <ul>
                {results.map(result => (
                    <li key={result.id}>{result.name}</li>
                ))}
            </ul>
        </div>
    );
}
```

---

## Practice Exercise

### Exercise: Hooks Practice

**Objective**: Practice using useEffect, useContext, useReducer, and creating custom hooks.

**Instructions**:

1. Create a React project
2. Practice hooks
3. Practice:
   - Using useEffect for side effects
   - Using useContext for context
   - Using useReducer for complex state
   - Creating custom hooks

**Example Solution**:

```javascript
// src/hooks/useCounter.js
import { useState } from ''react'';

export function useCounter(initialValue = 0, step = 1) {
    const [count, setCount] = useState(initialValue);
    
    const increment = () => setCount(count + step);
    const decrement = () => setCount(count - step);
    const reset = () => setCount(initialValue);
    
    return { count, increment, decrement, reset };
}
```

```javascript
// src/hooks/useFetch.js
import { useState, useEffect } from ''react'';

export function useFetch(url) {
    const [data, setData] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        let cancelled = false;
        
        setLoading(true);
        setError(null);
        
        fetch(url)
            .then(response => {
                if (!response.ok) {
                    throw new Error(''Network response was not ok'');
                }
                return response.json();
            })
            .then(data => {
                if (!cancelled) {
                    setData(data);
                    setLoading(false);
                }
            })
            .catch(err => {
                if (!cancelled) {
                    setError(err.message);
                    setLoading(false);
                }
            });
        
        return () => {
            cancelled = true;
        };
    }, [url]);
    
    return { data, loading, error };
}
```

```javascript
// src/hooks/useLocalStorage.js
import { useState, useEffect } from ''react'';

export function useLocalStorage(key, initialValue) {
    const [storedValue, setStoredValue] = useState(() => {
        try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
        } catch (error) {
            console.error(error);
            return initialValue;
        }
    });
    
    const setValue = (value) => {
        try {
            const valueToStore = value instanceof Function ? value(storedValue) : value;
            setStoredValue(valueToStore);
            window.localStorage.setItem(key, JSON.stringify(valueToStore));
        } catch (error) {
            console.error(error);
        }
    };
    
    return [storedValue, setValue];
}
```

```javascript
// src/contexts/ThemeContext.jsx
import { createContext, useContext, useState, useEffect } from ''react'';

const ThemeContext = createContext();

export function ThemeProvider({ children }) {
    const [theme, setTheme] = useLocalStorage(''theme'', ''light'');
    
    useEffect(() => {
        document.documentElement.setAttribute(''data-theme'', theme);
    }, [theme]);
    
    return (
        <ThemeContext.Provider value={{ theme, setTheme }}>
            {children}
        </ThemeContext.Provider>
    );
}

export function useTheme() {
    const context = useContext(ThemeContext);
    if (!context) {
        throw new Error(''useTheme must be used within ThemeProvider'');
    }
    return context;
}
```

```javascript
// src/components/Counter.jsx
import React from ''react'';
import { useCounter } from ''../hooks/useCounter'';

function Counter() {
    const { count, increment, decrement, reset } = useCounter(0);
    
    return (
        <div className="counter">
            <h2>Counter</h2>
            <p>Count: {count}</p>
            <div className="buttons">
                <button onClick={decrement}>-</button>
                <button onClick={reset}>Reset</button>
                <button onClick={increment}>+</button>
            </div>
        </div>
    );
}

export default Counter;
```

```javascript
// src/components/TodoApp.jsx
import React, { useReducer, useState } from ''react'';

function todoReducer(state, action) {
    switch (action.type) {
        case ''add'':
            return {
                ...state,
                todos: [...state.todos, {
                    id: Date.now(),
                    text: action.text,
                    completed: false
                }]
            };
        case ''toggle'':
            return {
                ...state,
                todos: state.todos.map(todo =>
                    todo.id === action.id
                        ? { ...todo, completed: !todo.completed }
                        : todo
                )
            };
        case ''delete'':
            return {
                ...state,
                todos: state.todos.filter(todo => todo.id !== action.id)
            };
        case ''setFilter'':
            return {
                ...state,
                filter: action.filter
            };
        default:
            return state;
    }
}

function TodoApp() {
    const [state, dispatch] = useReducer(todoReducer, {
        todos: [],
        filter: ''all''
    });
    const [input, setInput] = useState('''');
    
    const addTodo = () => {
        if (input.trim()) {
            dispatch({ type: ''add'', text: input });
            setInput('''');
        }
    };
    
    const filteredTodos = state.todos.filter(todo => {
        if (state.filter === ''active'') return !todo.completed;
        if (state.filter === ''completed'') return todo.completed;
        return true;
    });
    
    return (
        <div className="todo-app">
            <h2>Todo App</h2>
            <div className="todo-input">
                <input
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    onKeyPress={(e) => e.key === ''Enter'' && addTodo()}
                    placeholder="Add todo..."
                />
                <button onClick={addTodo}>Add</button>
            </div>
            <div className="filters">
                <button
                    className={state.filter === ''all'' ? ''active'' : ''''}
                    onClick={() => dispatch({ type: ''setFilter'', filter: ''all'' })}
                >
                    All
                </button>
                <button
                    className={state.filter === ''active'' ? ''active'' : ''''}
                    onClick={() => dispatch({ type: ''setFilter'', filter: ''active'' })}
                >
                    Active
                </button>
                <button
                    className={state.filter === ''completed'' ? ''active'' : ''''}
                    onClick={() => dispatch({ type: ''setFilter'', filter: ''completed'' })}
                >
                    Completed
                </button>
            </div>
            <ul className="todo-list">
                {filteredTodos.map(todo => (
                    <li key={todo.id} className={todo.completed ? ''completed'' : ''''}>
                        <input
                            type="checkbox"
                            checked={todo.completed}
                            onChange={() => dispatch({ type: ''toggle'', id: todo.id })}
                        />
                        <span>{todo.text}</span>
                        <button onClick={() => dispatch({ type: ''delete'', id: todo.id })}>
                            Delete
                        </button>
                    </li>
                ))}
            </ul>
        </div>
    );
}

export default TodoApp;
```

```javascript
// src/components/ThemeToggle.jsx
import React from ''react'';
import { useTheme } from ''../contexts/ThemeContext'';

function ThemeToggle() {
    const { theme, setTheme } = useTheme();
    
    return (
        <button
            className="theme-toggle"
            onClick={() => setTheme(theme === ''light'' ? ''dark'' : ''light'')}
        >
            {theme === ''light'' ? ''🌙'' : ''☀️''} {theme}
        </button>
    );
}

export default ThemeToggle;
```

```javascript
// src/components/UserProfile.jsx
import React from ''react'';
import { useFetch } from ''../hooks/useFetch'';

function UserProfile({ userId }) {
    const { data: user, loading, error } = useFetch(`https://jsonplaceholder.typicode.com/users/${userId}`);
    
    if (loading) return <div className="loading">Loading...</div>;
    if (error) return <div className="error">Error: {error}</div>;
    if (!user) return <div>No user found</div>;
    
    return (
        <div className="user-profile">
            <h2>{user.name}</h2>
            <p><strong>Email:</strong> {user.email}</p>
            <p><strong>Phone:</strong> {user.phone}</p>
            <p><strong>Website:</strong> {user.website}</p>
        </div>
    );
}

export default UserProfile;
```

```javascript
// src/App.jsx
import React from ''react'';
import { ThemeProvider } from ''./contexts/ThemeContext'';
import Counter from ''./components/Counter'';
import TodoApp from ''./components/TodoApp'';
import ThemeToggle from ''./components/ThemeToggle'';
import UserProfile from ''./components/UserProfile'';
import ''./App.css'';

function App() {
    return (
        <ThemeProvider>
            <div className="App">
                <header>
                    <h1>React Hooks Practice</h1>
                    <ThemeToggle />
                </header>
                <main>
                    <section>
                        <Counter />
                    </section>
                    <section>
                        <TodoApp />
                    </section>
                    <section>
                        <UserProfile userId={1} />
                    </section>
                </main>
            </div>
        </ThemeProvider>
    );
}

export default App;
```

```css
/* src/App.css */
[data-theme="light"] {
    --bg-color: #ffffff;
    --text-color: #000000;
    --border-color: #ddd;
}

[data-theme="dark"] {
    --bg-color: #1a1a1a;
    --text-color: #ffffff;
    --border-color: #444;
}

.App {
    min-height: 100vh;
    background-color: var(--bg-color);
    color: var(--text-color);
    padding: 20px;
}

header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 2px solid var(--border-color);
}

section {
    margin-bottom: 40px;
    padding: 20px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
}

.counter, .todo-app {
    max-width: 500px;
}

.buttons {
    display: flex;
    gap: 10px;
}

button {
    padding: 8px 16px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}

.todo-input {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.todo-input input {
    flex: 1;
    padding: 8px;
    border: 1px solid var(--border-color);
    border-radius: 4px;
}

.filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.filters button.active {
    background-color: #28a745;
}

.todo-list {
    list-style: none;
    padding: 0;
}

.todo-list li {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    margin: 5px 0;
    background-color: var(--bg-color);
    border: 1px solid var(--border-color);
    border-radius: 4px;
}

.todo-list li.completed span {
    text-decoration: line-through;
    opacity: 0.6;
}

.loading, .error {
    padding: 20px;
    text-align: center;
}

.user-profile {
    max-width: 400px;
}
```

**Expected Output** (in browser):
- Counter with custom hook
- Todo app with useReducer
- Theme toggle with context
- User profile with useFetch
- All working together

**Challenge (Optional)**:
- Create more custom hooks
- Build complex state management
- Practice all hooks together
- Build a complete application

---

## Common Mistakes

### 1. Missing Dependencies

```javascript
// ❌ Bad: Missing dependency
useEffect(() => {
    fetchData(userId);
}, []);  // Missing userId

// ✅ Good: Include dependencies
useEffect(() => {
    fetchData(userId);
}, [userId]);
```

### 2. Infinite Loops

```javascript
// ❌ Bad: Infinite loop
useEffect(() => {
    setCount(count + 1);
}, [count]);  // count changes, triggers effect, changes count again

// ✅ Good: Use functional update
useEffect(() => {
    setCount(prev => prev + 1);
}, []);  // Only run once
```

### 3. Not Cleaning Up

```javascript
// ❌ Bad: No cleanup
useEffect(() => {
    const interval = setInterval(() => {
        // Do something
    }, 1000);
    // Missing cleanup
}, []);

// ✅ Good: Cleanup
useEffect(() => {
    const interval = setInterval(() => {
        // Do something
    }, 1000);
    return () => clearInterval(interval);
}, []);
```

---

## Key Takeaways

1. **useEffect**: Handle side effects
2. **useContext**: Share context across components
3. **useReducer**: Manage complex state logic
4. **Custom Hooks**: Reusable logic
5. **Best Practice**: Clean up effects, include dependencies
6. **Patterns**: Separate concerns, use custom hooks
7. **Rules**: Only call hooks at top level

---

## Quiz: Hooks

Test your understanding with these questions:

1. **useEffect runs:**
   - A) After render
   - B) Before render
   - C) Both
   - D) Neither

2. **useContext:**
   - A) Accesses context
   - B) Creates context
   - C) Both
   - D) Neither

3. **useReducer:**
   - A) Complex state
   - B) Simple state
   - C) Both
   - D) Neither

4. **Custom hooks:**
   - A) Reusable logic
   - B) Component logic
   - C) Both
   - D) Neither

5. **Cleanup function:**
   - A) Required
   - B) Optional
   - C) Both
   - D) Neither

6. **Dependency array:**
   - A) Controls when effect runs
   - B) Doesn''t matter
   - C) Both
   - D) Neither

7. **Hooks can be called:**
   - A) Top level only
   - B) Anywhere
   - C) Both
   - D) Neither

**Answers**:
1. A) After render
2. A) Accesses context
3. A) Complex state
4. A) Reusable logic
5. B) Optional (but recommended)
6. A) Controls when effect runs
7. A) Top level only

---

## Next Steps

Congratulations! You''ve learned React hooks. You now know:
- How to use useEffect
- How to use useContext
- How to use useReducer
- How to create custom hooks

**What''s Next?**
- Lesson 26.2: React Router
- Learn routing in React
- Set up React Router
- Handle navigation

---

## Additional Resources

- **React Hooks**: [react.dev/reference/react](https://react.dev/reference/react)
- **useEffect**: [react.dev/reference/react/useEffect](https://react.dev/reference/react/useEffect)
- **useContext**: [react.dev/reference/react/useContext](https://react.dev/reference/react/useContext)
- **useReducer**: [react.dev/reference/react/useReducer](https://react.dev/reference/react/useReducer)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use useEffect hook
- Use useContext hook
- Use useReducer hook
- Create custom hooks
- Manage side effects
- Share context across components
- Handle complex state logic
- Build reusable hook logic');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (178, 66, 16, 'React Router', 'react-router', '# Lesson 26.2: React Router

## Learning Objectives

By the end of this lesson, you will be able to:
- Set up React Router
- Create routes and navigation
- Handle route parameters
- Work with nested routes
- Build single-page applications
- Implement navigation
- Handle protected routes

---

## Introduction to React Router

React Router is a library for routing in React applications. It enables navigation without page refreshes.

### What is React Router?

- **Client-Side Routing**: Navigation without page reload
- **Single-Page Application**: One HTML page, multiple views
- **URL-Based Navigation**: URLs reflect current view
- **History API**: Uses browser history API

### Installation

```bash
# Install React Router
npm install react-router-dom
```

---

## Setting Up React Router

### Basic Setup

```javascript
// src/main.jsx or src/index.js
import React from ''react'';
import ReactDOM from ''react-dom/client'';
import { BrowserRouter } from ''react-router-dom'';
import App from ''./App'';

ReactDOM.createRoot(document.getElementById(''root'')).render(
    <React.StrictMode>
        <BrowserRouter>
            <App />
        </BrowserRouter>
    </React.StrictMode>
);
```

### Router Types

```javascript
// BrowserRouter: Uses HTML5 history API (recommended)
import { BrowserRouter } from ''react-router-dom'';

// HashRouter: Uses hash in URL (#)
import { HashRouter } from ''react-router-dom'';

// MemoryRouter: Keeps history in memory (testing)
import { MemoryRouter } from ''react-router-dom'';
```

---

## Routes and Navigation

### Basic Routes

```javascript
import { Routes, Route } from ''react-router-dom'';

function App() {
    return (
        <Routes>
            <Route path="/" element={<Home />} />
            <Route path="/about" element={<About />} />
            <Route path="/contact" element={<Contact />} />
        </Routes>
    );
}
```

### Navigation with Link

```javascript
import { Link } from ''react-router-dom'';

function Navigation() {
    return (
        <nav>
            <Link to="/">Home</Link>
            <Link to="/about">About</Link>
            <Link to="/contact">Contact</Link>
        </nav>
    );
}
```

### Navigation with useNavigate

```javascript
import { useNavigate } from ''react-router-dom'';

function Button() {
    const navigate = useNavigate();
    
    const handleClick = () => {
        navigate(''/about'');
    };
    
    return <button onClick={handleClick}>Go to About</button>;
}
```

### Complete Example

```javascript
// src/App.jsx
import { Routes, Route } from ''react-router-dom'';
import Navigation from ''./components/Navigation'';
import Home from ''./pages/Home'';
import About from ''./pages/About'';
import Contact from ''./pages/Contact'';

function App() {
    return (
        <div>
            <Navigation />
            <Routes>
                <Route path="/" element={<Home />} />
                <Route path="/about" element={<About />} />
                <Route path="/contact" element={<Contact />} />
            </Routes>
        </div>
    );
}

export default App;
```

```javascript
// src/components/Navigation.jsx
import { Link } from ''react-router-dom'';

function Navigation() {
    return (
        <nav>
            <Link to="/">Home</Link>
            <Link to="/about">About</Link>
            <Link to="/contact">Contact</Link>
        </nav>
    );
}

export default Navigation;
```

```javascript
// src/pages/Home.jsx
function Home() {
    return <h1>Home Page</h1>;
}

export default Home;
```

---

## Route Parameters

### Dynamic Routes

```javascript
// Route with parameter
<Route path="/user/:id" element={<UserProfile />} />

// Access parameter
import { useParams } from ''react-router-dom'';

function UserProfile() {
    const { id } = useParams();
    return <h1>User ID: {id}</h1>;
}
```

### Multiple Parameters

```javascript
// Multiple parameters
<Route path="/user/:userId/post/:postId" element={<Post />} />

// Access multiple parameters
function Post() {
    const { userId, postId } = useParams();
    return (
        <div>
            <h1>User: {userId}</h1>
            <h2>Post: {postId}</h2>
        </div>
    );
}
```

### Example: User Profile

```javascript
// src/App.jsx
<Route path="/users/:id" element={<UserProfile />} />

// src/pages/UserProfile.jsx
import { useParams } from ''react-router-dom'';

function UserProfile() {
    const { id } = useParams();
    const [user, setUser] = useState(null);
    
    useEffect(() => {
        fetch(`/api/users/${id}`)
            .then(res => res.json())
            .then(data => setUser(data));
    }, [id]);
    
    if (!user) return <div>Loading...</div>;
    
    return (
        <div>
            <h1>{user.name}</h1>
            <p>{user.email}</p>
        </div>
    );
}
```

### Optional Parameters

```javascript
// Optional parameter
<Route path="/blog/:slug?" element={<BlogPost />} />

// Access optional parameter
function BlogPost() {
    const { slug } = useParams();
    return <div>{slug ? `Post: ${slug}` : ''All Posts''}</div>;
}
```

---

## Nested Routes

### Basic Nested Routes

```javascript
// Parent route
<Route path="/dashboard" element={<Dashboard />}>
    <Route path="profile" element={<Profile />} />
    <Route path="settings" element={<Settings />} />
</Route>

// Dashboard component with Outlet
import { Outlet, Link } from ''react-router-dom'';

function Dashboard() {
    return (
        <div>
            <nav>
                <Link to="/dashboard/profile">Profile</Link>
                <Link to="/dashboard/settings">Settings</Link>
            </nav>
            <Outlet />  {/* Renders child routes */}
        </div>
    );
}
```

### Index Routes

```javascript
// Index route (default child)
<Route path="/dashboard" element={<Dashboard />}>
    <Route index element={<DashboardHome />} />
    <Route path="profile" element={<Profile />} />
    <Route path="settings" element={<Settings />} />
</Route>
```

### Example: Dashboard with Nested Routes

```javascript
// src/App.jsx
import { Routes, Route } from ''react-router-dom'';
import Dashboard from ''./pages/Dashboard'';
import DashboardHome from ''./pages/DashboardHome'';
import Profile from ''./pages/Profile'';
import Settings from ''./pages/Settings'';

function App() {
    return (
        <Routes>
            <Route path="/dashboard" element={<Dashboard />}>
                <Route index element={<DashboardHome />} />
                <Route path="profile" element={<Profile />} />
                <Route path="settings" element={<Settings />} />
            </Route>
        </Routes>
    );
}
```

```javascript
// src/pages/Dashboard.jsx
import { Outlet, Link, useLocation } from ''react-router-dom'';

function Dashboard() {
    const location = useLocation();
    
    return (
        <div className="dashboard">
            <aside>
                <nav>
                    <Link 
                        to="/dashboard" 
                        className={location.pathname === ''/dashboard'' ? ''active'' : ''''}
                    >
                        Home
                    </Link>
                    <Link 
                        to="/dashboard/profile"
                        className={location.pathname === ''/dashboard/profile'' ? ''active'' : ''''}
                    >
                        Profile
                    </Link>
                    <Link 
                        to="/dashboard/settings"
                        className={location.pathname === ''/dashboard/settings'' ? ''active'' : ''''}
                    >
                        Settings
                    </Link>
                </nav>
            </aside>
            <main>
                <Outlet />
            </main>
        </div>
    );
}

export default Dashboard;
```

---

## Advanced Routing

### Protected Routes

```javascript
// Protected route component
import { Navigate } from ''react-router-dom'';

function ProtectedRoute({ children }) {
    const isAuthenticated = localStorage.getItem(''user'');
    
    if (!isAuthenticated) {
        return <Navigate to="/login" replace />;
    }
    
    return children;
}

// Usage
<Route 
    path="/dashboard" 
    element={
        <ProtectedRoute>
            <Dashboard />
        </ProtectedRoute>
    }
/>
```

### Redirect

```javascript
import { Navigate } from ''react-router-dom'';

// Redirect route
<Route path="/old" element={<Navigate to="/new" replace />} />

// Conditional redirect
function Home() {
    const isLoggedIn = localStorage.getItem(''user'');
    
    if (isLoggedIn) {
        return <Navigate to="/dashboard" replace />;
    }
    
    return <h1>Home</h1>;
}
```

### 404 Not Found

```javascript
// Catch-all route (must be last)
<Route path="*" element={<NotFound />} />

// NotFound component
function NotFound() {
    return (
        <div>
            <h1>404 - Page Not Found</h1>
            <Link to="/">Go Home</Link>
        </div>
    );
}
```

### Query Parameters

```javascript
import { useSearchParams } from ''react-router-dom'';

function Search() {
    const [searchParams, setSearchParams] = useSearchParams();
    const query = searchParams.get(''q'') || '''';
    
    const handleSearch = (e) => {
        e.preventDefault();
        setSearchParams({ q: e.target.search.value });
    };
    
    return (
        <form onSubmit={handleSearch}>
            <input name="search" defaultValue={query} />
            <button type="submit">Search</button>
        </form>
    );
}
```

---

## Practice Exercise

### Exercise: Routing

**Objective**: Practice setting up React Router, creating routes, handling parameters, and nested routes.

**Instructions**:

1. Create a React project
2. Install React Router
3. Practice:
   - Setting up routes
   - Navigation
   - Route parameters
   - Nested routes
   - Protected routes

**Example Solution**:

```javascript
// src/App.jsx
import { Routes, Route } from ''react-router-dom'';
import Layout from ''./components/Layout'';
import Home from ''./pages/Home'';
import About from ''./pages/About'';
import Contact from ''./pages/Contact'';
import Users from ''./pages/Users'';
import UserProfile from ''./pages/UserProfile'';
import Dashboard from ''./pages/Dashboard'';
import DashboardHome from ''./pages/DashboardHome'';
import Profile from ''./pages/Profile'';
import Settings from ''./pages/Settings'';
import Login from ''./pages/Login'';
import ProtectedRoute from ''./components/ProtectedRoute'';
import NotFound from ''./pages/NotFound'';
import ''./App.css'';

function App() {
    return (
        <Routes>
            <Route path="/" element={<Layout />}>
                <Route index element={<Home />} />
                <Route path="about" element={<About />} />
                <Route path="contact" element={<Contact />} />
                <Route path="users" element={<Users />} />
                <Route path="users/:id" element={<UserProfile />} />
                <Route path="login" element={<Login />} />
                <Route 
                    path="dashboard" 
                    element={
                        <ProtectedRoute>
                            <Dashboard />
                        </ProtectedRoute>
                    }
                >
                    <Route index element={<DashboardHome />} />
                    <Route path="profile" element={<Profile />} />
                    <Route path="settings" element={<Settings />} />
                </Route>
                <Route path="*" element={<NotFound />} />
            </Route>
        </Routes>
    );
}

export default App;
```

```javascript
// src/components/Layout.jsx
import { Outlet, Link, useLocation } from ''react-router-dom'';

function Layout() {
    const location = useLocation();
    
    return (
        <div className="layout">
            <header>
                <h1>My App</h1>
                <nav>
                    <Link 
                        to="/" 
                        className={location.pathname === ''/'' ? ''active'' : ''''}
                    >
                        Home
                    </Link>
                    <Link 
                        to="/about"
                        className={location.pathname === ''/about'' ? ''active'' : ''''}
                    >
                        About
                    </Link>
                    <Link 
                        to="/contact"
                        className={location.pathname === ''/contact'' ? ''active'' : ''''}
                    >
                        Contact
                    </Link>
                    <Link 
                        to="/users"
                        className={location.pathname === ''/users'' ? ''active'' : ''''}
                    >
                        Users
                    </Link>
                    <Link 
                        to="/dashboard"
                        className={location.pathname.startsWith(''/dashboard'') ? ''active'' : ''''}
                    >
                        Dashboard
                    </Link>
                </nav>
            </header>
            <main>
                <Outlet />
            </main>
            <footer>
                <p>&copy; 2024 My App</p>
            </footer>
        </div>
    );
}

export default Layout;
```

```javascript
// src/components/ProtectedRoute.jsx
import { Navigate } from ''react-router-dom'';

function ProtectedRoute({ children }) {
    const isAuthenticated = localStorage.getItem(''user'');
    
    if (!isAuthenticated) {
        return <Navigate to="/login" replace />;
    }
    
    return children;
}

export default ProtectedRoute;
```

```javascript
// src/pages/Home.jsx
function Home() {
    return (
        <div className="page">
            <h1>Home</h1>
            <p>Welcome to the home page!</p>
        </div>
    );
}

export default Home;
```

```javascript
// src/pages/Users.jsx
import { Link } from ''react-router-dom'';

function Users() {
    const users = [
        { id: 1, name: ''Alice'', email: ''alice@example.com'' },
        { id: 2, name: ''Bob'', email: ''bob@example.com'' },
        { id: 3, name: ''Charlie'', email: ''charlie@example.com'' }
    ];
    
    return (
        <div className="page">
            <h1>Users</h1>
            <ul className="user-list">
                {users.map(user => (
                    <li key={user.id}>
                        <Link to={`/users/${user.id}`}>
                            {user.name} - {user.email}
                        </Link>
                    </li>
                ))}
            </ul>
        </div>
    );
}

export default Users;
```

```javascript
// src/pages/UserProfile.jsx
import { useParams, Link, useNavigate } from ''react-router-dom'';

function UserProfile() {
    const { id } = useParams();
    const navigate = useNavigate();
    
    const users = {
        1: { id: 1, name: ''Alice'', email: ''alice@example.com'', bio: ''Developer'' },
        2: { id: 2, name: ''Bob'', email: ''bob@example.com'', bio: ''Designer'' },
        3: { id: 3, name: ''Charlie'', email: ''charlie@example.com'', bio: ''Manager'' }
    };
    
    const user = users[id];
    
    if (!user) {
        return (
            <div className="page">
                <h1>User Not Found</h1>
                <Link to="/users">Back to Users</Link>
            </div>
        );
    }
    
    return (
        <div className="page">
            <button onClick={() => navigate(-1)}>Back</button>
            <h1>{user.name}</h1>
            <p><strong>Email:</strong> {user.email}</p>
            <p><strong>Bio:</strong> {user.bio}</p>
            <Link to="/users">Back to Users</Link>
        </div>
    );
}

export default UserProfile;
```

```javascript
// src/pages/Dashboard.jsx
import { Outlet, Link, useLocation } from ''react-router-dom'';

function Dashboard() {
    const location = useLocation();
    
    return (
        <div className="dashboard">
            <aside className="sidebar">
                <h2>Dashboard</h2>
                <nav>
                    <Link 
                        to="/dashboard"
                        className={location.pathname === ''/dashboard'' ? ''active'' : ''''}
                    >
                        Home
                    </Link>
                    <Link 
                        to="/dashboard/profile"
                        className={location.pathname === ''/dashboard/profile'' ? ''active'' : ''''}
                    >
                        Profile
                    </Link>
                    <Link 
                        to="/dashboard/settings"
                        className={location.pathname === ''/dashboard/settings'' ? ''active'' : ''''}
                    >
                        Settings
                    </Link>
                </nav>
            </aside>
            <main className="dashboard-content">
                <Outlet />
            </main>
        </div>
    );
}

export default Dashboard;
```

```javascript
// src/pages/DashboardHome.jsx
function DashboardHome() {
    return (
        <div>
            <h1>Dashboard Home</h1>
            <p>Welcome to your dashboard!</p>
        </div>
    );
}

export default DashboardHome;
```

```javascript
// src/pages/Login.jsx
import { useNavigate } from ''react-router-dom'';

function Login() {
    const navigate = useNavigate();
    
    const handleLogin = (e) => {
        e.preventDefault();
        localStorage.setItem(''user'', JSON.stringify({ name: ''User'', id: 1 }));
        navigate(''/dashboard'');
    };
    
    return (
        <div className="page">
            <h1>Login</h1>
            <form onSubmit={handleLogin}>
                <input type="text" placeholder="Username" required />
                <input type="password" placeholder="Password" required />
                <button type="submit">Login</button>
            </form>
        </div>
    );
}

export default Login;
```

```javascript
// src/pages/NotFound.jsx
import { Link } from ''react-router-dom'';

function NotFound() {
    return (
        <div className="page">
            <h1>404 - Page Not Found</h1>
            <p>The page you''re looking for doesn''t exist.</p>
            <Link to="/">Go Home</Link>
        </div>
    );
}

export default NotFound;
```

```css
/* src/App.css */
.layout {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

header {
    background-color: #282c34;
    color: white;
    padding: 20px;
}

header nav {
    display: flex;
    gap: 20px;
    margin-top: 10px;
}

header nav a {
    color: white;
    text-decoration: none;
    padding: 5px 10px;
    border-radius: 4px;
}

header nav a:hover,
header nav a.active {
    background-color: #61dafb;
    color: #282c34;
}

main {
    flex: 1;
    padding: 20px;
    max-width: 1200px;
    margin: 0 auto;
    width: 100%;
}

footer {
    background-color: #282c34;
    color: white;
    padding: 10px;
    text-align: center;
}

.page {
    padding: 20px;
}

.user-list {
    list-style: none;
    padding: 0;
}

.user-list li {
    padding: 10px;
    margin: 5px 0;
    background-color: #f5f5f5;
    border-radius: 4px;
}

.user-list a {
    text-decoration: none;
    color: #007bff;
}

.user-list a:hover {
    text-decoration: underline;
}

.dashboard {
    display: flex;
    min-height: calc(100vh - 200px);
}

.sidebar {
    width: 200px;
    background-color: #f5f5f5;
    padding: 20px;
}

.sidebar nav {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.sidebar nav a {
    padding: 10px;
    text-decoration: none;
    color: #333;
    border-radius: 4px;
}

.sidebar nav a:hover,
.sidebar nav a.active {
    background-color: #007bff;
    color: white;
}

.dashboard-content {
    flex: 1;
    padding: 20px;
}

form {
    display: flex;
    flex-direction: column;
    gap: 10px;
    max-width: 300px;
}

form input {
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

form button {
    padding: 10px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
```

**Expected Output** (in browser):
- Navigation between pages
- User profiles with dynamic routes
- Protected dashboard
- Nested routes in dashboard
- 404 page for unknown routes

**Challenge (Optional)**:
- Build a complete SPA
- Add more routes
- Implement search with query params
- Add breadcrumbs

---

## Common Mistakes

### 1. Forgetting BrowserRouter

```javascript
// ❌ Bad: Missing BrowserRouter
function App() {
    return <Routes>...</Routes>;
}

// ✅ Good: Wrap with BrowserRouter
<BrowserRouter>
    <App />
</BrowserRouter>
```

### 2. Wrong Route Path

```javascript
// ❌ Bad: Absolute path in nested route
<Route path="/dashboard/profile" element={<Profile />} />

// ✅ Good: Relative path
<Route path="profile" element={<Profile />} />
```

### 3. Missing Outlet

```javascript
// ❌ Bad: No Outlet for nested routes
function Dashboard() {
    return <div>Dashboard</div>;
}

// ✅ Good: Include Outlet
function Dashboard() {
    return (
        <div>
            <nav>...</nav>
            <Outlet />
        </div>
    );
}
```

---

## Key Takeaways

1. **React Router**: Client-side routing library
2. **Routes**: Define application routes
3. **Navigation**: Link and useNavigate
4. **Parameters**: Dynamic route parameters
5. **Nested Routes**: Hierarchical routing
6. **Protected Routes**: Authentication-based routing
7. **Best Practice**: Use BrowserRouter, include Outlet, handle 404

---

## Quiz: React Router

Test your understanding with these questions:

1. **React Router:**
   - A) Client-side routing
   - B) Server-side routing
   - C) Both
   - D) Neither

2. **Routes defined:**
   - A) In Routes component
   - B) In Router component
   - C) Both
   - D) Neither

3. **Route parameters:**
   - A) Dynamic values
   - B) Static values
   - C) Both
   - D) Neither

4. **Nested routes:**
   - A) Child routes
   - B) Parent routes
   - C) Both
   - D) Neither

5. **Outlet:**
   - A) Renders child routes
   - B) Renders parent routes
   - C) Both
   - D) Neither

6. **Protected routes:**
   - A) Require authentication
   - B) Public routes
   - C) Both
   - D) Neither

7. **404 route:**
   - A) Catch-all route
   - B) Specific route
   - C) Both
   - D) Neither

**Answers**:
1. A) Client-side routing
2. A) In Routes component
3. A) Dynamic values
4. C) Both (child routes within parent)
5. A) Renders child routes
6. A) Require authentication
7. A) Catch-all route

---

## Next Steps

Congratulations! You''ve learned React Router. You now know:
- How to set up React Router
- How to create routes
- How to handle navigation
- How to work with nested routes

**What''s Next?**
- Lesson 26.3: State Management
- Learn Context API
- Learn Redux basics
- Understand state management patterns

---

## Additional Resources

- **React Router**: [reactrouter.com](https://reactrouter.com)
- **Getting Started**: [reactrouter.com/en/main/start/overview](https://reactrouter.com/en/main/start/overview)
- **API Reference**: [reactrouter.com/en/main/route/route](https://reactrouter.com/en/main/route/route)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Set up React Router
- Create routes and navigation
- Handle route parameters
- Work with nested routes
- Build single-page applications
- Implement navigation
- Handle protected routes');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (179, 66, 16, 'State Management', 'state-management', '# Lesson 26.3: State Management

## Learning Objectives

By the end of this lesson, you will be able to:
- Use Context API for state management
- Understand Redux basics
- Apply state management patterns
- Choose appropriate state management solution
- Manage global state
- Handle complex state logic
- Build scalable applications

---

## Introduction to State Management

State management is about how you store, organize, and update application state.

### When to Use State Management?

- **Local State**: Component-specific (useState)
- **Shared State**: Multiple components (Context API, Redux)
- **Global State**: App-wide state (Context API, Redux)
- **Complex State**: Complex logic (Redux, Zustand)

### State Management Solutions

```javascript
// Built-in
useState        // Local state
useContext      // Shared state
useReducer      // Complex local state

// Libraries
Redux           // Predictable state container
Zustand         // Lightweight state management
Jotai           // Atomic state management
Recoil          // Facebook''s state management
```

---

## Context API

### What is Context API?

Context API is React''s built-in solution for sharing state across components.

### Basic Context

```javascript
import { createContext, useContext, useState } from ''react'';

// Create context
const ThemeContext = createContext();

// Provider component
export function ThemeProvider({ children }) {
    const [theme, setTheme] = useState(''light'');
    
    return (
        <ThemeContext.Provider value={{ theme, setTheme }}>
            {children}
        </ThemeContext.Provider>
    );
}

// Custom hook
export function useTheme() {
    const context = useContext(ThemeContext);
    if (!context) {
        throw new Error(''useTheme must be used within ThemeProvider'');
    }
    return context;
}
```

### Multiple Contexts

```javascript
// Theme context
const ThemeContext = createContext();

// User context
const UserContext = createContext();

function App() {
    return (
        <ThemeProvider>
            <UserProvider>
                <Component />
            </UserProvider>
        </ThemeProvider>
    );
}
```

### Context with useReducer

```javascript
import { createContext, useContext, useReducer } from ''react'';

// Initial state
const initialState = {
    count: 0,
    todos: []
};

// Reducer
function appReducer(state, action) {
    switch (action.type) {
        case ''INCREMENT'':
            return { ...state, count: state.count + 1 };
        case ''ADD_TODO'':
            return {
                ...state,
                todos: [...state.todos, action.payload]
            };
        default:
            return state;
    }
}

// Context
const AppContext = createContext();

// Provider
export function AppProvider({ children }) {
    const [state, dispatch] = useReducer(appReducer, initialState);
    
    return (
        <AppContext.Provider value={{ state, dispatch }}>
            {children}
        </AppContext.Provider>
    );
}

// Hook
export function useApp() {
    const context = useContext(AppContext);
    if (!context) {
        throw new Error(''useApp must be used within AppProvider'');
    }
    return context;
}
```

### Example: Shopping Cart

```javascript
// src/contexts/CartContext.jsx
import { createContext, useContext, useReducer } from ''react'';

const CartContext = createContext();

const cartReducer = (state, action) => {
    switch (action.type) {
        case ''ADD_ITEM'':
            const existingItem = state.items.find(
                item => item.id === action.payload.id
            );
            if (existingItem) {
                return {
                    ...state,
                    items: state.items.map(item =>
                        item.id === action.payload.id
                            ? { ...item, quantity: item.quantity + 1 }
                            : item
                    )
                };
            }
            return {
                ...state,
                items: [...state.items, { ...action.payload, quantity: 1 }]
            };
        case ''REMOVE_ITEM'':
            return {
                ...state,
                items: state.items.filter(item => item.id !== action.payload)
            };
        case ''UPDATE_QUANTITY'':
            return {
                ...state,
                items: state.items.map(item =>
                    item.id === action.payload.id
                        ? { ...item, quantity: action.payload.quantity }
                        : item
                )
            };
        case ''CLEAR_CART'':
            return { ...state, items: [] };
        default:
            return state;
    }
};

export function CartProvider({ children }) {
    const [state, dispatch] = useReducer(cartReducer, { items: [] });
    
    const addItem = (item) => {
        dispatch({ type: ''ADD_ITEM'', payload: item });
    };
    
    const removeItem = (id) => {
        dispatch({ type: ''REMOVE_ITEM'', payload: id });
    };
    
    const updateQuantity = (id, quantity) => {
        dispatch({ type: ''UPDATE_QUANTITY'', payload: { id, quantity } });
    };
    
    const clearCart = () => {
        dispatch({ type: ''CLEAR_CART'' });
    };
    
    const total = state.items.reduce(
        (sum, item) => sum + item.price * item.quantity,
        0
    );
    
    return (
        <CartContext.Provider
            value={{
                items: state.items,
                total,
                addItem,
                removeItem,
                updateQuantity,
                clearCart
            }}
        >
            {children}
        </CartContext.Provider>
    );
}

export function useCart() {
    const context = useContext(CartContext);
    if (!context) {
        throw new Error(''useCart must be used within CartProvider'');
    }
    return context;
}
```

---

## Redux Basics

### What is Redux?

Redux is a predictable state container for JavaScript apps.

### Redux Principles

1. **Single Source of Truth**: One store
2. **State is Read-Only**: Only actions change state
3. **Changes with Pure Functions**: Reducers are pure

### Installation

```bash
# Install Redux
npm install @reduxjs/toolkit react-redux
```

### Basic Redux Setup

```javascript
// src/store/store.js
import { configureStore } from ''@reduxjs/toolkit'';
import counterReducer from ''./counterSlice'';

export const store = configureStore({
    reducer: {
        counter: counterReducer
    }
});
```

```javascript
// src/store/counterSlice.js
import { createSlice } from ''@reduxjs/toolkit'';

const initialState = {
    value: 0
};

const counterSlice = createSlice({
    name: ''counter'',
    initialState,
    reducers: {
        increment: (state) => {
            state.value += 1;
        },
        decrement: (state) => {
            state.value -= 1;
        },
        incrementByAmount: (state, action) => {
            state.value += action.payload;
        }
    }
});

export const { increment, decrement, incrementByAmount } = counterSlice.actions;
export default counterSlice.reducer;
```

```javascript
// src/main.jsx
import { Provider } from ''react-redux'';
import { store } from ''./store/store'';
import App from ''./App'';

ReactDOM.createRoot(document.getElementById(''root'')).render(
    <Provider store={store}>
        <App />
    </Provider>
);
```

### Using Redux

```javascript
// src/components/Counter.jsx
import { useSelector, useDispatch } from ''react-redux'';
import { increment, decrement, incrementByAmount } from ''../store/counterSlice'';

function Counter() {
    const count = useSelector((state) => state.counter.value);
    const dispatch = useDispatch();
    
    return (
        <div>
            <p>Count: {count}</p>
            <button onClick={() => dispatch(increment())}>+</button>
            <button onClick={() => dispatch(decrement())}>-</button>
            <button onClick={() => dispatch(incrementByAmount(5))}>
                +5
            </button>
        </div>
    );
}
```

### Redux with Async Actions

```javascript
// src/store/todosSlice.js
import { createSlice, createAsyncThunk } from ''@reduxjs/toolkit'';

// Async thunk
export const fetchTodos = createAsyncThunk(
    ''todos/fetchTodos'',
    async () => {
        const response = await fetch(''/api/todos'');
        return response.json();
    }
);

const todosSlice = createSlice({
    name: ''todos'',
    initialState: {
        items: [],
        loading: false,
        error: null
    },
    reducers: {
        addTodo: (state, action) => {
            state.items.push(action.payload);
        },
        removeTodo: (state, action) => {
            state.items = state.items.filter(item => item.id !== action.payload);
        }
    },
    extraReducers: (builder) => {
        builder
            .addCase(fetchTodos.pending, (state) => {
                state.loading = true;
            })
            .addCase(fetchTodos.fulfilled, (state, action) => {
                state.loading = false;
                state.items = action.payload;
            })
            .addCase(fetchTodos.rejected, (state, action) => {
                state.loading = false;
                state.error = action.error.message;
            });
    }
});

export const { addTodo, removeTodo } = todosSlice.actions;
export default todosSlice.reducer;
```

---

## State Management Patterns

### Pattern 1: Local State

```javascript
// Use for component-specific state
function Component() {
    const [count, setCount] = useState(0);
    // ...
}
```

### Pattern 2: Lifted State

```javascript
// Lift state to common ancestor
function Parent() {
    const [state, setState] = useState(initialState);
    return (
        <>
            <Child1 state={state} setState={setState} />
            <Child2 state={state} setState={setState} />
        </>
    );
}
```

### Pattern 3: Context API

```javascript
// Use for shared state across components
const Context = createContext();

function Provider({ children }) {
    const [state, setState] = useState(initialState);
    return (
        <Context.Provider value={{ state, setState }}>
            {children}
        </Context.Provider>
    );
}
```

### Pattern 4: Redux

```javascript
// Use for complex global state
const store = configureStore({
    reducer: {
        // Reducers
    }
});
```

### Pattern 5: Custom Hooks

```javascript
// Encapsulate state logic
function useCustomState() {
    const [state, setState] = useState(initialState);
    // Logic
    return { state, actions };
}
```

---

## Practice Exercise

### Exercise: State Management

**Objective**: Practice using Context API, Redux basics, and applying state management patterns.

**Instructions**:

1. Create a React project
2. Practice state management
3. Practice:
   - Context API
   - Redux setup
   - State management patterns
   - Choosing the right solution

**Example Solution**:

```javascript
// src/contexts/AuthContext.jsx
import { createContext, useContext, useState, useEffect } from ''react'';

const AuthContext = createContext();

export function AuthProvider({ children }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    
    useEffect(() => {
        const savedUser = localStorage.getItem(''user'');
        if (savedUser) {
            setUser(JSON.parse(savedUser));
        }
        setLoading(false);
    }, []);
    
    const login = (userData) => {
        setUser(userData);
        localStorage.setItem(''user'', JSON.stringify(userData));
    };
    
    const logout = () => {
        setUser(null);
        localStorage.removeItem(''user'');
    };
    
    return (
        <AuthContext.Provider value={{ user, login, logout, loading }}>
            {children}
        </AuthContext.Provider>
    );
}

export function useAuth() {
    const context = useContext(AuthContext);
    if (!context) {
        throw new Error(''useAuth must be used within AuthProvider'');
    }
    return context;
}
```

```javascript
// src/store/store.js
import { configureStore } from ''@reduxjs/toolkit'';
import todosReducer from ''./todosSlice'';
import counterReducer from ''./counterSlice'';

export const store = configureStore({
    reducer: {
        todos: todosReducer,
        counter: counterReducer
    }
});
```

```javascript
// src/store/todosSlice.js
import { createSlice } from ''@reduxjs/toolkit'';

const initialState = {
    items: [],
    filter: ''all''
};

const todosSlice = createSlice({
    name: ''todos'',
    initialState,
    reducers: {
        addTodo: (state, action) => {
            state.items.push({
                id: Date.now(),
                text: action.payload,
                completed: false
            });
        },
        toggleTodo: (state, action) => {
            const todo = state.items.find(item => item.id === action.payload);
            if (todo) {
                todo.completed = !todo.completed;
            }
        },
        removeTodo: (state, action) => {
            state.items = state.items.filter(item => item.id !== action.payload);
        },
        setFilter: (state, action) => {
            state.filter = action.payload;
        }
    }
});

export const { addTodo, toggleTodo, removeTodo, setFilter } = todosSlice.actions;
export default todosSlice.reducer;
```

```javascript
// src/store/counterSlice.js
import { createSlice } from ''@reduxjs/toolkit'';

const initialState = {
    value: 0
};

const counterSlice = createSlice({
    name: ''counter'',
    initialState,
    reducers: {
        increment: (state) => {
            state.value += 1;
        },
        decrement: (state) => {
            state.value -= 1;
        },
        reset: (state) => {
            state.value = 0;
        }
    }
});

export const { increment, decrement, reset } = counterSlice.actions;
export default counterSlice.reducer;
```

```javascript
// src/components/TodoList.jsx
import { useSelector, useDispatch } from ''react-redux'';
import { addTodo, toggleTodo, removeTodo, setFilter } from ''../store/todosSlice'';
import { useState } from ''react'';

function TodoList() {
    const todos = useSelector((state) => state.todos.items);
    const filter = useSelector((state) => state.todos.filter);
    const dispatch = useDispatch();
    const [input, setInput] = useState('''');
    
    const filteredTodos = todos.filter(todo => {
        if (filter === ''active'') return !todo.completed;
        if (filter === ''completed'') return todo.completed;
        return true;
    });
    
    const handleAdd = () => {
        if (input.trim()) {
            dispatch(addTodo(input));
            setInput('''');
        }
    };
    
    return (
        <div className="todo-list">
            <h2>Todo List (Redux)</h2>
            <div className="todo-input">
                <input
                    value={input}
                    onChange={(e) => setInput(e.target.value)}
                    onKeyPress={(e) => e.key === ''Enter'' && handleAdd()}
                    placeholder="Add todo..."
                />
                <button onClick={handleAdd}>Add</button>
            </div>
            <div className="filters">
                <button
                    className={filter === ''all'' ? ''active'' : ''''}
                    onClick={() => dispatch(setFilter(''all''))}
                >
                    All
                </button>
                <button
                    className={filter === ''active'' ? ''active'' : ''''}
                    onClick={() => dispatch(setFilter(''active''))}
                >
                    Active
                </button>
                <button
                    className={filter === ''completed'' ? ''active'' : ''''}
                    onClick={() => dispatch(setFilter(''completed''))}
                >
                    Completed
                </button>
            </div>
            <ul>
                {filteredTodos.map(todo => (
                    <li key={todo.id} className={todo.completed ? ''completed'' : ''''}>
                        <input
                            type="checkbox"
                            checked={todo.completed}
                            onChange={() => dispatch(toggleTodo(todo.id))}
                        />
                        <span>{todo.text}</span>
                        <button onClick={() => dispatch(removeTodo(todo.id))}>
                            Delete
                        </button>
                    </li>
                ))}
            </ul>
        </div>
    );
}

export default TodoList;
```

```javascript
// src/components/Counter.jsx
import { useSelector, useDispatch } from ''react-redux'';
import { increment, decrement, reset } from ''../store/counterSlice'';

function Counter() {
    const count = useSelector((state) => state.counter.value);
    const dispatch = useDispatch();
    
    return (
        <div className="counter">
            <h2>Counter (Redux)</h2>
            <p>Count: {count}</p>
            <div className="buttons">
                <button onClick={() => dispatch(decrement())}>-</button>
                <button onClick={() => dispatch(reset())}>Reset</button>
                <button onClick={() => dispatch(increment())}>+</button>
            </div>
        </div>
    );
}

export default Counter;
```

```javascript
// src/components/UserProfile.jsx
import { useAuth } from ''../contexts/AuthContext'';

function UserProfile() {
    const { user, logout } = useAuth();
    
    if (!user) {
        return <p>Please log in</p>;
    }
    
    return (
        <div className="user-profile">
            <h2>User Profile (Context)</h2>
            <p>Name: {user.name}</p>
            <p>Email: {user.email}</p>
            <button onClick={logout}>Logout</button>
        </div>
    );
}

export default UserProfile;
```

```javascript
// src/App.jsx
import { Provider } from ''react-redux'';
import { store } from ''./store/store'';
import { AuthProvider } from ''./contexts/AuthContext'';
import Counter from ''./components/Counter'';
import TodoList from ''./components/TodoList'';
import UserProfile from ''./components/UserProfile'';
import ''./App.css'';

function App() {
    return (
        <Provider store={store}>
            <AuthProvider>
                <div className="App">
                    <header>
                        <h1>State Management Examples</h1>
                    </header>
                    <main>
                        <section>
                            <Counter />
                        </section>
                        <section>
                            <TodoList />
                        </section>
                        <section>
                            <UserProfile />
                        </section>
                    </main>
                </div>
            </AuthProvider>
        </Provider>
    );
}

export default App;
```

```css
/* src/App.css */
.App {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 30px;
}

section {
    margin-bottom: 40px;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
}

.counter, .todo-list {
    max-width: 500px;
}

.buttons {
    display: flex;
    gap: 10px;
}

button {
    padding: 8px 16px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}

button.active {
    background-color: #28a745;
}

.todo-input {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.todo-input input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

ul {
    list-style: none;
    padding: 0;
}

li {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    margin: 5px 0;
    background-color: #f5f5f5;
    border-radius: 4px;
}

li.completed span {
    text-decoration: line-through;
    opacity: 0.6;
}
```

**Expected Output** (in browser):
- Counter using Redux
- Todo list using Redux
- User profile using Context API
- All working together

**Challenge (Optional)**:
- Build complex state management
- Combine Context and Redux
- Add async actions
- Build a complete app

---

## Common Mistakes

### 1. Overusing Redux

```javascript
// ❌ Bad: Redux for simple local state
const [count, setCount] = useState(0);  // Should use useState

// ✅ Good: Redux for global/complex state
// Use Redux for shared state across many components
```

### 2. Not Splitting Contexts

```javascript
// ❌ Bad: One context for everything
const AppContext = createContext();

// ✅ Good: Split contexts by concern
const ThemeContext = createContext();
const UserContext = createContext();
```

### 3. Mutating State in Redux

```javascript
// ❌ Bad: Direct mutation (old Redux)
state.items.push(newItem);

// ✅ Good: Immutable updates (Redux Toolkit)
state.items.push(newItem);  // OK with Redux Toolkit
// Or
state.items = [...state.items, newItem];
```

---

## Key Takeaways

1. **Context API**: Built-in solution for shared state
2. **Redux**: Predictable state container
3. **Patterns**: Choose right solution for use case
4. **Local State**: useState for component-specific
5. **Shared State**: Context API for shared
6. **Global State**: Redux for complex global state
7. **Best Practice**: Don''t overuse, split by concern

---

## Quiz: State Management

Test your understanding with these questions:

1. **Context API:**
   - A) Built-in React
   - B) External library
   - C) Both
   - D) Neither

2. **Redux:**
   - A) Predictable state
   - B) Unpredictable state
   - C) Both
   - D) Neither

3. **useState:**
   - A) Local state
   - B) Global state
   - C) Both
   - D) Neither

4. **Context API:**
   - A) Shared state
   - B) Local state
   - C) Both
   - D) Neither

5. **Redux:**
   - A) Complex state
   - B) Simple state
   - C) Both
   - D) Neither

6. **State management:**
   - A) Choose by use case
   - B) Always use Redux
   - C) Both
   - D) Neither

7. **Redux Toolkit:**
   - A) Modern Redux
   - B) Old Redux
   - C) Both
   - D) Neither

**Answers**:
1. A) Built-in React
2. A) Predictable state
3. A) Local state
4. A) Shared state
5. A) Complex state
6. A) Choose by use case
7. A) Modern Redux

---

## Next Steps

Congratulations! You''ve completed Module 26: React Advanced. You now know:
- React hooks (useEffect, useContext, useReducer)
- React Router
- State management (Context API, Redux)
- How to build advanced React applications

**What''s Next?**
- Module 27: Vue.js (Alternative Framework)
- Learn Vue.js basics
- Compare with React
- Build Vue applications

---

## Additional Resources

- **Context API**: [react.dev/reference/react/useContext](https://react.dev/reference/react/useContext)
- **Redux**: [redux.js.org](https://redux.js.org)
- **Redux Toolkit**: [redux-toolkit.js.org](https://redux-toolkit.js.org)
- **State Management Guide**: [react.dev/learn/managing-state](https://react.dev/learn/managing-state)

---

*Lesson completed! You''ve finished Module 26: React Advanced. Ready for Module 27: Vue.js!*

', NULL, 3, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use Context API for state management
- Understand Redux basics
- Apply state management patterns
- Choose appropriate state management solution
- Manage global state
- Handle complex state logic
- Build scalable applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (180, 67, 16, 'Vue.js Introduction', 'vuejs-introduction', '# Lesson 27.1: Vue.js Basics

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what Vue.js is
- Create Vue instances
- Work with templates and directives
- Use data binding
- Build your first Vue app
- Understand Vue.js fundamentals
- Create reactive applications

---

## Introduction to Vue.js

Vue.js is a progressive JavaScript framework for building user interfaces.

### What is Vue.js?

- **Progressive Framework**: Can be adopted incrementally
- **Reactive**: Automatic reactivity system
- **Component-Based**: Build with reusable components
- **Template Syntax**: HTML-based templates
- **Easy to Learn**: Gentle learning curve
- **Versatile**: Can be used for small or large applications

### Why Vue.js?

- **Simple**: Easy to understand
- **Flexible**: Can be used in many ways
- **Performant**: Fast and efficient
- **Developer Experience**: Great tooling
- **Growing**: Popular and well-maintained
- **Documentation**: Excellent documentation

---

## Vue.js Introduction

### Installation

```bash
# Using CDN
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

# Using npm
npm create vue@latest my-app
cd my-app
npm install
npm run dev

# Using Vite
npm create vite@latest my-vue-app -- --template vue
cd my-vue-app
npm install
npm run dev
```

### Vue Versions

```javascript
// Vue 2 (Legacy)
Vue 2.x

// Vue 3 (Current)
Vue 3.x
// - Composition API
// - Better performance
// - Better TypeScript support
```

---

## Vue Instance

### Creating a Vue Instance

```javascript
// Vue 3 - Using createApp
import { createApp } from ''vue'';

const app = createApp({
    data() {
        return {
            message: ''Hello Vue!''
        };
    }
});

app.mount(''#app'');
```

### Basic Vue App

```html
<!-- index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Vue App</title>
</head>
<body>
    <div id="app">
        <h1>{{ message }}</h1>
    </div>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    message: ''Hello Vue!''
                };
            }
        }).mount(''#app'');
    </script>
</body>
</html>
```

### Vue Instance Options

```javascript
const app = createApp({
    // Data
    data() {
        return {
            message: ''Hello'',
            count: 0
        };
    },
    
    // Methods
    methods: {
        increment() {
            this.count++;
        }
    },
    
    // Computed properties
    computed: {
        doubleCount() {
            return this.count * 2;
        }
    },
    
    // Lifecycle hooks
    mounted() {
        console.log(''Component mounted'');
    }
});
```

---

## Templates and Directives

### Template Syntax

```html
<!-- Interpolation -->
<div>{{ message }}</div>

<!-- Text interpolation -->
<span>Message: {{ message }}</span>

<!-- HTML interpolation (v-html) -->
<div v-html="htmlContent"></div>
```

### Directives

Directives are special attributes with the `v-` prefix.

### v-bind (Binding Attributes)

```html
<!-- v-bind -->
<div v-bind:id="dynamicId"></div>

<!-- Shorthand -->
<div :id="dynamicId"></div>

<!-- Binding classes -->
<div :class="{ active: isActive }"></div>
<div :class="[classA, classB]"></div>

<!-- Binding styles -->
<div :style="{ color: activeColor }"></div>
<div :style="[styleObject, styleObject2]"></div>
```

### v-if, v-else-if, v-else (Conditional Rendering)

```html
<!-- Conditional rendering -->
<div v-if="isVisible">Visible</div>
<div v-else-if="isHidden">Hidden</div>
<div v-else>Default</div>

<!-- v-show (toggles display) -->
<div v-show="isVisible">Toggle visibility</div>
```

### v-for (Lists)

```html
<!-- List rendering -->
<ul>
    <li v-for="item in items" :key="item.id">
        {{ item.name }}
    </li>
</ul>

<!-- With index -->
<ul>
    <li v-for="(item, index) in items" :key="item.id">
        {{ index }}: {{ item.name }}
    </li>
</ul>

<!-- Object iteration -->
<ul>
    <li v-for="(value, key) in object" :key="key">
        {{ key }}: {{ value }}
    </li>
</ul>
```

### v-on (Event Handling)

```html
<!-- Event handling -->
<button v-on:click="handleClick">Click me</button>

<!-- Shorthand -->
<button @click="handleClick">Click me</button>

<!-- With parameters -->
<button @click="handleClick(''param'')">Click</button>

<!-- Event modifiers -->
<button @click.stop="handleClick">Stop propagation</button>
<button @click.prevent="handleSubmit">Prevent default</button>
<button @click.once="handleClick">Once only</button>
```

### v-model (Two-Way Binding)

```html
<!-- Two-way binding -->
<input v-model="message" />

<!-- With modifiers -->
<input v-model.trim="message" />
<input v-model.number="age" />
<input v-model.lazy="message" />
```

### Other Directives

```html
<!-- v-text -->
<div v-text="message"></div>

<!-- v-once (render once) -->
<div v-once>{{ message }}</div>

<!-- v-pre (skip compilation) -->
<div v-pre>{{ message }}</div>
```

---

## Data Binding

### One-Way Binding

```html
<!-- Interpolation -->
<div>{{ message }}</div>

<!-- v-bind -->
<div :id="dynamicId"></div>
```

### Two-Way Binding

```html
<!-- v-model -->
<input v-model="message" />

<!-- Equivalent to -->
<input 
    :value="message"
    @input="message = $event.target.value"
/>
```

### Class Binding

```html
<!-- Object syntax -->
<div :class="{ active: isActive, ''text-danger'': hasError }"></div>

<!-- Array syntax -->
<div :class="[activeClass, errorClass]"></div>

<!-- Conditional -->
<div :class="[isActive ? activeClass : '''', errorClass]"></div>
```

### Style Binding

```html
<!-- Object syntax -->
<div :style="{ color: activeColor, fontSize: fontSize + ''px'' }"></div>

<!-- Array syntax -->
<div :style="[baseStyles, overridingStyles]"></div>

<!-- With computed -->
<div :style="styleObject"></div>
```

### Example: Complete Binding

```html
<div id="app">
    <!-- Text binding -->
    <p>{{ message }}</p>
    
    <!-- Attribute binding -->
    <div :id="dynamicId">Dynamic ID</div>
    
    <!-- Class binding -->
    <div :class="{ active: isActive }">Class binding</div>
    
    <!-- Style binding -->
    <div :style="{ color: textColor }">Style binding</div>
    
    <!-- Two-way binding -->
    <input v-model="message" />
    
    <!-- Event binding -->
    <button @click="toggleActive">Toggle</button>
</div>

<script>
const { createApp } = Vue;

createApp({
    data() {
        return {
            message: ''Hello Vue!'',
            dynamicId: ''my-id'',
            isActive: false,
            textColor: ''blue''
        };
    },
    methods: {
        toggleActive() {
            this.isActive = !this.isActive;
        }
    }
}).mount(''#app'');
</script>
```

---

## Practice Exercise

### Exercise: First Vue App

**Objective**: Practice creating Vue instances, using templates and directives, and data binding.

**Instructions**:

1. Set up a Vue project
2. Create Vue instances
3. Practice:
   - Templates and directives
   - Data binding
   - Event handling
   - Conditional rendering
   - List rendering

**Example Solution**:

```html
<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Basics Practice</title>
    <style>
        .active {
            background-color: #4CAF50;
            color: white;
        }
        .inactive {
            background-color: #f44336;
            color: white;
        }
        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        button {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div id="app">
        <header>
            <h1>{{ title }}</h1>
            <p>Vue.js Basics Practice</p>
        </header>
        
        <section class="card">
            <h2>Text Interpolation</h2>
            <p>Message: {{ message }}</p>
            <p>Count: {{ count }}</p>
            <p>Math: 2 + 2 = {{ 2 + 2 }}</p>
        </section>
        
        <section class="card">
            <h2>Two-Way Binding</h2>
            <input v-model="message" placeholder="Type a message" />
            <p>You typed: {{ message }}</p>
        </section>
        
        <section class="card">
            <h2>Event Handling</h2>
            <p>Count: {{ count }}</p>
            <button @click="increment">Increment</button>
            <button @click="decrement">Decrement</button>
            <button @click="reset">Reset</button>
        </section>
        
        <section class="card">
            <h2>Conditional Rendering</h2>
            <button @click="toggleVisibility">Toggle Visibility</button>
            <div v-if="isVisible" class="active">
                This is visible (v-if)
            </div>
            <div v-else class="inactive">
                This is hidden (v-else)
            </div>
            <div v-show="isVisible" class="active">
                This toggles display (v-show)
            </div>
        </section>
        
        <section class="card">
            <h2>List Rendering</h2>
            <input v-model="newItem" @keyup.enter="addItem" placeholder="Add item" />
            <button @click="addItem">Add</button>
            <ul>
                <li v-for="(item, index) in items" :key="index">
                    {{ item }}
                    <button @click="removeItem(index)">Remove</button>
                </li>
            </ul>
        </section>
        
        <section class="card">
            <h2>Class Binding</h2>
            <div :class="{ active: isActive, inactive: !isActive }">
                Dynamic class binding
            </div>
            <button @click="isActive = !isActive">Toggle Class</button>
        </section>
        
        <section class="card">
            <h2>Style Binding</h2>
            <div :style="{ color: textColor, fontSize: fontSize + ''px'' }">
                Dynamic style binding
            </div>
            <input v-model="textColor" placeholder="Color (e.g., blue)" />
            <input v-model.number="fontSize" type="number" placeholder="Font size" />
        </section>
        
        <section class="card">
            <h2>Computed Properties</h2>
            <p>Count: {{ count }}</p>
            <p>Double Count: {{ doubleCount }}</p>
            <p>Items Count: {{ items.length }}</p>
        </section>
    </div>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    title: ''Vue.js Basics'',
                    message: ''Hello Vue!'',
                    count: 0,
                    isVisible: true,
                    isActive: false,
                    items: [''Item 1'', ''Item 2'', ''Item 3''],
                    newItem: '''',
                    textColor: ''blue'',
                    fontSize: 16
                };
            },
            computed: {
                doubleCount() {
                    return this.count * 2;
                }
            },
            methods: {
                increment() {
                    this.count++;
                },
                decrement() {
                    this.count--;
                },
                reset() {
                    this.count = 0;
                },
                toggleVisibility() {
                    this.isVisible = !this.isVisible;
                },
                addItem() {
                    if (this.newItem.trim()) {
                        this.items.push(this.newItem);
                        this.newItem = '''';
                    }
                },
                removeItem(index) {
                    this.items.splice(index, 1);
                }
            },
            mounted() {
                console.log(''Vue app mounted!'');
            }
        }).mount(''#app'');
    </script>
</body>
</html>
```

**Expected Output** (in browser):
- Vue app with multiple sections
- Interactive elements
- Data binding working
- Event handling working
- Conditional and list rendering

**Challenge (Optional)**:
- Build a complete Vue app
- Add more features
- Style your app
- Practice all directives

---

## Common Mistakes

### 1. Forgetting v-bind for Attributes

```html
<!-- ❌ Bad: String literal -->
<div id="dynamicId">Content</div>

<!-- ✅ Good: v-bind -->
<div :id="dynamicId">Content</div>
```

### 2. Mutating Props

```html
<!-- ❌ Bad: Mutate prop -->
<child-component :prop="value" />
<!-- Inside child: this.prop = newValue -->

<!-- ✅ Good: Use data or emit event -->
```

### 3. Missing Keys in v-for

```html
<!-- ❌ Bad: No key -->
<li v-for="item in items">{{ item }}</li>

<!-- ✅ Good: With key -->
<li v-for="item in items" :key="item.id">{{ item }}</li>
```

---

## Key Takeaways

1. **Vue.js**: Progressive JavaScript framework
2. **Vue Instance**: Created with createApp
3. **Templates**: HTML-based template syntax
4. **Directives**: Special attributes with v- prefix
5. **Data Binding**: One-way and two-way binding
6. **Reactivity**: Automatic reactivity system
7. **Best Practice**: Use keys in v-for, don''t mutate props

---

## Quiz: Vue Basics

Test your understanding with these questions:

1. **Vue.js is:**
   - A) Framework
   - B) Library
   - C) Both
   - D) Neither

2. **Vue instance created with:**
   - A) createApp
   - B) new Vue
   - C) Both
   - D) Neither

3. **v-bind shorthand:**
   - A) :
   - B) @
   - C) Both
   - D) Neither

4. **v-on shorthand:**
   - A) :
   - B) @
   - C) Both
   - D) Neither

5. **v-model:**
   - A) Two-way binding
   - B) One-way binding
   - C) Both
   - D) Neither

6. **v-if vs v-show:**
   - A) v-if removes from DOM
   - B) v-show toggles display
   - C) Both
   - D) Neither

7. **v-for requires:**
   - A) key
   - B) index
   - C) Both
   - D) Neither

**Answers**:
1. A) Framework
2. A) createApp (Vue 3)
3. A) :
4. B) @
5. A) Two-way binding
6. C) Both (v-if removes, v-show toggles)
7. A) key (recommended)

---

## Next Steps

Congratulations! You''ve learned Vue.js basics. You now know:
- What Vue.js is
- How to create Vue instances
- Templates and directives
- Data binding

**What''s Next?**
- Lesson 27.2: Vue Components
- Learn component registration
- Understand props and events
- Work with slots

---

## Additional Resources

- **Vue.js Documentation**: [vuejs.org](https://vuejs.org)
- **Getting Started**: [vuejs.org/guide/quick-start.html](https://vuejs.org/guide/quick-start.html)
- **Template Syntax**: [vuejs.org/guide/essentials/template-syntax.html](https://vuejs.org/guide/essentials/template-syntax.html)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what Vue.js is
- Create Vue instances
- Work with templates and directives
- Use data binding
- Build your first Vue app
- Understand Vue.js fundamentals
- Create reactive applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (181, 67, 16, 'Vue Components and Directives', 'vue-components-and-directives', '# Lesson 27.2: Vue Components

## Learning Objectives

By the end of this lesson, you will be able to:
- Register Vue components
- Work with props
- Handle events
- Use slots
- Build reusable components
- Compose components
- Structure Vue applications

---

## Introduction to Components

Components are reusable Vue instances with a name. They let you split the UI into independent, reusable pieces.

### What are Components?

- **Reusable**: Use components multiple times
- **Independent**: Each component manages its own state
- **Composable**: Combine components to build UIs
- **Isolated**: Changes in one don''t affect others

---

## Component Registration

### Global Registration

```javascript
// Global component registration
const app = createApp({});

app.component(''my-component'', {
    template: ''<div>My Component</div>''
});

app.mount(''#app'');
```

### Local Registration

```javascript
// Local component registration
const MyComponent = {
    template: ''<div>My Component</div>''
};

const app = createApp({
    components: {
        ''my-component'': MyComponent
    }
});

app.mount(''#app'');
```

### Single File Components

```vue
<!-- MyComponent.vue -->
<template>
    <div>
        <h2>{{ title }}</h2>
        <p>{{ content }}</p>
    </div>
</template>

<script>
export default {
    name: ''MyComponent'',
    data() {
        return {
            title: ''My Component'',
            content: ''Component content''
        };
    }
};
</script>

<style scoped>
h2 {
    color: blue;
}
</style>
```

### Using Components

```html
<!-- In template -->
<my-component></my-component>

<!-- Self-closing -->
<my-component />
```

---

## Props

### What are Props?

Props are custom attributes you can register on a component. When a value is passed to a prop attribute, it becomes a property on that component instance.

### Basic Props

```javascript
// Component with props
const MyComponent = {
    props: [''title'', ''content''],
    template: `
        <div>
            <h2>{{ title }}</h2>
            <p>{{ content }}</p>
        </div>
    `
};

// Usage
<my-component title="Hello" content="World"></my-component>
```

### Props with Types

```javascript
// Props with types
const MyComponent = {
    props: {
        title: String,
        count: Number,
        isActive: Boolean,
        items: Array,
        user: Object
    },
    template: ''<div>{{ title }}</div>''
};
```

### Props with Validation

```javascript
// Props with validation
const MyComponent = {
    props: {
        title: {
            type: String,
            required: true
        },
        count: {
            type: Number,
            default: 0,
            validator(value) {
                return value >= 0;
            }
        },
        items: {
            type: Array,
            default: () => []
        }
    },
    template: ''<div>{{ title }}</div>''
};
```

### Props are Read-Only

```javascript
// ❌ Bad: Don''t mutate props
const MyComponent = {
    props: [''count''],
    methods: {
        increment() {
            this.count++;  // Error: Props are read-only
        }
    }
};

// ✅ Good: Use data or emit event
const MyComponent = {
    props: [''initialCount''],
    data() {
        return {
            count: this.initialCount
        };
    },
    methods: {
        increment() {
            this.count++;
        }
    }
};
```

---

## Events

### Emitting Events

```javascript
// Component emitting event
const MyComponent = {
    methods: {
        handleClick() {
            this.$emit(''custom-event'', ''data'');
        }
    },
    template: ''<button @click="handleClick">Click</button>''
};

// Usage
<my-component @custom-event="handleEvent"></my-component>
```

### Event with Data

```javascript
// Emit event with data
const MyComponent = {
    data() {
        return {
            message: ''Hello''
        };
    },
    methods: {
        sendMessage() {
            this.$emit(''message-sent'', this.message);
        }
    },
    template: ''<button @click="sendMessage">Send</button>''
};

// Parent component
const App = {
    methods: {
        handleMessage(message) {
            console.log(''Received:'', message);
        }
    },
    template: `
        <my-component @message-sent="handleMessage"></my-component>
    `
};
```

### Event Modifiers

```javascript
// Native event modifiers
<my-component @click.native="handleClick"></my-component>

// Custom event modifiers (Vue 3)
// Use with v-model
```

### v-model with Components

```javascript
// Component with v-model
const CustomInput = {
    props: [''modelValue''],
    emits: [''update:modelValue''],
    template: `
        <input
            :value="modelValue"
            @input="$emit(''update:modelValue'', $event.target.value)"
        />
    `
};

// Usage
<custom-input v-model="message"></custom-input>
```

---

## Slots

### What are Slots?

Slots are placeholders in components that can be filled with content from the parent.

### Basic Slot

```javascript
// Component with slot
const MyComponent = {
    template: `
        <div>
            <h2>Header</h2>
            <slot></slot>
            <p>Footer</p>
        </div>
    `
};

// Usage
<my-component>
    <p>This content goes in the slot</p>
</my-component>
```

### Named Slots

```javascript
// Component with named slots
const MyComponent = {
    template: `
        <div>
            <header>
                <slot name="header"></slot>
            </header>
            <main>
                <slot></slot>
            </main>
            <footer>
                <slot name="footer"></slot>
            </footer>
        </div>
    `
};

// Usage
<my-component>
    <template #header>
        <h1>Header Content</h1>
    </template>
    <p>Main content</p>
    <template #footer>
        <p>Footer Content</p>
    </template>
</my-component>
```

### Scoped Slots

```javascript
// Component with scoped slot
const MyComponent = {
    data() {
        return {
            items: [''Item 1'', ''Item 2'', ''Item 3'']
        };
    },
    template: `
        <ul>
            <li v-for="item in items" :key="item">
                <slot :item="item"></slot>
            </li>
        </ul>
    `
};

// Usage
<my-component>
    <template #default="{ item }">
        <strong>{{ item }}</strong>
    </template>
</my-component>
```

---

## Practical Examples

### Example 1: Button Component

```javascript
// Button component
const Button = {
    props: {
        text: {
            type: String,
            required: true
        },
        variant: {
            type: String,
            default: ''primary''
        },
        disabled: {
            type: Boolean,
            default: false
        }
    },
    emits: [''click''],
    template: `
        <button
            :class="[''btn'', ''btn-'' + variant]"
            :disabled="disabled"
            @click="$emit(''click'', $event)"
        >
            {{ text }}
        </button>
    `
};

// Usage
<button text="Click me" variant="primary" @click="handleClick"></button>
```

### Example 2: Card Component

```javascript
// Card component
const Card = {
    props: {
        title: String,
        image: String
    },
    template: `
        <div class="card">
            <img v-if="image" :src="image" :alt="title" />
            <div class="card-content">
                <h3 v-if="title">{{ title }}</h3>
                <slot></slot>
            </div>
        </div>
    `
};

// Usage
<card title="My Card" image="/image.jpg">
    <p>Card content</p>
</card>
```

### Example 3: List Component

```javascript
// List component
const List = {
    props: {
        items: {
            type: Array,
            required: true
        }
    },
    template: `
        <ul>
            <li v-for="(item, index) in items" :key="index">
                <slot :item="item" :index="index"></slot>
            </li>
        </ul>
    `
};

// Usage
<list :items="users">
    <template #default="{ item, index }">
        <strong>{{ item.name }}</strong> - {{ item.email }}
    </template>
</list>
```

---

## Practice Exercise

### Exercise: Vue Components

**Objective**: Practice creating components, working with props, events, and slots.

**Instructions**:

1. Create a Vue project
2. Create multiple components
3. Practice:
   - Component registration
   - Props
   - Events
   - Slots

**Example Solution**:

```vue
<!-- src/components/Button.vue -->
<template>
    <button
        :class="[''btn'', ''btn-'' + variant]"
        :disabled="disabled"
        @click="handleClick"
    >
        <slot>{{ text }}</slot>
    </button>
</template>

<script>
export default {
    name: ''Button'',
    props: {
        text: String,
        variant: {
            type: String,
            default: ''primary''
        },
        disabled: {
            type: Boolean,
            default: false
        }
    },
    emits: [''click''],
    methods: {
        handleClick(event) {
            this.$emit(''click'', event);
        }
    }
};
</script>

<style scoped>
.btn {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.btn-primary {
    background-color: #007bff;
    color: white;
}

.btn-secondary {
    background-color: #6c757d;
    color: white;
}

.btn-danger {
    background-color: #dc3545;
    color: white;
}

.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}
</style>
```

```vue
<!-- src/components/Card.vue -->
<template>
    <div class="card">
        <img v-if="image" :src="image" :alt="title" class="card-image" />
        <div class="card-content">
            <h3 v-if="title" class="card-title">{{ title }}</h3>
            <p v-if="description" class="card-description">{{ description }}</p>
            <slot></slot>
        </div>
    </div>
</template>

<script>
export default {
    name: ''Card'',
    props: {
        title: String,
        description: String,
        image: String
    }
};
</script>

<style scoped>
.card {
    border: 1px solid #ddd;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.card-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
}

.card-content {
    padding: 15px;
}

.card-title {
    margin: 0 0 10px 0;
}

.card-description {
    margin: 0 0 15px 0;
    color: #666;
}
</style>
```

```vue
<!-- src/components/UserCard.vue -->
<template>
    <card :title="user.name" :description="`Age: ${user.age} | Email: ${user.email}`">
        <div class="card-actions">
            <button text="Edit" variant="secondary" @click="handleEdit"></button>
            <button text="Delete" variant="danger" @click="handleDelete"></button>
        </div>
    </card>
</template>

<script>
import Card from ''./Card.vue'';
import Button from ''./Button.vue'';

export default {
    name: ''UserCard'',
    components: {
        Card,
        Button
    },
    props: {
        user: {
            type: Object,
            required: true
        }
    },
    emits: [''edit'', ''delete''],
    methods: {
        handleEdit() {
            this.$emit(''edit'', this.user.id);
        },
        handleDelete() {
            this.$emit(''delete'', this.user.id);
        }
    }
};
</script>

<style scoped>
.card-actions {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}
</style>
```

```vue
<!-- src/components/UserList.vue -->
<template>
    <div class="user-list">
        <h2 v-if="title">{{ title }}</h2>
        <div v-if="users.length === 0" class="empty">
            <slot name="empty">No users found</slot>
        </div>
        <div v-else class="users">
            <user-card
                v-for="user in users"
                :key="user.id"
                :user="user"
                @edit="handleEdit"
                @delete="handleDelete"
            />
        </div>
    </div>
</template>

<script>
import UserCard from ''./UserCard.vue'';

export default {
    name: ''UserList'',
    components: {
        UserCard
    },
    props: {
        users: {
            type: Array,
            default: () => []
        },
        title: String
    },
    emits: [''edit'', ''delete''],
    methods: {
        handleEdit(userId) {
            this.$emit(''edit'', userId);
        },
        handleDelete(userId) {
            this.$emit(''delete'', userId);
        }
    }
};
</script>

<style scoped>
.user-list {
    padding: 20px;
}

.users {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.empty {
    padding: 20px;
    text-align: center;
    color: #666;
}
</style>
```

```vue
<!-- src/components/Layout.vue -->
<template>
    <div class="layout">
        <header v-if="$slots.header">
            <slot name="header"></slot>
        </header>
        <main>
            <slot></slot>
        </main>
        <footer v-if="$slots.footer">
            <slot name="footer"></slot>
        </footer>
    </div>
</template>

<script>
export default {
    name: ''Layout''
};
</script>

<style scoped>
.layout {
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

header {
    background-color: #282c34;
    color: white;
    padding: 20px;
}

main {
    flex: 1;
    padding: 20px;
}

footer {
    background-color: #282c34;
    color: white;
    padding: 10px;
    text-align: center;
}
</style>
```

```vue
<!-- src/App.vue -->
<template>
    <layout>
        <template #header>
            <h1>Vue Components Practice</h1>
        </template>
        
        <div class="app-content">
            <user-list
                :users="users"
                title="Users"
                @edit="handleEdit"
                @delete="handleDelete"
            >
                <template #empty>
                    <p>No users available</p>
                </template>
            </user-list>
            
            <div class="actions">
                <button text="Add User" @click="handleAdd"></button>
            </div>
        </div>
        
        <template #footer>
            <p>&copy; 2024 My App</p>
        </template>
    </layout>
</template>

<script>
import Layout from ''./components/Layout.vue'';
import UserList from ''./components/UserList.vue'';
import Button from ''./components/Button.vue'';

export default {
    name: ''App'',
    components: {
        Layout,
        UserList,
        Button
    },
    data() {
        return {
            users: [
                { id: 1, name: ''Alice'', age: 30, email: ''alice@example.com'' },
                { id: 2, name: ''Bob'', age: 25, email: ''bob@example.com'' },
                { id: 3, name: ''Charlie'', age: 35, email: ''charlie@example.com'' }
            ]
        };
    },
    methods: {
        handleEdit(userId) {
            console.log(''Edit user:'', userId);
            alert(`Editing user ${userId}`);
        },
        handleDelete(userId) {
            if (confirm(''Are you sure?'')) {
                this.users = this.users.filter(user => user.id !== userId);
            }
        },
        handleAdd() {
            alert(''Add user'');
        }
    }
};
</script>

<style>
.app-content {
    max-width: 1200px;
    margin: 0 auto;
}

.actions {
    margin: 20px 0;
}
</style>
```

**Expected Output** (in browser):
- Layout with header and footer
- User list with cards
- Interactive buttons
- Components working together

**Challenge (Optional)**:
- Build a complete component library
- Create complex component compositions
- Add more features
- Build a real application

---

## Common Mistakes

### 1. Mutating Props

```javascript
// ❌ Bad: Mutate prop
props: [''count''],
methods: {
    increment() {
        this.count++;  // Error
    }
}

// ✅ Good: Use data or emit
props: [''initialCount''],
data() {
    return {
        count: this.initialCount
    };
}
```

### 2. Not Declaring Emits

```javascript
// ❌ Bad: Not declaring emits (Vue 3)
this.$emit(''custom-event'');

// ✅ Good: Declare emits
emits: [''custom-event''],
this.$emit(''custom-event'');
```

### 3. Missing Keys in v-for

```javascript
// ❌ Bad: No key
<li v-for="item in items">{{ item }}</li>

// ✅ Good: With key
<li v-for="item in items" :key="item.id">{{ item }}</li>
```

---

## Key Takeaways

1. **Components**: Reusable Vue instances
2. **Registration**: Global or local
3. **Props**: Pass data from parent to child
4. **Events**: Emit events from child to parent
5. **Slots**: Content projection
6. **Best Practice**: Don''t mutate props, declare emits, use keys
7. **Composition**: Combine components to build UIs

---

## Quiz: Vue Components

Test your understanding with these questions:

1. **Components are:**
   - A) Reusable
   - B) Independent
   - C) Both
   - D) Neither

2. **Props:**
   - A) Read-only
   - B) Mutable
   - C) Both
   - D) Neither

3. **Events:**
   - A) Child to parent
   - B) Parent to child
   - C) Both
   - D) Neither

4. **Slots:**
   - A) Content projection
   - B) Data passing
   - C) Both
   - D) Neither

5. **v-model with components:**
   - A) Uses modelValue prop
   - B) Uses value prop
   - C) Both
   - D) Neither

6. **Named slots:**
   - A) Use #name
   - B) Use v-slot:name
   - C) Both
   - D) Neither

7. **Scoped slots:**
   - A) Pass data to parent
   - B) Receive data from parent
   - C) Both
   - D) Neither

**Answers**:
1. C) Both
2. A) Read-only
3. A) Child to parent
4. A) Content projection
5. A) Uses modelValue prop (Vue 3)
6. C) Both (#name is shorthand)
7. A) Pass data to parent

---

## Next Steps

Congratulations! You''ve learned Vue components. You now know:
- How to register components
- How to work with props
- How to handle events
- How to use slots

**What''s Next?**
- Lesson 27.3: Vue Composition API
- Learn setup function
- Understand reactive references
- Work with computed properties

---

## Additional Resources

- **Vue Components**: [vuejs.org/guide/essentials/component-basics.html](https://vuejs.org/guide/essentials/component-basics.html)
- **Props**: [vuejs.org/guide/components/props.html](https://vuejs.org/guide/components/props.html)
- **Events**: [vuejs.org/guide/components/events.html](https://vuejs.org/guide/components/events.html)
- **Slots**: [vuejs.org/guide/components/slots.html](https://vuejs.org/guide/components/slots.html)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Register Vue components
- Work with props
- Handle events
- Use slots
- Build reusable components
- Compose components
- Structure Vue applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (182, 67, 16, 'Vue Router and State Management', 'vue-router-and-state-management', '# Lesson 27.3: Vue Composition API

## Learning Objectives

By the end of this lesson, you will be able to:
- Use the setup function
- Work with reactive references
- Use computed properties
- Understand Composition API benefits
- Build components with Composition API
- Organize component logic
- Create reusable composables

---

## Introduction to Composition API

The Composition API is a new way to write Vue components introduced in Vue 3. It provides better organization and reusability of component logic.

### Why Composition API?

- **Better Organization**: Group related logic together
- **Reusability**: Share logic between components
- **TypeScript Support**: Better TypeScript inference
- **Flexibility**: More flexible code organization
- **Performance**: Better tree-shaking

### Options API vs Composition API

```javascript
// Options API (Traditional)
export default {
    data() {
        return { count: 0 };
    },
    methods: {
        increment() {
            this.count++;
        }
    }
};

// Composition API (New)
import { ref } from ''vue'';

export default {
    setup() {
        const count = ref(0);
        const increment = () => {
            count.value++;
        };
        return { count, increment };
    }
};
```

---

## Setup Function

### Basic Setup

```javascript
// Component with setup function
import { ref } from ''vue'';

export default {
    setup() {
        const count = ref(0);
        
        const increment = () => {
            count.value++;
        };
        
        return {
            count,
            increment
        };
    }
};
```

### Setup with Template

```vue
<template>
    <div>
        <p>Count: {{ count }}</p>
        <button @click="increment">Increment</button>
    </div>
</template>

<script>
import { ref } from ''vue'';

export default {
    setup() {
        const count = ref(0);
        
        const increment = () => {
            count.value++;
        };
        
        return {
            count,
            increment
        };
    }
};
</script>
```

### Script Setup (Syntactic Sugar)

```vue
<template>
    <div>
        <p>Count: {{ count }}</p>
        <button @click="increment">Increment</button>
    </div>
</template>

<script setup>
import { ref } from ''vue'';

const count = ref(0);

const increment = () => {
    count.value++;
};
</script>
```

---

## Reactive References

### ref

`ref` creates a reactive reference to a value.

```javascript
import { ref } from ''vue'';

// Basic ref
const count = ref(0);

// Access value
console.log(count.value);  // 0

// Update value
count.value = 1;

// In template, .value is not needed
// {{ count }} not {{ count.value }}
```

### ref with Objects

```javascript
import { ref } from ''vue'';

const user = ref({
    name: ''Alice'',
    age: 30
});

// Access
console.log(user.value.name);  // Alice

// Update
user.value.name = ''Bob'';
```

### reactive

`reactive` creates a reactive object (no .value needed).

```javascript
import { reactive } from ''vue'';

const state = reactive({
    count: 0,
    name: ''Alice''
});

// Access (no .value)
console.log(state.count);  // 0

// Update
state.count = 1;
```

### ref vs reactive

```javascript
// ref: Use for primitives or when you need to replace entire object
const count = ref(0);
const user = ref({ name: ''Alice'' });

// reactive: Use for objects that won''t be replaced
const state = reactive({
    count: 0,
    name: ''Alice''
});

// ref is more flexible, reactive is simpler for objects
```

---

## Computed Properties

### Basic Computed

```javascript
import { ref, computed } from ''vue'';

const count = ref(0);

// Computed property
const doubleCount = computed(() => {
    return count.value * 2;
});

// Usage
console.log(doubleCount.value);  // 0 (count is 0)
count.value = 5;
console.log(doubleCount.value);  // 10
```

### Computed with Getter and Setter

```javascript
import { ref, computed } from ''vue'';

const firstName = ref(''John'');
const lastName = ref(''Doe'');

// Computed with getter and setter
const fullName = computed({
    get() {
        return `${firstName.value} ${lastName.value}`;
    },
    set(value) {
        const parts = value.split('' '');
        firstName.value = parts[0];
        lastName.value = parts[1] || '''';
    }
});

// Usage
console.log(fullName.value);  // John Doe
fullName.value = ''Jane Smith'';
console.log(firstName.value);  // Jane
console.log(lastName.value);    // Smith
```

### Computed in Template

```vue
<template>
    <div>
        <p>Count: {{ count }}</p>
        <p>Double: {{ doubleCount }}</p>
    </div>
</template>

<script setup>
import { ref, computed } from ''vue'';

const count = ref(0);
const doubleCount = computed(() => count.value * 2);
</script>
```

---

## Watch and WatchEffect

### watch

```javascript
import { ref, watch } from ''vue'';

const count = ref(0);
const message = ref('''');

// Watch single source
watch(count, (newValue, oldValue) => {
    console.log(`Count changed from ${oldValue} to ${newValue}`);
});

// Watch multiple sources
watch([count, message], ([newCount, newMessage], [oldCount, oldMessage]) => {
    console.log(''Count or message changed'');
});

// Watch with options
watch(count, (newValue) => {
    console.log(''Count changed:'', newValue);
}, {
    immediate: true,  // Run immediately
    deep: true        // Deep watch for objects
});
```

### watchEffect

```javascript
import { ref, watchEffect } from ''vue'';

const count = ref(0);
const doubleCount = ref(0);

// watchEffect runs immediately and tracks dependencies
watchEffect(() => {
    doubleCount.value = count.value * 2;
});

// Automatically tracks count as dependency
count.value = 5;  // doubleCount becomes 10
```

---

## Lifecycle Hooks

### Composition API Lifecycle

```javascript
import { onMounted, onUpdated, onUnmounted } from ''vue'';

export default {
    setup() {
        onMounted(() => {
            console.log(''Component mounted'');
        });
        
        onUpdated(() => {
            console.log(''Component updated'');
        });
        
        onUnmounted(() => {
            console.log(''Component unmounted'');
        });
    }
};
```

### All Lifecycle Hooks

```javascript
import {
    onBeforeMount,
    onMounted,
    onBeforeUpdate,
    onUpdated,
    onBeforeUnmount,
    onUnmounted
} from ''vue'';

export default {
    setup() {
        onBeforeMount(() => {
            // Before mount
        });
        
        onMounted(() => {
            // After mount
        });
        
        onBeforeUpdate(() => {
            // Before update
        });
        
        onUpdated(() => {
            // After update
        });
        
        onBeforeUnmount(() => {
            // Before unmount
        });
        
        onUnmounted(() => {
            // After unmount
        });
    }
};
```

---

## Props and Emits

### Props

```javascript
import { defineProps } from ''vue'';

// Define props
const props = defineProps({
    title: String,
    count: {
        type: Number,
        default: 0
    }
});

// Use props
console.log(props.title);
console.log(props.count);
```

### Emits

```javascript
import { defineEmits } from ''vue'';

// Define emits
const emit = defineEmits([''update'', ''delete'']);

// Emit events
const handleUpdate = () => {
    emit(''update'', data);
};

const handleDelete = () => {
    emit(''delete'', id);
};
```

### Props and Emits with TypeScript

```typescript
// With TypeScript
interface Props {
    title: string;
    count?: number;
}

const props = defineProps<Props>();

const emit = defineEmits<{
    update: [value: string];
    delete: [id: number];
}>();
```

---

## Composables (Custom Hooks)

### What are Composables?

Composables are functions that use Composition API features to encapsulate and reuse stateful logic.

### Basic Composable

```javascript
// useCounter.js
import { ref } from ''vue'';

export function useCounter(initialValue = 0) {
    const count = ref(initialValue);
    
    const increment = () => {
        count.value++;
    };
    
    const decrement = () => {
        count.value--;
    };
    
    const reset = () => {
        count.value = initialValue;
    };
    
    return {
        count,
        increment,
        decrement,
        reset
    };
}
```

### Using Composable

```vue
<template>
    <div>
        <p>Count: {{ count }}</p>
        <button @click="increment">+</button>
        <button @click="decrement">-</button>
        <button @click="reset">Reset</button>
    </div>
</template>

<script setup>
import { useCounter } from ''./composables/useCounter'';

const { count, increment, decrement, reset } = useCounter(0);
</script>
```

### Composable: useFetch

```javascript
// useFetch.js
import { ref, onMounted } from ''vue'';

export function useFetch(url) {
    const data = ref(null);
    const loading = ref(true);
    const error = ref(null);
    
    const fetchData = async () => {
        try {
            loading.value = true;
            error.value = null;
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(''Network response was not ok'');
            }
            data.value = await response.json();
        } catch (err) {
            error.value = err.message;
        } finally {
            loading.value = false;
        }
    };
    
    onMounted(() => {
        fetchData();
    });
    
    return {
        data,
        loading,
        error,
        refetch: fetchData
    };
}
```

### Composable: useLocalStorage

```javascript
// useLocalStorage.js
import { ref, watch } from ''vue'';

export function useLocalStorage(key, initialValue) {
    const storedValue = ref(() => {
        try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
        } catch (error) {
            console.error(error);
            return initialValue;
        }
    });
    
    watch(storedValue, (newValue) => {
        try {
            window.localStorage.setItem(key, JSON.stringify(newValue));
        } catch (error) {
            console.error(error);
        }
    }, { deep: true });
    
    return storedValue;
}
```

---

## Practice Exercise

### Exercise: Composition API

**Objective**: Practice using setup function, reactive references, computed properties, and creating composables.

**Instructions**:

1. Create a Vue 3 project
2. Practice Composition API
3. Practice:
   - Setup function
   - Reactive references
   - Computed properties
   - Creating composables

**Example Solution**:

```javascript
// src/composables/useCounter.js
import { ref } from ''vue'';

export function useCounter(initialValue = 0, step = 1) {
    const count = ref(initialValue);
    
    const increment = () => {
        count.value += step;
    };
    
    const decrement = () => {
        count.value -= step;
    };
    
    const reset = () => {
        count.value = initialValue;
    };
    
    return {
        count,
        increment,
        decrement,
        reset
    };
}
```

```javascript
// src/composables/useTodos.js
import { ref, computed } from ''vue'';

export function useTodos() {
    const todos = ref([]);
    const filter = ref(''all'');
    
    const addTodo = (text) => {
        if (text.trim()) {
            todos.value.push({
                id: Date.now(),
                text,
                completed: false
            });
        }
    };
    
    const toggleTodo = (id) => {
        const todo = todos.value.find(t => t.id === id);
        if (todo) {
            todo.completed = !todo.completed;
        }
    };
    
    const removeTodo = (id) => {
        todos.value = todos.value.filter(t => t.id !== id);
    };
    
    const setFilter = (newFilter) => {
        filter.value = newFilter;
    };
    
    const filteredTodos = computed(() => {
        if (filter.value === ''active'') {
            return todos.value.filter(t => !t.completed);
        }
        if (filter.value === ''completed'') {
            return todos.value.filter(t => t.completed);
        }
        return todos.value;
    });
    
    return {
        todos,
        filter,
        filteredTodos,
        addTodo,
        toggleTodo,
        removeTodo,
        setFilter
    };
}
```

```javascript
// src/composables/useFetch.js
import { ref, onMounted } from ''vue'';

export function useFetch(url) {
    const data = ref(null);
    const loading = ref(true);
    const error = ref(null);
    
    const fetchData = async () => {
        try {
            loading.value = true;
            error.value = null;
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(''Network response was not ok'');
            }
            data.value = await response.json();
        } catch (err) {
            error.value = err.message;
        } finally {
            loading.value = false;
        }
    };
    
    onMounted(() => {
        fetchData();
    });
    
    return {
        data,
        loading,
        error,
        refetch: fetchData
    };
}
```

```vue
<!-- src/components/Counter.vue -->
<template>
    <div class="counter">
        <h2>Counter</h2>
        <p>Count: {{ count }}</p>
        <p>Double: {{ doubleCount }}</p>
        <div class="buttons">
            <button @click="decrement">-</button>
            <button @click="reset">Reset</button>
            <button @click="increment">+</button>
        </div>
    </div>
</template>

<script setup>
import { computed } from ''vue'';
import { useCounter } from ''../composables/useCounter'';

const { count, increment, decrement, reset } = useCounter(0);
const doubleCount = computed(() => count.value * 2);
</script>

<style scoped>
.counter {
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
}

.buttons {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

button {
    padding: 8px 16px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
</style>
```

```vue
<!-- src/components/TodoApp.vue -->
<template>
    <div class="todo-app">
        <h2>Todo App</h2>
        <div class="todo-input">
            <input
                v-model="newTodo"
                @keyup.enter="handleAdd"
                placeholder="Add todo..."
            />
            <button @click="handleAdd">Add</button>
        </div>
        <div class="filters">
            <button
                :class="{ active: filter === ''all'' }"
                @click="setFilter(''all'')"
            >
                All
            </button>
            <button
                :class="{ active: filter === ''active'' }"
                @click="setFilter(''active'')"
            >
                Active
            </button>
            <button
                :class="{ active: filter === ''completed'' }"
                @click="setFilter(''completed'')"
            >
                Completed
            </button>
        </div>
        <ul>
            <li
                v-for="todo in filteredTodos"
                :key="todo.id"
                :class="{ completed: todo.completed }"
            >
                <input
                    type="checkbox"
                    :checked="todo.completed"
                    @change="toggleTodo(todo.id)"
                />
                <span>{{ todo.text }}</span>
                <button @click="removeTodo(todo.id)">Delete</button>
            </li>
        </ul>
    </div>
</template>

<script setup>
import { ref } from ''vue'';
import { useTodos } from ''../composables/useTodos'';

const { todos, filter, filteredTodos, addTodo, toggleTodo, removeTodo, setFilter } = useTodos();
const newTodo = ref('''');

const handleAdd = () => {
    addTodo(newTodo.value);
    newTodo.value = '''';
};
</script>

<style scoped>
.todo-app {
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
}

.todo-input {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.todo-input input {
    flex: 1;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

.filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.filters button.active {
    background-color: #28a745;
}

ul {
    list-style: none;
    padding: 0;
}

li {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px;
    margin: 5px 0;
    background-color: #f5f5f5;
    border-radius: 4px;
}

li.completed span {
    text-decoration: line-through;
    opacity: 0.6;
}

button {
    padding: 8px 16px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}
</style>
```

```vue
<!-- src/components/UserProfile.vue -->
<template>
    <div class="user-profile">
        <h2>User Profile</h2>
        <div v-if="loading">Loading...</div>
        <div v-else-if="error">Error: {{ error }}</div>
        <div v-else-if="data">
            <p><strong>Name:</strong> {{ data.name }}</p>
            <p><strong>Email:</strong> {{ data.email }}</p>
        </div>
        <button @click="refetch">Refetch</button>
    </div>
</template>

<script setup>
import { useFetch } from ''../composables/useFetch'';

const { data, loading, error, refetch } = useFetch(''https://jsonplaceholder.typicode.com/users/1'');
</script>

<style scoped>
.user-profile {
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 8px;
}
</style>
```

```vue
<!-- src/App.vue -->
<template>
    <div class="app">
        <header>
            <h1>Vue Composition API Practice</h1>
        </header>
        <main>
            <section>
                <counter />
            </section>
            <section>
                <todo-app />
            </section>
            <section>
                <user-profile />
            </section>
        </main>
    </div>
</template>

<script setup>
import Counter from ''./components/Counter.vue'';
import TodoApp from ''./components/TodoApp.vue'';
import UserProfile from ''./components/UserProfile.vue'';
</script>

<style>
.app {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 30px;
}

section {
    margin-bottom: 40px;
}
</style>
```

**Expected Output** (in browser):
- Counter with composable
- Todo app with composable
- User profile with useFetch
- All working with Composition API

**Challenge (Optional)**:
- Create more composables
- Build complex components
- Practice all Composition API features
- Build a complete application

---

## Common Mistakes

### 1. Forgetting .value with ref

```javascript
// ❌ Bad: Missing .value
const count = ref(0);
count++;  // Error

// ✅ Good: Use .value
const count = ref(0);
count.value++;
```

### 2. Not Returning from Setup

```javascript
// ❌ Bad: Not returning
setup() {
    const count = ref(0);
    // Missing return
}

// ✅ Good: Return what you need
setup() {
    const count = ref(0);
    return { count };
}
```

### 3. Mutating Props

```javascript
// ❌ Bad: Mutate prop
const props = defineProps([''count'']);
props.count++;  // Error

// ✅ Good: Use emit or local state
const props = defineProps([''initialCount'']);
const count = ref(props.initialCount);
```

---

## Key Takeaways

1. **Composition API**: New way to write Vue components
2. **Setup Function**: Entry point for Composition API
3. **ref**: Reactive reference (use .value)
4. **reactive**: Reactive object (no .value)
5. **computed**: Computed properties
6. **Composables**: Reusable logic functions
7. **Best Practice**: Use script setup, create composables, organize logic

---

## Quiz: Vue Composition API

Test your understanding with these questions:

1. **Composition API:**
   - A) Vue 3 feature
   - B) Vue 2 feature
   - C) Both
   - D) Neither

2. **ref requires:**
   - A) .value
   - B) No .value
   - C) Both
   - D) Neither

3. **reactive:**
   - A) No .value needed
   - B) .value needed
   - C) Both
   - D) Neither

4. **computed:**
   - A) Cached
   - B) Not cached
   - C) Both
   - D) Neither

5. **Composables:**
   - A) Reusable logic
   - B) Component logic
   - C) Both
   - D) Neither

6. **script setup:**
   - A) Syntactic sugar
   - B) Required
   - C) Both
   - D) Neither

7. **setup function:**
   - A) Must return
   - B) Optional return
   - C) Both
   - D) Neither

**Answers**:
1. A) Vue 3 feature
2. A) .value
3. A) No .value needed
4. A) Cached
5. A) Reusable logic
6. A) Syntactic sugar
7. A) Must return (unless using script setup)

---

## Next Steps

Congratulations! You''ve completed Module 27: Vue.js (Alternative Framework). You now know:
- Vue.js basics
- Vue components
- Vue Composition API
- How to build Vue applications

**What''s Next?**
- Module 28: Node.js Basics
- Learn Node.js introduction
- Understand Node.js fundamentals
- Build server-side applications

---

## Additional Resources

- **Composition API**: [vuejs.org/guide/extras/composition-api-faq.html](https://vuejs.org/guide/extras/composition-api-faq.html)
- **Script Setup**: [vuejs.org/api/sfc-script-setup.html](https://vuejs.org/api/sfc-script-setup.html)
- **Composables**: [vuejs.org/guide/reusability/composables.html](https://vuejs.org/guide/reusability/composables.html)

---

*Lesson completed! You''ve finished Module 27: Vue.js. Ready for Module 28: Node.js Basics!*

', NULL, 3, '2026-01-03 10:09:12', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Use the setup function
- Work with reactive references
- Use computed properties
- Understand Composition API benefits
- Build components with Composition API
- Organize component logic
- Create reusable composables');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (183, 68, 17, 'Node.js Introduction', 'nodejs-introduction', '# Lesson 28.1: Node.js Introduction

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand what Node.js is
- Know the differences between Node.js and browser JavaScript
- Install Node.js
- Use the REPL
- Run Node.js applications
- Understand Node.js fundamentals
- Write server-side JavaScript

---

## Introduction to Node.js

Node.js is a JavaScript runtime built on Chrome''s V8 JavaScript engine. It allows you to run JavaScript on the server.

### What is Node.js?

- **JavaScript Runtime**: Runs JavaScript outside the browser
- **Event-Driven**: Asynchronous, event-driven architecture
- **Non-Blocking I/O**: Efficient handling of I/O operations
- **Single-Threaded**: Uses event loop for concurrency
- **NPM**: Package manager for JavaScript
- **Cross-Platform**: Works on Windows, macOS, Linux

### Why Node.js?

- **One Language**: JavaScript for both frontend and backend
- **Fast**: Built on V8 engine
- **Scalable**: Handles many concurrent connections
- **Large Ecosystem**: Huge number of packages
- **Active Community**: Large and active community
- **Real-Time**: Great for real-time applications

---

## What is Node.js?

### Node.js Architecture

```
┌─────────────────┐
│   JavaScript    │
│     Code        │
└────────┬────────┘
         │
┌────────▼────────┐
│   Node.js API   │
│   (Core Modules)│
└────────┬────────┘
         │
┌────────▼────────┐
│   V8 Engine     │
│  (JavaScript    │
│   Engine)       │
└────────┬────────┘
         │
┌────────▼────────┐
│  libuv (C++)    │
│  (Event Loop)   │
└─────────────────┘
```

### Key Features

- **V8 Engine**: Google''s JavaScript engine
- **Event Loop**: Handles asynchronous operations
- **libuv**: C++ library for async I/O
- **Core Modules**: Built-in modules (fs, http, path, etc.)
- **NPM**: Node Package Manager

---

## Node.js vs Browser JavaScript

### Similarities

```javascript
// Both support:
// - JavaScript syntax
// - Variables, functions, objects
// - ES6+ features
// - Async/await, promises
```

### Differences

| Feature | Browser JavaScript | Node.js |
|---------|-------------------|---------|
| **Global Object** | `window` | `global` |
| **DOM** | Yes | No |
| **File System** | No | Yes |
| **Modules** | ES6 modules | CommonJS/ES6 |
| **Process** | No | Yes |
| **OS** | Limited | Full access |
| **Network** | Fetch API | http/https modules |

### Global Objects

```javascript
// Browser
console.log(window);      // Global object
console.log(document);    // DOM
console.log(navigator);   // Browser info

// Node.js
console.log(global);      // Global object
console.log(process);     // Process info
console.log(__dirname);   // Current directory
console.log(__filename);  // Current file
```

### No DOM in Node.js

```javascript
// ❌ Browser only
document.getElementById(''app'');
window.location;

// ✅ Node.js
const fs = require(''fs'');
const path = require(''path'');
const http = require(''http'');
```

---

## Installing Node.js

### Download and Install

1. **Visit**: [nodejs.org](https://nodejs.org)
2. **Download**: LTS (Long Term Support) version
3. **Install**: Follow installation wizard
4. **Verify**: Check installation

### Verify Installation

```bash
# Check Node.js version
node --version
# or
node -v

# Check npm version
npm --version
# or
npm -v
```

### Using nvm (Node Version Manager)

```bash
# Install nvm (macOS/Linux)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash

# Install Node.js
nvm install node        # Latest version
nvm install 18          # Specific version
nvm install --lts       # LTS version

# Use version
nvm use 18

# List installed versions
nvm list

# Set default
nvm alias default 18
```

### Using nvm-windows

```powershell
# Download from: https://github.com/coreybutler/nvm-windows/releases
# Install and use:
nvm install 18
nvm use 18
```

---

## REPL (Read-Eval-Print Loop)

### What is REPL?

REPL is an interactive programming environment where you can run JavaScript code.

### Starting REPL

```bash
# Start REPL
node

# Or with specific file
node filename.js
```

### REPL Commands

```javascript
// In REPL:
> const name = ''Alice'';
undefined

> name
''Alice''

> 2 + 2
4

> function greet(name) {
...   return `Hello, ${name}!`;
... }
undefined

> greet(''Alice'')
''Hello, Alice!''

// Special commands:
.help          // Show help
.break         // Exit multi-line input
.clear         // Clear context
.exit          // Exit REPL
.save file.js  // Save session
.load file.js  // Load file
```

### REPL Features

```javascript
// Multi-line input
> function add(a, b) {
...   return a + b;
... }
undefined

> add(2, 3)
5

// Variables persist
> let x = 10;
undefined
> x
10

// Use require
> const fs = require(''fs'');
undefined
> fs.readFileSync(''package.json'', ''utf8'')
''...''

// Use _ for last result
> 2 + 2
4
> _ * 2
8
```

---

## Your First Node.js Application

### Simple Script

```javascript
// hello.js
console.log(''Hello, Node.js!'');

// Run it
// node hello.js
```

### Using Modules

```javascript
// app.js
const fs = require(''fs'');
const path = require(''path'');

console.log(''Current directory:'', __dirname);
console.log(''Current file:'', __filename);

// Read a file
const data = fs.readFileSync(''package.json'', ''utf8'');
console.log(''Package.json:'', data);
```

### Using Process

```javascript
// process-example.js
console.log(''Process ID:'', process.pid);
console.log(''Node version:'', process.version);
console.log(''Platform:'', process.platform);
console.log(''Arguments:'', process.argv);

// Access command line arguments
const args = process.argv.slice(2);
console.log(''Arguments:'', args);
```

### Environment Variables

```javascript
// env-example.js
console.log(''NODE_ENV:'', process.env.NODE_ENV);
console.log(''HOME:'', process.env.HOME);

// Set environment variable
process.env.MY_VAR = ''my value'';
console.log(''MY_VAR:'', process.env.MY_VAR);
```

---

## Practice Exercise

### Exercise: Node.js Basics

**Objective**: Practice installing Node.js, using REPL, and creating your first Node.js applications.

**Instructions**:

1. Install Node.js
2. Use REPL
3. Create Node.js scripts
4. Practice:
   - Running Node.js scripts
   - Using global objects
   - Working with process
   - Using environment variables

**Example Solution**:

```javascript
// exercise-1.js
// Basic Node.js script
console.log(''Hello, Node.js!'');
console.log(''Current directory:'', __dirname);
console.log(''Current file:'', __filename);
```

```javascript
// exercise-2.js
// Process information
console.log(''=== Process Information ==='');
console.log(''Process ID:'', process.pid);
console.log(''Node version:'', process.version);
console.log(''Platform:'', process.platform);
console.log(''Architecture:'', process.arch);
console.log(''Current working directory:'', process.cwd());
```

```javascript
// exercise-3.js
// Command line arguments
const args = process.argv.slice(2);

console.log(''=== Command Line Arguments ==='');
console.log(''Number of arguments:'', args.length);
args.forEach((arg, index) => {
    console.log(`Argument ${index + 1}: ${arg}`);
});

// Example usage:
// node exercise-3.js arg1 arg2 arg3
```

```javascript
// exercise-4.js
// Environment variables
console.log(''=== Environment Variables ==='');
console.log(''NODE_ENV:'', process.env.NODE_ENV || ''not set'');
console.log(''HOME:'', process.env.HOME || process.env.USERPROFILE || ''not set'');
console.log(''PATH:'', process.env.PATH ? ''set'' : ''not set'');

// Set custom environment variable
process.env.MY_APP_NAME = ''My Node.js App'';
console.log(''MY_APP_NAME:'', process.env.MY_APP_NAME);
```

```javascript
// exercise-5.js
// Simple calculator
const args = process.argv.slice(2);

if (args.length !== 3) {
    console.log(''Usage: node exercise-5.js <num1> <operator> <num2>'');
    console.log(''Operators: +, -, *, /'');
    process.exit(1);
}

const num1 = parseFloat(args[0]);
const operator = args[1];
const num2 = parseFloat(args[2]);

let result;

switch (operator) {
    case ''+'':
        result = num1 + num2;
        break;
    case ''-'':
        result = num1 - num2;
        break;
    case ''*'':
        result = num1 * num2;
        break;
    case ''/'':
        if (num2 === 0) {
            console.error(''Error: Division by zero'');
            process.exit(1);
        }
        result = num1 / num2;
        break;
    default:
        console.error(''Error: Invalid operator'');
        process.exit(1);
}

console.log(`${num1} ${operator} ${num2} = ${result}`);

// Example usage:
// node exercise-5.js 10 + 5
// node exercise-5.js 10 - 5
// node exercise-5.js 10 * 5
// node exercise-5.js 10 / 5
```

```javascript
// exercise-6.js
// Interactive script with readline
const readline = require(''readline'');

const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
});

rl.question(''What is your name? '', (name) => {
    console.log(`Hello, ${name}!`);
    
    rl.question(''What is your age? '', (age) => {
        console.log(`You are ${age} years old.`);
        
        rl.question(''What is your favorite color? '', (color) => {
            console.log(`Your favorite color is ${color}.`);
            rl.close();
        });
    });
});
```

```json
// package.json
{
  "name": "nodejs-basics",
  "version": "1.0.0",
  "description": "Node.js basics practice",
  "main": "exercise-1.js",
  "scripts": {
    "start": "node exercise-1.js",
    "process": "node exercise-2.js",
    "args": "node exercise-3.js",
    "env": "node exercise-4.js",
    "calc": "node exercise-5.js",
    "interactive": "node exercise-6.js"
  },
  "keywords": ["nodejs", "basics"],
  "author": "",
  "license": "ISC"
}
```

**Expected Output**:

```bash
# Run exercises
node exercise-1.js
# Output: Hello, Node.js! Current directory: ... Current file: ...

node exercise-2.js
# Output: Process information

node exercise-3.js arg1 arg2
# Output: Command line arguments

node exercise-4.js
# Output: Environment variables

node exercise-5.js 10 + 5
# Output: 10 + 5 = 15

node exercise-6.js
# Interactive prompts
```

**Challenge (Optional)**:
- Create more complex scripts
- Build a CLI tool
- Practice with REPL
- Explore Node.js documentation

---

## Common Mistakes

### 1. Using Browser APIs

```javascript
// ❌ Bad: Browser APIs don''t exist in Node.js
document.getElementById(''app'');
window.location;

// ✅ Good: Use Node.js APIs
const fs = require(''fs'');
const http = require(''http'');
```

### 2. Forgetting to Install Dependencies

```javascript
// ❌ Bad: Using module without installing
const express = require(''express'');

// ✅ Good: Install first
// npm install express
const express = require(''express'');
```

### 3. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = fs.readFileSync(''file.txt'', ''utf8'');

// ✅ Good: Handle errors
try {
    const data = fs.readFileSync(''file.txt'', ''utf8'');
} catch (error) {
    console.error(''Error reading file:'', error);
}
```

---

## Key Takeaways

1. **Node.js**: JavaScript runtime for server-side
2. **V8 Engine**: Powers Node.js
3. **Event-Driven**: Asynchronous, non-blocking
4. **No DOM**: No browser APIs
5. **Global Objects**: global, process, __dirname, __filename
6. **REPL**: Interactive JavaScript environment
7. **Best Practice**: Use Node.js APIs, handle errors, install dependencies

---

## Quiz: Node.js Introduction

Test your understanding with these questions:

1. **Node.js is:**
   - A) JavaScript runtime
   - B) JavaScript framework
   - C) Both
   - D) Neither

2. **Node.js uses:**
   - A) V8 engine
   - B) SpiderMonkey
   - C) Both
   - D) Neither

3. **Node.js has:**
   - A) DOM
   - B) No DOM
   - C) Both
   - D) Neither

4. **Global object in Node.js:**
   - A) window
   - B) global
   - C) Both
   - D) Neither

5. **REPL stands for:**
   - A) Read-Eval-Print Loop
   - B) Run-Execute-Print Loop
   - C) Both
   - D) Neither

6. **Node.js is:**
   - A) Single-threaded
   - B) Multi-threaded
   - C) Both
   - D) Neither

7. **Package manager for Node.js:**
   - A) npm
   - B) yarn
   - C) Both
   - D) Neither

**Answers**:
1. A) JavaScript runtime
2. A) V8 engine
3. B) No DOM
4. B) global
5. A) Read-Eval-Print Loop
6. A) Single-threaded (with event loop)
7. C) Both (npm is default, yarn is alternative)

---

## Next Steps

Congratulations! You''ve learned Node.js introduction. You now know:
- What Node.js is
- Differences from browser JavaScript
- How to install Node.js
- How to use REPL

**What''s Next?**
- Lesson 28.2: Node.js Modules
- Learn CommonJS modules
- Understand core modules
- Work with npm modules

---

## Additional Resources

- **Node.js Documentation**: [nodejs.org/docs](https://nodejs.org/docs)
- **Node.js API**: [nodejs.org/api](https://nodejs.org/api)
- **npm Documentation**: [docs.npmjs.com](https://docs.npmjs.com)
- **nvm**: [github.com/nvm-sh/nvm](https://github.com/nvm-sh/nvm)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:13:14', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand what Node.js is
- Know the differences between Node.js and browser JavaScript
- Install Node.js
- Use the REPL
- Run Node.js applications
- Understand Node.js fundamentals
- Write server-side JavaScript');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (184, 68, 17, 'Node.js Modules and File System', 'nodejs-modules-and-file-system', '# Lesson 28.2: Node.js Modules

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand CommonJS modules
- Use core Node.js modules
- Work with npm modules
- Understand module patterns
- Create and use custom modules
- Organize code with modules
- Build modular applications

---

## Introduction to Modules

Modules are reusable pieces of code that can be imported and used in other files. Node.js uses a module system to organize code.

### Why Modules?

- **Code Organization**: Split code into logical units
- **Reusability**: Use code in multiple places
- **Namespace**: Avoid global variable pollution
- **Maintainability**: Easier to maintain and test
- **Dependency Management**: Clear dependencies

---

## CommonJS Modules

### What is CommonJS?

CommonJS is the module system used by Node.js. It uses `require()` and `module.exports`.

### Exporting Modules

```javascript
// math.js
// Export single value
module.exports = function add(a, b) {
    return a + b;
};

// Export object
module.exports = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => a / b
};

// Export using exports
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
```

### Importing Modules

```javascript
// app.js
// Import single value
const add = require(''./math'');
console.log(add(2, 3));

// Import object
const math = require(''./math'');
console.log(math.add(2, 3));
console.log(math.subtract(5, 2));

// Destructure import
const { add, subtract } = require(''./math'');
console.log(add(2, 3));
```

### Module Caching

```javascript
// Modules are cached after first require
// Subsequent requires return cached version
const module1 = require(''./math'');
const module2 = require(''./math'');
// module1 === module2 (same instance)
```

---

## Core Modules

### What are Core Modules?

Core modules are built-in Node.js modules that don''t require installation.

### Common Core Modules

```javascript
// File System
const fs = require(''fs'');

// Path
const path = require(''path'');

// HTTP
const http = require(''http'');
const https = require(''https'');

// URL
const url = require(''url'');

// Events
const events = require(''events'');

// Stream
const stream = require(''stream'');

// Crypto
const crypto = require(''crypto'');

// OS
const os = require(''os'');

// Process
const process = require(''process'');

// Buffer
const buffer = require(''buffer'');
```

### fs Module (File System)

```javascript
const fs = require(''fs'');

// Read file synchronously
const data = fs.readFileSync(''file.txt'', ''utf8'');

// Read file asynchronously
fs.readFile(''file.txt'', ''utf8'', (err, data) => {
    if (err) {
        console.error(err);
        return;
    }
    console.log(data);
});

// Write file
fs.writeFileSync(''output.txt'', ''Hello, World!'');

// Check if file exists
if (fs.existsSync(''file.txt'')) {
    console.log(''File exists'');
}
```

### path Module

```javascript
const path = require(''path'');

// Join paths
const fullPath = path.join(__dirname, ''data'', ''file.txt'');

// Get directory name
const dir = path.dirname(''/users/john/file.txt'');
// ''/users/john''

// Get file name
const filename = path.basename(''/users/john/file.txt'');
// ''file.txt''

// Get extension
const ext = path.extname(''file.txt'');
// ''.txt''

// Parse path
const parsed = path.parse(''/users/john/file.txt'');
// { root: ''/'', dir: ''/users/john'', base: ''file.txt'', ext: ''.txt'', name: ''file'' }

// Resolve path
const resolved = path.resolve(''data'', ''file.txt'');
```

### http Module

```javascript
const http = require(''http'');

// Create server
const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

server.listen(3000, () => {
    console.log(''Server running on port 3000'');
});
```

### url Module

```javascript
const url = require(''url'');

// Parse URL
const parsedUrl = url.parse(''https://example.com/path?query=value'');
console.log(parsedUrl.hostname);  // ''example.com''
console.log(parsedUrl.pathname);  // ''/path''
console.log(parsedUrl.query);     // ''query=value''

// Create URL
const myUrl = new URL(''https://example.com/path?query=value'');
console.log(myUrl.searchParams.get(''query''));  // ''value''
```

### os Module

```javascript
const os = require(''os'');

console.log(os.platform());      // ''darwin'', ''win32'', ''linux''
console.log(os.arch());          // ''x64'', ''arm64''
console.log(os.cpus());          // CPU information
console.log(os.totalmem());      // Total memory
console.log(os.freemem());       // Free memory
console.log(os.homedir());       // Home directory
console.log(os.hostname());      // Hostname
```

### crypto Module

```javascript
const crypto = require(''crypto'');

// Create hash
const hash = crypto.createHash(''sha256'');
hash.update(''Hello, World!'');
console.log(hash.digest(''hex''));

// Generate random bytes
const randomBytes = crypto.randomBytes(16);
console.log(randomBytes.toString(''hex''));
```

---

## npm Modules

### What is npm?

npm (Node Package Manager) is the package manager for Node.js. It allows you to install and manage third-party modules.

### Installing Packages

```bash
# Install package
npm install express

# Install as dev dependency
npm install --save-dev nodemon

# Install globally
npm install -g nodemon

# Install specific version
npm install express@4.18.0

# Install from package.json
npm install
```

### package.json

```json
{
  "name": "my-app",
  "version": "1.0.0",
  "description": "My application",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
  },
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  }
}
```

### Using npm Modules

```javascript
// Install: npm install express
const express = require(''express'');
const app = express();

app.get(''/'', (req, res) => {
    res.send(''Hello, World!'');
});

app.listen(3000);
```

### Popular npm Modules

```javascript
// Web framework
const express = require(''express'');

// Database
const mongoose = require(''mongoose'');
const mysql = require(''mysql2'');

// Validation
const joi = require(''joi'');

// Environment variables
require(''dotenv'').config();

// HTTP client
const axios = require(''axios'');

// File upload
const multer = require(''multer'');

// Authentication
const jwt = require(''jsonwebtoken'');
const bcrypt = require(''bcrypt'');
```

---

## Module Patterns

### Pattern 1: Single Export

```javascript
// calculator.js
module.exports = function calculate(a, b, operation) {
    switch (operation) {
        case ''add'':
            return a + b;
        case ''subtract'':
            return a - b;
        case ''multiply'':
            return a * b;
        case ''divide'':
            return a / b;
        default:
            throw new Error(''Invalid operation'');
    }
};

// app.js
const calculate = require(''./calculator'');
console.log(calculate(10, 5, ''add''));
```

### Pattern 2: Multiple Exports

```javascript
// utils.js
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => a / b;

// app.js
const { add, subtract } = require(''./utils'');
console.log(add(2, 3));
```

### Pattern 3: Class Export

```javascript
// User.js
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    greet() {
        return `Hello, ${this.name}!`;
    }
}

module.exports = User;

// app.js
const User = require(''./User'');
const user = new User(''Alice'', ''alice@example.com'');
console.log(user.greet());
```

### Pattern 4: Factory Function

```javascript
// createUser.js
module.exports = function createUser(name, email) {
    return {
        name,
        email,
        greet() {
            return `Hello, ${this.name}!`;
        }
    };
};

// app.js
const createUser = require(''./createUser'');
const user = createUser(''Alice'', ''alice@example.com'');
console.log(user.greet());
```

### Pattern 5: Singleton

```javascript
// config.js
let instance = null;

class Config {
    constructor() {
        if (instance) {
            return instance;
        }
        this.settings = {};
        instance = this;
    }
    
    set(key, value) {
        this.settings[key] = value;
    }
    
    get(key) {
        return this.settings[key];
    }
}

module.exports = new Config();

// app.js
const config = require(''./config'');
config.set(''port'', 3000);
console.log(config.get(''port''));
```

---

## Practice Exercise

### Exercise: Working with Modules

**Objective**: Practice creating modules, using core modules, installing npm modules, and applying module patterns.

**Instructions**:

1. Create Node.js modules
2. Use core modules
3. Install and use npm modules
4. Practice:
   - Creating custom modules
   - Using core modules
   - Installing npm packages
   - Applying module patterns

**Example Solution**:

```javascript
// src/utils/math.js
// Math utility module
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
};
```

```javascript
// src/utils/string.js
// String utility module
exports.capitalize = (str) => {
    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
};

exports.reverse = (str) => {
    return str.split('''').reverse().join('''');
};

exports.isPalindrome = (str) => {
    const cleaned = str.toLowerCase().replace(/[^a-z0-9]/g, '''');
    return cleaned === cleaned.split('''').reverse().join('''');
};
```

```javascript
// src/models/User.js
// User model module
class User {
    constructor(name, email) {
        this.id = Date.now();
        this.name = name;
        this.email = email;
        this.createdAt = new Date();
    }
    
    greet() {
        return `Hello, ${this.name}!`;
    }
    
    toJSON() {
        return {
            id: this.id,
            name: this.name,
            email: this.email,
            createdAt: this.createdAt
        };
    }
}

module.exports = User;
```

```javascript
// src/services/fileService.js
// File service using fs module
const fs = require(''fs'');
const path = require(''path'');

class FileService {
    readFile(filePath) {
        try {
            const fullPath = path.resolve(filePath);
            return fs.readFileSync(fullPath, ''utf8'');
        } catch (error) {
            throw new Error(`Error reading file: ${error.message}`);
        }
    }
    
    writeFile(filePath, data) {
        try {
            const fullPath = path.resolve(filePath);
            fs.writeFileSync(fullPath, data, ''utf8'');
            return true;
        } catch (error) {
            throw new Error(`Error writing file: ${error.message}`);
        }
    }
    
    fileExists(filePath) {
        const fullPath = path.resolve(filePath);
        return fs.existsSync(fullPath);
    }
    
    getFileInfo(filePath) {
        const fullPath = path.resolve(filePath);
        if (!fs.existsSync(fullPath)) {
            throw new Error(''File does not exist'');
        }
        
        const stats = fs.statSync(fullPath);
        return {
            path: fullPath,
            size: stats.size,
            created: stats.birthtime,
            modified: stats.mtime,
            isFile: stats.isFile(),
            isDirectory: stats.isDirectory()
        };
    }
}

module.exports = new FileService();
```

```javascript
// src/config/config.js
// Configuration module (singleton pattern)
const os = require(''os'');
const path = require(''path'');

class Config {
    constructor() {
        this.env = process.env.NODE_ENV || ''development'';
        this.port = process.env.PORT || 3000;
        this.host = process.env.HOST || ''localhost'';
        this.platform = os.platform();
        this.homeDir = os.homedir();
        this.appDir = __dirname;
    }
    
    get(key) {
        return this[key] || process.env[key];
    }
    
    set(key, value) {
        this[key] = value;
    }
    
    isDevelopment() {
        return this.env === ''development'';
    }
    
    isProduction() {
        return this.env === ''production'';
    }
}

module.exports = new Config();
```

```javascript
// src/app.js
// Main application using all modules
const math = require(''./utils/math'');
const string = require(''./utils/string'');
const User = require(''./models/User'');
const fileService = require(''./services/fileService'');
const config = require(''./config/config'');

console.log(''=== Math Utilities ==='');
console.log(''Add:'', math.add(10, 5));
console.log(''Subtract:'', math.subtract(10, 5));
console.log(''Multiply:'', math.multiply(10, 5));
console.log(''Divide:'', math.divide(10, 5));

console.log(''\\n=== String Utilities ==='');
console.log(''Capitalize:'', string.capitalize(''hello''));
console.log(''Reverse:'', string.reverse(''hello''));
console.log(''Is Palindrome:'', string.isPalindrome(''racecar''));

console.log(''\\n=== User Model ==='');
const user = new User(''Alice'', ''alice@example.com'');
console.log(user.greet());
console.log(''User JSON:'', JSON.stringify(user.toJSON(), null, 2));

console.log(''\\n=== File Service ==='');
try {
    // Create a test file
    const testFile = ''test.txt'';
    fileService.writeFile(testFile, ''Hello, World!'');
    console.log(''File written:'', testFile);
    
    // Read the file
    const content = fileService.readFile(testFile);
    console.log(''File content:'', content);
    
    // Get file info
    const info = fileService.getFileInfo(testFile);
    console.log(''File info:'', info);
} catch (error) {
    console.error(''File error:'', error.message);
}

console.log(''\\n=== Configuration ==='');
console.log(''Environment:'', config.env);
console.log(''Port:'', config.port);
console.log(''Platform:'', config.platform);
console.log(''Is Development:'', config.isDevelopment());
```

```json
// package.json
{
  "name": "nodejs-modules-practice",
  "version": "1.0.0",
  "description": "Node.js modules practice",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "test": "echo \\"Error: no test specified\\" && exit 1"
  },
  "keywords": ["nodejs", "modules"],
  "author": "",
  "license": "ISC"
}
```

**Expected Output**:

```bash
node src/app.js

=== Math Utilities ===
Add: 15
Subtract: 5
Multiply: 50
Divide: 2

=== String Utilities ===
Capitalize: Hello
Reverse: olleh
Is Palindrome: true

=== User Model ===
Hello, Alice!
User JSON: {
  "id": 1234567890,
  "name": "Alice",
  "email": "alice@example.com",
  "createdAt": "2024-01-01T00:00:00.000Z"
}

=== File Service ===
File written: test.txt
File content: Hello, World!
File info: { path: ''...'', size: 13, ... }

=== Configuration ===
Environment: development
Port: 3000
Platform: darwin
Is Development: true
```

**Challenge (Optional)**:
- Create more modules
- Build a complete application
- Use more core modules
- Install and use npm packages

---

## Common Mistakes

### 1. Circular Dependencies

```javascript
// ❌ Bad: Circular dependency
// a.js
const b = require(''./b'');
module.exports = { a: ''A'' };

// b.js
const a = require(''./a'');
module.exports = { b: ''B'' };

// ✅ Good: Avoid circular dependencies
// Use dependency injection or restructure
```

### 2. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = fs.readFileSync(''file.txt'', ''utf8'');

// ✅ Good: Handle errors
try {
    const data = fs.readFileSync(''file.txt'', ''utf8'');
} catch (error) {
    console.error(''Error:'', error.message);
}
```

### 3. Using Wrong Path

```javascript
// ❌ Bad: Relative path issues
const module = require(''./module'');

// ✅ Good: Use path.resolve or absolute paths
const path = require(''path'');
const module = require(path.resolve(__dirname, ''module''));
```

---

## Key Takeaways

1. **CommonJS**: Module system used by Node.js
2. **require()**: Import modules
3. **module.exports**: Export modules
4. **Core Modules**: Built-in Node.js modules
5. **npm Modules**: Third-party packages
6. **Module Patterns**: Different ways to structure modules
7. **Best Practice**: Avoid circular dependencies, handle errors, use proper paths

---

## Quiz: Node.js Modules

Test your understanding with these questions:

1. **CommonJS uses:**
   - A) require() and module.exports
   - B) import and export
   - C) Both
   - D) Neither

2. **Core modules:**
   - A) Built-in
   - B) Need installation
   - C) Both
   - D) Neither

3. **npm modules:**
   - A) Built-in
   - B) Need installation
   - C) Both
   - D) Neither

4. **Modules are:**
   - A) Cached
   - B) Not cached
   - C) Both
   - D) Neither

5. **module.exports:**
   - A) Export module
   - B) Import module
   - C) Both
   - D) Neither

6. **require():**
   - A) Export module
   - B) Import module
   - C) Both
   - D) Neither

7. **Circular dependencies:**
   - A) Good practice
   - B) Should avoid
   - C) Both
   - D) Neither

**Answers**:
1. A) require() and module.exports
2. A) Built-in
3. B) Need installation
4. A) Cached
5. A) Export module
6. B) Import module
7. B) Should avoid

---

## Next Steps

Congratulations! You''ve learned Node.js modules. You now know:
- How to use CommonJS modules
- How to use core modules
- How to work with npm modules
- How to apply module patterns

**What''s Next?**
- Lesson 28.3: File System Operations
- Learn reading and writing files
- Work with directories
- Understand streams

---

## Additional Resources

- **Node.js Modules**: [nodejs.org/api/modules.html](https://nodejs.org/api/modules.html)
- **Core Modules**: [nodejs.org/api](https://nodejs.org/api)
- **npm**: [docs.npmjs.com](https://docs.npmjs.com)
- **CommonJS**: [nodejs.org/api/modules.html#modules-commonjs-modules](https://nodejs.org/api/modules.html#modules-commonjs-modules)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:13:14', '2026-01-03 10:13:14', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand CommonJS modules
- Use core Node.js modules
- Work with npm modules
- Understand module patterns
- Create and use custom modules
- Organize code with modules
- Build modular applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (190, 68, 17, 'Node.js Modules', 'nodejs-modules', '# Lesson 28.2: Node.js Modules

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand CommonJS modules
- Use core Node.js modules
- Work with npm modules
- Understand module patterns
- Create and use custom modules
- Organize code with modules
- Build modular applications

---

## Introduction to Modules

Modules are reusable pieces of code that can be imported and used in other files. Node.js uses a module system to organize code.

### Why Modules?

- **Code Organization**: Split code into logical units
- **Reusability**: Use code in multiple places
- **Namespace**: Avoid global variable pollution
- **Maintainability**: Easier to maintain and test
- **Dependency Management**: Clear dependencies

---

## CommonJS Modules

### What is CommonJS?

CommonJS is the module system used by Node.js. It uses `require()` and `module.exports`.

### Exporting Modules

```javascript
// math.js
// Export single value
module.exports = function add(a, b) {
    return a + b;
};

// Export object
module.exports = {
    add: (a, b) => a + b,
    subtract: (a, b) => a - b,
    multiply: (a, b) => a * b,
    divide: (a, b) => a / b
};

// Export using exports
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
```

### Importing Modules

```javascript
// app.js
// Import single value
const add = require(''./math'');
console.log(add(2, 3));

// Import object
const math = require(''./math'');
console.log(math.add(2, 3));
console.log(math.subtract(5, 2));

// Destructure import
const { add, subtract } = require(''./math'');
console.log(add(2, 3));
```

### Module Caching

```javascript
// Modules are cached after first require
// Subsequent requires return cached version
const module1 = require(''./math'');
const module2 = require(''./math'');
// module1 === module2 (same instance)
```

---

## Core Modules

### What are Core Modules?

Core modules are built-in Node.js modules that don''t require installation.

### Common Core Modules

```javascript
// File System
const fs = require(''fs'');

// Path
const path = require(''path'');

// HTTP
const http = require(''http'');
const https = require(''https'');

// URL
const url = require(''url'');

// Events
const events = require(''events'');

// Stream
const stream = require(''stream'');

// Crypto
const crypto = require(''crypto'');

// OS
const os = require(''os'');

// Process
const process = require(''process'');

// Buffer
const buffer = require(''buffer'');
```

### fs Module (File System)

```javascript
const fs = require(''fs'');

// Read file synchronously
const data = fs.readFileSync(''file.txt'', ''utf8'');

// Read file asynchronously
fs.readFile(''file.txt'', ''utf8'', (err, data) => {
    if (err) {
        console.error(err);
        return;
    }
    console.log(data);
});

// Write file
fs.writeFileSync(''output.txt'', ''Hello, World!'');

// Check if file exists
if (fs.existsSync(''file.txt'')) {
    console.log(''File exists'');
}
```

### path Module

```javascript
const path = require(''path'');

// Join paths
const fullPath = path.join(__dirname, ''data'', ''file.txt'');

// Get directory name
const dir = path.dirname(''/users/john/file.txt'');
// ''/users/john''

// Get file name
const filename = path.basename(''/users/john/file.txt'');
// ''file.txt''

// Get extension
const ext = path.extname(''file.txt'');
// ''.txt''

// Parse path
const parsed = path.parse(''/users/john/file.txt'');
// { root: ''/'', dir: ''/users/john'', base: ''file.txt'', ext: ''.txt'', name: ''file'' }

// Resolve path
const resolved = path.resolve(''data'', ''file.txt'');
```

### http Module

```javascript
const http = require(''http'');

// Create server
const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

server.listen(3000, () => {
    console.log(''Server running on port 3000'');
});
```

### url Module

```javascript
const url = require(''url'');

// Parse URL
const parsedUrl = url.parse(''https://example.com/path?query=value'');
console.log(parsedUrl.hostname);  // ''example.com''
console.log(parsedUrl.pathname);  // ''/path''
console.log(parsedUrl.query);     // ''query=value''

// Create URL
const myUrl = new URL(''https://example.com/path?query=value'');
console.log(myUrl.searchParams.get(''query''));  // ''value''
```

### os Module

```javascript
const os = require(''os'');

console.log(os.platform());      // ''darwin'', ''win32'', ''linux''
console.log(os.arch());          // ''x64'', ''arm64''
console.log(os.cpus());          // CPU information
console.log(os.totalmem());      // Total memory
console.log(os.freemem());       // Free memory
console.log(os.homedir());       // Home directory
console.log(os.hostname());      // Hostname
```

### crypto Module

```javascript
const crypto = require(''crypto'');

// Create hash
const hash = crypto.createHash(''sha256'');
hash.update(''Hello, World!'');
console.log(hash.digest(''hex''));

// Generate random bytes
const randomBytes = crypto.randomBytes(16);
console.log(randomBytes.toString(''hex''));
```

---

## npm Modules

### What is npm?

npm (Node Package Manager) is the package manager for Node.js. It allows you to install and manage third-party modules.

### Installing Packages

```bash
# Install package
npm install express

# Install as dev dependency
npm install --save-dev nodemon

# Install globally
npm install -g nodemon

# Install specific version
npm install express@4.18.0

# Install from package.json
npm install
```

### package.json

```json
{
  "name": "my-app",
  "version": "1.0.0",
  "description": "My application",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "dev": "nodemon index.js"
  },
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  }
}
```

### Using npm Modules

```javascript
// Install: npm install express
const express = require(''express'');
const app = express();

app.get(''/'', (req, res) => {
    res.send(''Hello, World!'');
});

app.listen(3000);
```

### Popular npm Modules

```javascript
// Web framework
const express = require(''express'');

// Database
const mongoose = require(''mongoose'');
const mysql = require(''mysql2'');

// Validation
const joi = require(''joi'');

// Environment variables
require(''dotenv'').config();

// HTTP client
const axios = require(''axios'');

// File upload
const multer = require(''multer'');

// Authentication
const jwt = require(''jsonwebtoken'');
const bcrypt = require(''bcrypt'');
```

---

## Module Patterns

### Pattern 1: Single Export

```javascript
// calculator.js
module.exports = function calculate(a, b, operation) {
    switch (operation) {
        case ''add'':
            return a + b;
        case ''subtract'':
            return a - b;
        case ''multiply'':
            return a * b;
        case ''divide'':
            return a / b;
        default:
            throw new Error(''Invalid operation'');
    }
};

// app.js
const calculate = require(''./calculator'');
console.log(calculate(10, 5, ''add''));
```

### Pattern 2: Multiple Exports

```javascript
// utils.js
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => a / b;

// app.js
const { add, subtract } = require(''./utils'');
console.log(add(2, 3));
```

### Pattern 3: Class Export

```javascript
// User.js
class User {
    constructor(name, email) {
        this.name = name;
        this.email = email;
    }
    
    greet() {
        return `Hello, ${this.name}!`;
    }
}

module.exports = User;

// app.js
const User = require(''./User'');
const user = new User(''Alice'', ''alice@example.com'');
console.log(user.greet());
```

### Pattern 4: Factory Function

```javascript
// createUser.js
module.exports = function createUser(name, email) {
    return {
        name,
        email,
        greet() {
            return `Hello, ${this.name}!`;
        }
    };
};

// app.js
const createUser = require(''./createUser'');
const user = createUser(''Alice'', ''alice@example.com'');
console.log(user.greet());
```

### Pattern 5: Singleton

```javascript
// config.js
let instance = null;

class Config {
    constructor() {
        if (instance) {
            return instance;
        }
        this.settings = {};
        instance = this;
    }
    
    set(key, value) {
        this.settings[key] = value;
    }
    
    get(key) {
        return this.settings[key];
    }
}

module.exports = new Config();

// app.js
const config = require(''./config'');
config.set(''port'', 3000);
console.log(config.get(''port''));
```

---

## Practice Exercise

### Exercise: Working with Modules

**Objective**: Practice creating modules, using core modules, installing npm modules, and applying module patterns.

**Instructions**:

1. Create Node.js modules
2. Use core modules
3. Install and use npm modules
4. Practice:
   - Creating custom modules
   - Using core modules
   - Installing npm packages
   - Applying module patterns

**Example Solution**:

```javascript
// src/utils/math.js
// Math utility module
exports.add = (a, b) => a + b;
exports.subtract = (a, b) => a - b;
exports.multiply = (a, b) => a * b;
exports.divide = (a, b) => {
    if (b === 0) {
        throw new Error(''Division by zero'');
    }
    return a / b;
};
```

```javascript
// src/utils/string.js
// String utility module
exports.capitalize = (str) => {
    return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();
};

exports.reverse = (str) => {
    return str.split('''').reverse().join('''');
};

exports.isPalindrome = (str) => {
    const cleaned = str.toLowerCase().replace(/[^a-z0-9]/g, '''');
    return cleaned === cleaned.split('''').reverse().join('''');
};
```

```javascript
// src/models/User.js
// User model module
class User {
    constructor(name, email) {
        this.id = Date.now();
        this.name = name;
        this.email = email;
        this.createdAt = new Date();
    }
    
    greet() {
        return `Hello, ${this.name}!`;
    }
    
    toJSON() {
        return {
            id: this.id,
            name: this.name,
            email: this.email,
            createdAt: this.createdAt
        };
    }
}

module.exports = User;
```

```javascript
// src/services/fileService.js
// File service using fs module
const fs = require(''fs'');
const path = require(''path'');

class FileService {
    readFile(filePath) {
        try {
            const fullPath = path.resolve(filePath);
            return fs.readFileSync(fullPath, ''utf8'');
        } catch (error) {
            throw new Error(`Error reading file: ${error.message}`);
        }
    }
    
    writeFile(filePath, data) {
        try {
            const fullPath = path.resolve(filePath);
            fs.writeFileSync(fullPath, data, ''utf8'');
            return true;
        } catch (error) {
            throw new Error(`Error writing file: ${error.message}`);
        }
    }
    
    fileExists(filePath) {
        const fullPath = path.resolve(filePath);
        return fs.existsSync(fullPath);
    }
    
    getFileInfo(filePath) {
        const fullPath = path.resolve(filePath);
        if (!fs.existsSync(fullPath)) {
            throw new Error(''File does not exist'');
        }
        
        const stats = fs.statSync(fullPath);
        return {
            path: fullPath,
            size: stats.size,
            created: stats.birthtime,
            modified: stats.mtime,
            isFile: stats.isFile(),
            isDirectory: stats.isDirectory()
        };
    }
}

module.exports = new FileService();
```

```javascript
// src/config/config.js
// Configuration module (singleton pattern)
const os = require(''os'');
const path = require(''path'');

class Config {
    constructor() {
        this.env = process.env.NODE_ENV || ''development'';
        this.port = process.env.PORT || 3000;
        this.host = process.env.HOST || ''localhost'';
        this.platform = os.platform();
        this.homeDir = os.homedir();
        this.appDir = __dirname;
    }
    
    get(key) {
        return this[key] || process.env[key];
    }
    
    set(key, value) {
        this[key] = value;
    }
    
    isDevelopment() {
        return this.env === ''development'';
    }
    
    isProduction() {
        return this.env === ''production'';
    }
}

module.exports = new Config();
```

```javascript
// src/app.js
// Main application using all modules
const math = require(''./utils/math'');
const string = require(''./utils/string'');
const User = require(''./models/User'');
const fileService = require(''./services/fileService'');
const config = require(''./config/config'');

console.log(''=== Math Utilities ==='');
console.log(''Add:'', math.add(10, 5));
console.log(''Subtract:'', math.subtract(10, 5));
console.log(''Multiply:'', math.multiply(10, 5));
console.log(''Divide:'', math.divide(10, 5));

console.log(''\\n=== String Utilities ==='');
console.log(''Capitalize:'', string.capitalize(''hello''));
console.log(''Reverse:'', string.reverse(''hello''));
console.log(''Is Palindrome:'', string.isPalindrome(''racecar''));

console.log(''\\n=== User Model ==='');
const user = new User(''Alice'', ''alice@example.com'');
console.log(user.greet());
console.log(''User JSON:'', JSON.stringify(user.toJSON(), null, 2));

console.log(''\\n=== File Service ==='');
try {
    // Create a test file
    const testFile = ''test.txt'';
    fileService.writeFile(testFile, ''Hello, World!'');
    console.log(''File written:'', testFile);
    
    // Read the file
    const content = fileService.readFile(testFile);
    console.log(''File content:'', content);
    
    // Get file info
    const info = fileService.getFileInfo(testFile);
    console.log(''File info:'', info);
} catch (error) {
    console.error(''File error:'', error.message);
}

console.log(''\\n=== Configuration ==='');
console.log(''Environment:'', config.env);
console.log(''Port:'', config.port);
console.log(''Platform:'', config.platform);
console.log(''Is Development:'', config.isDevelopment());
```

```json
// package.json
{
  "name": "nodejs-modules-practice",
  "version": "1.0.0",
  "description": "Node.js modules practice",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "test": "echo \\"Error: no test specified\\" && exit 1"
  },
  "keywords": ["nodejs", "modules"],
  "author": "",
  "license": "ISC"
}
```

**Expected Output**:

```bash
node src/app.js

=== Math Utilities ===
Add: 15
Subtract: 5
Multiply: 50
Divide: 2

=== String Utilities ===
Capitalize: Hello
Reverse: olleh
Is Palindrome: true

=== User Model ===
Hello, Alice!
User JSON: {
  "id": 1234567890,
  "name": "Alice",
  "email": "alice@example.com",
  "createdAt": "2024-01-01T00:00:00.000Z"
}

=== File Service ===
File written: test.txt
File content: Hello, World!
File info: { path: ''...'', size: 13, ... }

=== Configuration ===
Environment: development
Port: 3000
Platform: darwin
Is Development: true
```

**Challenge (Optional)**:
- Create more modules
- Build a complete application
- Use more core modules
- Install and use npm packages

---

## Common Mistakes

### 1. Circular Dependencies

```javascript
// ❌ Bad: Circular dependency
// a.js
const b = require(''./b'');
module.exports = { a: ''A'' };

// b.js
const a = require(''./a'');
module.exports = { b: ''B'' };

// ✅ Good: Avoid circular dependencies
// Use dependency injection or restructure
```

### 2. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = fs.readFileSync(''file.txt'', ''utf8'');

// ✅ Good: Handle errors
try {
    const data = fs.readFileSync(''file.txt'', ''utf8'');
} catch (error) {
    console.error(''Error:'', error.message);
}
```

### 3. Using Wrong Path

```javascript
// ❌ Bad: Relative path issues
const module = require(''./module'');

// ✅ Good: Use path.resolve or absolute paths
const path = require(''path'');
const module = require(path.resolve(__dirname, ''module''));
```

---

## Key Takeaways

1. **CommonJS**: Module system used by Node.js
2. **require()**: Import modules
3. **module.exports**: Export modules
4. **Core Modules**: Built-in Node.js modules
5. **npm Modules**: Third-party packages
6. **Module Patterns**: Different ways to structure modules
7. **Best Practice**: Avoid circular dependencies, handle errors, use proper paths

---

## Quiz: Node.js Modules

Test your understanding with these questions:

1. **CommonJS uses:**
   - A) require() and module.exports
   - B) import and export
   - C) Both
   - D) Neither

2. **Core modules:**
   - A) Built-in
   - B) Need installation
   - C) Both
   - D) Neither

3. **npm modules:**
   - A) Built-in
   - B) Need installation
   - C) Both
   - D) Neither

4. **Modules are:**
   - A) Cached
   - B) Not cached
   - C) Both
   - D) Neither

5. **module.exports:**
   - A) Export module
   - B) Import module
   - C) Both
   - D) Neither

6. **require():**
   - A) Export module
   - B) Import module
   - C) Both
   - D) Neither

7. **Circular dependencies:**
   - A) Good practice
   - B) Should avoid
   - C) Both
   - D) Neither

**Answers**:
1. A) require() and module.exports
2. A) Built-in
3. B) Need installation
4. A) Cached
5. A) Export module
6. B) Import module
7. B) Should avoid

---

## Next Steps

Congratulations! You''ve learned Node.js modules. You now know:
- How to use CommonJS modules
- How to use core modules
- How to work with npm modules
- How to apply module patterns

**What''s Next?**
- Lesson 28.3: File System Operations
- Learn reading and writing files
- Work with directories
- Understand streams

---

## Additional Resources

- **Node.js Modules**: [nodejs.org/api/modules.html](https://nodejs.org/api/modules.html)
- **Core Modules**: [nodejs.org/api](https://nodejs.org/api)
- **npm**: [docs.npmjs.com](https://docs.npmjs.com)
- **CommonJS**: [nodejs.org/api/modules.html#modules-commonjs-modules](https://nodejs.org/api/modules.html#modules-commonjs-modules)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:13:54', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand CommonJS modules
- Use core Node.js modules
- Work with npm modules
- Understand module patterns
- Create and use custom modules
- Organize code with modules
- Build modular applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (191, 68, 17, 'File System Operations', 'file-system-operations', '# Lesson 28.3: File System Operations

## Learning Objectives

By the end of this lesson, you will be able to:
- Read files synchronously and asynchronously
- Write files synchronously and asynchronously
- Work with directories
- Understand streams
- Handle file operations
- Process file data
- Build file-based applications

---

## Introduction to File System

The `fs` module provides an API for interacting with the file system. It supports both synchronous and asynchronous operations.

### File System Operations

- **Reading Files**: Read file contents
- **Writing Files**: Write data to files
- **Directory Operations**: Create, read, delete directories
- **File Metadata**: Get file information
- **Watching Files**: Monitor file changes
- **Streams**: Handle large files efficiently

---

## Reading Files

### Synchronous Reading

```javascript
const fs = require(''fs'');

// Read file synchronously
try {
    const data = fs.readFileSync(''file.txt'', ''utf8'');
    console.log(data);
} catch (error) {
    console.error(''Error reading file:'', error);
}

// Read binary file
const buffer = fs.readFileSync(''image.jpg'');
console.log(buffer);
```

### Asynchronous Reading

```javascript
const fs = require(''fs'');

// Read file asynchronously (callback)
fs.readFile(''file.txt'', ''utf8'', (err, data) => {
    if (err) {
        console.error(''Error reading file:'', err);
        return;
    }
    console.log(data);
});

// Read file with promises
const fs = require(''fs'').promises;

async function readFile() {
    try {
        const data = await fs.readFile(''file.txt'', ''utf8'');
        console.log(data);
    } catch (error) {
        console.error(''Error reading file:'', error);
    }
}

readFile();
```

### Reading Options

```javascript
const fs = require(''fs'');

// Read with options
fs.readFile(''file.txt'', {
    encoding: ''utf8'',
    flag: ''r''  // read mode
}, (err, data) => {
    if (err) throw err;
    console.log(data);
});

// Flags:
// ''r'' - Open file for reading
// ''r+'' - Open file for reading and writing
// ''w'' - Open file for writing (truncate)
// ''w+'' - Open file for reading and writing (truncate)
// ''a'' - Open file for appending
// ''a+'' - Open file for reading and appending
```

---

## Writing Files

### Synchronous Writing

```javascript
const fs = require(''fs'');

// Write file synchronously
try {
    fs.writeFileSync(''output.txt'', ''Hello, World!'', ''utf8'');
    console.log(''File written successfully'');
} catch (error) {
    console.error(''Error writing file:'', error);
}

// Append to file
fs.appendFileSync(''output.txt'', ''\\nNew line'', ''utf8'');
```

### Asynchronous Writing

```javascript
const fs = require(''fs'');

// Write file asynchronously (callback)
fs.writeFile(''output.txt'', ''Hello, World!'', ''utf8'', (err) => {
    if (err) {
        console.error(''Error writing file:'', err);
        return;
    }
    console.log(''File written successfully'');
});

// Write with promises
const fs = require(''fs'').promises;

async function writeFile() {
    try {
        await fs.writeFile(''output.txt'', ''Hello, World!'', ''utf8'');
        console.log(''File written successfully'');
    } catch (error) {
        console.error(''Error writing file:'', error);
    }
}

writeFile();
```

### Writing Options

```javascript
const fs = require(''fs'');

// Write with options
fs.writeFile(''output.txt'', ''Hello, World!'', {
    encoding: ''utf8'',
    mode: 0o666,  // File permissions
    flag: ''w''     // Write mode
}, (err) => {
    if (err) throw err;
    console.log(''File written'');
});
```

---

## Working with Directories

### Creating Directories

```javascript
const fs = require(''fs'');
const path = require(''path'');

// Create directory synchronously
try {
    fs.mkdirSync(''new-directory'');
    console.log(''Directory created'');
} catch (error) {
    console.error(''Error creating directory:'', error);
}

// Create directory asynchronously
fs.mkdir(''new-directory'', (err) => {
    if (err) {
        console.error(''Error creating directory:'', err);
        return;
    }
    console.log(''Directory created'');
});

// Create nested directories
fs.mkdirSync(''parent/child/grandchild'', { recursive: true });
```

### Reading Directories

```javascript
const fs = require(''fs'');

// Read directory synchronously
try {
    const files = fs.readdirSync(''.'');
    console.log(''Files:'', files);
} catch (error) {
    console.error(''Error reading directory:'', error);
}

// Read directory asynchronously
fs.readdir(''.'', (err, files) => {
    if (err) {
        console.error(''Error reading directory:'', err);
        return;
    }
    console.log(''Files:'', files);
});

// Read with file types
fs.readdir(''.'', { withFileTypes: true }, (err, files) => {
    if (err) throw err;
    files.forEach(file => {
        console.log(file.name, file.isFile() ? ''file'' : ''directory'');
    });
});
```

### Removing Directories

```javascript
const fs = require(''fs'');

// Remove directory synchronously
try {
    fs.rmdirSync(''directory'');
    console.log(''Directory removed'');
} catch (error) {
    console.error(''Error removing directory:'', error);
}

// Remove directory asynchronously
fs.rmdir(''directory'', (err) => {
    if (err) {
        console.error(''Error removing directory:'', err);
        return;
    }
    console.log(''Directory removed'');
});

// Remove directory recursively (Node.js 14.14.0+)
fs.rmSync(''directory'', { recursive: true, force: true });
```

### File and Directory Information

```javascript
const fs = require(''fs'');

// Get file stats synchronously
try {
    const stats = fs.statSync(''file.txt'');
    console.log(''Is file:'', stats.isFile());
    console.log(''Is directory:'', stats.isDirectory());
    console.log(''Size:'', stats.size);
    console.log(''Created:'', stats.birthtime);
    console.log(''Modified:'', stats.mtime);
} catch (error) {
    console.error(''Error getting stats:'', error);
}

// Get file stats asynchronously
fs.stat(''file.txt'', (err, stats) => {
    if (err) {
        console.error(''Error getting stats:'', err);
        return;
    }
    console.log(''Stats:'', stats);
});
```

---

## Streams

### What are Streams?

Streams are objects that let you read data from a source or write data to a destination in a continuous fashion. They''re useful for handling large files.

### Reading Streams

```javascript
const fs = require(''fs'');

// Create read stream
const readStream = fs.createReadStream(''large-file.txt'', ''utf8'');

// Read data in chunks
readStream.on(''data'', (chunk) => {
    console.log(''Chunk received:'', chunk.length);
    // Process chunk
});

// Handle end
readStream.on(''end'', () => {
    console.log(''File read complete'');
});

// Handle errors
readStream.on(''error'', (err) => {
    console.error(''Error reading stream:'', err);
});
```

### Writing Streams

```javascript
const fs = require(''fs'');

// Create write stream
const writeStream = fs.createWriteStream(''output.txt'', ''utf8'');

// Write data
writeStream.write(''Hello, '');
writeStream.write(''World!'');
writeStream.end();

// Handle finish
writeStream.on(''finish'', () => {
    console.log(''File write complete'');
});

// Handle errors
writeStream.on(''error'', (err) => {
    console.error(''Error writing stream:'', err);
});
```

### Piping Streams

```javascript
const fs = require(''fs'');

// Pipe read stream to write stream
const readStream = fs.createReadStream(''input.txt'');
const writeStream = fs.createWriteStream(''output.txt'');

readStream.pipe(writeStream);

// Handle completion
writeStream.on(''finish'', () => {
    console.log(''File copied'');
});

// Handle errors
readStream.on(''error'', (err) => {
    console.error(''Read error:'', err);
});

writeStream.on(''error'', (err) => {
    console.error(''Write error:'', err);
});
```

### Transform Streams

```javascript
const fs = require(''fs'');
const { Transform } = require(''stream'');

// Create transform stream
const upperCaseTransform = new Transform({
    transform(chunk, encoding, callback) {
        this.push(chunk.toString().toUpperCase());
        callback();
    }
});

// Use transform stream
const readStream = fs.createReadStream(''input.txt'');
const writeStream = fs.createWriteStream(''output.txt'');

readStream
    .pipe(upperCaseTransform)
    .pipe(writeStream);
```

---

## Practical Examples

### Example 1: File Copy

```javascript
const fs = require(''fs'');
const path = require(''path'');

function copyFile(source, destination) {
    return new Promise((resolve, reject) => {
        const readStream = fs.createReadStream(source);
        const writeStream = fs.createWriteStream(destination);
        
        readStream.pipe(writeStream);
        
        writeStream.on(''finish'', () => {
            resolve();
        });
        
        readStream.on(''error'', reject);
        writeStream.on(''error'', reject);
    });
}

// Usage
copyFile(''source.txt'', ''destination.txt'')
    .then(() => console.log(''File copied''))
    .catch(err => console.error(''Error:'', err));
```

### Example 2: Directory Walker

```javascript
const fs = require(''fs'');
const path = require(''path'');

function walkDirectory(dir, callback) {
    const files = fs.readdirSync(dir);
    
    files.forEach(file => {
        const filePath = path.join(dir, file);
        const stats = fs.statSync(filePath);
        
        if (stats.isDirectory()) {
            walkDirectory(filePath, callback);
        } else {
            callback(filePath);
        }
    });
}

// Usage
walkDirectory(''.'', (filePath) => {
    console.log(''File:'', filePath);
});
```

### Example 3: File Watcher

```javascript
const fs = require(''fs'');

// Watch file
fs.watchFile(''file.txt'', (curr, prev) => {
    console.log(''File changed'');
    console.log(''Current mtime:'', curr.mtime);
    console.log(''Previous mtime:'', prev.mtime);
});

// Watch directory
fs.watch(''.'', (eventType, filename) => {
    console.log(''Event type:'', eventType);
    console.log(''Filename:'', filename);
});
```

---

## Practice Exercise

### Exercise: File Operations

**Objective**: Practice reading files, writing files, working with directories, and using streams.

**Instructions**:

1. Create file operations
2. Work with directories
3. Use streams
4. Practice:
   - Reading and writing files
   - Creating and reading directories
   - Using streams
   - Processing file data

**Example Solution**:

```javascript
// src/fileOperations.js
const fs = require(''fs'');
const path = require(''path'');

// File operations class
class FileOperations {
    // Read file
    static readFile(filePath) {
        try {
            return fs.readFileSync(filePath, ''utf8'');
        } catch (error) {
            throw new Error(`Error reading file: ${error.message}`);
        }
    }
    
    // Write file
    static writeFile(filePath, data) {
        try {
            fs.writeFileSync(filePath, data, ''utf8'');
            return true;
        } catch (error) {
            throw new Error(`Error writing file: ${error.message}`);
        }
    }
    
    // Append to file
    static appendFile(filePath, data) {
        try {
            fs.appendFileSync(filePath, data, ''utf8'');
            return true;
        } catch (error) {
            throw new Error(`Error appending to file: ${error.message}`);
        }
    }
    
    // Check if file exists
    static fileExists(filePath) {
        return fs.existsSync(filePath);
    }
    
    // Get file stats
    static getFileStats(filePath) {
        try {
            const stats = fs.statSync(filePath);
            return {
                size: stats.size,
                created: stats.birthtime,
                modified: stats.mtime,
                isFile: stats.isFile(),
                isDirectory: stats.isDirectory()
            };
        } catch (error) {
            throw new Error(`Error getting file stats: ${error.message}`);
        }
    }
    
    // Create directory
    static createDirectory(dirPath) {
        try {
            if (!fs.existsSync(dirPath)) {
                fs.mkdirSync(dirPath, { recursive: true });
                return true;
            }
            return false;
        } catch (error) {
            throw new Error(`Error creating directory: ${error.message}`);
        }
    }
    
    // Read directory
    static readDirectory(dirPath) {
        try {
            return fs.readdirSync(dirPath);
        } catch (error) {
            throw new Error(`Error reading directory: ${error.message}`);
        }
    }
    
    // Copy file using streams
    static copyFile(source, destination) {
        return new Promise((resolve, reject) => {
            const readStream = fs.createReadStream(source);
            const writeStream = fs.createWriteStream(destination);
            
            readStream.pipe(writeStream);
            
            writeStream.on(''finish'', () => {
                resolve();
            });
            
            readStream.on(''error'', reject);
            writeStream.on(''error'', reject);
        });
    }
    
    // Read file line by line
    static readFileLines(filePath) {
        const content = this.readFile(filePath);
        return content.split(''\\n'').filter(line => line.trim() !== '''');
    }
    
    // Write JSON file
    static writeJSON(filePath, data) {
        try {
            const json = JSON.stringify(data, null, 2);
            this.writeFile(filePath, json);
            return true;
        } catch (error) {
            throw new Error(`Error writing JSON: ${error.message}`);
        }
    }
    
    // Read JSON file
    static readJSON(filePath) {
        try {
            const content = this.readFile(filePath);
            return JSON.parse(content);
        } catch (error) {
            throw new Error(`Error reading JSON: ${error.message}`);
        }
    }
}

module.exports = FileOperations;
```

```javascript
// src/directoryWalker.js
const fs = require(''fs'');
const path = require(''path'');

class DirectoryWalker {
    static walk(dir, callback, fileList = []) {
        const files = fs.readdirSync(dir);
        
        files.forEach(file => {
            const filePath = path.join(dir, file);
            const stats = fs.statSync(filePath);
            
            if (stats.isDirectory()) {
                fileList = this.walk(filePath, callback, fileList);
            } else {
                fileList.push(filePath);
                if (callback) {
                    callback(filePath, stats);
                }
            }
        });
        
        return fileList;
    }
    
    static findFiles(dir, extension) {
        const files = [];
        this.walk(dir, (filePath, stats) => {
            if (path.extname(filePath) === extension) {
                files.push(filePath);
            }
        });
        return files;
    }
    
    static getDirectorySize(dir) {
        let totalSize = 0;
        this.walk(dir, (filePath, stats) => {
            totalSize += stats.size;
        });
        return totalSize;
    }
}

module.exports = DirectoryWalker;
```

```javascript
// src/streamProcessor.js
const fs = require(''fs'');
const { Transform } = require(''stream'');

class StreamProcessor {
    // Process file with transform
    static processFile(inputPath, outputPath, transformFn) {
        return new Promise((resolve, reject) => {
            const readStream = fs.createReadStream(inputPath, ''utf8'');
            const writeStream = fs.createWriteStream(outputPath, ''utf8'');
            
            const transform = new Transform({
                transform(chunk, encoding, callback) {
                    const result = transformFn(chunk.toString());
                    this.push(result);
                    callback();
                }
            });
            
            readStream
                .pipe(transform)
                .pipe(writeStream);
            
            writeStream.on(''finish'', resolve);
            readStream.on(''error'', reject);
            writeStream.on(''error'', reject);
        });
    }
    
    // Count lines in file
    static countLines(filePath) {
        return new Promise((resolve, reject) => {
            let lineCount = 0;
            const readStream = fs.createReadStream(filePath, ''utf8'');
            
            readStream.on(''data'', (chunk) => {
                lineCount += (chunk.match(/\\n/g) || []).length;
            });
            
            readStream.on(''end'', () => {
                resolve(lineCount);
            });
            
            readStream.on(''error'', reject);
        });
    }
}

module.exports = StreamProcessor;
```

```javascript
// src/app.js
// Main application
const FileOperations = require(''./fileOperations'');
const DirectoryWalker = require(''./directoryWalker'');
const StreamProcessor = require(''./streamProcessor'');

async function main() {
    console.log(''=== File Operations ===\\n'');
    
    // Create test directory
    const testDir = ''./test-data'';
    FileOperations.createDirectory(testDir);
    console.log(''Created directory:'', testDir);
    
    // Write test file
    const testFile = path.join(testDir, ''test.txt'');
    FileOperations.writeFile(testFile, ''Hello, World!\\nLine 2\\nLine 3'');
    console.log(''Written file:'', testFile);
    
    // Read file
    const content = FileOperations.readFile(testFile);
    console.log(''File content:'', content);
    
    // Append to file
    FileOperations.appendFile(testFile, ''\\nLine 4'');
    console.log(''Appended to file'');
    
    // Read lines
    const lines = FileOperations.readFileLines(testFile);
    console.log(''Lines:'', lines);
    
    // File stats
    const stats = FileOperations.getFileStats(testFile);
    console.log(''File stats:'', stats);
    
    // Write JSON
    const jsonFile = path.join(testDir, ''data.json'');
    const data = { name: ''Alice'', age: 30, city: ''New York'' };
    FileOperations.writeJSON(jsonFile, data);
    console.log(''Written JSON file'');
    
    // Read JSON
    const jsonData = FileOperations.readJSON(jsonFile);
    console.log(''JSON data:'', jsonData);
    
    // Copy file
    const copiedFile = path.join(testDir, ''test-copy.txt'');
    await FileOperations.copyFile(testFile, copiedFile);
    console.log(''File copied'');
    
    // Count lines using stream
    const lineCount = await StreamProcessor.countLines(testFile);
    console.log(''Line count:'', lineCount);
    
    // Process file with transform
    const processedFile = path.join(testDir, ''processed.txt'');
    await StreamProcessor.processFile(
        testFile,
        processedFile,
        (content) => content.toUpperCase()
    );
    console.log(''File processed'');
    
    // Walk directory
    console.log(''\\n=== Directory Walker ==='');
    const allFiles = DirectoryWalker.walk(testDir);
    console.log(''All files:'', allFiles);
    
    // Find specific files
    const txtFiles = DirectoryWalker.findFiles(testDir, ''.txt'');
    console.log(''TXT files:'', txtFiles);
    
    // Get directory size
    const dirSize = DirectoryWalker.getDirectorySize(testDir);
    console.log(''Directory size:'', dirSize, ''bytes'');
}

// Run application
const path = require(''path'');
main().catch(console.error);
```

```json
// package.json
{
  "name": "file-operations-practice",
  "version": "1.0.0",
  "description": "File system operations practice",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js"
  },
  "keywords": ["nodejs", "filesystem"],
  "author": "",
  "license": "ISC"
}
```

**Expected Output**:

```bash
node src/app.js

=== File Operations ===

Created directory: ./test-data
Written file: ./test-data/test.txt
File content: Hello, World!
Line 2
Line 3
Appended to file
Lines: [ ''Hello, World!'', ''Line 2'', ''Line 3'', ''Line 4'' ]
File stats: { size: 35, created: ..., modified: ..., isFile: true, isDirectory: false }
Written JSON file
JSON data: { name: ''Alice'', age: 30, city: ''New York'' }
File copied
Line count: 4
File processed

=== Directory Walker ===
All files: [ ''./test-data/test.txt'', ... ]
TXT files: [ ''./test-data/test.txt'', ... ]
Directory size: 1234 bytes
```

**Challenge (Optional)**:
- Build a file manager
- Create a log file processor
- Build a backup utility
- Create a file search tool

---

## Common Mistakes

### 1. Blocking Operations

```javascript
// ❌ Bad: Blocking operation in async context
const data = fs.readFileSync(''large-file.txt'');

// ✅ Good: Use async or streams
fs.readFile(''large-file.txt'', (err, data) => {
    // Handle data
});
```

### 2. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = fs.readFileSync(''file.txt'');

// ✅ Good: Handle errors
try {
    const data = fs.readFileSync(''file.txt'');
} catch (error) {
    console.error(''Error:'', error);
}
```

### 3. Memory Issues with Large Files

```javascript
// ❌ Bad: Loading entire file into memory
const data = fs.readFileSync(''huge-file.txt'');

// ✅ Good: Use streams
const readStream = fs.createReadStream(''huge-file.txt'');
readStream.on(''data'', (chunk) => {
    // Process chunk
});
```

---

## Key Takeaways

1. **fs Module**: File system operations
2. **Synchronous vs Asynchronous**: Choose based on use case
3. **Streams**: Efficient for large files
4. **Directories**: Create, read, remove directories
5. **Error Handling**: Always handle errors
6. **Best Practice**: Use async for I/O, streams for large files
7. **File Operations**: Read, write, append, copy, stats

---

## Quiz: File System

Test your understanding with these questions:

1. **fs.readFileSync:**
   - A) Synchronous
   - B) Asynchronous
   - C) Both
   - D) Neither

2. **Streams are:**
   - A) For large files
   - B) For small files
   - C) Both
   - D) Neither

3. **fs.writeFileSync:**
   - A) Overwrites file
   - B) Appends to file
   - C) Both
   - D) Neither

4. **fs.appendFileSync:**
   - A) Overwrites file
   - B) Appends to file
   - C) Both
   - D) Neither

5. **Streams use:**
   - A) Less memory
   - B) More memory
   - C) Both
   - D) Neither

6. **fs.mkdirSync:**
   - A) Creates directory
   - B) Removes directory
   - C) Both
   - D) Neither

7. **Pipe:**
   - A) Connects streams
   - B) Separates streams
   - C) Both
   - D) Neither

**Answers**:
1. A) Synchronous
2. A) For large files
3. A) Overwrites file
4. B) Appends to file
5. A) Less memory
6. A) Creates directory
7. A) Connects streams

---

## Next Steps

Congratulations! You''ve completed Module 28: Node.js Basics. You now know:
- Node.js introduction
- Node.js modules
- File system operations
- How to work with Node.js

**What''s Next?**
- Module 29: Building Web Servers
- Lesson 29.1: HTTP Server with Node.js
- Learn to create HTTP servers
- Build web applications

---

## Additional Resources

- **fs Module**: [nodejs.org/api/fs.html](https://nodejs.org/api/fs.html)
- **Streams**: [nodejs.org/api/stream.html](https://nodejs.org/api/stream.html)
- **Path Module**: [nodejs.org/api/path.html](https://nodejs.org/api/path.html)

---

*Lesson completed! You''ve finished Module 28: Node.js Basics. Ready for Module 29: Building Web Servers!*

', NULL, 3, '2026-01-03 10:13:54', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Read files synchronously and asynchronously
- Write files synchronously and asynchronously
- Work with directories
- Understand streams
- Handle file operations
- Process file data
- Build file-based applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (192, 69, 17, 'HTTP Server with Node.js', 'http-server-with-nodejs', '# Lesson 29.1: HTTP Server with Node.js

## Learning Objectives

By the end of this lesson, you will be able to:
- Create HTTP servers with Node.js
- Handle HTTP requests
- Implement routing
- Work with request and response objects
- Build basic web servers
- Understand HTTP protocol
- Process different request types

---

## Introduction to HTTP Servers

HTTP servers listen for incoming HTTP requests and send responses. Node.js provides the `http` module to create servers.

### What is an HTTP Server?

- **Listens**: Waits for incoming requests
- **Processes**: Handles request data
- **Responds**: Sends response back
- **Stateless**: Each request is independent
- **Protocol**: Uses HTTP/HTTPS protocol

---

## Creating HTTP Server

### Basic Server

```javascript
const http = require(''http'');

// Create server
const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

// Listen on port
server.listen(3000, () => {
    console.log(''Server running on http://localhost:3000'');
});
```

### Server with Options

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

server.listen(3000, ''localhost'', () => {
    console.log(''Server running on http://localhost:3000'');
});

// Or specify host
server.listen(3000, ''0.0.0.0'', () => {
    console.log(''Server running on all interfaces'');
});
```

### Server Class

```javascript
const http = require(''http'');

const server = http.createServer();

// Handle request event
server.on(''request'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

// Handle connection event
server.on(''connection'', (socket) => {
    console.log(''New connection'');
});

server.listen(3000, () => {
    console.log(''Server running on port 3000'');
});
```

---

## Handling Requests

### Request Object

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Request method
    console.log(''Method:'', req.method);
    
    // Request URL
    console.log(''URL:'', req.url);
    
    // Request headers
    console.log(''Headers:'', req.headers);
    
    // Request body (for POST, PUT, etc.)
    let body = '''';
    req.on(''data'', (chunk) => {
        body += chunk.toString();
    });
    
    req.on(''end'', () => {
        console.log(''Body:'', body);
        
        res.writeHead(200, { ''Content-Type'': ''text/plain'' });
        res.end(''Request received'');
    });
});

server.listen(3000);
```

### Response Object

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Set status code
    res.statusCode = 200;
    
    // Set headers
    res.setHeader(''Content-Type'', ''text/html'');
    res.setHeader(''X-Custom-Header'', ''my-value'');
    
    // Write response
    res.write(''<h1>Hello, World!</h1>'');
    res.write(''<p>This is a response</p>'');
    
    // End response
    res.end();
});

server.listen(3000);
```

### Different Response Types

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // JSON response
    if (req.url === ''/api/data'') {
        res.writeHead(200, { ''Content-Type'': ''application/json'' });
        res.end(JSON.stringify({ message: ''Hello'', data: [1, 2, 3] }));
        return;
    }
    
    // HTML response
    if (req.url === ''/'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Home Page</h1>'');
        return;
    }
    
    // Plain text response
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Default response'');
});

server.listen(3000);
```

---

## Routing

### Basic Routing

```javascript
const http = require(''http'');
const url = require(''url'');

const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    
    // Route handling
    if (path === ''/'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Home Page</h1>'');
    } else if (path === ''/about'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>About Page</h1>'');
    } else if (path === ''/contact'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Contact Page</h1>'');
    } else {
        res.writeHead(404, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>404 - Page Not Found</h1>'');
    }
});

server.listen(3000);
```

### Method-Based Routing

```javascript
const http = require(''http'');
const url = require(''url'');

const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    const method = req.method;
    
    // GET requests
    if (method === ''GET'') {
        if (path === ''/users'') {
            res.writeHead(200, { ''Content-Type'': ''application/json'' });
            res.end(JSON.stringify([{ id: 1, name: ''Alice'' }]));
        } else if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            res.writeHead(200, { ''Content-Type'': ''application/json'' });
            res.end(JSON.stringify({ id: userId, name: ''Alice'' }));
        }
    }
    
    // POST requests
    else if (method === ''POST'') {
        if (path === ''/users'') {
            let body = '''';
            req.on(''data'', (chunk) => {
                body += chunk.toString();
            });
            
            req.on(''end'', () => {
                const user = JSON.parse(body);
                res.writeHead(201, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ id: Date.now(), ...user }));
            });
        }
    }
    
    // PUT requests
    else if (method === ''PUT'') {
        if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            let body = '''';
            req.on(''data'', (chunk) => {
                body += chunk.toString();
            });
            
            req.on(''end'', () => {
                const user = JSON.parse(body);
                res.writeHead(200, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ id: userId, ...user }));
            });
        }
    }
    
    // DELETE requests
    else if (method === ''DELETE'') {
        if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            res.writeHead(204);
            res.end();
        }
    }
    
    // 404 for other routes
    else {
        res.writeHead(404, { ''Content-Type'': ''text/plain'' });
        res.end(''Not Found'');
    }
});

server.listen(3000);
```

### Router Helper

```javascript
const http = require(''http'');
const url = require(''url'');

// Simple router
class Router {
    constructor() {
        this.routes = {};
    }
    
    get(path, handler) {
        if (!this.routes[path]) {
            this.routes[path] = {};
        }
        this.routes[path].GET = handler;
    }
    
    post(path, handler) {
        if (!this.routes[path]) {
            this.routes[path] = {};
        }
        this.routes[path].POST = handler;
    }
    
    handle(req, res) {
        const parsedUrl = url.parse(req.url, true);
        const path = parsedUrl.pathname;
        const method = req.method;
        
        const route = this.routes[path];
        if (route && route[method]) {
            route[method](req, res);
        } else {
            res.writeHead(404, { ''Content-Type'': ''text/plain'' });
            res.end(''Not Found'');
        }
    }
}

// Use router
const router = new Router();

router.get(''/'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/html'' });
    res.end(''<h1>Home</h1>'');
});

router.get(''/about'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/html'' });
    res.end(''<h1>About</h1>'');
});

router.post(''/users'', (req, res) => {
    let body = '''';
    req.on(''data'', (chunk) => {
        body += chunk.toString();
    });
    
    req.on(''end'', () => {
        res.writeHead(201, { ''Content-Type'': ''application/json'' });
        res.end(JSON.stringify({ message: ''User created'' }));
    });
});

const server = http.createServer((req, res) => {
    router.handle(req, res);
});

server.listen(3000);
```

---

## Request and Response Objects

### Request Object Properties

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Method
    console.log(''Method:'', req.method);
    
    // URL
    console.log(''URL:'', req.url);
    
    // Headers
    console.log(''Headers:'', req.headers);
    console.log(''User-Agent:'', req.headers[''user-agent'']);
    console.log(''Content-Type:'', req.headers[''content-type'']);
    
    // HTTP Version
    console.log(''HTTP Version:'', req.httpVersion);
    
    // Status Code (response)
    console.log(''Status Code:'', req.statusCode);
    
    // Socket
    console.log(''Remote Address:'', req.socket.remoteAddress);
    console.log(''Remote Port:'', req.socket.remotePort);
    
    res.end(''Request logged'');
});

server.listen(3000);
```

### Response Object Methods

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Set status code
    res.statusCode = 200;
    
    // Set status message
    res.statusMessage = ''OK'';
    
    // Set header
    res.setHeader(''Content-Type'', ''text/html'');
    res.setHeader(''X-Custom-Header'', ''value'');
    
    // Set multiple headers
    res.writeHead(200, {
        ''Content-Type'': ''text/html'',
        ''X-Custom-Header'': ''value''
    });
    
    // Write data
    res.write(''<h1>Hello</h1>'');
    res.write(''<p>World</p>'');
    
    // End response
    res.end();
    
    // Check if headers sent
    console.log(''Headers sent:'', res.headersSent);
    
    // Get header
    const contentType = res.getHeader(''Content-Type'');
    console.log(''Content-Type:'', contentType);
    
    // Remove header
    res.removeHeader(''X-Custom-Header'');
});
```

### Handling Request Body

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Only handle POST, PUT, PATCH
    if ([''POST'', ''PUT'', ''PATCH''].includes(req.method)) {
        let body = '''';
        
        req.on(''data'', (chunk) => {
            body += chunk.toString();
        });
        
        req.on(''end'', () => {
            try {
                // Parse JSON
                const data = JSON.parse(body);
                console.log(''Received data:'', data);
                
                res.writeHead(200, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ success: true, data }));
            } catch (error) {
                res.writeHead(400, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ error: ''Invalid JSON'' }));
            }
        });
    } else {
        res.writeHead(200, { ''Content-Type'': ''text/plain'' });
        res.end(''OK'');
    }
});

server.listen(3000);
```

---

## Practice Exercise

### Exercise: Basic Server

**Objective**: Practice creating HTTP servers, handling requests, implementing routing, and working with request/response objects.

**Instructions**:

1. Create an HTTP server
2. Implement routing
3. Handle different request methods
4. Practice:
   - Creating servers
   - Handling requests
   - Implementing routing
   - Working with request/response objects

**Example Solution**:

```javascript
// src/server.js
const http = require(''http'');
const url = require(''url'');

// Simple in-memory data store
let users = [
    { id: 1, name: ''Alice'', email: ''alice@example.com'' },
    { id: 2, name: ''Bob'', email: ''bob@example.com'' }
];

// Helper function to parse request body
function parseBody(req) {
    return new Promise((resolve, reject) => {
        let body = '''';
        req.on(''data'', (chunk) => {
            body += chunk.toString();
        });
        req.on(''end'', () => {
            try {
                resolve(body ? JSON.parse(body) : {});
            } catch (error) {
                reject(error);
            }
        });
        req.on(''error'', reject);
    });
}

// Helper function to send JSON response
function sendJSON(res, statusCode, data) {
    res.writeHead(statusCode, { ''Content-Type'': ''application/json'' });
    res.end(JSON.stringify(data));
}

// Create server
const server = http.createServer(async (req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    const method = req.method;
    const query = parsedUrl.query;
    
    // CORS headers
    res.setHeader(''Access-Control-Allow-Origin'', ''*'');
    res.setHeader(''Access-Control-Allow-Methods'', ''GET, POST, PUT, DELETE, OPTIONS'');
    res.setHeader(''Access-Control-Allow-Headers'', ''Content-Type'');
    
    // Handle OPTIONS (preflight)
    if (method === ''OPTIONS'') {
        res.writeHead(200);
        res.end();
        return;
    }
    
    // Route: GET /
    if (path === ''/'' && method === ''GET'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Node.js HTTP Server</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    h1 { color: #333; }
                    .endpoint { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
                </style>
            </head>
            <body>
                <h1>Node.js HTTP Server</h1>
                <p>Welcome to the HTTP server!</p>
                <h2>Available Endpoints:</h2>
                <div class="endpoint">
                    <strong>GET /users</strong> - Get all users
                </div>
                <div class="endpoint">
                    <strong>GET /users/:id</strong> - Get user by ID
                </div>
                <div class="endpoint">
                    <strong>POST /users</strong> - Create new user
                </div>
                <div class="endpoint">
                    <strong>PUT /users/:id</strong> - Update user
                </div>
                <div class="endpoint">
                    <strong>DELETE /users/:id</strong> - Delete user
                </div>
            </body>
            </html>
        `);
        return;
    }
    
    // Route: GET /users
    if (path === ''/users'' && method === ''GET'') {
        sendJSON(res, 200, users);
        return;
    }
    
    // Route: GET /users/:id
    if (path.startsWith(''/users/'') && method === ''GET'') {
        const userId = parseInt(path.split(''/'')[2]);
        const user = users.find(u => u.id === userId);
        
        if (user) {
            sendJSON(res, 200, user);
        } else {
            sendJSON(res, 404, { error: ''User not found'' });
        }
        return;
    }
    
    // Route: POST /users
    if (path === ''/users'' && method === ''POST'') {
        try {
            const body = await parseBody(req);
            
            if (!body.name || !body.email) {
                sendJSON(res, 400, { error: ''Name and email are required'' });
                return;
            }
            
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                name: body.name,
                email: body.email
            };
            
            users.push(newUser);
            sendJSON(res, 201, newUser);
        } catch (error) {
            sendJSON(res, 400, { error: ''Invalid JSON'' });
        }
        return;
    }
    
    // Route: PUT /users/:id
    if (path.startsWith(''/users/'') && method === ''PUT'') {
        try {
            const userId = parseInt(path.split(''/'')[2]);
            const userIndex = users.findIndex(u => u.id === userId);
            
            if (userIndex === -1) {
                sendJSON(res, 404, { error: ''User not found'' });
                return;
            }
            
            const body = await parseBody(req);
            users[userIndex] = { ...users[userIndex], ...body };
            
            sendJSON(res, 200, users[userIndex]);
        } catch (error) {
            sendJSON(res, 400, { error: ''Invalid JSON'' });
        }
        return;
    }
    
    // Route: DELETE /users/:id
    if (path.startsWith(''/users/'') && method === ''DELETE'') {
        const userId = parseInt(path.split(''/'')[2]);
        const userIndex = users.findIndex(u => u.id === userId);
        
        if (userIndex === -1) {
            sendJSON(res, 404, { error: ''User not found'' });
            return;
        }
        
        users.splice(userIndex, 1);
        res.writeHead(204);
        res.end();
        return;
    }
    
    // 404 - Not Found
    sendJSON(res, 404, { error: ''Route not found'' });
});

// Start server
const PORT = process.env.PORT || 3000;
server.listen(PORT, () => {
    console.log(`Server running on http://localhost:${PORT}`);
    console.log(`Visit http://localhost:${PORT} in your browser`);
});
```

```json
// package.json
{
  "name": "http-server-practice",
  "version": "1.0.0",
  "description": "HTTP server practice with Node.js",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "node --watch src/server.js"
  },
  "keywords": ["nodejs", "http", "server"],
  "author": "",
  "license": "ISC"
}
```

**Testing the Server**:

```bash
# Start server
node src/server.js

# Test endpoints (in another terminal or browser)
# GET /users
curl http://localhost:3000/users

# GET /users/1
curl http://localhost:3000/users/1

# POST /users
curl -X POST http://localhost:3000/users \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Charlie","email":"charlie@example.com"}''

# PUT /users/1
curl -X PUT http://localhost:3000/users/1 \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Alice Updated","email":"alice.updated@example.com"}''

# DELETE /users/1
curl -X DELETE http://localhost:3000/users/1
```

**Expected Output**:
- Server running on port 3000
- HTML page at root
- RESTful API endpoints working
- CRUD operations functional

**Challenge (Optional)**:
- Add more routes
- Implement authentication
- Add request validation
- Create a complete API

---

## Common Mistakes

### 1. Not Ending Response

```javascript
// ❌ Bad: Response never ends
res.writeHead(200);
res.write(''Hello'');

// ✅ Good: Always end response
res.writeHead(200);
res.end(''Hello'');
```

### 2. Writing After End

```javascript
// ❌ Bad: Write after end
res.end(''Hello'');
res.write(''World'');  // Error

// ✅ Good: Write before end
res.write(''Hello'');
res.end(''World'');
```

### 3. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = JSON.parse(body);

// ✅ Good: Handle errors
try {
    const data = JSON.parse(body);
} catch (error) {
    res.writeHead(400);
    res.end(''Invalid JSON'');
}
```

---

## Key Takeaways

1. **HTTP Server**: Created with http.createServer()
2. **Request Object**: Contains method, URL, headers, body
3. **Response Object**: Used to send responses
4. **Routing**: Handle different paths and methods
5. **Status Codes**: Use appropriate HTTP status codes
6. **Best Practice**: Always end response, handle errors
7. **Protocol**: Understand HTTP methods and status codes

---

## Quiz: HTTP Server

Test your understanding with these questions:

1. **http.createServer:**
   - A) Creates server
   - B) Starts server
   - C) Both
   - D) Neither

2. **server.listen:**
   - A) Creates server
   - B) Starts server
   - C) Both
   - D) Neither

3. **req.method:**
   - A) Request method
   - B) Response method
   - C) Both
   - D) Neither

4. **res.end:**
   - A) Required
   - B) Optional
   - C) Both
   - D) Neither

5. **Status code 200:**
   - A) Success
   - B) Error
   - C) Both
   - D) Neither

6. **Status code 404:**
   - A) Not found
   - B) Found
   - C) Both
   - D) Neither

7. **Request body:**
   - A) Stream
   - B) String
   - C) Both
   - D) Neither

**Answers**:
1. A) Creates server
2. B) Starts server
3. A) Request method
4. A) Required
5. A) Success
6. A) Not found
7. A) Stream (needs to be read)

---

## Next Steps

Congratulations! You''ve learned HTTP server with Node.js. You now know:
- How to create HTTP servers
- How to handle requests
- How to implement routing
- How to work with request/response objects

**What''s Next?**
- Lesson 29.2: Express.js Framework
- Learn Express.js
- Understand routes and middleware
- Build web applications

---

## Additional Resources

- **HTTP Module**: [nodejs.org/api/http.html](https://nodejs.org/api/http.html)
- **HTTP Status Codes**: [developer.mozilla.org/en-US/docs/Web/HTTP/Status](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)
- **HTTP Methods**: [developer.mozilla.org/en-US/docs/Web/HTTP/Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:13:54', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create HTTP servers with Node.js
- Handle HTTP requests
- Implement routing
- Work with request and response objects
- Build basic web servers
- Understand HTTP protocol
- Process different request types');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (185, 69, 17, 'HTTP Server Basics', 'http-server-basics', '# Lesson 29.1: HTTP Server with Node.js

## Learning Objectives

By the end of this lesson, you will be able to:
- Create HTTP servers with Node.js
- Handle HTTP requests
- Implement routing
- Work with request and response objects
- Build basic web servers
- Understand HTTP protocol
- Process different request types

---

## Introduction to HTTP Servers

HTTP servers listen for incoming HTTP requests and send responses. Node.js provides the `http` module to create servers.

### What is an HTTP Server?

- **Listens**: Waits for incoming requests
- **Processes**: Handles request data
- **Responds**: Sends response back
- **Stateless**: Each request is independent
- **Protocol**: Uses HTTP/HTTPS protocol

---

## Creating HTTP Server

### Basic Server

```javascript
const http = require(''http'');

// Create server
const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

// Listen on port
server.listen(3000, () => {
    console.log(''Server running on http://localhost:3000'');
});
```

### Server with Options

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

server.listen(3000, ''localhost'', () => {
    console.log(''Server running on http://localhost:3000'');
});

// Or specify host
server.listen(3000, ''0.0.0.0'', () => {
    console.log(''Server running on all interfaces'');
});
```

### Server Class

```javascript
const http = require(''http'');

const server = http.createServer();

// Handle request event
server.on(''request'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Hello, World!'');
});

// Handle connection event
server.on(''connection'', (socket) => {
    console.log(''New connection'');
});

server.listen(3000, () => {
    console.log(''Server running on port 3000'');
});
```

---

## Handling Requests

### Request Object

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Request method
    console.log(''Method:'', req.method);
    
    // Request URL
    console.log(''URL:'', req.url);
    
    // Request headers
    console.log(''Headers:'', req.headers);
    
    // Request body (for POST, PUT, etc.)
    let body = '''';
    req.on(''data'', (chunk) => {
        body += chunk.toString();
    });
    
    req.on(''end'', () => {
        console.log(''Body:'', body);
        
        res.writeHead(200, { ''Content-Type'': ''text/plain'' });
        res.end(''Request received'');
    });
});

server.listen(3000);
```

### Response Object

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Set status code
    res.statusCode = 200;
    
    // Set headers
    res.setHeader(''Content-Type'', ''text/html'');
    res.setHeader(''X-Custom-Header'', ''my-value'');
    
    // Write response
    res.write(''<h1>Hello, World!</h1>'');
    res.write(''<p>This is a response</p>'');
    
    // End response
    res.end();
});

server.listen(3000);
```

### Different Response Types

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // JSON response
    if (req.url === ''/api/data'') {
        res.writeHead(200, { ''Content-Type'': ''application/json'' });
        res.end(JSON.stringify({ message: ''Hello'', data: [1, 2, 3] }));
        return;
    }
    
    // HTML response
    if (req.url === ''/'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Home Page</h1>'');
        return;
    }
    
    // Plain text response
    res.writeHead(200, { ''Content-Type'': ''text/plain'' });
    res.end(''Default response'');
});

server.listen(3000);
```

---

## Routing

### Basic Routing

```javascript
const http = require(''http'');
const url = require(''url'');

const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    
    // Route handling
    if (path === ''/'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Home Page</h1>'');
    } else if (path === ''/about'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>About Page</h1>'');
    } else if (path === ''/contact'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>Contact Page</h1>'');
    } else {
        res.writeHead(404, { ''Content-Type'': ''text/html'' });
        res.end(''<h1>404 - Page Not Found</h1>'');
    }
});

server.listen(3000);
```

### Method-Based Routing

```javascript
const http = require(''http'');
const url = require(''url'');

const server = http.createServer((req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    const method = req.method;
    
    // GET requests
    if (method === ''GET'') {
        if (path === ''/users'') {
            res.writeHead(200, { ''Content-Type'': ''application/json'' });
            res.end(JSON.stringify([{ id: 1, name: ''Alice'' }]));
        } else if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            res.writeHead(200, { ''Content-Type'': ''application/json'' });
            res.end(JSON.stringify({ id: userId, name: ''Alice'' }));
        }
    }
    
    // POST requests
    else if (method === ''POST'') {
        if (path === ''/users'') {
            let body = '''';
            req.on(''data'', (chunk) => {
                body += chunk.toString();
            });
            
            req.on(''end'', () => {
                const user = JSON.parse(body);
                res.writeHead(201, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ id: Date.now(), ...user }));
            });
        }
    }
    
    // PUT requests
    else if (method === ''PUT'') {
        if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            let body = '''';
            req.on(''data'', (chunk) => {
                body += chunk.toString();
            });
            
            req.on(''end'', () => {
                const user = JSON.parse(body);
                res.writeHead(200, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ id: userId, ...user }));
            });
        }
    }
    
    // DELETE requests
    else if (method === ''DELETE'') {
        if (path.startsWith(''/users/'')) {
            const userId = path.split(''/'')[2];
            res.writeHead(204);
            res.end();
        }
    }
    
    // 404 for other routes
    else {
        res.writeHead(404, { ''Content-Type'': ''text/plain'' });
        res.end(''Not Found'');
    }
});

server.listen(3000);
```

### Router Helper

```javascript
const http = require(''http'');
const url = require(''url'');

// Simple router
class Router {
    constructor() {
        this.routes = {};
    }
    
    get(path, handler) {
        if (!this.routes[path]) {
            this.routes[path] = {};
        }
        this.routes[path].GET = handler;
    }
    
    post(path, handler) {
        if (!this.routes[path]) {
            this.routes[path] = {};
        }
        this.routes[path].POST = handler;
    }
    
    handle(req, res) {
        const parsedUrl = url.parse(req.url, true);
        const path = parsedUrl.pathname;
        const method = req.method;
        
        const route = this.routes[path];
        if (route && route[method]) {
            route[method](req, res);
        } else {
            res.writeHead(404, { ''Content-Type'': ''text/plain'' });
            res.end(''Not Found'');
        }
    }
}

// Use router
const router = new Router();

router.get(''/'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/html'' });
    res.end(''<h1>Home</h1>'');
});

router.get(''/about'', (req, res) => {
    res.writeHead(200, { ''Content-Type'': ''text/html'' });
    res.end(''<h1>About</h1>'');
});

router.post(''/users'', (req, res) => {
    let body = '''';
    req.on(''data'', (chunk) => {
        body += chunk.toString();
    });
    
    req.on(''end'', () => {
        res.writeHead(201, { ''Content-Type'': ''application/json'' });
        res.end(JSON.stringify({ message: ''User created'' }));
    });
});

const server = http.createServer((req, res) => {
    router.handle(req, res);
});

server.listen(3000);
```

---

## Request and Response Objects

### Request Object Properties

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Method
    console.log(''Method:'', req.method);
    
    // URL
    console.log(''URL:'', req.url);
    
    // Headers
    console.log(''Headers:'', req.headers);
    console.log(''User-Agent:'', req.headers[''user-agent'']);
    console.log(''Content-Type:'', req.headers[''content-type'']);
    
    // HTTP Version
    console.log(''HTTP Version:'', req.httpVersion);
    
    // Status Code (response)
    console.log(''Status Code:'', req.statusCode);
    
    // Socket
    console.log(''Remote Address:'', req.socket.remoteAddress);
    console.log(''Remote Port:'', req.socket.remotePort);
    
    res.end(''Request logged'');
});

server.listen(3000);
```

### Response Object Methods

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Set status code
    res.statusCode = 200;
    
    // Set status message
    res.statusMessage = ''OK'';
    
    // Set header
    res.setHeader(''Content-Type'', ''text/html'');
    res.setHeader(''X-Custom-Header'', ''value'');
    
    // Set multiple headers
    res.writeHead(200, {
        ''Content-Type'': ''text/html'',
        ''X-Custom-Header'': ''value''
    });
    
    // Write data
    res.write(''<h1>Hello</h1>'');
    res.write(''<p>World</p>'');
    
    // End response
    res.end();
    
    // Check if headers sent
    console.log(''Headers sent:'', res.headersSent);
    
    // Get header
    const contentType = res.getHeader(''Content-Type'');
    console.log(''Content-Type:'', contentType);
    
    // Remove header
    res.removeHeader(''X-Custom-Header'');
});
```

### Handling Request Body

```javascript
const http = require(''http'');

const server = http.createServer((req, res) => {
    // Only handle POST, PUT, PATCH
    if ([''POST'', ''PUT'', ''PATCH''].includes(req.method)) {
        let body = '''';
        
        req.on(''data'', (chunk) => {
            body += chunk.toString();
        });
        
        req.on(''end'', () => {
            try {
                // Parse JSON
                const data = JSON.parse(body);
                console.log(''Received data:'', data);
                
                res.writeHead(200, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ success: true, data }));
            } catch (error) {
                res.writeHead(400, { ''Content-Type'': ''application/json'' });
                res.end(JSON.stringify({ error: ''Invalid JSON'' }));
            }
        });
    } else {
        res.writeHead(200, { ''Content-Type'': ''text/plain'' });
        res.end(''OK'');
    }
});

server.listen(3000);
```

---

## Practice Exercise

### Exercise: Basic Server

**Objective**: Practice creating HTTP servers, handling requests, implementing routing, and working with request/response objects.

**Instructions**:

1. Create an HTTP server
2. Implement routing
3. Handle different request methods
4. Practice:
   - Creating servers
   - Handling requests
   - Implementing routing
   - Working with request/response objects

**Example Solution**:

```javascript
// src/server.js
const http = require(''http'');
const url = require(''url'');

// Simple in-memory data store
let users = [
    { id: 1, name: ''Alice'', email: ''alice@example.com'' },
    { id: 2, name: ''Bob'', email: ''bob@example.com'' }
];

// Helper function to parse request body
function parseBody(req) {
    return new Promise((resolve, reject) => {
        let body = '''';
        req.on(''data'', (chunk) => {
            body += chunk.toString();
        });
        req.on(''end'', () => {
            try {
                resolve(body ? JSON.parse(body) : {});
            } catch (error) {
                reject(error);
            }
        });
        req.on(''error'', reject);
    });
}

// Helper function to send JSON response
function sendJSON(res, statusCode, data) {
    res.writeHead(statusCode, { ''Content-Type'': ''application/json'' });
    res.end(JSON.stringify(data));
}

// Create server
const server = http.createServer(async (req, res) => {
    const parsedUrl = url.parse(req.url, true);
    const path = parsedUrl.pathname;
    const method = req.method;
    const query = parsedUrl.query;
    
    // CORS headers
    res.setHeader(''Access-Control-Allow-Origin'', ''*'');
    res.setHeader(''Access-Control-Allow-Methods'', ''GET, POST, PUT, DELETE, OPTIONS'');
    res.setHeader(''Access-Control-Allow-Headers'', ''Content-Type'');
    
    // Handle OPTIONS (preflight)
    if (method === ''OPTIONS'') {
        res.writeHead(200);
        res.end();
        return;
    }
    
    // Route: GET /
    if (path === ''/'' && method === ''GET'') {
        res.writeHead(200, { ''Content-Type'': ''text/html'' });
        res.end(`
            <!DOCTYPE html>
            <html>
            <head>
                <title>Node.js HTTP Server</title>
                <style>
                    body { font-family: Arial, sans-serif; padding: 20px; }
                    h1 { color: #333; }
                    .endpoint { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 5px; }
                </style>
            </head>
            <body>
                <h1>Node.js HTTP Server</h1>
                <p>Welcome to the HTTP server!</p>
                <h2>Available Endpoints:</h2>
                <div class="endpoint">
                    <strong>GET /users</strong> - Get all users
                </div>
                <div class="endpoint">
                    <strong>GET /users/:id</strong> - Get user by ID
                </div>
                <div class="endpoint">
                    <strong>POST /users</strong> - Create new user
                </div>
                <div class="endpoint">
                    <strong>PUT /users/:id</strong> - Update user
                </div>
                <div class="endpoint">
                    <strong>DELETE /users/:id</strong> - Delete user
                </div>
            </body>
            </html>
        `);
        return;
    }
    
    // Route: GET /users
    if (path === ''/users'' && method === ''GET'') {
        sendJSON(res, 200, users);
        return;
    }
    
    // Route: GET /users/:id
    if (path.startsWith(''/users/'') && method === ''GET'') {
        const userId = parseInt(path.split(''/'')[2]);
        const user = users.find(u => u.id === userId);
        
        if (user) {
            sendJSON(res, 200, user);
        } else {
            sendJSON(res, 404, { error: ''User not found'' });
        }
        return;
    }
    
    // Route: POST /users
    if (path === ''/users'' && method === ''POST'') {
        try {
            const body = await parseBody(req);
            
            if (!body.name || !body.email) {
                sendJSON(res, 400, { error: ''Name and email are required'' });
                return;
            }
            
            const newUser = {
                id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
                name: body.name,
                email: body.email
            };
            
            users.push(newUser);
            sendJSON(res, 201, newUser);
        } catch (error) {
            sendJSON(res, 400, { error: ''Invalid JSON'' });
        }
        return;
    }
    
    // Route: PUT /users/:id
    if (path.startsWith(''/users/'') && method === ''PUT'') {
        try {
            const userId = parseInt(path.split(''/'')[2]);
            const userIndex = users.findIndex(u => u.id === userId);
            
            if (userIndex === -1) {
                sendJSON(res, 404, { error: ''User not found'' });
                return;
            }
            
            const body = await parseBody(req);
            users[userIndex] = { ...users[userIndex], ...body };
            
            sendJSON(res, 200, users[userIndex]);
        } catch (error) {
            sendJSON(res, 400, { error: ''Invalid JSON'' });
        }
        return;
    }
    
    // Route: DELETE /users/:id
    if (path.startsWith(''/users/'') && method === ''DELETE'') {
        const userId = parseInt(path.split(''/'')[2]);
        const userIndex = users.findIndex(u => u.id === userId);
        
        if (userIndex === -1) {
            sendJSON(res, 404, { error: ''User not found'' });
            return;
        }
        
        users.splice(userIndex, 1);
        res.writeHead(204);
        res.end();
        return;
    }
    
    // 404 - Not Found
    sendJSON(res, 404, { error: ''Route not found'' });
});

// Start server
const PORT = process.env.PORT || 3000;
server.listen(PORT, () => {
    console.log(`Server running on http://localhost:${PORT}`);
    console.log(`Visit http://localhost:${PORT} in your browser`);
});
```

```json
// package.json
{
  "name": "http-server-practice",
  "version": "1.0.0",
  "description": "HTTP server practice with Node.js",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "node --watch src/server.js"
  },
  "keywords": ["nodejs", "http", "server"],
  "author": "",
  "license": "ISC"
}
```

**Testing the Server**:

```bash
# Start server
node src/server.js

# Test endpoints (in another terminal or browser)
# GET /users
curl http://localhost:3000/users

# GET /users/1
curl http://localhost:3000/users/1

# POST /users
curl -X POST http://localhost:3000/users \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Charlie","email":"charlie@example.com"}''

# PUT /users/1
curl -X PUT http://localhost:3000/users/1 \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Alice Updated","email":"alice.updated@example.com"}''

# DELETE /users/1
curl -X DELETE http://localhost:3000/users/1
```

**Expected Output**:
- Server running on port 3000
- HTML page at root
- RESTful API endpoints working
- CRUD operations functional

**Challenge (Optional)**:
- Add more routes
- Implement authentication
- Add request validation
- Create a complete API

---

## Common Mistakes

### 1. Not Ending Response

```javascript
// ❌ Bad: Response never ends
res.writeHead(200);
res.write(''Hello'');

// ✅ Good: Always end response
res.writeHead(200);
res.end(''Hello'');
```

### 2. Writing After End

```javascript
// ❌ Bad: Write after end
res.end(''Hello'');
res.write(''World'');  // Error

// ✅ Good: Write before end
res.write(''Hello'');
res.end(''World'');
```

### 3. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const data = JSON.parse(body);

// ✅ Good: Handle errors
try {
    const data = JSON.parse(body);
} catch (error) {
    res.writeHead(400);
    res.end(''Invalid JSON'');
}
```

---

## Key Takeaways

1. **HTTP Server**: Created with http.createServer()
2. **Request Object**: Contains method, URL, headers, body
3. **Response Object**: Used to send responses
4. **Routing**: Handle different paths and methods
5. **Status Codes**: Use appropriate HTTP status codes
6. **Best Practice**: Always end response, handle errors
7. **Protocol**: Understand HTTP methods and status codes

---

## Quiz: HTTP Server

Test your understanding with these questions:

1. **http.createServer:**
   - A) Creates server
   - B) Starts server
   - C) Both
   - D) Neither

2. **server.listen:**
   - A) Creates server
   - B) Starts server
   - C) Both
   - D) Neither

3. **req.method:**
   - A) Request method
   - B) Response method
   - C) Both
   - D) Neither

4. **res.end:**
   - A) Required
   - B) Optional
   - C) Both
   - D) Neither

5. **Status code 200:**
   - A) Success
   - B) Error
   - C) Both
   - D) Neither

6. **Status code 404:**
   - A) Not found
   - B) Found
   - C) Both
   - D) Neither

7. **Request body:**
   - A) Stream
   - B) String
   - C) Both
   - D) Neither

**Answers**:
1. A) Creates server
2. B) Starts server
3. A) Request method
4. A) Required
5. A) Success
6. A) Not found
7. A) Stream (needs to be read)

---

## Next Steps

Congratulations! You''ve learned HTTP server with Node.js. You now know:
- How to create HTTP servers
- How to handle requests
- How to implement routing
- How to work with request/response objects

**What''s Next?**
- Lesson 29.2: Express.js Framework
- Learn Express.js
- Understand routes and middleware
- Build web applications

---

## Additional Resources

- **HTTP Module**: [nodejs.org/api/http.html](https://nodejs.org/api/http.html)
- **HTTP Status Codes**: [developer.mozilla.org/en-US/docs/Web/HTTP/Status](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)
- **HTTP Methods**: [developer.mozilla.org/en-US/docs/Web/HTTP/Methods](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:13:14', '2026-01-03 10:13:14', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Create HTTP servers with Node.js
- Handle HTTP requests
- Implement routing
- Work with request and response objects
- Build basic web servers
- Understand HTTP protocol
- Process different request types');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (186, 69, 17, 'Express.js Framework', 'expressjs-framework', '# Lesson 29.2: Express.js Framework

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand Express.js framework
- Create Express applications
- Work with routes and middleware
- Handle requests and responses
- Use template engines
- Build web applications with Express
- Organize Express applications

---

## Express Introduction

Express.js is a fast, unopinionated, minimalist web framework for Node.js. It simplifies building web applications and APIs.

### What is Express?

- **Web Framework**: Simplifies Node.js web development
- **Minimalist**: Lightweight and flexible
- **Middleware**: Powerful middleware system
- **Routing**: Easy routing system
- **Template Engines**: Support for various template engines
- **Popular**: Most popular Node.js framework

### Why Express?

- **Simple**: Easy to learn and use
- **Flexible**: Unopinionated, use as needed
- **Fast**: Lightweight and performant
- **Middleware**: Rich ecosystem of middleware
- **Community**: Large community and resources
- **Standard**: Industry standard for Node.js

---

## Express Introduction

### Installation

```bash
# Install Express
npm install express

# Install with dev dependencies
npm install express --save-dev

# Install specific version
npm install express@4.18.0
```

### Basic Express App

```javascript
const express = require(''express'');
const app = express();
const PORT = 3000;

// Basic route
app.get(''/'', (req, res) => {
    res.send(''Hello, Express!'');
});

// Start server
app.listen(PORT, () => {
    console.log(`Server running on http://localhost:${PORT}`);
});
```

### Express vs Native HTTP

```javascript
// Native HTTP (verbose)
const http = require(''http'');
const server = http.createServer((req, res) => {
    if (req.url === ''/'' && req.method === ''GET'') {
        res.writeHead(200, { ''Content-Type'': ''text/plain'' });
        res.end(''Hello'');
    }
});

// Express (simple)
const express = require(''express'');
const app = express();
app.get(''/'', (req, res) => {
    res.send(''Hello'');
});
```

---

## Routes and Middleware

### Basic Routes

```javascript
const express = require(''express'');
const app = express();

// GET route
app.get(''/'', (req, res) => {
    res.send(''Home page'');
});

// POST route
app.post(''/users'', (req, res) => {
    res.send(''Create user'');
});

// PUT route
app.put(''/users/:id'', (req, res) => {
    res.send(''Update user'');
});

// DELETE route
app.delete(''/users/:id'', (req, res) => {
    res.send(''Delete user'');
});

// All methods
app.all(''/test'', (req, res) => {
    res.send(''Any method'');
});
```

### Route Parameters

```javascript
const express = require(''express'');
const app = express();

// Single parameter
app.get(''/users/:id'', (req, res) => {
    const userId = req.params.id;
    res.send(`User ID: ${userId}`);
});

// Multiple parameters
app.get(''/users/:userId/posts/:postId'', (req, res) => {
    const { userId, postId } = req.params;
    res.send(`User ${userId}, Post ${postId}`);
});

// Optional parameter
app.get(''/users/:id?'', (req, res) => {
    const userId = req.params.id || ''all'';
    res.send(`User: ${userId}`);
});
```

### Query Parameters

```javascript
const express = require(''express'');
const app = express();

// Query parameters
app.get(''/search'', (req, res) => {
    const { q, page, limit } = req.query;
    res.json({
        query: q,
        page: page || 1,
        limit: limit || 10
    });
});

// Usage: /search?q=express&page=1&limit=10
```

### Route Handlers

```javascript
const express = require(''express'');
const app = express();

// Single handler
app.get(''/single'', (req, res) => {
    res.send(''Single handler'');
});

// Multiple handlers
app.get(''/multiple'',
    (req, res, next) => {
        console.log(''First handler'');
        next();
    },
    (req, res) => {
        res.send(''Second handler'');
    }
);

// Array of handlers
const handlers = [
    (req, res, next) => {
        console.log(''Handler 1'');
        next();
    },
    (req, res, next) => {
        console.log(''Handler 2'');
        next();
    },
    (req, res) => {
        res.send(''Handler 3'');
    }
];
app.get(''/array'', handlers);
```

### Middleware

```javascript
const express = require(''express'');
const app = express();

// Application-level middleware
app.use((req, res, next) => {
    console.log(''Request:'', req.method, req.url);
    next(); // Continue to next middleware
});

// Route-specific middleware
const checkAuth = (req, res, next) => {
    const isAuthenticated = true; // Check authentication
    if (isAuthenticated) {
        next();
    } else {
        res.status(401).send(''Unauthorized'');
    }
};

app.get(''/protected'', checkAuth, (req, res) => {
    res.send(''Protected route'');
});

// Multiple middleware
app.use(''/api'', checkAuth, (req, res, next) => {
    console.log(''API middleware'');
    next();
});
```

### Built-in Middleware

```javascript
const express = require(''express'');
const app = express();

// Parse JSON bodies
app.use(express.json());

// Parse URL-encoded bodies
app.use(express.urlencoded({ extended: true }));

// Serve static files
app.use(express.static(''public''));

// CORS (if needed)
app.use((req, res, next) => {
    res.header(''Access-Control-Allow-Origin'', ''*'');
    res.header(''Access-Control-Allow-Methods'', ''GET, POST, PUT, DELETE'');
    next();
});
```

---

## Request Handling

### Request Object

```javascript
const express = require(''express'');
const app = express();

app.use(express.json());
app.use(express.urlencoded({ extended: true }));

app.post(''/users'', (req, res) => {
    // Request properties
    console.log(''Method:'', req.method);
    console.log(''URL:'', req.url);
    console.log(''Path:'', req.path);
    console.log(''Query:'', req.query);
    console.log(''Params:'', req.params);
    console.log(''Headers:'', req.headers);
    console.log(''Body:'', req.body);
    console.log(''IP:'', req.ip);
    console.log(''Protocol:'', req.protocol);
    console.log(''Hostname:'', req.hostname);
    
    res.send(''Request logged'');
});
```

### Response Methods

```javascript
const express = require(''express'');
const app = express();

app.get(''/response'', (req, res) => {
    // Send response
    res.send(''Hello, World!'');
    
    // Send JSON
    res.json({ message: ''Hello'' });
    
    // Send status
    res.status(200).send(''OK'');
    
    // Send file
    res.sendFile(''/path/to/file.html'');
    
    // Redirect
    res.redirect(''/other-route'');
    
    // Set header
    res.set(''X-Custom-Header'', ''value'');
    
    // Set multiple headers
    res.set({
        ''X-Header-1'': ''value1'',
        ''X-Header-2'': ''value2''
    });
    
    // Cookie
    res.cookie(''name'', ''value'');
    
    // Clear cookie
    res.clearCookie(''name'');
});
```

### Error Handling

```javascript
const express = require(''express'');
const app = express();

// Error handling middleware (must be last)
app.use((err, req, res, next) => {
    console.error(err.stack);
    res.status(500).json({
        error: ''Something went wrong!'',
        message: err.message
    });
});

// Route with error
app.get(''/error'', (req, res, next) => {
    try {
        throw new Error(''Test error'');
    } catch (error) {
        next(error); // Pass to error handler
    }
});

// Async error handling
app.get(''/async-error'', async (req, res, next) => {
    try {
        // Async operation
        await someAsyncOperation();
    } catch (error) {
        next(error);
    }
});
```

---

## Template Engines

### What are Template Engines?

Template engines allow you to use static template files and replace variables with actual values at runtime.

### Setting Up Template Engine

```javascript
const express = require(''express'');
const app = express();

// Set view engine
app.set(''view engine'', ''ejs'');

// Set views directory
app.set(''views'', ''./views'');

// Render template
app.get(''/'', (req, res) => {
    res.render(''index'', {
        title: ''Home Page'',
        message: ''Hello, World!''
    });
});
```

### EJS Template

```html
<!-- views/index.ejs -->
<!DOCTYPE html>
<html>
<head>
    <title><%= title %></title>
</head>
<body>
    <h1><%= title %></h1>
    <p><%= message %></p>
    
    <!-- Loop -->
    <ul>
        <% users.forEach(user => { %>
            <li><%= user.name %></li>
        <% }); %>
    </ul>
    
    <!-- Condition -->
    <% if (isLoggedIn) { %>
        <p>Welcome back!</p>
    <% } else { %>
        <p>Please log in</p>
    <% } %>
</body>
</html>
```

### Handlebars Template

```javascript
// Install: npm install express-handlebars
const express = require(''express'');
const exphbs = require(''express-handlebars'');

const app = express();

app.engine(''handlebars'', exphbs());
app.set(''view engine'', ''handlebars'');

app.get(''/'', (req, res) => {
    res.render(''index'', {
        title: ''Home'',
        users: [
            { name: ''Alice'' },
            { name: ''Bob'' }
        ]
    });
});
```

```handlebars
<!-- views/index.handlebars -->
<h1>{{title}}</h1>
<ul>
    {{#each users}}
        <li>{{name}}</li>
    {{/each}}
</ul>
```

### Pug Template

```javascript
// Install: npm install pug
const express = require(''express'');
const app = express();

app.set(''view engine'', ''pug'');

app.get(''/'', (req, res) => {
    res.render(''index'', {
        title: ''Home'',
        users: [''Alice'', ''Bob'']
    });
});
```

```pug
//- views/index.pug
html
    head
        title= title
    body
        h1= title
        ul
            each user in users
                li= user
```

---

## Practice Exercise

### Exercise: Express App

**Objective**: Practice creating Express applications, working with routes and middleware, handling requests, and using template engines.

**Instructions**:

1. Create an Express application
2. Set up routes and middleware
3. Handle requests and responses
4. Use template engines
5. Practice:
   - Creating Express apps
   - Setting up routes
   - Using middleware
   - Handling requests
   - Rendering templates

**Example Solution**:

```javascript
// src/app.js
const express = require(''express'');
const path = require(''path'');
const app = express();
const PORT = process.env.PORT || 3000;

// Set view engine
app.set(''view engine'', ''ejs'');
app.set(''views'', path.join(__dirname, ''views''));

// Middleware
app.use(express.json());
app.use(express.urlencoded({ extended: true }));
app.use(express.static(path.join(__dirname, ''public'')));

// Logging middleware
app.use((req, res, next) => {
    console.log(`${new Date().toISOString()} - ${req.method} ${req.url}`);
    next();
});

// In-memory data store
let users = [
    { id: 1, name: ''Alice'', email: ''alice@example.com'' },
    { id: 2, name: ''Bob'', email: ''bob@example.com'' }
];

// Routes
app.get(''/'', (req, res) => {
    res.render(''index'', {
        title: ''Home'',
        message: ''Welcome to Express App!''
    });
});

app.get(''/users'', (req, res) => {
    res.render(''users'', {
        title: ''Users'',
        users: users
    });
});

app.get(''/users/:id'', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    if (user) {
        res.render(''user-detail'', {
            title: `User: ${user.name}`,
            user: user
        });
    } else {
        res.status(404).render(''error'', {
            title: ''Not Found'',
            message: ''User not found''
        });
    }
});

app.get(''/api/users'', (req, res) => {
    res.json(users);
});

app.get(''/api/users/:id'', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    if (user) {
        res.json(user);
    } else {
        res.status(404).json({ error: ''User not found'' });
    }
});

app.post(''/api/users'', (req, res) => {
    const { name, email } = req.body;
    if (!name || !email) {
        return res.status(400).json({ error: ''Name and email are required'' });
    }
    
    const newUser = {
        id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
        name,
        email
    };
    
    users.push(newUser);
    res.status(201).json(newUser);
});

app.put(''/api/users/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({ error: ''User not found'' });
    }
    
    const { name, email } = req.body;
    users[userIndex] = { ...users[userIndex], ...req.body };
    
    res.json(users[userIndex]);
});

app.delete(''/api/users/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({ error: ''User not found'' });
    }
    
    users.splice(userIndex, 1);
    res.status(204).send();
});

// Error handling middleware
app.use((err, req, res, next) => {
    console.error(err.stack);
    res.status(500).render(''error'', {
        title: ''Error'',
        message: ''Something went wrong!''
    });
});

// 404 handler
app.use((req, res) => {
    res.status(404).render(''error'', {
        title: ''Not Found'',
        message: ''Page not found''
    });
});

// Start server
app.listen(PORT, () => {
    console.log(`Server running on http://localhost:${PORT}`);
});
```

```html
<!-- views/index.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <h1><%= title %></h1>
        <p><%= message %></p>
        <nav>
            <a href="/">Home</a>
            <a href="/users">Users</a>
            <a href="/api/users">API Users</a>
        </nav>
    </div>
</body>
</html>
```

```html
<!-- views/users.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <h1><%= title %></h1>
        <nav>
            <a href="/">Home</a>
            <a href="/users">Users</a>
        </nav>
        <ul class="user-list">
            <% users.forEach(user => { %>
                <li>
                    <a href="/users/<%= user.id %>">
                        <%= user.name %> - <%= user.email %>
                    </a>
                </li>
            <% }); %>
        </ul>
    </div>
</body>
</html>
```

```html
<!-- views/user-detail.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <h1><%= title %></h1>
        <nav>
            <a href="/">Home</a>
            <a href="/users">Users</a>
        </nav>
        <div class="user-detail">
            <p><strong>ID:</strong> <%= user.id %></p>
            <p><strong>Name:</strong> <%= user.name %></p>
            <p><strong>Email:</strong> <%= user.email %></p>
        </div>
    </div>
</body>
</html>
```

```html
<!-- views/error.ejs -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <h1><%= title %></h1>
        <p><%= message %></p>
        <nav>
            <a href="/">Home</a>
        </nav>
    </div>
</body>
</html>
```

```css
/* public/css/style.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #f4f4f4;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    padding: 20px;
    background-color: white;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

h1 {
    color: #333;
    margin-bottom: 20px;
}

nav {
    margin: 20px 0;
}

nav a {
    display: inline-block;
    margin-right: 10px;
    padding: 8px 16px;
    background-color: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 4px;
}

nav a:hover {
    background-color: #0056b3;
}

.user-list {
    list-style: none;
    padding: 0;
}

.user-list li {
    padding: 10px;
    margin: 5px 0;
    background-color: #f8f9fa;
    border-radius: 4px;
}

.user-list a {
    text-decoration: none;
    color: #007bff;
}

.user-list a:hover {
    text-decoration: underline;
}

.user-detail {
    margin-top: 20px;
    padding: 20px;
    background-color: #f8f9fa;
    border-radius: 4px;
}

.user-detail p {
    margin: 10px 0;
}
```

```json
// package.json
{
  "name": "express-app-practice",
  "version": "1.0.0",
  "description": "Express.js application practice",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "dev": "nodemon src/app.js"
  },
  "dependencies": {
    "express": "^4.18.0",
    "ejs": "^3.1.9"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  },
  "keywords": ["express", "nodejs"],
  "author": "",
  "license": "ISC"
}
```

**Expected Output**:
- Express server running
- HTML pages rendered
- API endpoints working
- Static files served
- Error handling working

**Challenge (Optional)**:
- Add authentication
- Implement sessions
- Add database integration
- Build a complete application

---

## Common Mistakes

### 1. Not Using next() in Middleware

```javascript
// ❌ Bad: Missing next()
app.use((req, res) => {
    console.log(''Request'');
    // Request hangs
});

// ✅ Good: Call next()
app.use((req, res, next) => {
    console.log(''Request'');
    next();
});
```

### 2. Wrong Middleware Order

```javascript
// ❌ Bad: Error handler before routes
app.use((err, req, res, next) => {
    // Error handler
});
app.get(''/'', (req, res) => {
    // Route
});

// ✅ Good: Routes before error handler
app.get(''/'', (req, res) => {
    // Route
});
app.use((err, req, res, next) => {
    // Error handler
});
```

### 3. Not Parsing Body

```javascript
// ❌ Bad: Body not parsed
app.post(''/users'', (req, res) => {
    console.log(req.body); // undefined
});

// ✅ Good: Parse body
app.use(express.json());
app.post(''/users'', (req, res) => {
    console.log(req.body); // { name: ''Alice'' }
});
```

---

## Key Takeaways

1. **Express**: Fast, minimalist web framework
2. **Routes**: Easy route definition
3. **Middleware**: Powerful middleware system
4. **Request/Response**: Simplified request/response handling
5. **Template Engines**: Support for various engines
6. **Best Practice**: Use middleware, handle errors, organize code
7. **Popular**: Industry standard for Node.js

---

## Quiz: Express

Test your understanding with these questions:

1. **Express is:**
   - A) Web framework
   - B) Database
   - C) Both
   - D) Neither

2. **app.get:**
   - A) GET route
   - B) POST route
   - C) Both
   - D) Neither

3. **Middleware:**
   - A) Uses next()
   - B) Doesn''t use next()
   - C) Both
   - D) Neither

4. **req.params:**
   - A) Route parameters
   - B) Query parameters
   - C) Both
   - D) Neither

5. **req.query:**
   - A) Route parameters
   - B) Query parameters
   - C) Both
   - D) Neither

6. **Template engine:**
   - A) Renders views
   - B) Serves static files
   - C) Both
   - D) Neither

7. **Error handler:**
   - A) 4 parameters
   - B) 3 parameters
   - C) Both
   - D) Neither

**Answers**:
1. A) Web framework
2. A) GET route
3. A) Uses next()
4. A) Route parameters
5. B) Query parameters
6. A) Renders views
7. A) 4 parameters (err, req, res, next)

---

## Next Steps

Congratulations! You''ve learned Express.js framework. You now know:
- How to create Express applications
- How to work with routes and middleware
- How to handle requests
- How to use template engines

**What''s Next?**
- Lesson 29.3: RESTful APIs with Express
- Learn REST principles
- Build REST APIs
- Handle API requests/responses

---

## Additional Resources

- **Express Documentation**: [expressjs.com](https://expressjs.com)
- **Express Guide**: [expressjs.com/en/guide/routing.html](https://expressjs.com/en/guide/routing.html)
- **Middleware**: [expressjs.com/en/guide/using-middleware.html](https://expressjs.com/en/guide/using-middleware.html)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:13:14', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand Express.js framework
- Create Express applications
- Work with routes and middleware
- Handle requests and responses
- Use template engines
- Build web applications with Express
- Organize Express applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (193, 69, 17, 'RESTful APIs with Express', 'restful-apis-with-express', '# Lesson 29.3: RESTful APIs with Express

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand REST principles
- Design RESTful API endpoints
- Handle API requests and responses
- Implement proper error handling
- Build REST APIs with Express
- Follow REST conventions
- Create production-ready APIs

---

## Introduction to REST

REST (Representational State Transfer) is an architectural style for designing networked applications. RESTful APIs use HTTP methods to perform operations on resources.

### What is REST?

- **Architectural Style**: Design pattern for web services
- **Resource-Based**: Everything is a resource
- **HTTP Methods**: Use standard HTTP methods
- **Stateless**: Each request is independent
- **Uniform Interface**: Consistent API design
- **Client-Server**: Separation of concerns

---

## REST Principles

### REST Principles

1. **Client-Server**: Separation of client and server
2. **Stateless**: Each request contains all information
3. **Cacheable**: Responses can be cached
4. **Uniform Interface**: Consistent resource identification
5. **Layered System**: System can have multiple layers
6. **Code on Demand**: Optional - server can send executable code

### RESTful Design

- **Resources**: Identified by URLs
- **HTTP Methods**: GET, POST, PUT, DELETE, PATCH
- **Status Codes**: Use appropriate HTTP status codes
- **JSON**: Common format for data exchange
- **Stateless**: No server-side session state

---

## API Endpoints

### RESTful Endpoint Design

```javascript
// Resource: Users
GET    /users           // Get all users
GET    /users/:id       // Get user by ID
POST   /users           // Create new user
PUT    /users/:id       // Update entire user
PATCH  /users/:id       // Partially update user
DELETE /users/:id       // Delete user

// Nested resources
GET    /users/:id/posts        // Get user''s posts
GET    /users/:id/posts/:postId // Get specific post
POST   /users/:id/posts        // Create post for user
```

### Express Router

```javascript
const express = require(''express'');
const router = express.Router();

// GET /users
router.get(''/'', (req, res) => {
    res.json(users);
});

// GET /users/:id
router.get(''/:id'', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    if (user) {
        res.json(user);
    } else {
        res.status(404).json({ error: ''User not found'' });
    }
});

// POST /users
router.post(''/'', (req, res) => {
    const newUser = {
        id: users.length + 1,
        ...req.body
    };
    users.push(newUser);
    res.status(201).json(newUser);
});

// PUT /users/:id
router.put(''/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({ error: ''User not found'' });
    }
    
    users[userIndex] = { id: userId, ...req.body };
    res.json(users[userIndex]);
});

// DELETE /users/:id
router.delete(''/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({ error: ''User not found'' });
    }
    
    users.splice(userIndex, 1);
    res.status(204).send();
});

module.exports = router;
```

### Using Router

```javascript
const express = require(''express'');
const usersRouter = require(''./routes/users'');
const postsRouter = require(''./routes/posts'');

const app = express();

app.use(express.json());

// Mount routers
app.use(''/api/users'', usersRouter);
app.use(''/api/posts'', postsRouter);

app.listen(3000);
```

---

## Request/Response Handling

### Request Validation

```javascript
const express = require(''express'');
const router = express.Router();

// Validation middleware
const validateUser = (req, res, next) => {
    const { name, email } = req.body;
    
    if (!name || !email) {
        return res.status(400).json({
            error: ''Name and email are required''
        });
    }
    
    if (!email.includes(''@'')) {
        return res.status(400).json({
            error: ''Invalid email format''
        });
    }
    
    next();
};

// Use validation
router.post(''/'', validateUser, (req, res) => {
    const newUser = {
        id: Date.now(),
        ...req.body
    };
    res.status(201).json(newUser);
});
```

### Response Formatting

```javascript
const express = require(''express'');
const router = express.Router();

// Success response
router.get(''/:id'', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    
    if (user) {
        res.json({
            success: true,
            data: user
        });
    } else {
        res.status(404).json({
            success: false,
            error: ''User not found''
        });
    }
});

// List response
router.get(''/'', (req, res) => {
    res.json({
        success: true,
        count: users.length,
        data: users
    });
});
```

### Query Parameters

```javascript
const express = require(''express'');
const router = express.Router();

router.get(''/'', (req, res) => {
    const { page = 1, limit = 10, sort = ''id'', order = ''asc'' } = req.query;
    
    // Pagination
    const startIndex = (page - 1) * limit;
    const endIndex = page * limit;
    
    // Sorting
    const sortedUsers = [...users].sort((a, b) => {
        if (order === ''asc'') {
            return a[sort] > b[sort] ? 1 : -1;
        } else {
            return a[sort] < b[sort] ? 1 : -1;
        }
    });
    
    // Paginate
    const paginatedUsers = sortedUsers.slice(startIndex, endIndex);
    
    res.json({
        success: true,
        page: parseInt(page),
        limit: parseInt(limit),
        total: users.length,
        data: paginatedUsers
    });
});
```

---

## Error Handling

### Error Handling Middleware

```javascript
const express = require(''express'');
const app = express();

// Custom error class
class AppError extends Error {
    constructor(message, statusCode) {
        super(message);
        this.statusCode = statusCode;
        this.isOperational = true;
        Error.captureStackTrace(this, this.constructor);
    }
}

// Error handling middleware
const errorHandler = (err, req, res, next) => {
    err.statusCode = err.statusCode || 500;
    err.status = err.status || ''error'';
    
    if (process.env.NODE_ENV === ''development'') {
        res.status(err.statusCode).json({
            status: err.status,
            error: err,
            message: err.message,
            stack: err.stack
        });
    } else {
        // Production
        if (err.isOperational) {
            res.status(err.statusCode).json({
                status: err.status,
                message: err.message
            });
        } else {
            // Programming or unknown error
            res.status(500).json({
                status: ''error'',
                message: ''Something went wrong!''
            });
        }
    }
};

// Use error handler
app.use(errorHandler);
```

### Async Error Handling

```javascript
const express = require(''express'');
const router = express.Router();

// Async wrapper
const asyncHandler = (fn) => {
    return (req, res, next) => {
        Promise.resolve(fn(req, res, next)).catch(next);
    };
};

// Use with async functions
router.get(''/:id'', asyncHandler(async (req, res) => {
    const user = await User.findById(req.params.id);
    if (!user) {
        throw new AppError(''User not found'', 404);
    }
    res.json({ success: true, data: user });
}));
```

### Error Types

```javascript
// 400 - Bad Request
if (!req.body.name) {
    return res.status(400).json({
        error: ''Name is required''
    });
}

// 401 - Unauthorized
if (!isAuthenticated) {
    return res.status(401).json({
        error: ''Unauthorized''
    });
}

// 403 - Forbidden
if (!hasPermission) {
    return res.status(403).json({
        error: ''Forbidden''
    });
}

// 404 - Not Found
if (!user) {
    return res.status(404).json({
        error: ''User not found''
    });
}

// 409 - Conflict
if (userExists) {
    return res.status(409).json({
        error: ''User already exists''
    });
}

// 500 - Internal Server Error
try {
    // Operation
} catch (error) {
    return res.status(500).json({
        error: ''Internal server error''
    });
}
```

---

## Practice Exercise

### Exercise: REST API

**Objective**: Practice building RESTful APIs with Express, implementing proper endpoints, request/response handling, and error handling.

**Instructions**:

1. Create a REST API
2. Implement CRUD operations
3. Add validation and error handling
4. Practice:
   - REST principles
   - API endpoints
   - Request/response handling
   - Error handling

**Example Solution**:

```javascript
// src/routes/users.js
const express = require(''express'');
const router = express.Router();

// In-memory data store
let users = [
    { id: 1, name: ''Alice'', email: ''alice@example.com'', age: 30 },
    { id: 2, name: ''Bob'', email: ''bob@example.com'', age: 25 }
];

// Validation middleware
const validateUser = (req, res, next) => {
    const { name, email, age } = req.body;
    
    if (!name || !email) {
        return res.status(400).json({
            success: false,
            error: ''Name and email are required''
        });
    }
    
    if (!email.includes(''@'')) {
        return res.status(400).json({
            success: false,
            error: ''Invalid email format''
        });
    }
    
    if (age && (isNaN(age) || age < 0)) {
        return res.status(400).json({
            success: false,
            error: ''Age must be a positive number''
        });
    }
    
    next();
};

// GET /api/users - Get all users
router.get(''/'', (req, res) => {
    const { page = 1, limit = 10, sort = ''id'', order = ''asc'' } = req.query;
    
    // Sorting
    const sortedUsers = [...users].sort((a, b) => {
        const aVal = a[sort];
        const bVal = b[sort];
        
        if (order === ''desc'') {
            return aVal < bVal ? 1 : -1;
        }
        return aVal > bVal ? 1 : -1;
    });
    
    // Pagination
    const startIndex = (page - 1) * limit;
    const endIndex = page * limit;
    const paginatedUsers = sortedUsers.slice(startIndex, endIndex);
    
    res.json({
        success: true,
        page: parseInt(page),
        limit: parseInt(limit),
        total: users.length,
        data: paginatedUsers
    });
});

// GET /api/users/:id - Get user by ID
router.get(''/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const user = users.find(u => u.id === userId);
    
    if (!user) {
        return res.status(404).json({
            success: false,
            error: ''User not found''
        });
    }
    
    res.json({
        success: true,
        data: user
    });
});

// POST /api/users - Create new user
router.post(''/'', validateUser, (req, res) => {
    const { name, email, age } = req.body;
    
    // Check if email already exists
    const existingUser = users.find(u => u.email === email);
    if (existingUser) {
        return res.status(409).json({
            success: false,
            error: ''User with this email already exists''
        });
    }
    
    const newUser = {
        id: users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1,
        name,
        email,
        age: age || null
    };
    
    users.push(newUser);
    
    res.status(201).json({
        success: true,
        data: newUser
    });
});

// PUT /api/users/:id - Update entire user
router.put(''/:id'', validateUser, (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({
            success: false,
            error: ''User not found''
        });
    }
    
    const { name, email, age } = req.body;
    
    // Check if email is taken by another user
    const emailTaken = users.some(u => u.email === email && u.id !== userId);
    if (emailTaken) {
        return res.status(409).json({
            success: false,
            error: ''Email already taken''
        });
    }
    
    users[userIndex] = {
        id: userId,
        name,
        email,
        age: age || null
    };
    
    res.json({
        success: true,
        data: users[userIndex]
    });
});

// PATCH /api/users/:id - Partially update user
router.patch(''/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({
            success: false,
            error: ''User not found''
        });
    }
    
    const { name, email, age } = req.body;
    
    // Validate email if provided
    if (email && !email.includes(''@'')) {
        return res.status(400).json({
            success: false,
            error: ''Invalid email format''
        });
    }
    
    // Check if email is taken
    if (email) {
        const emailTaken = users.some(u => u.email === email && u.id !== userId);
        if (emailTaken) {
            return res.status(409).json({
                success: false,
                error: ''Email already taken''
            });
        }
    }
    
    // Update only provided fields
    if (name) users[userIndex].name = name;
    if (email) users[userIndex].email = email;
    if (age !== undefined) users[userIndex].age = age;
    
    res.json({
        success: true,
        data: users[userIndex]
    });
});

// DELETE /api/users/:id - Delete user
router.delete(''/:id'', (req, res) => {
    const userId = parseInt(req.params.id);
    const userIndex = users.findIndex(u => u.id === userId);
    
    if (userIndex === -1) {
        return res.status(404).json({
            success: false,
            error: ''User not found''
        });
    }
    
    users.splice(userIndex, 1);
    
    res.status(204).send();
});

module.exports = router;
```

```javascript
// src/middleware/errorHandler.js
const errorHandler = (err, req, res, next) => {
    let error = { ...err };
    error.message = err.message;
    
    // Log error
    console.error(err);
    
    // Mongoose bad ObjectId
    if (err.name === ''CastError'') {
        const message = ''Resource not found'';
        error = { message, statusCode: 404 };
    }
    
    // Mongoose duplicate key
    if (err.code === 11000) {
        const message = ''Duplicate field value entered'';
        error = { message, statusCode: 400 };
    }
    
    // Mongoose validation error
    if (err.name === ''ValidationError'') {
        const message = Object.values(err.errors).map(val => val.message);
        error = { message, statusCode: 400 };
    }
    
    res.status(error.statusCode || 500).json({
        success: false,
        error: error.message || ''Server Error''
    });
};

module.exports = errorHandler;
```

```javascript
// src/middleware/notFound.js
const notFound = (req, res, next) => {
    res.status(404).json({
        success: false,
        error: `Route ${req.originalUrl} not found`
    });
};

module.exports = notFound;
```

```javascript
// src/app.js
const express = require(''express'');
const usersRouter = require(''./routes/users'');
const errorHandler = require(''./middleware/errorHandler'');
const notFound = require(''./middleware/notFound'');

const app = express();

// Middleware
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// CORS
app.use((req, res, next) => {
    res.header(''Access-Control-Allow-Origin'', ''*'');
    res.header(''Access-Control-Allow-Methods'', ''GET, POST, PUT, PATCH, DELETE'');
    res.header(''Access-Control-Allow-Headers'', ''Content-Type, Authorization'');
    next();
});

// Routes
app.get(''/'', (req, res) => {
    res.json({
        success: true,
        message: ''Welcome to REST API'',
        endpoints: {
            users: ''/api/users''
        }
    });
});

app.use(''/api/users'', usersRouter);

// Error handling
app.use(notFound);
app.use(errorHandler);

// Start server
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
    console.log(`API available at http://localhost:${PORT}/api`);
});
```

```json
// package.json
{
  "name": "rest-api-practice",
  "version": "1.0.0",
  "description": "RESTful API practice with Express",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "dev": "nodemon src/app.js"
  },
  "dependencies": {
    "express": "^4.18.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  },
  "keywords": ["express", "rest", "api"],
  "author": "",
  "license": "ISC"
}
```

**Testing the API**:

```bash
# Start server
npm start

# GET all users
curl http://localhost:3000/api/users

# GET user by ID
curl http://localhost:3000/api/users/1

# POST create user
curl -X POST http://localhost:3000/api/users \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Charlie","email":"charlie@example.com","age":35}''

# PUT update user
curl -X PUT http://localhost:3000/api/users/1 \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"Alice Updated","email":"alice.updated@example.com","age":31}''

# PATCH partial update
curl -X PATCH http://localhost:3000/api/users/1 \\
  -H "Content-Type: application/json" \\
  -d ''{"age":32}''

# DELETE user
curl -X DELETE http://localhost:3000/api/users/1
```

**Expected Output**:
- REST API with CRUD operations
- Proper status codes
- Error handling
- Validation
- Pagination and sorting

**Challenge (Optional)**:
- Add authentication
- Implement rate limiting
- Add API documentation
- Create nested resources

---

## Common Mistakes

### 1. Wrong HTTP Methods

```javascript
// ❌ Bad: Using GET for creating
app.get(''/users'', createUser);

// ✅ Good: Use POST for creating
app.post(''/users'', createUser);
```

### 2. Not Using Status Codes

```javascript
// ❌ Bad: Always 200
res.json({ error: ''Not found'' });

// ✅ Good: Use appropriate status code
res.status(404).json({ error: ''Not found'' });
```

### 3. Inconsistent Response Format

```javascript
// ❌ Bad: Inconsistent format
res.json(user);
res.json({ data: user });
res.json({ success: true, user });

// ✅ Good: Consistent format
res.json({ success: true, data: user });
```

---

## Key Takeaways

1. **REST**: Architectural style for web services
2. **Resources**: Identified by URLs
3. **HTTP Methods**: GET, POST, PUT, PATCH, DELETE
4. **Status Codes**: Use appropriate codes
5. **Error Handling**: Proper error responses
6. **Best Practice**: Consistent format, validation, documentation
7. **RESTful**: Follow REST principles

---

## Quiz: REST APIs

Test your understanding with these questions:

1. **REST stands for:**
   - A) Representational State Transfer
   - B) Remote State Transfer
   - C) Both
   - D) Neither

2. **GET method:**
   - A) Retrieve data
   - B) Create data
   - C) Both
   - D) Neither

3. **POST method:**
   - A) Retrieve data
   - B) Create data
   - C) Both
   - D) Neither

4. **PUT method:**
   - A) Update entire resource
   - B) Partial update
   - C) Both
   - D) Neither

5. **PATCH method:**
   - A) Update entire resource
   - B) Partial update
   - C) Both
   - D) Neither

6. **Status code 201:**
   - A) Created
   - B) Updated
   - C) Both
   - D) Neither

7. **Status code 204:**
   - A) No content
   - B) Success
   - C) Both
   - D) Neither

**Answers**:
1. A) Representational State Transfer
2. A) Retrieve data
3. B) Create data
4. A) Update entire resource
5. B) Partial update
6. A) Created
7. A) No content

---

## Next Steps

Congratulations! You''ve completed Module 29: Building Web Servers. You now know:
- How to create HTTP servers
- How to use Express.js
- How to build RESTful APIs
- How to handle requests and errors

**What''s Next?**
- Module 30: Databases and Authentication
- Lesson 30.1: Working with Databases
- Learn database integration
- Work with SQL and NoSQL databases

---

## Additional Resources

- **REST API Tutorial**: [restfulapi.net](https://restfulapi.net)
- **HTTP Status Codes**: [developer.mozilla.org/en-US/docs/Web/HTTP/Status](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)
- **Express Best Practices**: [expressjs.com/en/advanced/best-practice-performance.html](https://expressjs.com/en/advanced/best-practice-performance.html)

---

*Lesson completed! You''ve finished Module 29: Building Web Servers. Ready for Module 30: Databases and Authentication!*

', NULL, 3, '2026-01-03 10:13:54', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand REST principles
- Design RESTful API endpoints
- Handle API requests and responses
- Implement proper error handling
- Build REST APIs with Express
- Follow REST conventions
- Create production-ready APIs');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (187, 70, 17, 'Working with Databases', 'working-with-databases', '# Lesson 30.1: Working with Databases

## Learning Objectives

By the end of this lesson, you will be able to:
- Work with SQL databases (MySQL, PostgreSQL)
- Work with NoSQL databases (MongoDB)
- Use ORMs (Sequelize, Mongoose)
- Establish database connections
- Perform CRUD operations
- Query databases
- Integrate databases with Node.js applications

---

## Introduction to Databases

Databases are systems for storing and managing data. They provide efficient ways to store, retrieve, and manipulate data.

### Types of Databases

- **SQL Databases**: Relational databases (MySQL, PostgreSQL)
- **NoSQL Databases**: Non-relational databases (MongoDB, Redis)
- **In-Memory Databases**: Store data in memory (Redis)
- **Document Databases**: Store documents (MongoDB)
- **Graph Databases**: Store relationships (Neo4j)

---

## SQL Databases

### MySQL

MySQL is a popular open-source relational database management system.

#### Installation

```bash
# Install MySQL driver
npm install mysql2

# Or with promise support
npm install mysql2/promise
```

#### Basic Connection

```javascript
const mysql = require(''mysql2/promise'');

// Create connection pool
const pool = mysql.createPool({
    host: ''localhost'',
    user: ''root'',
    password: ''password'',
    database: ''mydb'',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
});

// Use connection
async function getUsers() {
    const [rows] = await pool.execute(''SELECT * FROM users'');
    return rows;
}
```

#### CRUD Operations

```javascript
const mysql = require(''mysql2/promise'');

const pool = mysql.createPool({
    host: ''localhost'',
    user: ''root'',
    password: ''password'',
    database: ''mydb''
});

// CREATE
async function createUser(name, email) {
    const [result] = await pool.execute(
        ''INSERT INTO users (name, email) VALUES (?, ?)'',
        [name, email]
    );
    return result.insertId;
}

// READ
async function getUsers() {
    const [rows] = await pool.execute(''SELECT * FROM users'');
    return rows;
}

async function getUserById(id) {
    const [rows] = await pool.execute(
        ''SELECT * FROM users WHERE id = ?'',
        [id]
    );
    return rows[0];
}

// UPDATE
async function updateUser(id, name, email) {
    const [result] = await pool.execute(
        ''UPDATE users SET name = ?, email = ? WHERE id = ?'',
        [name, email, id]
    );
    return result.affectedRows;
}

// DELETE
async function deleteUser(id) {
    const [result] = await pool.execute(
        ''DELETE FROM users WHERE id = ?'',
        [id]
    );
    return result.affectedRows;
}
```

### PostgreSQL

PostgreSQL is a powerful open-source relational database.

#### Installation

```bash
npm install pg
```

#### Basic Connection

```javascript
const { Pool } = require(''pg'');

const pool = new Pool({
    user: ''postgres'',
    host: ''localhost'',
    database: ''mydb'',
    password: ''password'',
    port: 5432
});

// Query
async function getUsers() {
    const result = await pool.query(''SELECT * FROM users'');
    return result.rows;
}
```

#### CRUD Operations

```javascript
const { Pool } = require(''pg'');

const pool = new Pool({
    user: ''postgres'',
    host: ''localhost'',
    database: ''mydb'',
    password: ''password'',
    port: 5432
});

// CREATE
async function createUser(name, email) {
    const result = await pool.query(
        ''INSERT INTO users (name, email) VALUES ($1, $2) RETURNING *'',
        [name, email]
    );
    return result.rows[0];
}

// READ
async function getUsers() {
    const result = await pool.query(''SELECT * FROM users'');
    return result.rows;
}

// UPDATE
async function updateUser(id, name, email) {
    const result = await pool.query(
        ''UPDATE users SET name = $1, email = $2 WHERE id = $3 RETURNING *'',
        [name, email, id]
    );
    return result.rows[0];
}

// DELETE
async function deleteUser(id) {
    const result = await pool.query(
        ''DELETE FROM users WHERE id = $1 RETURNING *'',
        [id]
    );
    return result.rows[0];
}
```

---

## NoSQL Databases

### MongoDB

MongoDB is a popular NoSQL document database.

#### Installation

```bash
npm install mongodb
# Or with Mongoose
npm install mongoose
```

#### Basic Connection (Native Driver)

```javascript
const { MongoClient } = require(''mongodb'');

const uri = ''mongodb://localhost:27017'';
const client = new MongoClient(uri);

async function connect() {
    try {
        await client.connect();
        console.log(''Connected to MongoDB'');
        return client.db(''mydb'');
    } catch (error) {
        console.error(''Connection error:'', error);
        throw error;
    }
}

// Use database
async function getUsers() {
    const db = await connect();
    const users = db.collection(''users'');
    return await users.find({}).toArray();
}
```

#### CRUD Operations (Native Driver)

```javascript
const { MongoClient } = require(''mongodb'');

const uri = ''mongodb://localhost:27017'';
const client = new MongoClient(uri);

async function getDb() {
    await client.connect();
    return client.db(''mydb'');
}

// CREATE
async function createUser(name, email) {
    const db = await getDb();
    const users = db.collection(''users'');
    const result = await users.insertOne({ name, email });
    return result.insertedId;
}

// READ
async function getUsers() {
    const db = await getDb();
    const users = db.collection(''users'');
    return await users.find({}).toArray();
}

async function getUserById(id) {
    const db = await getDb();
    const users = db.collection(''users'');
    return await users.findOne({ _id: id });
}

// UPDATE
async function updateUser(id, name, email) {
    const db = await getDb();
    const users = db.collection(''users'');
    const result = await users.updateOne(
        { _id: id },
        { $set: { name, email } }
    );
    return result.modifiedCount;
}

// DELETE
async function deleteUser(id) {
    const db = await getDb();
    const users = db.collection(''users'');
    const result = await users.deleteOne({ _id: id });
    return result.deletedCount;
}
```

---

## ORMs

### Sequelize (SQL ORM)

Sequelize is a promise-based ORM for Node.js.

#### Installation

```bash
npm install sequelize
npm install mysql2  # For MySQL
# or
npm install pg pg-hstore  # For PostgreSQL
```

#### Basic Setup

```javascript
const { Sequelize } = require(''sequelize'');

const sequelize = new Sequelize(''mydb'', ''user'', ''password'', {
    host: ''localhost'',
    dialect: ''mysql''
});

// Test connection
async function testConnection() {
    try {
        await sequelize.authenticate();
        console.log(''Connection established'');
    } catch (error) {
        console.error(''Unable to connect:'', error);
    }
}
```

#### Define Models

```javascript
const { Sequelize, DataTypes } = require(''sequelize'');

const sequelize = new Sequelize(''mydb'', ''user'', ''password'', {
    host: ''localhost'',
    dialect: ''mysql''
});

// Define User model
const User = sequelize.define(''User'', {
    id: {
        type: DataTypes.INTEGER,
        primaryKey: true,
        autoIncrement: true
    },
    name: {
        type: DataTypes.STRING,
        allowNull: false
    },
    email: {
        type: DataTypes.STRING,
        allowNull: false,
        unique: true
    }
}, {
    tableName: ''users'',
    timestamps: true
});

// Sync model
await User.sync();
```

#### CRUD Operations (Sequelize)

```javascript
// CREATE
const user = await User.create({
    name: ''Alice'',
    email: ''alice@example.com''
});

// READ
const users = await User.findAll();
const user = await User.findByPk(1);
const user = await User.findOne({ where: { email: ''alice@example.com'' } });

// UPDATE
await user.update({ name: ''Alice Updated'' });
// or
await User.update(
    { name: ''Alice Updated'' },
    { where: { id: 1 } }
);

// DELETE
await user.destroy();
// or
await User.destroy({ where: { id: 1 } });
```

### Mongoose (MongoDB ORM)

Mongoose is an ODM (Object Document Mapper) for MongoDB.

#### Installation

```bash
npm install mongoose
```

#### Basic Setup

```javascript
const mongoose = require(''mongoose'');

const uri = ''mongodb://localhost:27017/mydb'';

async function connect() {
    try {
        await mongoose.connect(uri);
        console.log(''Connected to MongoDB'');
    } catch (error) {
        console.error(''Connection error:'', error);
        throw error;
    }
}
```

#### Define Schemas

```javascript
const mongoose = require(''mongoose'');

const userSchema = new mongoose.Schema({
    name: {
        type: String,
        required: true
    },
    email: {
        type: String,
        required: true,
        unique: true
    },
    age: {
        type: Number,
        min: 0
    },
    createdAt: {
        type: Date,
        default: Date.now
    }
});

const User = mongoose.model(''User'', userSchema);
```

#### CRUD Operations (Mongoose)

```javascript
// CREATE
const user = await User.create({
    name: ''Alice'',
    email: ''alice@example.com'',
    age: 30
});

// READ
const users = await User.find();
const user = await User.findById(id);
const user = await User.findOne({ email: ''alice@example.com'' });

// UPDATE
await User.findByIdAndUpdate(id, { name: ''Alice Updated'' });
// or
user.name = ''Alice Updated'';
await user.save();

// DELETE
await User.findByIdAndDelete(id);
// or
await user.deleteOne();
```

---

## Database Connections

### Connection Pooling

```javascript
// MySQL with connection pool
const mysql = require(''mysql2/promise'');

const pool = mysql.createPool({
    host: ''localhost'',
    user: ''root'',
    password: ''password'',
    database: ''mydb'',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
});

// Use pool
const [rows] = await pool.execute(''SELECT * FROM users'');
```

### Environment Variables

```javascript
// .env file
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=password
DB_NAME=mydb
DB_PORT=3306

// Use in code
require(''dotenv'').config();

const pool = mysql.createPool({
    host: process.env.DB_HOST,
    user: process.env.DB_USER,
    password: process.env.DB_PASSWORD,
    database: process.env.DB_NAME,
    port: process.env.DB_PORT
});
```

### Error Handling

```javascript
async function getUsers() {
    try {
        const [rows] = await pool.execute(''SELECT * FROM users'');
        return rows;
    } catch (error) {
        console.error(''Database error:'', error);
        throw error;
    }
}
```

---

## Practice Exercise

### Exercise: Database Integration

**Objective**: Practice working with databases, using ORMs, and integrating databases with Node.js applications.

**Instructions**:

1. Set up database connection
2. Create models/schemas
3. Implement CRUD operations
4. Practice:
   - SQL databases (MySQL/PostgreSQL)
   - NoSQL databases (MongoDB)
   - ORMs (Sequelize/Mongoose)
   - Database connections

**Example Solution**:

```javascript
// src/config/database.js
const mysql = require(''mysql2/promise'');
require(''dotenv'').config();

const pool = mysql.createPool({
    host: process.env.DB_HOST || ''localhost'',
    user: process.env.DB_USER || ''root'',
    password: process.env.DB_PASSWORD || '''',
    database: process.env.DB_NAME || ''mydb'',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
});

module.exports = pool;
```

```javascript
// src/models/user.js (MySQL with mysql2)
const pool = require(''../config/database'');

class User {
    static async findAll() {
        const [rows] = await pool.execute(''SELECT * FROM users'');
        return rows;
    }
    
    static async findById(id) {
        const [rows] = await pool.execute(
            ''SELECT * FROM users WHERE id = ?'',
            [id]
        );
        return rows[0];
    }
    
    static async create(name, email) {
        const [result] = await pool.execute(
            ''INSERT INTO users (name, email) VALUES (?, ?)'',
            [name, email]
        );
        return result.insertId;
    }
    
    static async update(id, name, email) {
        const [result] = await pool.execute(
            ''UPDATE users SET name = ?, email = ? WHERE id = ?'',
            [name, email, id]
        );
        return result.affectedRows;
    }
    
    static async delete(id) {
        const [result] = await pool.execute(
            ''DELETE FROM users WHERE id = ?'',
            [id]
        );
        return result.affectedRows;
    }
}

module.exports = User;
```

```javascript
// src/models/user.js (MongoDB with Mongoose)
const mongoose = require(''mongoose'');

const userSchema = new mongoose.Schema({
    name: {
        type: String,
        required: true,
        trim: true
    },
    email: {
        type: String,
        required: true,
        unique: true,
        lowercase: true,
        trim: true
    },
    age: {
        type: Number,
        min: 0
    }
}, {
    timestamps: true
});

const User = mongoose.model(''User'', userSchema);

module.exports = User;
```

```javascript
// src/models/user.js (Sequelize)
const { DataTypes } = require(''sequelize'');
const sequelize = require(''../config/database'');

const User = sequelize.define(''User'', {
    id: {
        type: DataTypes.INTEGER,
        primaryKey: true,
        autoIncrement: true
    },
    name: {
        type: DataTypes.STRING,
        allowNull: false,
        validate: {
            notEmpty: true
        }
    },
    email: {
        type: DataTypes.STRING,
        allowNull: false,
        unique: true,
        validate: {
            isEmail: true
        }
    },
    age: {
        type: DataTypes.INTEGER,
        allowNull: true,
        validate: {
            min: 0
        }
    }
}, {
    tableName: ''users'',
    timestamps: true
});

module.exports = User;
```

```javascript
// src/routes/users.js (with MySQL)
const express = require(''express'');
const router = express.Router();
const User = require(''../models/user'');

router.get(''/'', async (req, res) => {
    try {
        const users = await User.findAll();
        res.json({ success: true, data: users });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.get(''/:id'', async (req, res) => {
    try {
        const user = await User.findById(req.params.id);
        if (user) {
            res.json({ success: true, data: user });
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.post(''/'', async (req, res) => {
    try {
        const { name, email } = req.body;
        if (!name || !email) {
            return res.status(400).json({
                success: false,
                error: ''Name and email are required''
            });
        }
        
        const userId = await User.create(name, email);
        res.status(201).json({
            success: true,
            data: { id: userId, name, email }
        });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.put(''/:id'', async (req, res) => {
    try {
        const { name, email } = req.body;
        const affectedRows = await User.update(req.params.id, name, email);
        
        if (affectedRows > 0) {
            res.json({ success: true, message: ''User updated'' });
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.delete(''/:id'', async (req, res) => {
    try {
        const affectedRows = await User.delete(req.params.id);
        
        if (affectedRows > 0) {
            res.status(204).send();
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

module.exports = router;
```

```javascript
// src/routes/users.js (with Mongoose)
const express = require(''express'');
const router = express.Router();
const User = require(''../models/user'');

router.get(''/'', async (req, res) => {
    try {
        const users = await User.find();
        res.json({ success: true, data: users });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.get(''/:id'', async (req, res) => {
    try {
        const user = await User.findById(req.params.id);
        if (user) {
            res.json({ success: true, data: user });
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.post(''/'', async (req, res) => {
    try {
        const { name, email, age } = req.body;
        const user = await User.create({ name, email, age });
        res.status(201).json({ success: true, data: user });
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.put(''/:id'', async (req, res) => {
    try {
        const user = await User.findByIdAndUpdate(
            req.params.id,
            req.body,
            { new: true, runValidators: true }
        );
        
        if (user) {
            res.json({ success: true, data: user });
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

router.delete(''/:id'', async (req, res) => {
    try {
        const user = await User.findByIdAndDelete(req.params.id);
        
        if (user) {
            res.status(204).send();
        } else {
            res.status(404).json({ success: false, error: ''User not found'' });
        }
    } catch (error) {
        res.status(500).json({ success: false, error: error.message });
    }
});

module.exports = router;
```

```javascript
// src/app.js
const express = require(''express'');
const mongoose = require(''mongoose'');
const usersRouter = require(''./routes/users'');
require(''dotenv'').config();

const app = express();

app.use(express.json());

// Connect to MongoDB
mongoose.connect(process.env.MONGODB_URI || ''mongodb://localhost:27017/mydb'')
    .then(() => console.log(''Connected to MongoDB''))
    .catch(err => console.error(''MongoDB connection error:'', err));

// Routes
app.use(''/api/users'', usersRouter);

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

**Expected Output**:
- Database connection established
- CRUD operations working
- API endpoints functional
- Error handling in place

**Challenge (Optional)**:
- Add relationships/associations
- Implement transactions
- Add database migrations
- Create complex queries

---

## Common Mistakes

### 1. SQL Injection

```javascript
// ❌ Bad: SQL injection vulnerability
const query = `SELECT * FROM users WHERE name = ''${name}''`;

// ✅ Good: Use parameterized queries
const [rows] = await pool.execute(
    ''SELECT * FROM users WHERE name = ?'',
    [name]
);
```

### 2. Not Closing Connections

```javascript
// ❌ Bad: Connection not closed
const connection = await mysql.createConnection(config);

// ✅ Good: Use connection pool or close connection
const pool = mysql.createPool(config);
// Pool manages connections automatically
```

### 3. Not Handling Errors

```javascript
// ❌ Bad: No error handling
const users = await User.find();

// ✅ Good: Handle errors
try {
    const users = await User.find();
} catch (error) {
    console.error(''Database error:'', error);
    throw error;
}
```

---

## Key Takeaways

1. **SQL Databases**: MySQL, PostgreSQL (relational)
2. **NoSQL Databases**: MongoDB (document-based)
3. **ORMs**: Sequelize (SQL), Mongoose (MongoDB)
4. **Connections**: Use connection pools
5. **Security**: Use parameterized queries
6. **Best Practice**: Handle errors, use environment variables
7. **Choose**: Based on use case and requirements

---

## Quiz: Databases

Test your understanding with these questions:

1. **SQL databases:**
   - A) Relational
   - B) Non-relational
   - C) Both
   - D) Neither

2. **NoSQL databases:**
   - A) Relational
   - B) Non-relational
   - C) Both
   - D) Neither

3. **Sequelize:**
   - A) SQL ORM
   - B) MongoDB ODM
   - C) Both
   - D) Neither

4. **Mongoose:**
   - A) SQL ORM
   - B) MongoDB ODM
   - C) Both
   - D) Neither

5. **Connection pool:**
   - A) Manages connections
   - B) Single connection
   - C) Both
   - D) Neither

6. **Parameterized queries:**
   - A) Prevent SQL injection
   - B) Don''t prevent SQL injection
   - C) Both
   - D) Neither

7. **MongoDB:**
   - A) Document database
   - B) Relational database
   - C) Both
   - D) Neither

**Answers**:
1. A) Relational
2. B) Non-relational
3. A) SQL ORM
4. B) MongoDB ODM
5. A) Manages connections
6. A) Prevent SQL injection
7. A) Document database

---

## Next Steps

Congratulations! You''ve learned working with databases. You now know:
- How to work with SQL databases
- How to work with NoSQL databases
- How to use ORMs
- How to establish database connections

**What''s Next?**
- Lesson 30.2: Authentication and Security
- Learn authentication strategies
- Understand JWT tokens
- Implement password hashing

---

## Additional Resources

- **MySQL**: [dev.mysql.com](https://dev.mysql.com)
- **PostgreSQL**: [postgresql.org](https://www.postgresql.org)
- **MongoDB**: [mongodb.com](https://www.mongodb.com)
- **Sequelize**: [sequelize.org](https://sequelize.org)
- **Mongoose**: [mongoosejs.com](https://mongoosejs.com)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 1, '2026-01-03 10:13:14', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Work with SQL databases (MySQL, PostgreSQL)
- Work with NoSQL databases (MongoDB)
- Use ORMs (Sequelize, Mongoose)
- Establish database connections
- Perform CRUD operations
- Query databases
- Integrate databases with Node.js applications');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (188, 70, 17, 'Authentication and Security', 'authentication-and-security', '# Lesson 30.2: Authentication and Security

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand authentication strategies
- Implement JWT tokens
- Hash passwords with bcrypt
- Manage sessions
- Apply security best practices
- Build secure authentication systems
- Protect user data

---

## Introduction to Authentication

Authentication is the process of verifying who a user is. It ensures that users are who they claim to be.

### Authentication vs Authorization

- **Authentication**: Verifying identity (who you are)
- **Authorization**: Verifying permissions (what you can do)

### Authentication Methods

- **Password-based**: Username and password
- **Token-based**: JWT tokens
- **Session-based**: Server-side sessions
- **OAuth**: Third-party authentication
- **Multi-factor**: Multiple verification methods

---

## Authentication Strategies

### Basic Authentication

```javascript
const express = require(''express'');
const app = express();

// Basic auth middleware
const basicAuth = (req, res, next) => {
    const authHeader = req.headers.authorization;
    
    if (!authHeader) {
        return res.status(401).json({ error: ''Unauthorized'' });
    }
    
    const credentials = Buffer.from(
        authHeader.split('' '')[1],
        ''base64''
    ).toString().split('':'');
    
    const [username, password] = credentials;
    
    // Verify credentials
    if (username === ''admin'' && password === ''password'') {
        next();
    } else {
        res.status(401).json({ error: ''Invalid credentials'' });
    }
};

app.get(''/protected'', basicAuth, (req, res) => {
    res.json({ message: ''Protected resource'' });
});
```

### Custom Authentication

```javascript
const express = require(''express'');
const app = express();

// Login endpoint
app.post(''/login'', async (req, res) => {
    const { email, password } = req.body;
    
    // Find user
    const user = await User.findOne({ email });
    if (!user) {
        return res.status(401).json({ error: ''Invalid credentials'' });
    }
    
    // Verify password
    const isValid = await bcrypt.compare(password, user.password);
    if (!isValid) {
        return res.status(401).json({ error: ''Invalid credentials'' });
    }
    
    // Generate token
    const token = jwt.sign(
        { userId: user.id },
        process.env.JWT_SECRET,
        { expiresIn: ''1h'' }
    );
    
    res.json({ token, user: { id: user.id, email: user.email } });
});
```

---

## JWT Tokens

### What is JWT?

JWT (JSON Web Token) is a compact, URL-safe token format for securely transmitting information.

### JWT Structure

```
header.payload.signature
```

### Installation

```bash
npm install jsonwebtoken
```

### Creating Tokens

```javascript
const jwt = require(''jsonwebtoken'');

// Create token
const token = jwt.sign(
    { userId: 123, email: ''user@example.com'' },
    process.env.JWT_SECRET,
    { expiresIn: ''1h'' }
);

// Token with more options
const token = jwt.sign(
    { userId: 123 },
    process.env.JWT_SECRET,
    {
        expiresIn: ''24h'',
        issuer: ''myapp'',
        audience: ''myapp-users''
    }
);
```

### Verifying Tokens

```javascript
const jwt = require(''jsonwebtoken'');

// Verify token
try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    console.log(''Decoded:'', decoded);
} catch (error) {
    console.error(''Invalid token:'', error);
}
```

### JWT Middleware

```javascript
const jwt = require(''jsonwebtoken'');

const authenticateToken = (req, res, next) => {
    const authHeader = req.headers[''authorization''];
    const token = authHeader && authHeader.split('' '')[1]; // Bearer TOKEN
    
    if (!token) {
        return res.status(401).json({ error: ''Access token required'' });
    }
    
    jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
        if (err) {
            return res.status(403).json({ error: ''Invalid or expired token'' });
        }
        
        req.user = user;
        next();
    });
};

// Use middleware
app.get(''/protected'', authenticateToken, (req, res) => {
    res.json({ message: ''Protected resource'', user: req.user });
});
```

### Refresh Tokens

```javascript
const jwt = require(''jsonwebtoken'');

// Generate tokens
function generateTokens(user) {
    const accessToken = jwt.sign(
        { userId: user.id },
        process.env.JWT_SECRET,
        { expiresIn: ''15m'' }
    );
    
    const refreshToken = jwt.sign(
        { userId: user.id },
        process.env.JWT_REFRESH_SECRET,
        { expiresIn: ''7d'' }
    );
    
    return { accessToken, refreshToken };
}

// Refresh access token
app.post(''/refresh'', (req, res) => {
    const { refreshToken } = req.body;
    
    if (!refreshToken) {
        return res.status(401).json({ error: ''Refresh token required'' });
    }
    
    jwt.verify(refreshToken, process.env.JWT_REFRESH_SECRET, (err, user) => {
        if (err) {
            return res.status(403).json({ error: ''Invalid refresh token'' });
        }
        
        const accessToken = jwt.sign(
            { userId: user.userId },
            process.env.JWT_SECRET,
            { expiresIn: ''15m'' }
        );
        
        res.json({ accessToken });
    });
});
```

---

## Password Hashing (bcrypt)

### Why Hash Passwords?

- **Security**: Passwords should never be stored in plain text
- **Hashing**: One-way function (can''t be reversed)
- **Salting**: Adds random data to prevent rainbow table attacks

### Installation

```bash
npm install bcrypt
```

### Hashing Passwords

```javascript
const bcrypt = require(''bcrypt'');

// Hash password
async function hashPassword(password) {
    const saltRounds = 10;
    const hashedPassword = await bcrypt.hash(password, saltRounds);
    return hashedPassword;
}

// Compare password
async function comparePassword(password, hashedPassword) {
    const isMatch = await bcrypt.compare(password, hashedPassword);
    return isMatch;
}
```

### User Registration

```javascript
const bcrypt = require(''bcrypt'');
const User = require(''../models/user'');

app.post(''/register'', async (req, res) => {
    try {
        const { name, email, password } = req.body;
        
        // Check if user exists
        const existingUser = await User.findOne({ email });
        if (existingUser) {
            return res.status(400).json({ error: ''User already exists'' });
        }
        
        // Hash password
        const hashedPassword = await bcrypt.hash(password, 10);
        
        // Create user
        const user = await User.create({
            name,
            email,
            password: hashedPassword
        });
        
        // Generate token
        const token = jwt.sign(
            { userId: user.id },
            process.env.JWT_SECRET,
            { expiresIn: ''1h'' }
        );
        
        res.status(201).json({
            token,
            user: { id: user.id, name: user.name, email: user.email }
        });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});
```

### User Login

```javascript
const bcrypt = require(''bcrypt'');
const jwt = require(''jsonwebtoken'');
const User = require(''../models/user'');

app.post(''/login'', async (req, res) => {
    try {
        const { email, password } = req.body;
        
        // Find user
        const user = await User.findOne({ email });
        if (!user) {
            return res.status(401).json({ error: ''Invalid credentials'' });
        }
        
        // Compare password
        const isMatch = await bcrypt.compare(password, user.password);
        if (!isMatch) {
            return res.status(401).json({ error: ''Invalid credentials'' });
        }
        
        // Generate token
        const token = jwt.sign(
            { userId: user.id },
            process.env.JWT_SECRET,
            { expiresIn: ''1h'' }
        );
        
        res.json({
            token,
            user: { id: user.id, name: user.name, email: user.email }
        });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});
```

---

## Session Management

### Express Sessions

```bash
npm install express-session
```

### Session Setup

```javascript
const express = require(''express'');
const session = require(''express-session'');
const app = express();

app.use(session({
    secret: process.env.SESSION_SECRET,
    resave: false,
    saveUninitialized: false,
    cookie: {
        secure: process.env.NODE_ENV === ''production'',
        httpOnly: true,
        maxAge: 24 * 60 * 60 * 1000 // 24 hours
    }
}));
```

### Using Sessions

```javascript
// Login
app.post(''/login'', async (req, res) => {
    const { email, password } = req.body;
    
    const user = await User.findOne({ email });
    if (!user) {
        return res.status(401).json({ error: ''Invalid credentials'' });
    }
    
    const isMatch = await bcrypt.compare(password, user.password);
    if (!isMatch) {
        return res.status(401).json({ error: ''Invalid credentials'' });
    }
    
    // Store in session
    req.session.userId = user.id;
    req.session.email = user.email;
    
    res.json({ message: ''Logged in successfully'' });
});

// Protected route
app.get(''/profile'', (req, res) => {
    if (!req.session.userId) {
        return res.status(401).json({ error: ''Not authenticated'' });
    }
    
    res.json({ userId: req.session.userId, email: req.session.email });
});

// Logout
app.post(''/logout'', (req, res) => {
    req.session.destroy((err) => {
        if (err) {
            return res.status(500).json({ error: ''Logout failed'' });
        }
        res.json({ message: ''Logged out successfully'' });
    });
});
```

---

## Security Best Practices

### Password Requirements

```javascript
function validatePassword(password) {
    // At least 8 characters
    if (password.length < 8) {
        return { valid: false, error: ''Password must be at least 8 characters'' };
    }
    
    // At least one uppercase letter
    if (!/[A-Z]/.test(password)) {
        return { valid: false, error: ''Password must contain uppercase letter'' };
    }
    
    // At least one lowercase letter
    if (!/[a-z]/.test(password)) {
        return { valid: false, error: ''Password must contain lowercase letter'' };
    }
    
    // At least one number
    if (!/[0-9]/.test(password)) {
        return { valid: false, error: ''Password must contain a number'' };
    }
    
    // At least one special character
    if (!/[!@#$%^&*]/.test(password)) {
        return { valid: false, error: ''Password must contain special character'' };
    }
    
    return { valid: true };
}
```

### Rate Limiting

```bash
npm install express-rate-limit
```

```javascript
const rateLimit = require(''express-rate-limit'');

const loginLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 5, // 5 requests per window
    message: ''Too many login attempts, please try again later''
});

app.post(''/login'', loginLimiter, async (req, res) => {
    // Login logic
});
```

### Input Validation

```javascript
const validator = require(''validator'');

function validateEmail(email) {
    return validator.isEmail(email);
}

function validatePassword(password) {
    return password.length >= 8;
}

app.post(''/register'', (req, res) => {
    const { email, password } = req.body;
    
    if (!validateEmail(email)) {
        return res.status(400).json({ error: ''Invalid email'' });
    }
    
    if (!validatePassword(password)) {
        return res.status(400).json({ error: ''Invalid password'' });
    }
    
    // Continue registration
});
```

### Environment Variables

```javascript
// .env file
JWT_SECRET=your-secret-key-here
JWT_REFRESH_SECRET=your-refresh-secret-here
SESSION_SECRET=your-session-secret-here
NODE_ENV=production

// Use in code
require(''dotenv'').config();

const token = jwt.sign(
    { userId: user.id },
    process.env.JWT_SECRET
);
```

---

## Practice Exercise

### Exercise: Authentication System

**Objective**: Practice implementing authentication, JWT tokens, password hashing, and session management.

**Instructions**:

1. Create authentication system
2. Implement JWT tokens
3. Hash passwords
4. Add session management
5. Practice:
   - User registration
   - User login
   - Token generation
   - Password hashing
   - Protected routes

**Example Solution**:

```javascript
// src/middleware/auth.js
const jwt = require(''jsonwebtoken'');

const authenticateToken = (req, res, next) => {
    const authHeader = req.headers[''authorization''];
    const token = authHeader && authHeader.split('' '')[1];
    
    if (!token) {
        return res.status(401).json({ error: ''Access token required'' });
    }
    
    jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
        if (err) {
            return res.status(403).json({ error: ''Invalid or expired token'' });
        }
        req.user = user;
        next();
    });
};

module.exports = authenticateToken;
```

```javascript
// src/routes/auth.js
const express = require(''express'');
const bcrypt = require(''bcrypt'');
const jwt = require(''jsonwebtoken'');
const User = require(''../models/user'');
const authenticateToken = require(''../middleware/auth'');

const router = express.Router();

// Register
router.post(''/register'', async (req, res) => {
    try {
        const { name, email, password } = req.body;
        
        // Validation
        if (!name || !email || !password) {
            return res.status(400).json({
                error: ''Name, email, and password are required''
            });
        }
        
        if (password.length < 8) {
            return res.status(400).json({
                error: ''Password must be at least 8 characters''
            });
        }
        
        // Check if user exists
        const existingUser = await User.findOne({ email });
        if (existingUser) {
            return res.status(400).json({ error: ''User already exists'' });
        }
        
        // Hash password
        const hashedPassword = await bcrypt.hash(password, 10);
        
        // Create user
        const user = await User.create({
            name,
            email,
            password: hashedPassword
        });
        
        // Generate token
        const token = jwt.sign(
            { userId: user._id },
            process.env.JWT_SECRET,
            { expiresIn: ''24h'' }
        );
        
        res.status(201).json({
            success: true,
            token,
            user: {
                id: user._id,
                name: user.name,
                email: user.email
            }
        });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// Login
router.post(''/login'', async (req, res) => {
    try {
        const { email, password } = req.body;
        
        if (!email || !password) {
            return res.status(400).json({
                error: ''Email and password are required''
            });
        }
        
        // Find user
        const user = await User.findOne({ email });
        if (!user) {
            return res.status(401).json({ error: ''Invalid credentials'' });
        }
        
        // Compare password
        const isMatch = await bcrypt.compare(password, user.password);
        if (!isMatch) {
            return res.status(401).json({ error: ''Invalid credentials'' });
        }
        
        // Generate token
        const token = jwt.sign(
            { userId: user._id },
            process.env.JWT_SECRET,
            { expiresIn: ''24h'' }
        );
        
        res.json({
            success: true,
            token,
            user: {
                id: user._id,
                name: user.name,
                email: user.email
            }
        });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// Get current user
router.get(''/me'', authenticateToken, async (req, res) => {
    try {
        const user = await User.findById(req.user.userId).select(''-password'');
        if (!user) {
            return res.status(404).json({ error: ''User not found'' });
        }
        res.json({ success: true, user });
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

module.exports = router;
```

```javascript
// src/models/user.js
const mongoose = require(''mongoose'');

const userSchema = new mongoose.Schema({
    name: {
        type: String,
        required: true,
        trim: true
    },
    email: {
        type: String,
        required: true,
        unique: true,
        lowercase: true,
        trim: true
    },
    password: {
        type: String,
        required: true,
        minlength: 8
    }
}, {
    timestamps: true
});

// Remove password from JSON
userSchema.methods.toJSON = function() {
    const user = this.toObject();
    delete user.password;
    return user;
};

const User = mongoose.model(''User'', userSchema);

module.exports = User;
```

```javascript
// src/app.js
const express = require(''express'');
const mongoose = require(''mongoose'');
const authRouter = require(''./routes/auth'');
require(''dotenv'').config();

const app = express();

app.use(express.json());

// Connect to MongoDB
mongoose.connect(process.env.MONGODB_URI || ''mongodb://localhost:27017/mydb'')
    .then(() => console.log(''Connected to MongoDB''))
    .catch(err => console.error(''MongoDB connection error:'', err));

// Routes
app.use(''/api/auth'', authRouter);

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

**Expected Output**:
- User registration working
- User login working
- JWT tokens generated
- Passwords hashed
- Protected routes working

**Challenge (Optional)**:
- Add refresh tokens
- Implement password reset
- Add email verification
- Add two-factor authentication

---

## Common Mistakes

### 1. Storing Plain Text Passwords

```javascript
// ❌ Bad: Plain text password
const user = await User.create({
    email,
    password: password  // Never do this!
});

// ✅ Good: Hash password
const hashedPassword = await bcrypt.hash(password, 10);
const user = await User.create({
    email,
    password: hashedPassword
});
```

### 2. Weak JWT Secret

```javascript
// ❌ Bad: Weak secret
const token = jwt.sign(payload, ''secret'');

// ✅ Good: Strong secret from environment
const token = jwt.sign(payload, process.env.JWT_SECRET);
```

### 3. Not Validating Tokens

```javascript
// ❌ Bad: No validation
const decoded = jwt.decode(token);

// ✅ Good: Verify token
const decoded = jwt.verify(token, process.env.JWT_SECRET);
```

---

## Key Takeaways

1. **Authentication**: Verify user identity
2. **JWT Tokens**: Stateless authentication
3. **Password Hashing**: Use bcrypt
4. **Sessions**: Server-side state
5. **Security**: Rate limiting, validation, strong secrets
6. **Best Practice**: Never store plain passwords, use HTTPS
7. **Tokens**: Short-lived access tokens, longer refresh tokens

---

## Quiz: Authentication

Test your understanding with these questions:

1. **Authentication:**
   - A) Verify identity
   - B) Verify permissions
   - C) Both
   - D) Neither

2. **JWT:**
   - A) Stateless
   - B) Stateful
   - C) Both
   - D) Neither

3. **bcrypt:**
   - A) Hash passwords
   - B) Encrypt passwords
   - C) Both
   - D) Neither

4. **Password hashing:**
   - A) One-way
   - B) Two-way
   - C) Both
   - D) Neither

5. **JWT secret:**
   - A) Should be strong
   - B) Can be weak
   - C) Both
   - D) Neither

6. **Sessions:**
   - A) Server-side
   - B) Client-side
   - C) Both
   - D) Neither

7. **Rate limiting:**
   - A) Prevents abuse
   - B) Doesn''t prevent abuse
   - C) Both
   - D) Neither

**Answers**:
1. A) Verify identity
2. A) Stateless
3. A) Hash passwords
4. A) One-way
5. A) Should be strong
6. A) Server-side
7. A) Prevents abuse

---

## Next Steps

Congratulations! You''ve learned authentication and security. You now know:
- How to implement authentication
- How to use JWT tokens
- How to hash passwords
- How to manage sessions

**What''s Next?**
- Lesson 30.3: API Security
- Learn CORS
- Understand rate limiting
- Implement input validation

---

## Additional Resources

- **JWT**: [jwt.io](https://jwt.io)
- **bcrypt**: [github.com/kelektiv/node.bcrypt.js](https://github.com/kelektiv/node.bcrypt.js)
- **Express Sessions**: [github.com/expressjs/session](https://github.com/expressjs/session)
- **OWASP**: [owasp.org](https://owasp.org)

---

*Lesson completed! You''re ready to move on to the next lesson.*

', NULL, 2, '2026-01-03 10:13:14', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand authentication strategies
- Implement JWT tokens
- Hash passwords with bcrypt
- Manage sessions
- Apply security best practices
- Build secure authentication systems
- Protect user data');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (189, 70, 17, 'API Development', 'api-development', '# Lesson 30.3: API Security

## Learning Objectives

By the end of this lesson, you will be able to:
- Understand and implement CORS
- Use rate limiting
- Validate input
- Prevent SQL injection
- Implement HTTPS
- Secure APIs
- Follow security best practices

---

## Introduction to API Security

API security is crucial for protecting your APIs from attacks and unauthorized access. It involves multiple layers of protection.

### Security Threats

- **SQL Injection**: Malicious SQL code injection
- **XSS (Cross-Site Scripting)**: Script injection attacks
- **CSRF (Cross-Site Request Forgery)**: Unauthorized actions
- **DDoS**: Denial of service attacks
- **Man-in-the-Middle**: Intercepting communications
- **Brute Force**: Password guessing attacks

---

## CORS

### What is CORS?

CORS (Cross-Origin Resource Sharing) is a mechanism that allows resources to be requested from a different domain.

### CORS Setup

```bash
npm install cors
```

```javascript
const express = require(''express'');
const cors = require(''cors'');
const app = express();

// Enable CORS for all routes
app.use(cors());

// Or configure CORS
app.use(cors({
    origin: ''https://example.com'',
    methods: [''GET'', ''POST'', ''PUT'', ''DELETE''],
    allowedHeaders: [''Content-Type'', ''Authorization''],
    credentials: true
}));
```

### CORS Middleware

```javascript
// Custom CORS middleware
const corsMiddleware = (req, res, next) => {
    const allowedOrigins = [
        ''https://example.com'',
        ''https://www.example.com''
    ];
    
    const origin = req.headers.origin;
    
    if (allowedOrigins.includes(origin)) {
        res.header(''Access-Control-Allow-Origin'', origin);
    }
    
    res.header(''Access-Control-Allow-Methods'', ''GET, POST, PUT, DELETE'');
    res.header(''Access-Control-Allow-Headers'', ''Content-Type, Authorization'');
    res.header(''Access-Control-Allow-Credentials'', ''true'');
    
    // Handle preflight
    if (req.method === ''OPTIONS'') {
        res.sendStatus(200);
    } else {
        next();
    }
};

app.use(corsMiddleware);
```

---

## Rate Limiting

### What is Rate Limiting?

Rate limiting controls how many requests a client can make in a given time period.

### Express Rate Limit

```bash
npm install express-rate-limit
```

```javascript
const rateLimit = require(''express-rate-limit'');

// General rate limiter
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100, // 100 requests per window
    message: ''Too many requests, please try again later''
});

app.use(limiter);

// Specific route limiter
const loginLimiter = rateLimit({
    windowMs: 15 * 60 * 1000,
    max: 5,
    message: ''Too many login attempts, please try again later'',
    standardHeaders: true,
    legacyHeaders: false
});

app.post(''/login'', loginLimiter, (req, res) => {
    // Login logic
});
```

### Advanced Rate Limiting

```javascript
const rateLimit = require(''express-rate-limit'');

// Store limiter (requires Redis or similar)
const createAccountLimiter = rateLimit({
    windowMs: 60 * 60 * 1000, // 1 hour
    max: 3, // 3 accounts per hour
    message: ''Too many accounts created, please try again later'',
    skipSuccessfulRequests: true
});

app.post(''/register'', createAccountLimiter, (req, res) => {
    // Registration logic
});

// IP-based rate limiting
const ipLimiter = rateLimit({
    windowMs: 15 * 60 * 1000,
    max: 100,
    keyGenerator: (req) => {
        return req.ip;
    }
});
```

---

## Input Validation

### Why Validate Input?

- **Security**: Prevent injection attacks
- **Data Integrity**: Ensure correct data format
- **User Experience**: Provide clear error messages

### Manual Validation

```javascript
function validateEmail(email) {
    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return emailRegex.test(email);
}

function validatePassword(password) {
    if (password.length < 8) {
        return { valid: false, error: ''Password must be at least 8 characters'' };
    }
    if (!/[A-Z]/.test(password)) {
        return { valid: false, error: ''Password must contain uppercase letter'' };
    }
    if (!/[a-z]/.test(password)) {
        return { valid: false, error: ''Password must contain lowercase letter'' };
    }
    if (!/[0-9]/.test(password)) {
        return { valid: false, error: ''Password must contain a number'' };
    }
    return { valid: true };
}

app.post(''/register'', (req, res) => {
    const { email, password } = req.body;
    
    if (!validateEmail(email)) {
        return res.status(400).json({ error: ''Invalid email'' });
    }
    
    const passwordValidation = validatePassword(password);
    if (!passwordValidation.valid) {
        return res.status(400).json({ error: passwordValidation.error });
    }
    
    // Continue registration
});
```

### Using Validator Library

```bash
npm install validator
```

```javascript
const validator = require(''validator'');

app.post(''/register'', (req, res) => {
    const { email, password, name } = req.body;
    
    if (!validator.isEmail(email)) {
        return res.status(400).json({ error: ''Invalid email'' });
    }
    
    if (!validator.isLength(password, { min: 8 })) {
        return res.status(400).json({ error: ''Password too short'' });
    }
    
    if (!validator.isAlphanumeric(name, ''en-US'', { ignore: '' '' })) {
        return res.status(400).json({ error: ''Invalid name'' });
    }
    
    // Continue registration
});
```

### Using Joi

```bash
npm install joi
```

```javascript
const Joi = require(''joi'');

const userSchema = Joi.object({
    name: Joi.string().min(3).max(30).required(),
    email: Joi.string().email().required(),
    password: Joi.string().min(8).pattern(new RegExp(''^[a-zA-Z0-9]{3,30}$'')).required(),
    age: Joi.number().integer().min(0).max(150).optional()
});

app.post(''/register'', (req, res) => {
    const { error, value } = userSchema.validate(req.body);
    
    if (error) {
        return res.status(400).json({
            error: error.details[0].message
        });
    }
    
    // Use validated value
    // Continue registration
});
```

### Sanitization

```javascript
const validator = require(''validator'');

function sanitizeInput(input) {
    // Remove HTML tags
    let sanitized = validator.escape(input);
    
    // Trim whitespace
    sanitized = sanitized.trim();
    
    return sanitized;
}

app.post(''/comment'', (req, res) => {
    const { comment } = req.body;
    const sanitizedComment = sanitizeInput(comment);
    
    // Use sanitized comment
});
```

---

## SQL Injection Prevention

### What is SQL Injection?

SQL injection is a code injection technique that exploits security vulnerabilities in database queries.

### Vulnerable Code

```javascript
// ❌ Bad: SQL injection vulnerability
const query = `SELECT * FROM users WHERE email = ''${email}''`;
const [rows] = await pool.execute(query);
```

### Prevention with Parameterized Queries

```javascript
// ✅ Good: Parameterized query
const query = ''SELECT * FROM users WHERE email = ?'';
const [rows] = await pool.execute(query, [email]);
```

### Using ORMs

```javascript
// Sequelize (automatically prevents SQL injection)
const user = await User.findOne({
    where: { email: email }
});

// Mongoose (automatically prevents injection)
const user = await User.findOne({ email });
```

### Input Validation

```javascript
function validateEmail(email) {
    // Only allow valid email format
    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
    return emailRegex.test(email);
}

app.get(''/user'', async (req, res) => {
    const { email } = req.query;
    
    if (!validateEmail(email)) {
        return res.status(400).json({ error: ''Invalid email'' });
    }
    
    // Safe to use in query
    const user = await User.findOne({ email });
    res.json(user);
});
```

---

## HTTPS

### What is HTTPS?

HTTPS (HTTP Secure) encrypts data between client and server using SSL/TLS.

### Setting Up HTTPS

```bash
# Generate self-signed certificate (development)
openssl req -x509 -newkey rsa:4096 -nodes -keyout key.pem -out cert.pem -days 365
```

```javascript
const https = require(''https'');
const fs = require(''fs'');
const express = require(''express'');

const app = express();

const options = {
    key: fs.readFileSync(''key.pem''),
    cert: fs.readFileSync(''cert.pem'')
};

https.createServer(options, app).listen(443, () => {
    console.log(''HTTPS server running on port 443'');
});
```

### Redirect HTTP to HTTPS

```javascript
const express = require(''express'');
const app = express();

// Redirect HTTP to HTTPS
app.use((req, res, next) => {
    if (req.secure || req.headers[''x-forwarded-proto''] === ''https'') {
        next();
    } else {
        res.redirect(`https://${req.headers.host}${req.url}`);
    }
});
```

### Security Headers

```javascript
const helmet = require(''helmet'');
app.use(helmet());

// Or manually set headers
app.use((req, res, next) => {
    res.setHeader(''Strict-Transport-Security'', ''max-age=31536000; includeSubDomains'');
    res.setHeader(''X-Content-Type-Options'', ''nosniff'');
    res.setHeader(''X-Frame-Options'', ''DENY'');
    res.setHeader(''X-XSS-Protection'', ''1; mode=block'');
    next();
});
```

---

## Practice Exercise

### Exercise: Securing APIs

**Objective**: Practice implementing CORS, rate limiting, input validation, SQL injection prevention, and HTTPS.

**Instructions**:

1. Secure your API
2. Implement CORS
3. Add rate limiting
4. Validate input
5. Prevent SQL injection
6. Practice:
   - CORS configuration
   - Rate limiting
   - Input validation
   - Security headers
   - HTTPS setup

**Example Solution**:

```javascript
// src/middleware/security.js
const rateLimit = require(''express-rate-limit'');
const helmet = require(''helmet'');

// Security headers
const securityHeaders = helmet({
    contentSecurityPolicy: {
        directives: {
            defaultSrc: ["''self''"],
            styleSrc: ["''self''", "''unsafe-inline''"],
            scriptSrc: ["''self''"],
            imgSrc: ["''self''", ''data:'', ''https:'']
        }
    },
    hsts: {
        maxAge: 31536000,
        includeSubDomains: true,
        preload: true
    }
});

// Rate limiters
const generalLimiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100,
    message: ''Too many requests, please try again later''
});

const authLimiter = rateLimit({
    windowMs: 15 * 60 * 1000,
    max: 5,
    message: ''Too many authentication attempts, please try again later'',
    skipSuccessfulRequests: true
});

const createAccountLimiter = rateLimit({
    windowMs: 60 * 60 * 1000, // 1 hour
    max: 3,
    message: ''Too many accounts created, please try again later''
});

module.exports = {
    securityHeaders,
    generalLimiter,
    authLimiter,
    createAccountLimiter
};
```

```javascript
// src/middleware/validation.js
const Joi = require(''joi'');

const validate = (schema) => {
    return (req, res, next) => {
        const { error, value } = schema.validate(req.body, {
            abortEarly: false,
            stripUnknown: true
        });
        
        if (error) {
            const errors = error.details.map(detail => ({
                field: detail.path.join(''.''),
                message: detail.message
            }));
            
            return res.status(400).json({
                success: false,
                errors
            });
        }
        
        req.body = value;
        next();
    };
};

// Validation schemas
const registerSchema = Joi.object({
    name: Joi.string().min(3).max(50).required(),
    email: Joi.string().email().required(),
    password: Joi.string().min(8).pattern(new RegExp(''^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])'')).required()
});

const loginSchema = Joi.object({
    email: Joi.string().email().required(),
    password: Joi.string().required()
});

module.exports = {
    validate,
    registerSchema,
    loginSchema
};
```

```javascript
// src/middleware/cors.js
const cors = require(''cors'');

const corsOptions = {
    origin: (origin, callback) => {
        const allowedOrigins = [
            ''http://localhost:3000'',
            ''https://example.com''
        ];
        
        // Allow requests with no origin (mobile apps, Postman, etc.)
        if (!origin) return callback(null, true);
        
        if (allowedOrigins.indexOf(origin) !== -1) {
            callback(null, true);
        } else {
            callback(new Error(''Not allowed by CORS''));
        }
    },
    methods: [''GET'', ''POST'', ''PUT'', ''DELETE'', ''PATCH''],
    allowedHeaders: [''Content-Type'', ''Authorization''],
    credentials: true,
    maxAge: 86400 // 24 hours
};

module.exports = cors(corsOptions);
```

```javascript
// src/routes/auth.js
const express = require(''express'');
const router = express.Router();
const { validate, registerSchema, loginSchema } = require(''../middleware/validation'');
const { authLimiter, createAccountLimiter } = require(''../middleware/security'');

// Register with validation and rate limiting
router.post(''/register'',
    createAccountLimiter,
    validate(registerSchema),
    async (req, res) => {
        // Registration logic
    }
);

// Login with validation and rate limiting
router.post(''/login'',
    authLimiter,
    validate(loginSchema),
    async (req, res) => {
        // Login logic
    }
);

module.exports = router;
```

```javascript
// src/app.js
const express = require(''express'');
const mongoose = require(''mongoose'');
const { securityHeaders, generalLimiter } = require(''./middleware/security'');
const corsOptions = require(''./middleware/cors'');
const authRouter = require(''./routes/auth'');
require(''dotenv'').config();

const app = express();

// Security middleware
app.use(securityHeaders);
app.use(corsOptions);
app.use(express.json({ limit: ''10mb'' }));
app.use(express.urlencoded({ extended: true, limit: ''10mb'' }));

// Rate limiting
app.use(''/api/'', generalLimiter);

// Database connection
mongoose.connect(process.env.MONGODB_URI || ''mongodb://localhost:27017/mydb'')
    .then(() => console.log(''Connected to MongoDB''))
    .catch(err => console.error(''MongoDB connection error:'', err));

// Routes
app.use(''/api/auth'', authRouter);

// Error handling
app.use((err, req, res, next) => {
    console.error(err.stack);
    res.status(500).json({
        success: false,
        error: process.env.NODE_ENV === ''production'' 
            ? ''Internal server error'' 
            : err.message
    });
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

```json
// package.json
{
  "name": "api-security-practice",
  "version": "1.0.0",
  "description": "API security practice",
  "main": "src/app.js",
  "scripts": {
    "start": "node src/app.js",
    "dev": "nodemon src/app.js"
  },
  "dependencies": {
    "express": "^4.18.0",
    "mongoose": "^7.0.0",
    "cors": "^2.8.5",
    "helmet": "^7.0.0",
    "express-rate-limit": "^6.7.0",
    "joi": "^17.9.0",
    "dotenv": "^16.0.0"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  }
}
```

**Expected Output**:
- CORS configured
- Rate limiting active
- Input validation working
- Security headers set
- API secured

**Challenge (Optional)**:
- Add request logging
- Implement API key authentication
- Add IP whitelisting
- Create security monitoring

---

## Common Mistakes

### 1. Not Using Parameterized Queries

```javascript
// ❌ Bad: SQL injection vulnerability
const query = `SELECT * FROM users WHERE email = ''${email}''`;

// ✅ Good: Parameterized query
const query = ''SELECT * FROM users WHERE email = ?'';
const [rows] = await pool.execute(query, [email]);
```

### 2. Weak CORS Configuration

```javascript
// ❌ Bad: Allow all origins
app.use(cors());

// ✅ Good: Specific origins
app.use(cors({
    origin: [''https://example.com'']
}));
```

### 3. No Input Validation

```javascript
// ❌ Bad: No validation
app.post(''/user'', (req, res) => {
    const user = await User.create(req.body);
});

// ✅ Good: Validate input
app.post(''/user'', validate(userSchema), (req, res) => {
    const user = await User.create(req.body);
});
```

---

## Key Takeaways

1. **CORS**: Control cross-origin requests
2. **Rate Limiting**: Prevent abuse
3. **Input Validation**: Ensure data integrity
4. **SQL Injection**: Use parameterized queries
5. **HTTPS**: Encrypt communications
6. **Security Headers**: Add extra protection
7. **Best Practice**: Multiple layers of security

---

## Quiz: API Security

Test your understanding with these questions:

1. **CORS:**
   - A) Cross-Origin Resource Sharing
   - B) Cross-Origin Request Sharing
   - C) Both
   - D) Neither

2. **Rate limiting:**
   - A) Prevents abuse
   - B) Allows abuse
   - C) Both
   - D) Neither

3. **SQL injection:**
   - A) Prevented with parameterized queries
   - B) Not prevented
   - C) Both
   - D) Neither

4. **HTTPS:**
   - A) Encrypts data
   - B) Doesn''t encrypt data
   - C) Both
   - D) Neither

5. **Input validation:**
   - A) Important for security
   - B) Not important
   - C) Both
   - D) Neither

6. **Security headers:**
   - A) Add protection
   - B) Don''t add protection
   - C) Both
   - D) Neither

7. **Parameterized queries:**
   - A) Prevent SQL injection
   - B) Don''t prevent SQL injection
   - C) Both
   - D) Neither

**Answers**:
1. A) Cross-Origin Resource Sharing
2. A) Prevents abuse
3. A) Prevented with parameterized queries
4. A) Encrypts data
5. A) Important for security
6. A) Add protection
7. A) Prevent SQL injection

---

## Next Steps

Congratulations! You''ve completed Module 30: Databases and Authentication. You now know:
- How to work with databases
- How to implement authentication
- How to secure APIs
- How to protect applications

**What''s Next?**
- Course 9: Practical Projects
- Build real-world applications
- Apply all learned concepts
- Create portfolio projects

---

## Additional Resources

- **OWASP**: [owasp.org](https://owasp.org)
- **CORS**: [developer.mozilla.org/en-US/docs/Web/HTTP/CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)
- **Helmet**: [helmetjs.github.io](https://helmetjs.github.io)
- **Rate Limiting**: [github.com/express-rate-limit/express-rate-limit](https://github.com/express-rate-limit/express-rate-limit)

---

*Lesson completed! You''ve finished Module 30: Databases and Authentication. Ready for Course 9: Practical Projects!*

', NULL, 3, '2026-01-03 10:13:14', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this lesson, you will be able to:
- Understand and implement CORS
- Use rate limiting
- Validate input
- Prevent SQL injection
- Implement HTTPS
- Secure APIs
- Follow security best practices');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (194, 71, 18, 'Todo List Application', 'todo-list-application', '# Project 1.1: Todo List Application

## Project Overview

Build a fully functional Todo List application using vanilla JavaScript. This project will help you practice DOM manipulation, event handling, local storage, and CRUD operations.

## Learning Objectives

By the end of this project, you will be able to:
- Manipulate the DOM dynamically
- Handle various user events
- Store data in local storage
- Implement CRUD operations
- Build a complete interactive application
- Structure JavaScript code effectively

---

## Project Requirements

### Core Features

1. **Add Todos**: Users can add new todo items
2. **View Todos**: Display all todos in a list
3. **Edit Todos**: Update existing todo items
4. **Delete Todos**: Remove todo items
5. **Mark Complete**: Toggle completion status
6. **Filter Todos**: Filter by all/active/completed
7. **Persist Data**: Save todos to local storage
8. **Clear Completed**: Remove all completed todos

### Technical Requirements

- Use vanilla JavaScript (no frameworks)
- Use semantic HTML5
- Responsive CSS design
- Local storage for persistence
- Clean, organized code structure
- Error handling

---

## Project Structure

```
todo-app/
├── index.html
├── css/
│   └── style.css
├── js/
│   ├── app.js
│   ├── todo.js
│   └── storage.js
└── README.md
```

---

## Step-by-Step Implementation

### Step 1: HTML Structure

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo List Application</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>My Todo List</h1>
        </header>
        
        <main>
            <!-- Add Todo Form -->
            <form id="todo-form">
                <input 
                    type="text" 
                    id="todo-input" 
                    placeholder="Add a new todo..."
                    required
                >
                <button type="submit">Add</button>
            </form>
            
            <!-- Filter Buttons -->
            <div class="filters">
                <button class="filter-btn active" data-filter="all">All</button>
                <button class="filter-btn" data-filter="active">Active</button>
                <button class="filter-btn" data-filter="completed">Completed</button>
            </div>
            
            <!-- Todo List -->
            <ul id="todo-list"></ul>
            
            <!-- Todo Stats -->
            <div class="stats">
                <span id="todo-count">0 items left</span>
                <button id="clear-completed">Clear Completed</button>
            </div>
        </main>
    </div>
    
    <script src="js/storage.js"></script>
    <script src="js/todo.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
```

### Step 2: CSS Styling

```css
/* css/style.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: ''Segoe UI'', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

header h1 {
    font-size: 2.5em;
    font-weight: 300;
}

main {
    padding: 30px;
}

#todo-form {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

#todo-input {
    flex: 1;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 5px;
    font-size: 16px;
    transition: border-color 0.3s;
}

#todo-input:focus {
    outline: none;
    border-color: #667eea;
}

#todo-form button {
    padding: 12px 24px;
    background: #667eea;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
}

#todo-form button:hover {
    background: #5568d3;
}

.filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
}

.filter-btn {
    padding: 8px 16px;
    background: #f5f5f5;
    border: 1px solid #e0e0e0;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}

.filter-btn:hover {
    background: #e0e0e0;
}

.filter-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}

#todo-list {
    list-style: none;
    margin-bottom: 20px;
}

.todo-item {
    display: flex;
    align-items: center;
    padding: 15px;
    margin-bottom: 10px;
    background: #f9f9f9;
    border-radius: 5px;
    transition: all 0.3s;
}

.todo-item:hover {
    background: #f0f0f0;
}

.todo-item.completed {
    opacity: 0.6;
}

.todo-item.completed .todo-text {
    text-decoration: line-through;
}

.todo-checkbox {
    width: 20px;
    height: 20px;
    margin-right: 15px;
    cursor: pointer;
}

.todo-text {
    flex: 1;
    font-size: 16px;
    color: #333;
}

.todo-item.editing .todo-text {
    display: none;
}

.todo-edit-input {
    flex: 1;
    padding: 8px;
    border: 2px solid #667eea;
    border-radius: 5px;
    font-size: 16px;
    display: none;
}

.todo-item.editing .todo-edit-input {
    display: block;
}

.todo-actions {
    display: flex;
    gap: 10px;
}

.todo-btn {
    padding: 5px 10px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
}

.edit-btn {
    background: #4caf50;
    color: white;
}

.edit-btn:hover {
    background: #45a049;
}

.delete-btn {
    background: #f44336;
    color: white;
}

.delete-btn:hover {
    background: #da190b;
}

.stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 20px;
    border-top: 1px solid #e0e0e0;
}

#todo-count {
    color: #666;
    font-size: 14px;
}

#clear-completed {
    padding: 8px 16px;
    background: #f44336;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
}

#clear-completed:hover {
    background: #da190b;
}

#clear-completed:disabled {
    background: #ccc;
    cursor: not-allowed;
}

.empty-state {
    text-align: center;
    padding: 40px;
    color: #999;
}

.empty-state.hidden {
    display: none;
}
```

### Step 3: Storage Module

```javascript
// js/storage.js
class Storage {
    static getTodos() {
        const todos = localStorage.getItem(''todos'');
        return todos ? JSON.parse(todos) : [];
    }
    
    static saveTodos(todos) {
        localStorage.setItem(''todos'', JSON.stringify(todos));
    }
    
    static addTodo(todo) {
        const todos = this.getTodos();
        todos.push(todo);
        this.saveTodos(todos);
        return todo;
    }
    
    static updateTodo(id, updates) {
        const todos = this.getTodos();
        const index = todos.findIndex(todo => todo.id === id);
        if (index !== -1) {
            todos[index] = { ...todos[index], ...updates };
            this.saveTodos(todos);
            return todos[index];
        }
        return null;
    }
    
    static deleteTodo(id) {
        const todos = this.getTodos();
        const filtered = todos.filter(todo => todo.id !== id);
        this.saveTodos(filtered);
        return filtered;
    }
    
    static clearCompleted() {
        const todos = this.getTodos();
        const active = todos.filter(todo => !todo.completed);
        this.saveTodos(active);
        return active;
    }
}
```

### Step 4: Todo Model

```javascript
// js/todo.js
class Todo {
    constructor(id, text, completed = false) {
        this.id = id;
        this.text = text;
        this.completed = completed;
        this.createdAt = new Date().toISOString();
    }
    
    toggle() {
        this.completed = !this.completed;
        return this;
    }
    
    updateText(newText) {
        this.text = newText;
        return this;
    }
    
    toJSON() {
        return {
            id: this.id,
            text: this.text,
            completed: this.completed,
            createdAt: this.createdAt
        };
    }
    
    static fromJSON(data) {
        const todo = new Todo(data.id, data.text, data.completed);
        todo.createdAt = data.createdAt;
        return todo;
    }
}
```

### Step 5: Main Application

```javascript
// js/app.js
class TodoApp {
    constructor() {
        this.todos = [];
        this.currentFilter = ''all'';
        this.editingId = null;
        
        this.initializeElements();
        this.loadTodos();
        this.attachEventListeners();
        this.render();
    }
    
    initializeElements() {
        this.form = document.getElementById(''todo-form'');
        this.input = document.getElementById(''todo-input'');
        this.todoList = document.getElementById(''todo-list'');
        this.filterBtns = document.querySelectorAll(''.filter-btn'');
        this.todoCount = document.getElementById(''todo-count'');
        this.clearCompletedBtn = document.getElementById(''clear-completed'');
    }
    
    loadTodos() {
        const todosData = Storage.getTodos();
        this.todos = todosData.map(data => Todo.fromJSON(data));
    }
    
    attachEventListeners() {
        // Form submission
        this.form.addEventListener(''submit'', (e) => {
            e.preventDefault();
            this.addTodo();
        });
        
        // Filter buttons
        this.filterBtns.forEach(btn => {
            btn.addEventListener(''click'', (e) => {
                this.setFilter(e.target.dataset.filter);
            });
        });
        
        // Clear completed
        this.clearCompletedBtn.addEventListener(''click'', () => {
            this.clearCompleted();
        });
    }
    
    addTodo() {
        const text = this.input.value.trim();
        if (!text) return;
        
        const todo = new Todo(Date.now(), text);
        Storage.addTodo(todo.toJSON());
        this.todos.push(todo);
        this.input.value = '''';
        this.render();
    }
    
    deleteTodo(id) {
        this.todos = Storage.deleteTodo(id);
        this.render();
    }
    
    toggleTodo(id) {
        const todo = this.todos.find(t => t.id === id);
        if (todo) {
            todo.toggle();
            Storage.updateTodo(id, { completed: todo.completed });
            this.render();
        }
    }
    
    startEditing(id) {
        this.editingId = id;
        this.render();
    }
    
    saveEdit(id, newText) {
        const text = newText.trim();
        if (!text) {
            this.cancelEdit();
            return;
        }
        
        const todo = this.todos.find(t => t.id === id);
        if (todo) {
            todo.updateText(text);
            Storage.updateTodo(id, { text: todo.text });
            this.editingId = null;
            this.render();
        }
    }
    
    cancelEdit() {
        this.editingId = null;
        this.render();
    }
    
    setFilter(filter) {
        this.currentFilter = filter;
        this.filterBtns.forEach(btn => {
            btn.classList.toggle(''active'', btn.dataset.filter === filter);
        });
        this.render();
    }
    
    clearCompleted() {
        this.todos = Storage.clearCompleted();
        this.render();
    }
    
    getFilteredTodos() {
        switch (this.currentFilter) {
            case ''active'':
                return this.todos.filter(todo => !todo.completed);
            case ''completed'':
                return this.todos.filter(todo => todo.completed);
            default:
                return this.todos;
        }
    }
    
    getActiveCount() {
        return this.todos.filter(todo => !todo.completed).length;
    }
    
    render() {
        const filteredTodos = this.getFilteredTodos();
        
        // Render todos
        if (filteredTodos.length === 0) {
            this.todoList.innerHTML = `
                <li class="empty-state">
                    <p>No todos found. Add one to get started!</p>
                </li>
            `;
        } else {
            this.todoList.innerHTML = filteredTodos.map(todo => {
                const isEditing = this.editingId === todo.id;
                return `
                    <li class="todo-item ${todo.completed ? ''completed'' : ''''} ${isEditing ? ''editing'' : ''''}">
                        <input 
                            type="checkbox" 
                            class="todo-checkbox" 
                            ${todo.completed ? ''checked'' : ''''}
                            onchange="app.toggleTodo(${todo.id})"
                        >
                        <span class="todo-text">${this.escapeHtml(todo.text)}</span>
                        <input 
                            type="text" 
                            class="todo-edit-input" 
                            value="${this.escapeHtml(todo.text)}"
                            onblur="app.saveEdit(${todo.id}, this.value)"
                            onkeypress="if(event.key === ''Enter'') app.saveEdit(${todo.id}, this.value)"
                            onkeydown="if(event.key === ''Escape'') app.cancelEdit()"
                        >
                        <div class="todo-actions">
                            <button class="todo-btn edit-btn" onclick="app.startEditing(${todo.id})">
                                Edit
                            </button>
                            <button class="todo-btn delete-btn" onclick="app.deleteTodo(${todo.id})">
                                Delete
                            </button>
                        </div>
                    </li>
                `;
            }).join('''');
        }
        
        // Update count
        const activeCount = this.getActiveCount();
        this.todoCount.textContent = `${activeCount} ${activeCount === 1 ? ''item'' : ''items''} left`;
        
        // Update clear completed button
        const completedCount = this.todos.filter(t => t.completed).length;
        this.clearCompletedBtn.disabled = completedCount === 0;
    }
    
    escapeHtml(text) {
        const div = document.createElement(''div'');
        div.textContent = text;
        return div.innerHTML;
    }
}

// Initialize app
const app = new TodoApp();
```

---

## Features Implementation

### DOM Manipulation

- **Dynamic List Rendering**: Todos are rendered dynamically based on state
- **Event Delegation**: Efficient event handling
- **DOM Updates**: Smooth updates without page refresh

### Event Handling

- **Form Submission**: Add new todos
- **Click Events**: Edit, delete, toggle todos
- **Keyboard Events**: Enter to save, Escape to cancel
- **Change Events**: Checkbox toggles

### Local Storage

- **Persist Data**: Todos saved automatically
- **Load on Start**: Todos loaded when app starts
- **Sync Updates**: All changes saved immediately

### CRUD Operations

- **Create**: Add new todos
- **Read**: Display todos with filtering
- **Update**: Edit todo text and toggle completion
- **Delete**: Remove individual or completed todos

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Add a new todo
- [ ] Mark todo as complete
- [ ] Edit todo text
- [ ] Delete a todo
- [ ] Filter by All/Active/Completed
- [ ] Clear all completed todos
- [ ] Refresh page (data should persist)
- [ ] Test with empty input
- [ ] Test with special characters
- [ ] Test keyboard shortcuts

---

## Exercise: Build Todo App

**Instructions**:

1. Create the project structure
2. Implement all files as shown
3. Test all features
4. Customize the design
5. Add your own enhancements

**Enhancement Ideas**:

- Add due dates
- Add priority levels
- Add categories/tags
- Add search functionality
- Add drag-and-drop reordering
- Add animations
- Add dark mode
- Add export/import functionality

---

## Common Issues and Solutions

### Issue: Todos not persisting

**Solution**: Check browser console for errors. Ensure localStorage is enabled.

### Issue: Events not working

**Solution**: Make sure DOM is loaded before initializing app. Use DOMContentLoaded event if needed.

### Issue: Editing not working

**Solution**: Check that editingId is being set correctly and input events are attached.

---

## Quiz: Project Concepts

1. **Local storage stores data as:**
   - A) Strings
   - B) Objects
   - C) Both (JSON stringified)
   - D) Neither

2. **DOM manipulation:**
   - A) Changes page structure
   - B) Doesn''t change page
   - C) Both
   - D) Neither

3. **Event handling:**
   - A) Responds to user actions
   - B) Doesn''t respond
   - C) Both
   - D) Neither

4. **CRUD stands for:**
   - A) Create, Read, Update, Delete
   - B) Create, Remove, Update, Delete
   - C) Both
   - D) Neither

5. **Local storage:**
   - A) Persists data
   - B) Temporary data
   - C) Both
   - D) Neither

**Answers**:
1. A) Strings (JSON stringified)
2. A) Changes page structure
3. A) Responds to user actions
4. A) Create, Read, Update, Delete
5. A) Persists data

---

## Key Takeaways

1. **DOM Manipulation**: Essential for dynamic web pages
2. **Event Handling**: Responds to user interactions
3. **Local Storage**: Persists data in browser
4. **CRUD Operations**: Core functionality of most apps
5. **Code Organization**: Separate concerns into modules
6. **Best Practice**: Clean, maintainable code structure

---

## Next Steps

Congratulations! You''ve built a complete Todo List application. You now know:
- How to manipulate the DOM
- How to handle events
- How to use local storage
- How to implement CRUD operations

**What''s Next?**
- Project 1.2: Weather App
- Learn API integration
- Work with external data
- Build a weather application

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 1, '2026-01-03 10:32:02', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Manipulate the DOM dynamically
- Handle various user events
- Store data in local storage
- Implement CRUD operations
- Build a complete interactive application
- Structure JavaScript code effectively');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (195, 71, 18, 'Weather App', 'weather-app', '# Project 1.2: Weather App

## Project Overview

Build a Weather Application that fetches real-time weather data from an API and displays it in a beautiful, user-friendly interface. This project will help you practice API integration, Fetch API, error handling, and UI design.

## Learning Objectives

By the end of this project, you will be able to:
- Integrate with external APIs
- Use Fetch API for HTTP requests
- Handle API errors gracefully
- Design responsive user interfaces
- Parse and display JSON data
- Handle async operations

---

## Project Requirements

### Core Features

1. **Search by City**: Enter city name to get weather
2. **Current Weather**: Display current temperature, conditions
3. **Weather Details**: Show humidity, wind speed, pressure
4. **Weather Icons**: Visual representation of weather
5. **Error Handling**: Handle API errors and invalid inputs
6. **Loading States**: Show loading indicators
7. **Recent Searches**: Remember recent city searches
8. **Responsive Design**: Works on all devices

### Technical Requirements

- Use Fetch API for HTTP requests
- Use a weather API (OpenWeatherMap recommended)
- Handle errors gracefully
- Responsive CSS design
- Clean, organized code
- API key management

---

## Project Structure

```
weather-app/
├── index.html
├── css/
│   └── style.css
├── js/
│   ├── app.js
│   ├── api.js
│   └── ui.js
└── README.md
```

---

## Step-by-Step Implementation

### Step 1: Get API Key

1. Sign up at [OpenWeatherMap](https://openweathermap.org/api)
2. Get your free API key
3. Store it securely (use environment variables in production)

### Step 2: HTML Structure

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-cloud-sun"></i> Weather App</h1>
        </header>
        
        <main>
            <!-- Search Section -->
            <div class="search-section">
                <form id="search-form">
                    <input 
                        type="text" 
                        id="city-input" 
                        placeholder="Enter city name..."
                        autocomplete="off"
                    >
                    <button type="submit">
                        <i class="fas fa-search"></i>
                    </button>
                </form>
                <div id="error-message" class="error-message hidden"></div>
            </div>
            
            <!-- Loading Indicator -->
            <div id="loading" class="loading hidden">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Loading weather data...</p>
            </div>
            
            <!-- Weather Display -->
            <div id="weather-container" class="weather-container hidden">
                <!-- Current Weather -->
                <div class="current-weather">
                    <div class="location">
                        <h2 id="city-name"></h2>
                        <p id="date"></p>
                    </div>
                    <div class="temperature">
                        <img id="weather-icon" src="" alt="Weather icon">
                        <div>
                            <span id="temperature"></span>
                            <span class="unit">°C</span>
                        </div>
                    </div>
                    <div class="description">
                        <p id="weather-description"></p>
                    </div>
                </div>
                
                <!-- Weather Details -->
                <div class="weather-details">
                    <div class="detail-item">
                        <i class="fas fa-tint"></i>
                        <div>
                            <p class="label">Humidity</p>
                            <p id="humidity" class="value"></p>
                        </div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-wind"></i>
                        <div>
                            <p class="label">Wind Speed</p>
                            <p id="wind-speed" class="value"></p>
                        </div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-compress-arrows-alt"></i>
                        <div>
                            <p class="label">Pressure</p>
                            <p id="pressure" class="value"></p>
                        </div>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-eye"></i>
                        <div>
                            <p class="label">Visibility</p>
                            <p id="visibility" class="value"></p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recent Searches -->
            <div class="recent-searches">
                <h3>Recent Searches</h3>
                <div id="recent-list" class="recent-list"></div>
            </div>
        </main>
    </div>
    
    <script src="js/api.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
```

### Step 3: CSS Styling

```css
/* css/style.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: ''Segoe UI'', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: 0 auto;
}

header {
    text-align: center;
    color: white;
    margin-bottom: 30px;
}

header h1 {
    font-size: 2.5em;
    font-weight: 300;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
}

.search-section {
    margin-bottom: 30px;
}

#search-form {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
}

#city-input {
    flex: 1;
    padding: 15px;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

#city-input:focus {
    outline: none;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

#search-form button {
    padding: 15px 20px;
    background: white;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 18px;
    color: #0984e3;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: all 0.3s;
}

#search-form button:hover {
    background: #f0f0f0;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}

.error-message {
    background: #ff6b6b;
    color: white;
    padding: 12px;
    border-radius: 5px;
    text-align: center;
    margin-top: 10px;
}

.error-message.hidden {
    display: none;
}

.loading {
    text-align: center;
    color: white;
    padding: 40px;
}

.loading i {
    font-size: 3em;
    margin-bottom: 20px;
}

.loading.hidden {
    display: none;
}

.weather-container {
    background: white;
    border-radius: 20px;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    margin-bottom: 30px;
}

.weather-container.hidden {
    display: none;
}

.current-weather {
    text-align: center;
    margin-bottom: 30px;
    padding-bottom: 30px;
    border-bottom: 1px solid #e0e0e0;
}

.location h2 {
    font-size: 2em;
    color: #333;
    margin-bottom: 5px;
}

.location p {
    color: #666;
    font-size: 14px;
}

.temperature {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin: 20px 0;
}

.temperature img {
    width: 80px;
    height: 80px;
}

.temperature span {
    font-size: 4em;
    font-weight: 300;
    color: #333;
}

.temperature .unit {
    font-size: 2em;
    vertical-align: super;
}

.description p {
    font-size: 1.2em;
    color: #666;
    text-transform: capitalize;
}

.weather-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
}

.detail-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 10px;
}

.detail-item i {
    font-size: 2em;
    color: #0984e3;
}

.detail-item .label {
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
}

.detail-item .value {
    font-size: 18px;
    font-weight: 600;
    color: #333;
}

.recent-searches {
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

.recent-searches h3 {
    color: #333;
    margin-bottom: 15px;
}

.recent-list {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.recent-item {
    padding: 8px 16px;
    background: #f8f9fa;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 14px;
}

.recent-item:hover {
    background: #e9ecef;
    transform: translateY(-2px);
}

@media (max-width: 600px) {
    .weather-details {
        grid-template-columns: 1fr;
    }
    
    .temperature {
        flex-direction: column;
    }
    
    header h1 {
        font-size: 2em;
    }
}
```

### Step 4: API Module

```javascript
// js/api.js
class WeatherAPI {
    constructor() {
        // Replace with your API key
        this.apiKey = ''YOUR_API_KEY_HERE'';
        this.baseURL = ''https://api.openweathermap.org/data/2.5'';
    }
    
    async getWeather(city) {
        try {
            const url = `${this.baseURL}/weather?q=${city}&appid=${this.apiKey}&units=metric`;
            const response = await fetch(url);
            
            if (!response.ok) {
                if (response.status === 404) {
                    throw new Error(''City not found'');
                }
                throw new Error(''Failed to fetch weather data'');
            }
            
            const data = await response.json();
            return this.formatWeatherData(data);
        } catch (error) {
            throw error;
        }
    }
    
    formatWeatherData(data) {
        return {
            city: data.name,
            country: data.sys.country,
            temperature: Math.round(data.main.temp),
            feelsLike: Math.round(data.main.feels_like),
            description: data.weather[0].description,
            icon: data.weather[0].icon,
            humidity: data.main.humidity,
            windSpeed: data.wind.speed,
            pressure: data.main.pressure,
            visibility: data.visibility ? (data.visibility / 1000).toFixed(1) : ''N/A'',
            date: new Date().toLocaleDateString(''en-US'', {
                weekday: ''long'',
                year: ''numeric'',
                month: ''long'',
                day: ''numeric''
            })
        };
    }
    
    getIconURL(iconCode) {
        return `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
    }
}
```

### Step 5: UI Module

```javascript
// js/ui.js
class WeatherUI {
    constructor() {
        this.initializeElements();
    }
    
    initializeElements() {
        this.weatherContainer = document.getElementById(''weather-container'');
        this.loading = document.getElementById(''loading'');
        this.errorMessage = document.getElementById(''error-message'');
        this.cityName = document.getElementById(''city-name'');
        this.date = document.getElementById(''date'');
        this.temperature = document.getElementById(''temperature'');
        this.weatherIcon = document.getElementById(''weather-icon'');
        this.weatherDescription = document.getElementById(''weather-description'');
        this.humidity = document.getElementById(''humidity'');
        this.windSpeed = document.getElementById(''wind-speed'');
        this.pressure = document.getElementById(''pressure'');
        this.visibility = document.getElementById(''visibility'');
        this.recentList = document.getElementById(''recent-list'');
    }
    
    showLoading() {
        this.loading.classList.remove(''hidden'');
        this.weatherContainer.classList.add(''hidden'');
        this.hideError();
    }
    
    hideLoading() {
        this.loading.classList.add(''hidden'');
    }
    
    showWeather(weatherData, api) {
        this.hideLoading();
        this.hideError();
        
        this.cityName.textContent = `${weatherData.city}, ${weatherData.country}`;
        this.date.textContent = weatherData.date;
        this.temperature.textContent = weatherData.temperature;
        this.weatherIcon.src = api.getIconURL(weatherData.icon);
        this.weatherIcon.alt = weatherData.description;
        this.weatherDescription.textContent = weatherData.description;
        this.humidity.textContent = `${weatherData.humidity}%`;
        this.windSpeed.textContent = `${weatherData.windSpeed} m/s`;
        this.pressure.textContent = `${weatherData.pressure} hPa`;
        this.visibility.textContent = `${weatherData.visibility} km`;
        
        this.weatherContainer.classList.remove(''hidden'');
    }
    
    showError(message) {
        this.hideLoading();
        this.weatherContainer.classList.add(''hidden'');
        this.errorMessage.textContent = message;
        this.errorMessage.classList.remove(''hidden'');
    }
    
    hideError() {
        this.errorMessage.classList.add(''hidden'');
    }
    
    addRecentSearch(city) {
        const recentSearches = this.getRecentSearches();
        if (!recentSearches.includes(city)) {
            recentSearches.unshift(city);
            if (recentSearches.length > 5) {
                recentSearches.pop();
            }
            localStorage.setItem(''recentSearches'', JSON.stringify(recentSearches));
            this.renderRecentSearches();
        }
    }
    
    getRecentSearches() {
        const stored = localStorage.getItem(''recentSearches'');
        return stored ? JSON.parse(stored) : [];
    }
    
    renderRecentSearches() {
        const recentSearches = this.getRecentSearches();
        if (recentSearches.length === 0) {
            this.recentList.innerHTML = ''<p style="color: #666;">No recent searches</p>'';
            return;
        }
        
        this.recentList.innerHTML = recentSearches.map(city => 
            `<span class="recent-item" data-city="${city}">${city}</span>`
        ).join('''');
    }
}
```

### Step 6: Main Application

```javascript
// js/app.js
class WeatherApp {
    constructor() {
        this.api = new WeatherAPI();
        this.ui = new WeatherUI();
        this.initializeApp();
    }
    
    initializeApp() {
        this.attachEventListeners();
        this.ui.renderRecentSearches();
        
        // Load weather for default city (optional)
        // this.loadWeather(''London'');
    }
    
    attachEventListeners() {
        const form = document.getElementById(''search-form'');
        form.addEventListener(''submit'', (e) => {
            e.preventDefault();
            this.handleSearch();
        });
        
        // Recent searches click
        this.ui.recentList.addEventListener(''click'', (e) => {
            if (e.target.classList.contains(''recent-item'')) {
                const city = e.target.dataset.city;
                document.getElementById(''city-input'').value = city;
                this.loadWeather(city);
            }
        });
    }
    
    async handleSearch() {
        const input = document.getElementById(''city-input'');
        const city = input.value.trim();
        
        if (!city) {
            this.ui.showError(''Please enter a city name'');
            return;
        }
        
        await this.loadWeather(city);
    }
    
    async loadWeather(city) {
        try {
            this.ui.showLoading();
            const weatherData = await this.api.getWeather(city);
            this.ui.showWeather(weatherData, this.api);
            this.ui.addRecentSearch(city);
        } catch (error) {
            this.ui.showError(error.message);
        }
    }
}

// Initialize app
const app = new WeatherApp();
```

---

## API Integration

### Fetch API Usage

- **GET Requests**: Fetch weather data
- **Error Handling**: Handle network and API errors
- **Async/Await**: Modern async handling
- **Response Parsing**: Convert JSON to usable data

### Error Handling

- **Network Errors**: Connection issues
- **API Errors**: Invalid city, API key issues
- **User Feedback**: Clear error messages
- **Graceful Degradation**: App continues to work

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Search for a valid city
- [ ] Search for invalid city (error handling)
- [ ] Check all weather data displays correctly
- [ ] Test recent searches functionality
- [ ] Test with empty input
- [ ] Test loading states
- [ ] Test on mobile devices
- [ ] Test with slow network (loading indicator)

---

## Exercise: Build Weather App

**Instructions**:

1. Sign up for OpenWeatherMap API
2. Get your API key
3. Create all files as shown
4. Replace ''YOUR_API_KEY_HERE'' with your actual key
5. Test all features
6. Customize the design

**Enhancement Ideas**:

- Add 5-day forecast
- Add hourly forecast
- Add weather maps
- Add location-based weather (geolocation)
- Add unit conversion (Celsius/Fahrenheit)
- Add weather alerts
- Add favorite cities
- Add weather history

---

## Common Issues and Solutions

### Issue: API key not working

**Solution**: Check that you''ve replaced the placeholder and that your API key is valid.

### Issue: CORS errors

**Solution**: OpenWeatherMap API supports CORS. If you see CORS errors, check your API key.

### Issue: City not found

**Solution**: Ensure city name is spelled correctly. Try using city, country format.

---

## Quiz: API Integration

1. **Fetch API:**
   - A) Modern way to make HTTP requests
   - B) Old way to make requests
   - C) Both
   - D) Neither

2. **async/await:**
   - A) Handles asynchronous operations
   - B) Handles synchronous operations
   - C) Both
   - D) Neither

3. **Error handling:**
   - A) Important for API calls
   - B) Not important
   - C) Both
   - D) Neither

4. **API key:**
   - A) Should be kept secret
   - B) Can be public
   - C) Both
   - D) Neither

5. **Loading states:**
   - A) Improve user experience
   - B) Don''t improve UX
   - C) Both
   - D) Neither

**Answers**:
1. A) Modern way to make HTTP requests
2. A) Handles asynchronous operations
3. A) Important for API calls
4. A) Should be kept secret
5. A) Improve user experience

---

## Key Takeaways

1. **API Integration**: Connect to external services
2. **Fetch API**: Modern HTTP client
3. **Error Handling**: Essential for robust apps
4. **Async Operations**: Handle asynchronous data
5. **UI Design**: Create beautiful interfaces
6. **Best Practice**: Handle all error cases

---

## Next Steps

Congratulations! You''ve built a Weather Application. You now know:
- How to integrate with APIs
- How to use Fetch API
- How to handle errors
- How to design user interfaces

**What''s Next?**
- Project 1.3: Calculator
- Learn state management
- Build a calculator application
- Practice event handling

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 2, '2026-01-03 10:32:36', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Integrate with external APIs
- Use Fetch API for HTTP requests
- Handle API errors gracefully
- Design responsive user interfaces
- Parse and display JSON data
- Handle async operations');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (196, 71, 18, 'Calculator', 'calculator', '# Project 1.3: Calculator

## Project Overview

Build a fully functional Calculator application with a modern, clean interface. This project will help you practice event handling, state management, mathematical operations, and building interactive user interfaces.

## Learning Objectives

By the end of this project, you will be able to:
- Handle complex event interactions
- Manage application state
- Perform mathematical operations
- Build interactive UI components
- Handle edge cases and errors
- Create a polished user experience

---

## Project Requirements

### Core Features

1. **Basic Operations**: Addition, subtraction, multiplication, division
2. **Number Input**: Enter numbers via buttons or keyboard
3. **Clear Function**: Clear current input or all
4. **Decimal Support**: Handle decimal numbers
5. **Equals Function**: Calculate and display result
6. **Error Handling**: Handle division by zero, invalid operations
7. **Keyboard Support**: Use keyboard for input
8. **History Display**: Show calculation history (optional)

### Technical Requirements

- Use vanilla JavaScript
- Clean, modern UI design
- Responsive layout
- Proper state management
- Error handling
- Keyboard accessibility

---

## Project Structure

```
calculator/
├── index.html
├── css/
│   └── style.css
├── js/
│   ├── app.js
│   ├── calculator.js
│   └── display.js
└── README.md
```

---

## Step-by-Step Implementation

### Step 1: HTML Structure

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <div class="calculator">
            <header>
                <h1>Calculator</h1>
            </header>
            
            <!-- Display -->
            <div class="display-container">
                <div id="history" class="history"></div>
                <div id="display" class="display">0</div>
            </div>
            
            <!-- Buttons -->
            <div class="buttons">
                <!-- Row 1 -->
                <button class="btn btn-clear" data-action="clear">C</button>
                <button class="btn btn-clear" data-action="clear-entry">CE</button>
                <button class="btn btn-operator" data-operator="%">%</button>
                <button class="btn btn-operator" data-operator="/">÷</button>
                
                <!-- Row 2 -->
                <button class="btn btn-number" data-number="7">7</button>
                <button class="btn btn-number" data-number="8">8</button>
                <button class="btn btn-number" data-number="9">9</button>
                <button class="btn btn-operator" data-operator="*">×</button>
                
                <!-- Row 3 -->
                <button class="btn btn-number" data-number="4">4</button>
                <button class="btn btn-number" data-number="5">5</button>
                <button class="btn btn-number" data-number="6">6</button>
                <button class="btn btn-operator" data-operator="-">−</button>
                
                <!-- Row 4 -->
                <button class="btn btn-number" data-number="1">1</button>
                <button class="btn btn-number" data-number="2">2</button>
                <button class="btn btn-number" data-number="3">3</button>
                <button class="btn btn-operator" data-operator="+">+</button>
                
                <!-- Row 5 -->
                <button class="btn btn-number btn-zero" data-number="0">0</button>
                <button class="btn btn-number" data-number=".">.</button>
                <button class="btn btn-equals" data-action="equals">=</button>
            </div>
        </div>
    </div>
    
    <script src="js/calculator.js"></script>
    <script src="js/display.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
```

### Step 2: CSS Styling

```css
/* css/style.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: ''Segoe UI'', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.container {
    width: 100%;
    max-width: 400px;
}

.calculator {
    background: #1a1a1a;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
}

header {
    text-align: center;
    margin-bottom: 20px;
}

header h1 {
    color: white;
    font-size: 1.5em;
    font-weight: 300;
}

.display-container {
    background: #2a2a2a;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    min-height: 120px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
}

.history {
    color: #888;
    font-size: 0.9em;
    min-height: 20px;
    text-align: right;
    margin-bottom: 10px;
    word-break: break-all;
}

.display {
    color: white;
    font-size: 3em;
    text-align: right;
    word-break: break-all;
    overflow-wrap: break-word;
}

.buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.btn {
    padding: 20px;
    border: none;
    border-radius: 10px;
    font-size: 1.2em;
    cursor: pointer;
    transition: all 0.2s;
    font-weight: 500;
}

.btn:active {
    transform: scale(0.95);
}

.btn-number {
    background: #3a3a3a;
    color: white;
}

.btn-number:hover {
    background: #4a4a4a;
}

.btn-operator {
    background: #ff9500;
    color: white;
}

.btn-operator:hover {
    background: #ffaa33;
}

.btn-operator.active {
    background: white;
    color: #ff9500;
}

.btn-clear {
    background: #505050;
    color: white;
}

.btn-clear:hover {
    background: #606060;
}

.btn-equals {
    background: #ff9500;
    color: white;
    grid-column: span 1;
}

.btn-equals:hover {
    background: #ffaa33;
}

.btn-zero {
    grid-column: span 1;
}

@media (max-width: 480px) {
    .display {
        font-size: 2.5em;
    }
    
    .btn {
        padding: 15px;
        font-size: 1em;
    }
}
```

### Step 3: Calculator Logic

```javascript
// js/calculator.js
class Calculator {
    constructor() {
        this.currentValue = ''0'';
        this.previousValue = null;
        this.operator = null;
        this.waitingForOperand = false;
    }
    
    inputNumber(number) {
        if (this.waitingForOperand) {
            this.currentValue = number;
            this.waitingForOperand = false;
        } else {
            this.currentValue = this.currentValue === ''0'' ? number : this.currentValue + number;
        }
    }
    
    inputDecimal() {
        if (this.waitingForOperand) {
            this.currentValue = ''0.'';
            this.waitingForOperand = false;
        } else if (this.currentValue.indexOf(''.'') === -1) {
            this.currentValue += ''.'';
        }
    }
    
    clear() {
        this.currentValue = ''0'';
        this.previousValue = null;
        this.operator = null;
        this.waitingForOperand = false;
    }
    
    clearEntry() {
        this.currentValue = ''0'';
    }
    
    performOperation(nextOperator) {
        const inputValue = parseFloat(this.currentValue);
        
        if (this.previousValue === null) {
            this.previousValue = inputValue;
        } else if (this.operator) {
            const currentValue = this.previousValue || 0;
            const newValue = this.calculate(currentValue, inputValue, this.operator);
            
            this.currentValue = String(newValue);
            this.previousValue = newValue;
        }
        
        this.waitingForOperand = true;
        this.operator = nextOperator;
    }
    
    calculate(firstValue, secondValue, operator) {
        switch (operator) {
            case ''+'':
                return firstValue + secondValue;
            case ''-'':
                return firstValue - secondValue;
            case ''*'':
                return firstValue * secondValue;
            case ''/'':
                if (secondValue === 0) {
                    throw new Error(''Cannot divide by zero'');
                }
                return firstValue / secondValue;
            case ''%'':
                return firstValue % secondValue;
            default:
                return secondValue;
        }
    }
    
    equals() {
        if (this.operator && this.previousValue !== null) {
            const inputValue = parseFloat(this.currentValue);
            const newValue = this.calculate(this.previousValue, inputValue, this.operator);
            
            this.currentValue = String(newValue);
            this.previousValue = null;
            this.operator = null;
            this.waitingForOperand = true;
        }
    }
    
    getDisplayValue() {
        return this.currentValue;
    }
    
    getHistory() {
        if (this.previousValue !== null && this.operator) {
            return `${this.previousValue} ${this.operator}`;
        }
        return '''';
    }
}
```

### Step 4: Display Module

```javascript
// js/display.js
class Display {
    constructor() {
        this.display = document.getElementById(''display'');
        this.history = document.getElementById(''history'');
    }
    
    updateDisplay(value) {
        // Format large numbers
        const numValue = parseFloat(value);
        if (isNaN(numValue)) {
            this.display.textContent = ''Error'';
            return;
        }
        
        // Handle very large numbers
        if (Math.abs(numValue) > 999999999) {
            this.display.textContent = numValue.toExponential(3);
        } else {
            // Format with appropriate decimal places
            const formatted = this.formatNumber(value);
            this.display.textContent = formatted;
        }
    }
    
    formatNumber(value) {
        const num = parseFloat(value);
        if (isNaN(num)) return ''0'';
        
        // If it''s an integer, don''t show decimals
        if (num % 1 === 0) {
            return num.toString();
        }
        
        // Otherwise, limit to 9 decimal places
        return num.toFixed(9).replace(/\\.?0+$/, '''');
    }
    
    updateHistory(history) {
        this.history.textContent = history;
    }
    
    showError(message) {
        this.display.textContent = message;
        this.history.textContent = '''';
    }
}
```

### Step 5: Main Application

```javascript
// js/app.js
class CalculatorApp {
    constructor() {
        this.calculator = new Calculator();
        this.display = new Display();
        this.initializeApp();
    }
    
    initializeApp() {
        this.attachEventListeners();
        this.attachKeyboardListeners();
        this.updateDisplay();
    }
    
    attachEventListeners() {
        // Number buttons
        document.querySelectorAll(''.btn-number[data-number]'').forEach(btn => {
            btn.addEventListener(''click'', () => {
                const number = btn.dataset.number;
                if (number === ''.'') {
                    this.calculator.inputDecimal();
                } else {
                    this.calculator.inputNumber(number);
                }
                this.updateDisplay();
            });
        });
        
        // Operator buttons
        document.querySelectorAll(''.btn-operator[data-operator]'').forEach(btn => {
            btn.addEventListener(''click'', () => {
                const operator = btn.dataset.operator;
                try {
                    this.calculator.performOperation(operator);
                    this.updateDisplay();
                    this.updateOperatorButtons();
                } catch (error) {
                    this.display.showError(error.message);
                }
            });
        });
        
        // Equals button
        document.querySelector(''.btn-equals'').addEventListener(''click'', () => {
            try {
                this.calculator.equals();
                this.updateDisplay();
                this.updateOperatorButtons();
            } catch (error) {
                this.display.showError(error.message);
            }
        });
        
        // Clear buttons
        document.querySelector(''[data-action="clear"]'').addEventListener(''click'', () => {
            this.calculator.clear();
            this.updateDisplay();
            this.updateOperatorButtons();
        });
        
        document.querySelector(''[data-action="clear-entry"]'').addEventListener(''click'', () => {
            this.calculator.clearEntry();
            this.updateDisplay();
        });
    }
    
    attachKeyboardListeners() {
        document.addEventListener(''keydown'', (e) => {
            // Prevent default for calculator keys
            if (this.isCalculatorKey(e.key)) {
                e.preventDefault();
            }
            
            // Handle number keys
            if (e.key >= ''0'' && e.key <= ''9'') {
                this.calculator.inputNumber(e.key);
                this.updateDisplay();
            }
            
            // Handle decimal
            if (e.key === ''.'') {
                this.calculator.inputDecimal();
                this.updateDisplay();
            }
            
            // Handle operators
            if ([''+'', ''-'', ''*'', ''/'', ''%''].includes(e.key)) {
                try {
                    this.calculator.performOperation(e.key);
                    this.updateDisplay();
                    this.updateOperatorButtons();
                } catch (error) {
                    this.display.showError(error.message);
                }
            }
            
            // Handle equals
            if (e.key === ''='' || e.key === ''Enter'') {
                try {
                    this.calculator.equals();
                    this.updateDisplay();
                    this.updateOperatorButtons();
                } catch (error) {
                    this.display.showError(error.message);
                }
            }
            
            // Handle clear
            if (e.key === ''Escape'') {
                this.calculator.clear();
                this.updateDisplay();
                this.updateOperatorButtons();
            }
            
            // Handle backspace
            if (e.key === ''Backspace'') {
                const current = this.calculator.getDisplayValue();
                if (current.length > 1) {
                    this.calculator.currentValue = current.slice(0, -1);
                } else {
                    this.calculator.currentValue = ''0'';
                }
                this.updateDisplay();
            }
        });
    }
    
    isCalculatorKey(key) {
        return (key >= ''0'' && key <= ''9'') ||
               [''+'', ''-'', ''*'', ''/'', ''%'', ''.'', ''='', ''Enter'', ''Escape'', ''Backspace''].includes(key);
    }
    
    updateDisplay() {
        this.display.updateDisplay(this.calculator.getDisplayValue());
        this.display.updateHistory(this.calculator.getHistory());
    }
    
    updateOperatorButtons() {
        document.querySelectorAll(''.btn-operator'').forEach(btn => {
            btn.classList.remove(''active'');
        });
        
        if (this.calculator.operator) {
            const activeBtn = document.querySelector(`[data-operator="${this.calculator.operator}"]`);
            if (activeBtn) {
                activeBtn.classList.add(''active'');
            }
        }
    }
}

// Initialize app
const app = new CalculatorApp();
```

---

## Features Implementation

### Event Handling

- **Button Clicks**: All calculator buttons functional
- **Keyboard Support**: Full keyboard input support
- **Visual Feedback**: Active operator highlighting
- **Smooth Interactions**: Button press animations

### State Management

- **Current Value**: Currently displayed number
- **Previous Value**: Stored for operations
- **Operator**: Current operation type
- **Waiting Flag**: Tracks input state

### Mathematical Operations

- **Basic Operations**: +, -, *, /
- **Modulo**: % operation
- **Decimal Support**: Proper decimal handling
- **Error Handling**: Division by zero, invalid operations

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Test all number buttons
- [ ] Test all operators
- [ ] Test equals function
- [ ] Test clear functions
- [ ] Test decimal input
- [ ] Test division by zero
- [ ] Test keyboard input
- [ ] Test chained operations
- [ ] Test large numbers
- [ ] Test negative numbers

---

## Exercise: Build Calculator

**Instructions**:

1. Create all files as shown
2. Implement all features
3. Test thoroughly
4. Customize the design
5. Add your own enhancements

**Enhancement Ideas**:

- Add scientific calculator functions
- Add memory functions (M+, M-, MR, MC)
- Add calculation history
- Add theme switcher (light/dark)
- Add sound effects
- Add animation effects
- Add keyboard shortcuts display
- Add unit conversion

---

## Common Issues and Solutions

### Issue: Decimal input not working

**Solution**: Check that inputDecimal() properly handles the waitingForOperand state.

### Issue: Operations not chaining

**Solution**: Ensure performOperation() properly stores previous value and operator.

### Issue: Division by zero

**Solution**: Add check in calculate() method to throw error for division by zero.

---

## Quiz: Calculator Concepts

1. **State management:**
   - A) Tracks calculator state
   - B) Doesn''t track state
   - C) Both
   - D) Neither

2. **Event handling:**
   - A) Responds to user input
   - B) Doesn''t respond
   - C) Both
   - D) Neither

3. **Mathematical operations:**
   - A) Perform calculations
   - B) Don''t perform calculations
   - C) Both
   - D) Neither

4. **Error handling:**
   - A) Important for calculator
   - B) Not important
   - C) Both
   - D) Neither

5. **Keyboard support:**
   - A) Improves usability
   - B) Doesn''t improve usability
   - C) Both
   - D) Neither

**Answers**:
1. A) Tracks calculator state
2. A) Responds to user input
3. A) Perform calculations
4. A) Important for calculator
5. A) Improves usability

---

## Key Takeaways

1. **Event Handling**: Complex interactions require careful event management
2. **State Management**: Track all necessary state for calculations
3. **Mathematical Operations**: Implement operations correctly
4. **Error Handling**: Handle edge cases gracefully
5. **User Experience**: Smooth interactions and visual feedback
6. **Best Practice**: Clean code structure and proper separation of concerns

---

## Next Steps

Congratulations! You''ve built a complete Calculator application. You now know:
- How to handle complex events
- How to manage application state
- How to perform mathematical operations
- How to build interactive UIs

**What''s Next?**
- Project 2: Frontend Applications
- Learn React projects
- Build React applications
- Apply React concepts

---

*Project completed! You''ve finished Project 1: Interactive Web Pages. Ready for Project 2: Frontend Applications!*

', NULL, 3, '2026-01-03 10:32:36', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Handle complex event interactions
- Manage application state
- Perform mathematical operations
- Build interactive UI components
- Handle edge cases and errors
- Create a polished user experience');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (197, 72, 18, 'React Todo App', 'react-todo-app', '# Project 2.1: React Todo App

## Project Overview

Build a fully functional Todo List application using React. This project will help you practice React components, state management, hooks, and local storage integration.

## Learning Objectives

By the end of this project, you will be able to:
- Create React components
- Manage state with hooks
- Use useEffect for side effects
- Integrate local storage
- Build reusable components
- Structure React applications
- Handle user interactions

---

## Project Requirements

### Core Features

1. **Add Todos**: Create new todo items
2. **View Todos**: Display all todos
3. **Edit Todos**: Update todo text
4. **Delete Todos**: Remove todos
5. **Toggle Complete**: Mark todos as complete/incomplete
6. **Filter Todos**: Filter by all/active/completed
7. **Persist Data**: Save to local storage
8. **Clear Completed**: Remove all completed todos

### Technical Requirements

- Use React (Create React App or Vite)
- Use functional components with hooks
- Implement local storage
- Clean component structure
- Responsive design
- Error handling

---

## Project Setup

### Option 1: Create React App

```bash
npx create-react-app react-todo-app
cd react-todo-app
npm start
```

### Option 2: Vite

```bash
npm create vite@latest react-todo-app -- --template react
cd react-todo-app
npm install
npm run dev
```

---

## Project Structure

```
react-todo-app/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── TodoForm.jsx
│   │   ├── TodoList.jsx
│   │   ├── TodoItem.jsx
│   │   ├── FilterButtons.jsx
│   │   └── TodoStats.jsx
│   ├── hooks/
│   │   └── useLocalStorage.js
│   ├── utils/
│   │   └── storage.js
│   ├── App.jsx
│   ├── App.css
│   └── index.js
└── package.json
```

---

## Step-by-Step Implementation

### Step 1: Custom Hook for Local Storage

```javascript
// src/hooks/useLocalStorage.js
import { useState, useEffect } from ''react'';

function useLocalStorage(key, initialValue) {
    const [storedValue, setStoredValue] = useState(() => {
        try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
        } catch (error) {
            console.error(error);
            return initialValue;
        }
    });
    
    const setValue = (value) => {
        try {
            const valueToStore = value instanceof Function ? value(storedValue) : value;
            setStoredValue(valueToStore);
            window.localStorage.setItem(key, JSON.stringify(valueToStore));
        } catch (error) {
            console.error(error);
        }
    };
    
    return [storedValue, setValue];
}

export default useLocalStorage;
```

### Step 2: Todo Form Component

```javascript
// src/components/TodoForm.jsx
import { useState } from ''react'';
import ''./TodoForm.css'';

function TodoForm({ onAddTodo }) {
    const [input, setInput] = useState('''');
    
    const handleSubmit = (e) => {
        e.preventDefault();
        if (input.trim()) {
            onAddTodo(input.trim());
            setInput('''');
        }
    };
    
    return (
        <form className="todo-form" onSubmit={handleSubmit}>
            <input
                type="text"
                className="todo-input"
                placeholder="Add a new todo..."
                value={input}
                onChange={(e) => setInput(e.target.value)}
            />
            <button type="submit" className="todo-button">
                Add
            </button>
        </form>
    );
}

export default TodoForm;
```

### Step 3: Todo Item Component

```javascript
// src/components/TodoItem.jsx
import { useState } from ''react'';
import ''./TodoItem.css'';

function TodoItem({ todo, onToggle, onDelete, onUpdate }) {
    const [isEditing, setIsEditing] = useState(false);
    const [editText, setEditText] = useState(todo.text);
    
    const handleEdit = () => {
        setIsEditing(true);
    };
    
    const handleSave = () => {
        if (editText.trim()) {
            onUpdate(todo.id, editText.trim());
            setIsEditing(false);
        }
    };
    
    const handleCancel = () => {
        setEditText(todo.text);
        setIsEditing(false);
    };
    
    const handleKeyDown = (e) => {
        if (e.key === ''Enter'') {
            handleSave();
        } else if (e.key === ''Escape'') {
            handleCancel();
        }
    };
    
    return (
        <li className={`todo-item ${todo.completed ? ''completed'' : ''''} ${isEditing ? ''editing'' : ''''}`}>
            <input
                type="checkbox"
                className="todo-checkbox"
                checked={todo.completed}
                onChange={() => onToggle(todo.id)}
            />
            
            {isEditing ? (
                <input
                    type="text"
                    className="todo-edit-input"
                    value={editText}
                    onChange={(e) => setEditText(e.target.value)}
                    onBlur={handleSave}
                    onKeyDown={handleKeyDown}
                    autoFocus
                />
            ) : (
                <span className="todo-text" onDoubleClick={handleEdit}>
                    {todo.text}
                </span>
            )}
            
            <div className="todo-actions">
                <button
                    className="todo-btn edit-btn"
                    onClick={handleEdit}
                    disabled={isEditing}
                >
                    Edit
                </button>
                <button
                    className="todo-btn delete-btn"
                    onClick={() => onDelete(todo.id)}
                >
                    Delete
                </button>
            </div>
        </li>
    );
}

export default TodoItem;
```

### Step 4: Todo List Component

```javascript
// src/components/TodoList.jsx
import TodoItem from ''./TodoItem'';
import ''./TodoList.css'';

function TodoList({ todos, onToggle, onDelete, onUpdate }) {
    if (todos.length === 0) {
        return (
            <div className="empty-state">
                <p>No todos found. Add one to get started!</p>
            </div>
        );
    }
    
    return (
        <ul className="todo-list">
            {todos.map(todo => (
                <TodoItem
                    key={todo.id}
                    todo={todo}
                    onToggle={onToggle}
                    onDelete={onDelete}
                    onUpdate={onUpdate}
                />
            ))}
        </ul>
    );
}

export default TodoList;
```

### Step 5: Filter Buttons Component

```javascript
// src/components/FilterButtons.jsx
import ''./FilterButtons.css'';

const filters = [
    { key: ''all'', label: ''All'' },
    { key: ''active'', label: ''Active'' },
    { key: ''completed'', label: ''Completed'' }
];

function FilterButtons({ currentFilter, onFilterChange }) {
    return (
        <div className="filters">
            {filters.map(filter => (
                <button
                    key={filter.key}
                    className={`filter-btn ${currentFilter === filter.key ? ''active'' : ''''}`}
                    onClick={() => onFilterChange(filter.key)}
                >
                    {filter.label}
                </button>
            ))}
        </div>
    );
}

export default FilterButtons;
```

### Step 6: Todo Stats Component

```javascript
// src/components/TodoStats.jsx
import ''./TodoStats.css'';

function TodoStats({ todos, onClearCompleted }) {
    const activeCount = todos.filter(todo => !todo.completed).length;
    const completedCount = todos.filter(todo => todo.completed).length;
    
    return (
        <div className="todo-stats">
            <span className="todo-count">
                {activeCount} {activeCount === 1 ? ''item'' : ''items''} left
            </span>
            <button
                className="clear-completed-btn"
                onClick={onClearCompleted}
                disabled={completedCount === 0}
            >
                Clear Completed
            </button>
        </div>
    );
}

export default TodoStats;
```

### Step 7: Main App Component

```javascript
// src/App.jsx
import { useState, useMemo } from ''react'';
import useLocalStorage from ''./hooks/useLocalStorage'';
import TodoForm from ''./components/TodoForm'';
import TodoList from ''./components/TodoList'';
import FilterButtons from ''./components/FilterButtons'';
import TodoStats from ''./components/TodoStats'';
import ''./App.css'';

function App() {
    const [todos, setTodos] = useLocalStorage(''todos'', []);
    const [filter, setFilter] = useState(''all'');
    
    const addTodo = (text) => {
        const newTodo = {
            id: Date.now(),
            text,
            completed: false,
            createdAt: new Date().toISOString()
        };
        setTodos([...todos, newTodo]);
    };
    
    const toggleTodo = (id) => {
        setTodos(todos.map(todo =>
            todo.id === id ? { ...todo, completed: !todo.completed } : todo
        ));
    };
    
    const deleteTodo = (id) => {
        setTodos(todos.filter(todo => todo.id !== id));
    };
    
    const updateTodo = (id, newText) => {
        setTodos(todos.map(todo =>
            todo.id === id ? { ...todo, text: newText } : todo
        ));
    };
    
    const clearCompleted = () => {
        setTodos(todos.filter(todo => !todo.completed));
    };
    
    const filteredTodos = useMemo(() => {
        switch (filter) {
            case ''active'':
                return todos.filter(todo => !todo.completed);
            case ''completed'':
                return todos.filter(todo => todo.completed);
            default:
                return todos;
        }
    }, [todos, filter]);
    
    return (
        <div className="app">
            <div className="container">
                <header>
                    <h1>React Todo App</h1>
                </header>
                
                <main>
                    <TodoForm onAddTodo={addTodo} />
                    <FilterButtons
                        currentFilter={filter}
                        onFilterChange={setFilter}
                    />
                    <TodoList
                        todos={filteredTodos}
                        onToggle={toggleTodo}
                        onDelete={deleteTodo}
                        onUpdate={updateTodo}
                    />
                    <TodoStats
                        todos={todos}
                        onClearCompleted={clearCompleted}
                    />
                </main>
            </div>
        </div>
    );
}

export default App;
```

### Step 8: CSS Styling

```css
/* src/App.css */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: ''Segoe UI'', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}

.app {
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    overflow: hidden;
}

header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    text-align: center;
}

header h1 {
    font-size: 2.5em;
    font-weight: 300;
}

main {
    padding: 30px;
}
```

```css
/* src/components/TodoForm.css */
.todo-form {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
}

.todo-input {
    flex: 1;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 5px;
    font-size: 16px;
    transition: border-color 0.3s;
}

.todo-input:focus {
    outline: none;
    border-color: #667eea;
}

.todo-button {
    padding: 12px 24px;
    background: #667eea;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.3s;
}

.todo-button:hover {
    background: #5568d3;
}
```

```css
/* src/components/TodoItem.css */
.todo-item {
    display: flex;
    align-items: center;
    padding: 15px;
    margin-bottom: 10px;
    background: #f9f9f9;
    border-radius: 5px;
    transition: all 0.3s;
}

.todo-item:hover {
    background: #f0f0f0;
}

.todo-item.completed {
    opacity: 0.6;
}

.todo-item.completed .todo-text {
    text-decoration: line-through;
}

.todo-checkbox {
    width: 20px;
    height: 20px;
    margin-right: 15px;
    cursor: pointer;
}

.todo-text {
    flex: 1;
    font-size: 16px;
    color: #333;
    cursor: pointer;
}

.todo-item.editing .todo-text {
    display: none;
}

.todo-edit-input {
    flex: 1;
    padding: 8px;
    border: 2px solid #667eea;
    border-radius: 5px;
    font-size: 16px;
    display: none;
}

.todo-item.editing .todo-edit-input {
    display: block;
}

.todo-actions {
    display: flex;
    gap: 10px;
}

.todo-btn {
    padding: 5px 10px;
    border: none;
    border-radius: 3px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s;
}

.edit-btn {
    background: #4caf50;
    color: white;
}

.edit-btn:hover:not(:disabled) {
    background: #45a049;
}

.delete-btn {
    background: #f44336;
    color: white;
}

.delete-btn:hover {
    background: #da190b;
}

.todo-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
```

```css
/* src/components/FilterButtons.css */
.filters {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
}

.filter-btn {
    padding: 8px 16px;
    background: #f5f5f5;
    border: 1px solid #e0e0e0;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}

.filter-btn:hover {
    background: #e0e0e0;
}

.filter-btn.active {
    background: #667eea;
    color: white;
    border-color: #667eea;
}
```

```css
/* src/components/TodoStats.css */
.todo-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 20px;
    border-top: 1px solid #e0e0e0;
}

.todo-count {
    color: #666;
    font-size: 14px;
}

.clear-completed-btn {
    padding: 8px 16px;
    background: #f44336;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    transition: background 0.3s;
}

.clear-completed-btn:hover:not(:disabled) {
    background: #da190b;
}

.clear-completed-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
}
```

---

## Features Implementation

### React Components

- **Functional Components**: All components use function syntax
- **Props**: Data passed via props
- **State Management**: useState and custom hooks
- **Component Composition**: Reusable components

### State Management

- **useState**: Local component state
- **useLocalStorage**: Custom hook for persistence
- **useMemo**: Optimize filtered todos
- **Lifting State**: State managed in App component

### Local Storage

- **Custom Hook**: useLocalStorage hook
- **Automatic Sync**: Data saved automatically
- **Load on Mount**: Data loaded on app start

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Add new todos
- [ ] Toggle todo completion
- [ ] Edit todo text
- [ ] Delete todos
- [ ] Filter todos
- [ ] Clear completed
- [ ] Refresh page (data persists)
- [ ] Test with empty input
- [ ] Test keyboard shortcuts

---

## Exercise: React Todo App

**Instructions**:

1. Set up React project
2. Create all components
3. Implement all features
4. Test thoroughly
5. Customize design

**Enhancement Ideas**:

- Add due dates
- Add priority levels
- Add categories
- Add search functionality
- Add drag-and-drop
- Add animations
- Add dark mode
- Add export/import

---

## Common Issues and Solutions

### Issue: State not updating

**Solution**: Ensure you''re using functional updates or spreading state correctly.

### Issue: Local storage not working

**Solution**: Check browser console for errors. Ensure localStorage is enabled.

### Issue: Components not re-rendering

**Solution**: Check that state updates are creating new objects/arrays.

---

## Quiz: React Project

1. **React components:**
   - A) Reusable UI pieces
   - B) Not reusable
   - C) Both
   - D) Neither

2. **useState:**
   - A) Manages state
   - B) Doesn''t manage state
   - C) Both
   - D) Neither

3. **Props:**
   - A) Pass data to components
   - B) Don''t pass data
   - C) Both
   - D) Neither

4. **useEffect:**
   - A) Handles side effects
   - B) Doesn''t handle side effects
   - C) Both
   - D) Neither

5. **Local storage:**
   - A) Persists data
   - B) Temporary data
   - C) Both
   - D) Neither

**Answers**:
1. A) Reusable UI pieces
2. A) Manages state
3. A) Pass data to components
4. A) Handles side effects
5. A) Persists data

---

## Key Takeaways

1. **React Components**: Build reusable UI components
2. **State Management**: Use hooks for state
3. **Local Storage**: Persist data in browser
4. **Component Structure**: Organize components well
5. **Best Practice**: Clean, maintainable code

---

## Next Steps

Congratulations! You''ve built a React Todo App. You now know:
- How to create React components
- How to manage state
- How to use local storage
- How to structure React apps

**What''s Next?**
- Project 2.2: React Blog Application
- Learn React Router
- Build a blog application
- Integrate with APIs

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 1, '2026-01-03 10:35:57', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Create React components
- Manage state with hooks
- Use useEffect for side effects
- Integrate local storage
- Build reusable components
- Structure React applications
- Handle user interactions');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (198, 72, 18, 'React Blog Application', 'react-blog-application', '# Project 2.2: React Blog Application

## Project Overview

Build a complete Blog Application using React and React Router. This project will help you practice routing, component architecture, API integration, and building multi-page React applications.

## Learning Objectives

By the end of this project, you will be able to:
- Set up and use React Router
- Create multiple routes and pages
- Build component architecture
- Integrate with APIs
- Handle navigation
- Manage application state
- Create dynamic routes

---

## Project Requirements

### Core Features

1. **Home Page**: Display list of blog posts
2. **Post Detail**: View individual post
3. **Create Post**: Add new blog posts
4. **Edit Post**: Update existing posts
5. **Delete Post**: Remove posts
6. **Navigation**: Navigate between pages
7. **API Integration**: Fetch and post data
8. **Loading States**: Show loading indicators

### Technical Requirements

- Use React Router for navigation
- Component-based architecture
- API integration (JSONPlaceholder or custom)
- Error handling
- Responsive design
- Clean code structure

---

## Project Setup

```bash
# Create React app
npx create-react-app react-blog-app
cd react-blog-app

# Install React Router
npm install react-router-dom

# Start development server
npm start
```

---

## Project Structure

```
react-blog-app/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── Layout.jsx
│   │   ├── Navigation.jsx
│   │   ├── PostCard.jsx
│   │   ├── PostForm.jsx
│   │   └── Loading.jsx
│   ├── pages/
│   │   ├── Home.jsx
│   │   ├── PostDetail.jsx
│   │   ├── CreatePost.jsx
│   │   └── EditPost.jsx
│   ├── hooks/
│   │   └── usePosts.js
│   ├── services/
│   │   └── api.js
│   ├── App.jsx
│   ├── App.css
│   └── index.js
└── package.json
```

---

## Step-by-Step Implementation

### Step 1: API Service

```javascript
// src/services/api.js
const API_URL = ''https://jsonplaceholder.typicode.com/posts'';

export const api = {
    // Get all posts
    async getPosts() {
        try {
            const response = await fetch(API_URL);
            if (!response.ok) {
                throw new Error(''Failed to fetch posts'');
            }
            return await response.json();
        } catch (error) {
            throw error;
        }
    },
    
    // Get single post
    async getPost(id) {
        try {
            const response = await fetch(`${API_URL}/${id}`);
            if (!response.ok) {
                throw new Error(''Failed to fetch post'');
            }
            return await response.json();
        } catch (error) {
            throw error;
        }
    },
    
    // Create post
    async createPost(post) {
        try {
            const response = await fetch(API_URL, {
                method: ''POST'',
                headers: {
                    ''Content-Type'': ''application/json'',
                },
                body: JSON.stringify(post),
            });
            if (!response.ok) {
                throw new Error(''Failed to create post'');
            }
            return await response.json();
        } catch (error) {
            throw error;
        }
    },
    
    // Update post
    async updatePost(id, post) {
        try {
            const response = await fetch(`${API_URL}/${id}`, {
                method: ''PUT'',
                headers: {
                    ''Content-Type'': ''application/json'',
                },
                body: JSON.stringify(post),
            });
            if (!response.ok) {
                throw new Error(''Failed to update post'');
            }
            return await response.json();
        } catch (error) {
            throw error;
        }
    },
    
    // Delete post
    async deletePost(id) {
        try {
            const response = await fetch(`${API_URL}/${id}`, {
                method: ''DELETE'',
            });
            if (!response.ok) {
                throw new Error(''Failed to delete post'');
            }
            return true;
        } catch (error) {
            throw error;
        }
    },
};
```

### Step 2: Custom Hook for Posts

```javascript
// src/hooks/usePosts.js
import { useState, useEffect } from ''react'';
import { api } from ''../services/api'';

export function usePosts() {
    const [posts, setPosts] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        loadPosts();
    }, []);
    
    const loadPosts = async () => {
        try {
            setLoading(true);
            setError(null);
            const data = await api.getPosts();
            setPosts(data);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    const createPost = async (post) => {
        try {
            const newPost = await api.createPost(post);
            setPosts([newPost, ...posts]);
            return newPost;
        } catch (err) {
            throw err;
        }
    };
    
    const updatePost = async (id, post) => {
        try {
            const updatedPost = await api.updatePost(id, post);
            setPosts(posts.map(p => p.id === id ? updatedPost : p));
            return updatedPost;
        } catch (err) {
            throw err;
        }
    };
    
    const deletePost = async (id) => {
        try {
            await api.deletePost(id);
            setPosts(posts.filter(p => p.id !== id));
        } catch (err) {
            throw err;
        }
    };
    
    return {
        posts,
        loading,
        error,
        createPost,
        updatePost,
        deletePost,
        reloadPosts: loadPosts
    };
}
```

### Step 3: Layout Component

```javascript
// src/components/Layout.jsx
import { Outlet } from ''react-router-dom'';
import Navigation from ''./Navigation'';
import ''./Layout.css'';

function Layout() {
    return (
        <div className="layout">
            <Navigation />
            <main className="main-content">
                <Outlet />
            </main>
        </div>
    );
}

export default Layout;
```

### Step 4: Navigation Component

```javascript
// src/components/Navigation.jsx
import { Link, useLocation } from ''react-router-dom'';
import ''./Navigation.css'';

function Navigation() {
    const location = useLocation();
    
    const isActive = (path) => {
        return location.pathname === path;
    };
    
    return (
        <nav className="navigation">
            <div className="nav-container">
                <Link to="/" className="nav-logo">
                    My Blog
                </Link>
                <div className="nav-links">
                    <Link
                        to="/"
                        className={`nav-link ${isActive(''/'') ? ''active'' : ''''}`}
                    >
                        Home
                    </Link>
                    <Link
                        to="/create"
                        className={`nav-link ${isActive(''/create'') ? ''active'' : ''''}`}
                    >
                        Create Post
                    </Link>
                </div>
            </div>
        </nav>
    );
}

export default Navigation;
```

### Step 5: Post Card Component

```javascript
// src/components/PostCard.jsx
import { Link } from ''react-router-dom'';
import ''./PostCard.css'';

function PostCard({ post, onDelete }) {
    const handleDelete = async (e) => {
        e.preventDefault();
        if (window.confirm(''Are you sure you want to delete this post?'')) {
            await onDelete(post.id);
        }
    };
    
    return (
        <div className="post-card">
            <Link to={`/posts/${post.id}`} className="post-link">
                <h2 className="post-title">{post.title}</h2>
                <p className="post-body">{post.body}</p>
            </Link>
            <div className="post-actions">
                <Link to={`/posts/${post.id}/edit`} className="btn btn-edit">
                    Edit
                </Link>
                <button onClick={handleDelete} className="btn btn-delete">
                    Delete
                </button>
            </div>
        </div>
    );
}

export default PostCard;
```

### Step 6: Post Form Component

```javascript
// src/components/PostForm.jsx
import { useState, useEffect } from ''react'';
import ''./PostForm.css'';

function PostForm({ post, onSubmit, onCancel }) {
    const [title, setTitle] = useState('''');
    const [body, setBody] = useState('''');
    const [errors, setErrors] = useState({});
    
    useEffect(() => {
        if (post) {
            setTitle(post.title || '''');
            setBody(post.body || '''');
        }
    }, [post]);
    
    const validate = () => {
        const newErrors = {};
        if (!title.trim()) {
            newErrors.title = ''Title is required'';
        }
        if (!body.trim()) {
            newErrors.body = ''Body is required'';
        }
        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        if (validate()) {
            onSubmit({ title: title.trim(), body: body.trim() });
        }
    };
    
    return (
        <form className="post-form" onSubmit={handleSubmit}>
            <div className="form-group">
                <label htmlFor="title">Title</label>
                <input
                    type="text"
                    id="title"
                    value={title}
                    onChange={(e) => setTitle(e.target.value)}
                    className={errors.title ? ''error'' : ''''}
                />
                {errors.title && <span className="error-message">{errors.title}</span>}
            </div>
            
            <div className="form-group">
                <label htmlFor="body">Body</label>
                <textarea
                    id="body"
                    value={body}
                    onChange={(e) => setBody(e.target.value)}
                    rows="10"
                    className={errors.body ? ''error'' : ''''}
                />
                {errors.body && <span className="error-message">{errors.body}</span>}
            </div>
            
            <div className="form-actions">
                <button type="submit" className="btn btn-primary">
                    {post ? ''Update'' : ''Create''} Post
                </button>
                {onCancel && (
                    <button type="button" onClick={onCancel} className="btn btn-secondary">
                        Cancel
                    </button>
                )}
            </div>
        </form>
    );
}

export default PostForm;
```

### Step 7: Loading Component

```javascript
// src/components/Loading.jsx
import ''./Loading.css'';

function Loading() {
    return (
        <div className="loading">
            <div className="spinner"></div>
            <p>Loading...</p>
        </div>
    );
}

export default Loading;
```

### Step 8: Home Page

```javascript
// src/pages/Home.jsx
import { usePosts } from ''../hooks/usePosts'';
import PostCard from ''../components/PostCard'';
import Loading from ''../components/Loading'';
import ''./Home.css'';

function Home() {
    const { posts, loading, error, deletePost } = usePosts();
    
    if (loading) {
        return <Loading />;
    }
    
    if (error) {
        return <div className="error">Error: {error}</div>;
    }
    
    return (
        <div className="home">
            <h1>Blog Posts</h1>
            <div className="posts-grid">
                {posts.map(post => (
                    <PostCard
                        key={post.id}
                        post={post}
                        onDelete={deletePost}
                    />
                ))}
            </div>
        </div>
    );
}

export default Home;
```

### Step 9: Post Detail Page

```javascript
// src/pages/PostDetail.jsx
import { useParams, Link, useNavigate } from ''react-router-dom'';
import { useState, useEffect } from ''react'';
import { api } from ''../services/api'';
import Loading from ''../components/Loading'';
import ''./PostDetail.css'';

function PostDetail() {
    const { id } = useParams();
    const navigate = useNavigate();
    const [post, setPost] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        loadPost();
    }, [id]);
    
    const loadPost = async () => {
        try {
            setLoading(true);
            setError(null);
            const data = await api.getPost(id);
            setPost(data);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    const handleDelete = async () => {
        if (window.confirm(''Are you sure you want to delete this post?'')) {
            try {
                await api.deletePost(id);
                navigate(''/'');
            } catch (err) {
                alert(''Failed to delete post'');
            }
        }
    };
    
    if (loading) {
        return <Loading />;
    }
    
    if (error) {
        return <div className="error">Error: {error}</div>;
    }
    
    if (!post) {
        return <div className="error">Post not found</div>;
    }
    
    return (
        <div className="post-detail">
            <Link to="/" className="back-link">← Back to Posts</Link>
            <article className="post">
                <h1>{post.title}</h1>
                <div className="post-meta">
                    <span>Post ID: {post.id}</span>
                </div>
                <div className="post-body">
                    <p>{post.body}</p>
                </div>
                <div className="post-actions">
                    <Link to={`/posts/${post.id}/edit`} className="btn btn-edit">
                        Edit
                    </Link>
                    <button onClick={handleDelete} className="btn btn-delete">
                        Delete
                    </button>
                </div>
            </article>
        </div>
    );
}

export default PostDetail;
```

### Step 10: Create Post Page

```javascript
// src/pages/CreatePost.jsx
import { useNavigate } from ''react-router-dom'';
import { usePosts } from ''../hooks/usePosts'';
import PostForm from ''../components/PostForm'';
import ''./CreatePost.css'';

function CreatePost() {
    const navigate = useNavigate();
    const { createPost } = usePosts();
    
    const handleSubmit = async (postData) => {
        try {
            await createPost({
                ...postData,
                userId: 1 // Default user ID
            });
            navigate(''/'');
        } catch (error) {
            alert(''Failed to create post'');
        }
    };
    
    return (
        <div className="create-post">
            <h1>Create New Post</h1>
            <PostForm onSubmit={handleSubmit} onCancel={() => navigate(''/'')} />
        </div>
    );
}

export default CreatePost;
```

### Step 11: Edit Post Page

```javascript
// src/pages/EditPost.jsx
import { useParams, useNavigate } from ''react-router-dom'';
import { useState, useEffect } from ''react'';
import { api } from ''../services/api'';
import { usePosts } from ''../hooks/usePosts'';
import PostForm from ''../components/PostForm'';
import Loading from ''../components/Loading'';
import ''./EditPost.css'';

function EditPost() {
    const { id } = useParams();
    const navigate = useNavigate();
    const { updatePost } = usePosts();
    const [post, setPost] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        loadPost();
    }, [id]);
    
    const loadPost = async () => {
        try {
            setLoading(true);
            setError(null);
            const data = await api.getPost(id);
            setPost(data);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    const handleSubmit = async (postData) => {
        try {
            await updatePost(id, {
                ...postData,
                userId: post.userId,
                id: parseInt(id)
            });
            navigate(`/posts/${id}`);
        } catch (error) {
            alert(''Failed to update post'');
        }
    };
    
    if (loading) {
        return <Loading />;
    }
    
    if (error) {
        return <div className="error">Error: {error}</div>;
    }
    
    if (!post) {
        return <div className="error">Post not found</div>;
    }
    
    return (
        <div className="edit-post">
            <h1>Edit Post</h1>
            <PostForm post={post} onSubmit={handleSubmit} onCancel={() => navigate(-1)} />
        </div>
    );
}

export default EditPost;
```

### Step 12: App Component with Routes

```javascript
// src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import Layout from ''./components/Layout'';
import Home from ''./pages/Home'';
import PostDetail from ''./pages/PostDetail'';
import CreatePost from ''./pages/CreatePost'';
import EditPost from ''./pages/EditPost'';
import ''./App.css'';

function App() {
    return (
        <BrowserRouter>
            <Routes>
                <Route path="/" element={<Layout />}>
                    <Route index element={<Home />} />
                    <Route path="posts/:id" element={<PostDetail />} />
                    <Route path="posts/:id/edit" element={<EditPost />} />
                    <Route path="create" element={<CreatePost />} />
                </Route>
            </Routes>
        </BrowserRouter>
    );
}

export default App;
```

---

## Features Implementation

### React Router

- **BrowserRouter**: Enables routing
- **Routes**: Define route structure
- **Route**: Individual routes
- **Link**: Navigation links
- **useNavigate**: Programmatic navigation
- **useParams**: Access route parameters

### Component Architecture

- **Layout Component**: Shared layout
- **Page Components**: Route-specific pages
- **Reusable Components**: PostCard, PostForm, etc.
- **Separation of Concerns**: Clear component boundaries

### API Integration

- **Service Layer**: API calls in service file
- **Custom Hooks**: usePosts hook for data management
- **Error Handling**: Proper error handling
- **Loading States**: Loading indicators

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Navigate to home page
- [ ] View post details
- [ ] Create new post
- [ ] Edit existing post
- [ ] Delete post
- [ ] Test navigation
- [ ] Test error handling
- [ ] Test loading states

---

## Exercise: Blog App

**Instructions**:

1. Set up React Router
2. Create all components and pages
3. Implement API integration
4. Test all features
5. Customize design

**Enhancement Ideas**:

- Add user authentication
- Add comments system
- Add categories/tags
- Add search functionality
- Add pagination
- Add image upload
- Add markdown support
- Add dark mode

---

## Common Issues and Solutions

### Issue: Routes not working

**Solution**: Ensure BrowserRouter wraps the app and routes are correctly defined.

### Issue: API calls failing

**Solution**: Check API URL and network connectivity. Handle CORS if needed.

### Issue: Navigation not working

**Solution**: Use Link components for navigation, not anchor tags.

---

## Quiz: React Routing

1. **React Router:**
   - A) Enables routing
   - B) Doesn''t enable routing
   - C) Both
   - D) Neither

2. **BrowserRouter:**
   - A) Wraps the app
   - B) Doesn''t wrap app
   - C) Both
   - D) Neither

3. **useParams:**
   - A) Gets route parameters
   - B) Doesn''t get parameters
   - C) Both
   - D) Neither

4. **Link component:**
   - A) Navigates without reload
   - B) Reloads page
   - C) Both
   - D) Neither

5. **Outlet:**
   - A) Renders child routes
   - B) Doesn''t render routes
   - C) Both
   - D) Neither

**Answers**:
1. A) Enables routing
2. A) Wraps the app
3. A) Gets route parameters
4. A) Navigates without reload
5. A) Renders child routes

---

## Key Takeaways

1. **React Router**: Essential for multi-page apps
2. **Component Architecture**: Organize components well
3. **API Integration**: Connect to backend services
4. **Navigation**: Smooth user experience
5. **Best Practice**: Clean, maintainable structure

---

## Next Steps

Congratulations! You''ve built a React Blog Application. You now know:
- How to use React Router
- How to build component architecture
- How to integrate with APIs
- How to create multi-page apps

**What''s Next?**
- Project 2.3: E-commerce Frontend
- Learn complex state management
- Build shopping cart
- Create product catalog

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 2, '2026-01-03 10:35:57', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Set up and use React Router
- Create multiple routes and pages
- Build component architecture
- Integrate with APIs
- Handle navigation
- Manage application state
- Create dynamic routes');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (199, 72, 18, 'E-commerce Frontend', 'ecommerce-frontend', '# Project 2.3: E-commerce Frontend

## Project Overview

Build a complete E-commerce Frontend application with shopping cart, product catalog, and complex state management. This project will help you practice advanced React concepts, state management patterns, and building complex user interfaces.

## Learning Objectives

By the end of this project, you will be able to:
- Manage complex application state
- Implement shopping cart functionality
- Build product catalog with filtering
- Use Context API for global state
- Handle user interactions
- Create responsive e-commerce UI
- Implement cart persistence

---

## Project Requirements

### Core Features

1. **Product Catalog**: Display products with images, prices, descriptions
2. **Product Details**: View individual product information
3. **Shopping Cart**: Add/remove items, update quantities
4. **Cart Persistence**: Save cart to local storage
5. **Filter Products**: Filter by category, price, search
6. **Cart Summary**: Show total, item count
7. **Checkout Page**: Review order before checkout
8. **Responsive Design**: Works on all devices

### Technical Requirements

- Use React with Context API
- Complex state management
- Local storage integration
- Responsive design
- Clean component architecture
- Error handling

---

## Project Setup

```bash
# Create React app
npx create-react-app ecommerce-frontend
cd ecommerce-frontend

# Install dependencies
npm install react-router-dom

# Start development server
npm start
```

---

## Project Structure

```
ecommerce-frontend/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── Layout.jsx
│   │   ├── Navigation.jsx
│   │   ├── ProductCard.jsx
│   │   ├── ProductList.jsx
│   │   ├── ProductDetail.jsx
│   │   ├── Cart.jsx
│   │   ├── CartItem.jsx
│   │   ├── FilterBar.jsx
│   │   └── Checkout.jsx
│   ├── context/
│   │   ├── CartContext.jsx
│   │   └── ProductContext.jsx
│   ├── pages/
│   │   ├── Home.jsx
│   │   ├── Products.jsx
│   │   ├── ProductDetailPage.jsx
│   │   └── CheckoutPage.jsx
│   ├── data/
│   │   └── products.js
│   ├── App.jsx
│   ├── App.css
│   └── index.js
└── package.json
```

---

## Step-by-Step Implementation

### Step 1: Products Data

```javascript
// src/data/products.js
export const products = [
    {
        id: 1,
        name: ''Wireless Headphones'',
        price: 99.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Electronics'',
        description: ''High-quality wireless headphones with noise cancellation.'',
        inStock: true
    },
    {
        id: 2,
        name: ''Smart Watch'',
        price: 199.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Electronics'',
        description: ''Feature-rich smartwatch with fitness tracking.'',
        inStock: true
    },
    {
        id: 3,
        name: ''Laptop Backpack'',
        price: 49.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Accessories'',
        description: ''Durable laptop backpack with multiple compartments.'',
        inStock: true
    },
    {
        id: 4,
        name: ''USB-C Cable'',
        price: 19.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Accessories'',
        description: ''Fast charging USB-C cable, 6 feet long.'',
        inStock: true
    },
    {
        id: 5,
        name: ''Wireless Mouse'',
        price: 29.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Electronics'',
        description: ''Ergonomic wireless mouse with long battery life.'',
        inStock: true
    },
    {
        id: 6,
        name: ''Mechanical Keyboard'',
        price: 129.99,
        image: ''https://via.placeholder.com/300'',
        category: ''Electronics'',
        description: ''RGB mechanical keyboard with customizable keys.'',
        inStock: false
    }
];
```

### Step 2: Cart Context

```javascript
// src/context/CartContext.jsx
import { createContext, useContext, useReducer, useEffect } from ''react'';

const CartContext = createContext();

const cartReducer = (state, action) => {
    switch (action.type) {
        case ''LOAD_CART'':
            return action.payload;
        case ''ADD_ITEM'':
            const existingItem = state.items.find(item => item.id === action.payload.id);
            if (existingItem) {
                return {
                    ...state,
                    items: state.items.map(item =>
                        item.id === action.payload.id
                            ? { ...item, quantity: item.quantity + 1 }
                            : item
                    )
                };
            }
            return {
                ...state,
                items: [...state.items, { ...action.payload, quantity: 1 }]
            };
        case ''REMOVE_ITEM'':
            return {
                ...state,
                items: state.items.filter(item => item.id !== action.payload)
            };
        case ''UPDATE_QUANTITY'':
            return {
                ...state,
                items: state.items.map(item =>
                    item.id === action.payload.id
                        ? { ...item, quantity: action.payload.quantity }
                        : item
                )
            };
        case ''CLEAR_CART'':
            return { items: [] };
        default:
            return state;
    }
};

const initialState = { items: [] };

export function CartProvider({ children }) {
    const [state, dispatch] = useReducer(cartReducer, initialState);
    
    // Load cart from localStorage
    useEffect(() => {
        const savedCart = localStorage.getItem(''cart'');
        if (savedCart) {
            dispatch({ type: ''LOAD_CART'', payload: JSON.parse(savedCart) });
        }
    }, []);
    
    // Save cart to localStorage
    useEffect(() => {
        localStorage.setItem(''cart'', JSON.stringify(state));
    }, [state]);
    
    const addItem = (product) => {
        dispatch({ type: ''ADD_ITEM'', payload: product });
    };
    
    const removeItem = (id) => {
        dispatch({ type: ''REMOVE_ITEM'', payload: id });
    };
    
    const updateQuantity = (id, quantity) => {
        if (quantity <= 0) {
            removeItem(id);
        } else {
            dispatch({ type: ''UPDATE_QUANTITY'', payload: { id, quantity } });
        }
    };
    
    const clearCart = () => {
        dispatch({ type: ''CLEAR_CART'' });
    };
    
    const getTotal = () => {
        return state.items.reduce((total, item) => {
            return total + (item.price * item.quantity);
        }, 0);
    };
    
    const getItemCount = () => {
        return state.items.reduce((count, item) => count + item.quantity, 0);
    };
    
    return (
        <CartContext.Provider
            value={{
                items: state.items,
                addItem,
                removeItem,
                updateQuantity,
                clearCart,
                getTotal,
                getItemCount
            }}
        >
            {children}
        </CartContext.Provider>
    );
}

export function useCart() {
    const context = useContext(CartContext);
    if (!context) {
        throw new Error(''useCart must be used within CartProvider'');
    }
    return context;
}
```

### Step 3: Product Context

```javascript
// src/context/ProductContext.jsx
import { createContext, useContext, useState, useMemo } from ''react'';
import { products } from ''../data/products'';

const ProductContext = createContext();

export function ProductProvider({ children }) {
    const [searchTerm, setSearchTerm] = useState('''');
    const [selectedCategory, setSelectedCategory] = useState(''All'');
    const [priceRange, setPriceRange] = useState([0, 1000]);
    
    const categories = useMemo(() => {
        const cats = [''All'', ...new Set(products.map(p => p.category))];
        return cats;
    }, []);
    
    const filteredProducts = useMemo(() => {
        return products.filter(product => {
            const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                product.description.toLowerCase().includes(searchTerm.toLowerCase());
            const matchesCategory = selectedCategory === ''All'' || product.category === selectedCategory;
            const matchesPrice = product.price >= priceRange[0] && product.price <= priceRange[1];
            
            return matchesSearch && matchesCategory && matchesPrice;
        });
    }, [searchTerm, selectedCategory, priceRange]);
    
    return (
        <ProductContext.Provider
            value={{
                products: filteredProducts,
                allProducts: products,
                categories,
                searchTerm,
                setSearchTerm,
                selectedCategory,
                setSelectedCategory,
                priceRange,
                setPriceRange
            }}
        >
            {children}
        </ProductContext.Provider>
    );
}

export function useProducts() {
    const context = useContext(ProductContext);
    if (!context) {
        throw new Error(''useProducts must be used within ProductProvider'');
    }
    return context;
}
```

### Step 4: Product Card Component

```javascript
// src/components/ProductCard.jsx
import { Link } from ''react-router-dom'';
import { useCart } from ''../context/CartContext'';
import ''./ProductCard.css'';

function ProductCard({ product }) {
    const { addItem } = useCart();
    
    const handleAddToCart = (e) => {
        e.preventDefault();
        addItem(product);
    };
    
    return (
        <div className="product-card">
            <Link to={`/products/${product.id}`} className="product-link">
                <div className="product-image-container">
                    <img src={product.image} alt={product.name} className="product-image" />
                    {!product.inStock && (
                        <div className="out-of-stock">Out of Stock</div>
                    )}
                </div>
                <div className="product-info">
                    <h3 className="product-name">{product.name}</h3>
                    <p className="product-category">{product.category}</p>
                    <p className="product-price">${product.price.toFixed(2)}</p>
                </div>
            </Link>
            <button
                className="add-to-cart-btn"
                onClick={handleAddToCart}
                disabled={!product.inStock}
            >
                {product.inStock ? ''Add to Cart'' : ''Out of Stock''}
            </button>
        </div>
    );
}

export default ProductCard;
```

### Step 5: Product List Component

```javascript
// src/components/ProductList.jsx
import ProductCard from ''./ProductCard'';
import ''./ProductList.css'';

function ProductList({ products }) {
    if (products.length === 0) {
        return (
            <div className="no-products">
                <p>No products found. Try adjusting your filters.</p>
            </div>
        );
    }
    
    return (
        <div className="product-list">
            {products.map(product => (
                <ProductCard key={product.id} product={product} />
            ))}
        </div>
    );
}

export default ProductList;
```

### Step 6: Filter Bar Component

```javascript
// src/components/FilterBar.jsx
import { useProducts } from ''../context/ProductContext'';
import ''./FilterBar.css'';

function FilterBar() {
    const {
        searchTerm,
        setSearchTerm,
        selectedCategory,
        setSelectedCategory,
        categories,
        priceRange,
        setPriceRange
    } = useProducts();
    
    return (
        <div className="filter-bar">
            <div className="filter-group">
                <label>Search</label>
                <input
                    type="text"
                    placeholder="Search products..."
                    value={searchTerm}
                    onChange={(e) => setSearchTerm(e.target.value)}
                    className="search-input"
                />
            </div>
            
            <div className="filter-group">
                <label>Category</label>
                <select
                    value={selectedCategory}
                    onChange={(e) => setSelectedCategory(e.target.value)}
                    className="category-select"
                >
                    {categories.map(category => (
                        <option key={category} value={category}>
                            {category}
                        </option>
                    ))}
                </select>
            </div>
            
            <div className="filter-group">
                <label>Price Range: ${priceRange[0]} - ${priceRange[1]}</label>
                <input
                    type="range"
                    min="0"
                    max="1000"
                    value={priceRange[1]}
                    onChange={(e) => setPriceRange([priceRange[0], parseInt(e.target.value)])}
                    className="price-range"
                />
            </div>
        </div>
    );
}

export default FilterBar;
```

### Step 7: Cart Item Component

```javascript
// src/components/CartItem.jsx
import { useCart } from ''../context/CartContext'';
import ''./CartItem.css'';

function CartItem({ item }) {
    const { removeItem, updateQuantity } = useCart();
    
    return (
        <div className="cart-item">
            <img src={item.image} alt={item.name} className="cart-item-image" />
            <div className="cart-item-info">
                <h4>{item.name}</h4>
                <p className="cart-item-price">${item.price.toFixed(2)}</p>
            </div>
            <div className="cart-item-actions">
                <div className="quantity-controls">
                    <button onClick={() => updateQuantity(item.id, item.quantity - 1)}>
                        −
                    </button>
                    <span>{item.quantity}</span>
                    <button onClick={() => updateQuantity(item.id, item.quantity + 1)}>
                        +
                    </button>
                </div>
                <button
                    className="remove-btn"
                    onClick={() => removeItem(item.id)}
                >
                    Remove
                </button>
            </div>
            <div className="cart-item-total">
                ${(item.price * item.quantity).toFixed(2)}
            </div>
        </div>
    );
}

export default CartItem;
```

### Step 8: Cart Component

```javascript
// src/components/Cart.jsx
import { useCart } from ''../context/CartContext'';
import CartItem from ''./CartItem'';
import { Link } from ''react-router-dom'';
import ''./Cart.css'';

function Cart() {
    const { items, getTotal, clearCart } = useCart();
    
    if (items.length === 0) {
        return (
            <div className="cart-empty">
                <p>Your cart is empty</p>
                <Link to="/products" className="btn btn-primary">
                    Continue Shopping
                </Link>
            </div>
        );
    }
    
    return (
        <div className="cart">
            <div className="cart-header">
                <h2>Shopping Cart</h2>
                <button onClick={clearCart} className="clear-cart-btn">
                    Clear Cart
                </button>
            </div>
            
            <div className="cart-items">
                {items.map(item => (
                    <CartItem key={item.id} item={item} />
                ))}
            </div>
            
            <div className="cart-summary">
                <div className="cart-total">
                    <h3>Total: ${getTotal().toFixed(2)}</h3>
                </div>
                <Link to="/checkout" className="btn btn-checkout">
                    Proceed to Checkout
                </Link>
            </div>
        </div>
    );
}

export default Cart;
```

### Step 9: Checkout Component

```javascript
// src/components/Checkout.jsx
import { useState } from ''react'';
import { useCart } from ''../context/CartContext'';
import { useNavigate } from ''react-router-dom'';
import ''./Checkout.css'';

function Checkout() {
    const { items, getTotal, clearCart } = useCart();
    const navigate = useNavigate();
    const [formData, setFormData] = useState({
        name: '''',
        email: '''',
        address: '''',
        city: '''',
        zip: '''',
        cardNumber: '''',
        expiryDate: '''',
        cvv: ''''
    });
    const [errors, setErrors] = useState({});
    
    const handleChange = (e) => {
        setFormData({
            ...formData,
            [e.target.name]: e.target.value
        });
    };
    
    const validate = () => {
        const newErrors = {};
        if (!formData.name.trim()) newErrors.name = ''Name is required'';
        if (!formData.email.trim()) newErrors.email = ''Email is required'';
        if (!formData.address.trim()) newErrors.address = ''Address is required'';
        if (!formData.city.trim()) newErrors.city = ''City is required'';
        if (!formData.zip.trim()) newErrors.zip = ''ZIP code is required'';
        if (!formData.cardNumber.trim()) newErrors.cardNumber = ''Card number is required'';
        if (!formData.expiryDate.trim()) newErrors.expiryDate = ''Expiry date is required'';
        if (!formData.cvv.trim()) newErrors.cvv = ''CVV is required'';
        
        setErrors(newErrors);
        return Object.keys(newErrors).length === 0;
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        if (validate()) {
            // In a real app, this would send data to backend
            alert(''Order placed successfully!'');
            clearCart();
            navigate(''/'');
        }
    };
    
    return (
        <div className="checkout">
            <h1>Checkout</h1>
            <div className="checkout-content">
                <div className="checkout-form-container">
                    <form className="checkout-form" onSubmit={handleSubmit}>
                        <h2>Shipping Information</h2>
                        <div className="form-group">
                            <label>Full Name</label>
                            <input
                                type="text"
                                name="name"
                                value={formData.name}
                                onChange={handleChange}
                                className={errors.name ? ''error'' : ''''}
                            />
                            {errors.name && <span className="error-message">{errors.name}</span>}
                        </div>
                        
                        <div className="form-group">
                            <label>Email</label>
                            <input
                                type="email"
                                name="email"
                                value={formData.email}
                                onChange={handleChange}
                                className={errors.email ? ''error'' : ''''}
                            />
                            {errors.email && <span className="error-message">{errors.email}</span>}
                        </div>
                        
                        <div className="form-group">
                            <label>Address</label>
                            <input
                                type="text"
                                name="address"
                                value={formData.address}
                                onChange={handleChange}
                                className={errors.address ? ''error'' : ''''}
                            />
                            {errors.address && <span className="error-message">{errors.address}</span>}
                        </div>
                        
                        <div className="form-row">
                            <div className="form-group">
                                <label>City</label>
                                <input
                                    type="text"
                                    name="city"
                                    value={formData.city}
                                    onChange={handleChange}
                                    className={errors.city ? ''error'' : ''''}
                                />
                                {errors.city && <span className="error-message">{errors.city}</span>}
                            </div>
                            
                            <div className="form-group">
                                <label>ZIP Code</label>
                                <input
                                    type="text"
                                    name="zip"
                                    value={formData.zip}
                                    onChange={handleChange}
                                    className={errors.zip ? ''error'' : ''''}
                                />
                                {errors.zip && <span className="error-message">{errors.zip}</span>}
                            </div>
                        </div>
                        
                        <h2>Payment Information</h2>
                        <div className="form-group">
                            <label>Card Number</label>
                            <input
                                type="text"
                                name="cardNumber"
                                value={formData.cardNumber}
                                onChange={handleChange}
                                placeholder="1234 5678 9012 3456"
                                className={errors.cardNumber ? ''error'' : ''''}
                            />
                            {errors.cardNumber && <span className="error-message">{errors.cardNumber}</span>}
                        </div>
                        
                        <div className="form-row">
                            <div className="form-group">
                                <label>Expiry Date</label>
                                <input
                                    type="text"
                                    name="expiryDate"
                                    value={formData.expiryDate}
                                    onChange={handleChange}
                                    placeholder="MM/YY"
                                    className={errors.expiryDate ? ''error'' : ''''}
                                />
                                {errors.expiryDate && <span className="error-message">{errors.expiryDate}</span>}
                            </div>
                            
                            <div className="form-group">
                                <label>CVV</label>
                                <input
                                    type="text"
                                    name="cvv"
                                    value={formData.cvv}
                                    onChange={handleChange}
                                    placeholder="123"
                                    className={errors.cvv ? ''error'' : ''''}
                                />
                                {errors.cvv && <span className="error-message">{errors.cvv}</span>}
                            </div>
                        </div>
                        
                        <button type="submit" className="btn btn-submit">
                            Place Order
                        </button>
                    </form>
                </div>
                
                <div className="order-summary">
                    <h2>Order Summary</h2>
                    <div className="summary-items">
                        {items.map(item => (
                            <div key={item.id} className="summary-item">
                                <span>{item.name} x{item.quantity}</span>
                                <span>${(item.price * item.quantity).toFixed(2)}</span>
                            </div>
                        ))}
                    </div>
                    <div className="summary-total">
                        <h3>Total: ${getTotal().toFixed(2)}</h3>
                    </div>
                </div>
            </div>
        </div>
    );
}

export default Checkout;
```

### Step 10: Navigation Component

```javascript
// src/components/Navigation.jsx
import { Link } from ''react-router-dom'';
import { useCart } from ''../context/CartContext'';
import ''./Navigation.css'';

function Navigation() {
    const { getItemCount } = useCart();
    const itemCount = getItemCount();
    
    return (
        <nav className="navigation">
            <div className="nav-container">
                <Link to="/" className="nav-logo">
                    E-Commerce
                </Link>
                <div className="nav-links">
                    <Link to="/" className="nav-link">Home</Link>
                    <Link to="/products" className="nav-link">Products</Link>
                    <Link to="/cart" className="nav-link cart-link">
                        Cart
                        {itemCount > 0 && <span className="cart-badge">{itemCount}</span>}
                    </Link>
                </div>
            </div>
        </nav>
    );
}

export default Navigation;
```

### Step 11: Pages

```javascript
// src/pages/Home.jsx
import { Link } from ''react-router-dom'';
import ''./Home.css'';

function Home() {
    return (
        <div className="home">
            <div className="hero">
                <h1>Welcome to Our Store</h1>
                <p>Discover amazing products at great prices</p>
                <Link to="/products" className="btn btn-primary">
                    Shop Now
                </Link>
            </div>
        </div>
    );
}

export default Home;
```

```javascript
// src/pages/Products.jsx
import { useProducts } from ''../context/ProductContext'';
import FilterBar from ''../components/FilterBar'';
import ProductList from ''../components/ProductList'';
import ''./Products.css'';

function Products() {
    const { products } = useProducts();
    
    return (
        <div className="products-page">
            <h1>Products</h1>
            <FilterBar />
            <ProductList products={products} />
        </div>
    );
}

export default Products;
```

```javascript
// src/pages/ProductDetailPage.jsx
import { useParams, useNavigate } from ''react-router-dom'';
import { useProducts } from ''../context/ProductContext'';
import { useCart } from ''../context/CartContext'';
import ''./ProductDetailPage.css'';

function ProductDetailPage() {
    const { id } = useParams();
    const navigate = useNavigate();
    const { allProducts } = useProducts();
    const { addItem } = useCart();
    
    const product = allProducts.find(p => p.id === parseInt(id));
    
    if (!product) {
        return <div>Product not found</div>;
    }
    
    const handleAddToCart = () => {
        addItem(product);
        navigate(''/cart'');
    };
    
    return (
        <div className="product-detail-page">
            <button onClick={() => navigate(-1)} className="back-btn">
                ← Back
            </button>
            <div className="product-detail">
                <div className="product-detail-image">
                    <img src={product.image} alt={product.name} />
                </div>
                <div className="product-detail-info">
                    <h1>{product.name}</h1>
                    <p className="product-category">{product.category}</p>
                    <p className="product-price">${product.price.toFixed(2)}</p>
                    <p className="product-description">{product.description}</p>
                    <div className="product-status">
                        {product.inStock ? (
                            <span className="in-stock">In Stock</span>
                        ) : (
                            <span className="out-of-stock">Out of Stock</span>
                        )}
                    </div>
                    <button
                        className="btn btn-primary add-to-cart-detail"
                        onClick={handleAddToCart}
                        disabled={!product.inStock}
                    >
                        {product.inStock ? ''Add to Cart'' : ''Out of Stock''}
                    </button>
                </div>
            </div>
        </div>
    );
}

export default ProductDetailPage;
```

```javascript
// src/pages/CheckoutPage.jsx
import Checkout from ''../components/Checkout'';
import ''./CheckoutPage.css'';

function CheckoutPage() {
    return (
        <div className="checkout-page">
            <Checkout />
        </div>
    );
}

export default CheckoutPage;
```

### Step 12: App Component

```javascript
// src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import { CartProvider } from ''./context/CartContext'';
import { ProductProvider } from ''./context/ProductContext'';
import Layout from ''./components/Layout'';
import Home from ''./pages/Home'';
import Products from ''./pages/Products'';
import ProductDetailPage from ''./pages/ProductDetailPage'';
import Cart from ''./components/Cart'';
import CheckoutPage from ''./pages/CheckoutPage'';
import ''./App.css'';

function App() {
    return (
        <CartProvider>
            <ProductProvider>
                <BrowserRouter>
                    <Routes>
                        <Route path="/" element={<Layout />}>
                            <Route index element={<Home />} />
                            <Route path="products" element={<Products />} />
                            <Route path="products/:id" element={<ProductDetailPage />} />
                            <Route path="cart" element={<Cart />} />
                            <Route path="checkout" element={<CheckoutPage />} />
                        </Route>
                    </Routes>
                </BrowserRouter>
            </ProductProvider>
        </CartProvider>
    );
}

export default App;
```

---

## Features Implementation

### Complex State Management

- **Context API**: Global state for cart and products
- **useReducer**: Complex cart state management
- **Local Storage**: Persist cart data
- **State Updates**: Efficient state updates

### Shopping Cart

- **Add Items**: Add products to cart
- **Remove Items**: Remove from cart
- **Update Quantities**: Change item quantities
- **Calculate Totals**: Automatic total calculation
- **Persist Cart**: Save to local storage

### Product Catalog

- **Display Products**: Show all products
- **Filtering**: Filter by category, price, search
- **Product Details**: Individual product pages
- **Responsive Grid**: Product grid layout

---

## Testing Your Application

### Manual Testing Checklist

- [ ] View product catalog
- [ ] Filter products
- [ ] View product details
- [ ] Add items to cart
- [ ] Update cart quantities
- [ ] Remove items from cart
- [ ] View cart
- [ ] Proceed to checkout
- [ ] Complete checkout form
- [ ] Test cart persistence

---

## Exercise: E-commerce Frontend

**Instructions**:

1. Set up React project
2. Create all components and contexts
3. Implement all features
4. Test thoroughly
5. Customize design

**Enhancement Ideas**:

- Add user authentication
- Add product reviews
- Add wishlist functionality
- Add product recommendations
- Add order history
- Add payment integration
- Add shipping calculator
- Add product images gallery

---

## Common Issues and Solutions

### Issue: Cart not persisting

**Solution**: Check localStorage implementation in CartContext.

### Issue: State not updating

**Solution**: Ensure Context providers wrap components correctly.

### Issue: Filters not working

**Solution**: Check useMemo dependencies in ProductContext.

---

## Quiz: Complex React App

1. **Context API:**
   - A) Manages global state
   - B) Doesn''t manage state
   - C) Both
   - D) Neither

2. **useReducer:**
   - A) Complex state management
   - B) Simple state management
   - C) Both
   - D) Neither

3. **Shopping cart:**
   - A) Complex state
   - B) Simple state
   - C) Both
   - D) Neither

4. **Local storage:**
   - A) Persists data
   - B) Temporary data
   - C) Both
   - D) Neither

5. **Product filtering:**
   - A) Uses useMemo
   - B) Doesn''t use useMemo
   - C) Both
   - D) Neither

**Answers**:
1. A) Manages global state
2. A) Complex state management
3. A) Complex state
4. A) Persists data
5. A) Uses useMemo (for optimization)

---

## Key Takeaways

1. **Complex State**: Use Context API and useReducer
2. **Shopping Cart**: Implement cart functionality
3. **Product Catalog**: Build filtering and display
4. **State Management**: Efficient state updates
5. **Best Practice**: Clean architecture and separation

---

## Next Steps

Congratulations! You''ve built an E-commerce Frontend. You now know:
- How to manage complex state
- How to implement shopping cart
- How to build product catalog
- How to create complex React apps

**What''s Next?**
- Project 3: Full-Stack Applications
- Learn backend development
- Build REST APIs
- Create full-stack applications

---

*Project completed! You''ve finished Project 2: Frontend Applications. Ready for Project 3: Full-Stack Applications!*

', NULL, 3, '2026-01-03 10:35:57', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Manage complex application state
- Implement shopping cart functionality
- Build product catalog with filtering
- Use Context API for global state
- Handle user interactions
- Create responsive e-commerce UI
- Implement cart persistence');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (200, 73, 18, 'REST API with Node.js', 'rest-api-with-nodejs', '# Project 3.1: REST API with Node.js

## Project Overview

Build a complete REST API using Node.js, Express.js, and a database. This project will help you practice backend development, database integration, CRUD operations, and authentication.

## Learning Objectives

By the end of this project, you will be able to:
- Set up Express.js server
- Integrate with databases (MongoDB or MySQL)
- Implement CRUD operations
- Add authentication and authorization
- Handle errors properly
- Structure backend applications
- Test API endpoints

---

## Project Requirements

### Core Features

1. **User Management**: Register, login, get user profile
2. **Product Management**: CRUD operations for products
3. **Authentication**: JWT-based authentication
4. **Authorization**: Protect routes
5. **Error Handling**: Proper error responses
6. **Validation**: Input validation
7. **Database**: Persistent data storage
8. **API Documentation**: Clear API structure

### Technical Requirements

- Node.js and Express.js
- Database (MongoDB with Mongoose or MySQL)
- JWT authentication
- Input validation
- Error handling middleware
- Environment variables
- RESTful API design

---

## Project Setup

```bash
# Create project directory
mkdir rest-api-project
cd rest-api-project

# Initialize npm
npm init -y

# Install dependencies
npm install express mongoose dotenv bcrypt jsonwebtoken express-validator cors
npm install --save-dev nodemon

# Create project structure
mkdir src
mkdir src/controllers
mkdir src/models
mkdir src/routes
mkdir src/middleware
mkdir src/utils
```

---

## Project Structure

```
rest-api-project/
├── src/
│   ├── controllers/
│   │   ├── authController.js
│   │   └── productController.js
│   ├── models/
│   │   ├── User.js
│   │   └── Product.js
│   ├── routes/
│   │   ├── authRoutes.js
│   │   └── productRoutes.js
│   ├── middleware/
│   │   ├── auth.js
│   │   ├── errorHandler.js
│   │   └── validate.js
│   ├── utils/
│   │   └── generateToken.js
│   └── server.js
├── .env
├── .gitignore
└── package.json
```

---

## Step-by-Step Implementation

### Step 1: Package.json Configuration

```json
{
  "name": "rest-api-project",
  "version": "1.0.0",
  "description": "REST API with Node.js and Express",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "nodemon src/server.js"
  },
  "keywords": ["api", "rest", "express"],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "express": "^4.18.0",
    "mongoose": "^7.0.0",
    "dotenv": "^16.0.0",
    "bcrypt": "^5.1.0",
    "jsonwebtoken": "^9.0.0",
    "express-validator": "^7.0.0",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "nodemon": "^2.0.0"
  }
}
```

### Step 2: Environment Variables

```bash
# .env
NODE_ENV=development
PORT=5000
MONGODB_URI=mongodb://localhost:27017/ecommerce
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRE=7d
```

### Step 3: User Model

```javascript
// src/models/User.js
const mongoose = require(''mongoose'');
const bcrypt = require(''bcrypt'');

const userSchema = new mongoose.Schema({
    name: {
        type: String,
        required: [true, ''Please provide a name''],
        trim: true
    },
    email: {
        type: String,
        required: [true, ''Please provide an email''],
        unique: true,
        lowercase: true,
        trim: true,
        match: [/^\\S+@\\S+\\.\\S+$/, ''Please provide a valid email'']
    },
    password: {
        type: String,
        required: [true, ''Please provide a password''],
        minlength: [6, ''Password must be at least 6 characters''],
        select: false
    },
    role: {
        type: String,
        enum: [''user'', ''admin''],
        default: ''user''
    }
}, {
    timestamps: true
});

// Hash password before saving
userSchema.pre(''save'', async function(next) {
    if (!this.isModified(''password'')) {
        return next();
    }
    const salt = await bcrypt.genSalt(10);
    this.password = await bcrypt.hash(this.password, salt);
    next();
});

// Compare password method
userSchema.methods.comparePassword = async function(candidatePassword) {
    return await bcrypt.compare(candidatePassword, this.password);
};

module.exports = mongoose.model(''User'', userSchema);
```

### Step 4: Product Model

```javascript
// src/models/Product.js
const mongoose = require(''mongoose'');

const productSchema = new mongoose.Schema({
    name: {
        type: String,
        required: [true, ''Please provide a product name''],
        trim: true
    },
    description: {
        type: String,
        required: [true, ''Please provide a description'']
    },
    price: {
        type: Number,
        required: [true, ''Please provide a price''],
        min: [0, ''Price must be positive'']
    },
    category: {
        type: String,
        required: [true, ''Please provide a category'']
    },
    image: {
        type: String,
        default: ''https://via.placeholder.com/300''
    },
    inStock: {
        type: Boolean,
        default: true
    },
    stock: {
        type: Number,
        default: 0,
        min: 0
    },
    createdBy: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User'',
        required: true
    }
}, {
    timestamps: true
});

module.exports = mongoose.model(''Product'', productSchema);
```

### Step 5: Generate Token Utility

```javascript
// src/utils/generateToken.js
const jwt = require(''jsonwebtoken'');

const generateToken = (userId) => {
    return jwt.sign({ userId }, process.env.JWT_SECRET, {
        expiresIn: process.env.JWT_EXPIRE
    });
};

module.exports = generateToken;
```

### Step 6: Authentication Middleware

```javascript
// src/middleware/auth.js
const jwt = require(''jsonwebtoken'');
const User = require(''../models/User'');

const protect = async (req, res, next) => {
    let token;
    
    if (req.headers.authorization && req.headers.authorization.startsWith(''Bearer'')) {
        token = req.headers.authorization.split('' '')[1];
    }
    
    if (!token) {
        return res.status(401).json({
            success: false,
            error: ''Not authorized to access this route''
        });
    }
    
    try {
        const decoded = jwt.verify(token, process.env.JWT_SECRET);
        req.user = await User.findById(decoded.userId).select(''-password'');
        
        if (!req.user) {
            return res.status(401).json({
                success: false,
                error: ''User not found''
            });
        }
        
        next();
    } catch (error) {
        return res.status(401).json({
            success: false,
            error: ''Not authorized to access this route''
        });
    }
};

const authorize = (...roles) => {
    return (req, res, next) => {
        if (!roles.includes(req.user.role)) {
            return res.status(403).json({
                success: false,
                error: `User role ${req.user.role} is not authorized to access this route`
            });
        }
        next();
    };
};

module.exports = { protect, authorize };
```

### Step 7: Validation Middleware

```javascript
// src/middleware/validate.js
const { validationResult } = require(''express-validator'');

const validate = (req, res, next) => {
    const errors = validationResult(req);
    if (!errors.isEmpty()) {
        return res.status(400).json({
            success: false,
            errors: errors.array()
        });
    }
    next();
};

module.exports = validate;
```

### Step 8: Error Handler Middleware

```javascript
// src/middleware/errorHandler.js
const errorHandler = (err, req, res, next) => {
    let error = { ...err };
    error.message = err.message;
    
    // Log error
    console.error(err);
    
    // Mongoose bad ObjectId
    if (err.name === ''CastError'') {
        const message = ''Resource not found'';
        error = { message, statusCode: 404 };
    }
    
    // Mongoose duplicate key
    if (err.code === 11000) {
        const message = ''Duplicate field value entered'';
        error = { message, statusCode: 400 };
    }
    
    // Mongoose validation error
    if (err.name === ''ValidationError'') {
        const message = Object.values(err.errors).map(val => val.message);
        error = { message, statusCode: 400 };
    }
    
    res.status(error.statusCode || 500).json({
        success: false,
        error: error.message || ''Server Error''
    });
};

module.exports = errorHandler;
```

### Step 9: Auth Controller

```javascript
// src/controllers/authController.js
const User = require(''../models/User'');
const generateToken = require(''../utils/generateToken'');

// @desc    Register user
// @route   POST /api/auth/register
// @access  Public
exports.register = async (req, res, next) => {
    try {
        const { name, email, password } = req.body;
        
        // Check if user exists
        const userExists = await User.findOne({ email });
        if (userExists) {
            return res.status(400).json({
                success: false,
                error: ''User already exists''
            });
        }
        
        // Create user
        const user = await User.create({
            name,
            email,
            password
        });
        
        // Generate token
        const token = generateToken(user._id);
        
        res.status(201).json({
            success: true,
            token,
            user: {
                id: user._id,
                name: user.name,
                email: user.email,
                role: user.role
            }
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Login user
// @route   POST /api/auth/login
// @access  Public
exports.login = async (req, res, next) => {
    try {
        const { email, password } = req.body;
        
        // Validate email and password
        if (!email || !password) {
            return res.status(400).json({
                success: false,
                error: ''Please provide email and password''
            });
        }
        
        // Check for user
        const user = await User.findOne({ email }).select(''+password'');
        if (!user) {
            return res.status(401).json({
                success: false,
                error: ''Invalid credentials''
            });
        }
        
        // Check if password matches
        const isMatch = await user.comparePassword(password);
        if (!isMatch) {
            return res.status(401).json({
                success: false,
                error: ''Invalid credentials''
            });
        }
        
        // Generate token
        const token = generateToken(user._id);
        
        res.json({
            success: true,
            token,
            user: {
                id: user._id,
                name: user.name,
                email: user.email,
                role: user.role
            }
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Get current user
// @route   GET /api/auth/me
// @access  Private
exports.getMe = async (req, res, next) => {
    try {
        const user = await User.findById(req.user._id);
        
        res.json({
            success: true,
            user: {
                id: user._id,
                name: user.name,
                email: user.email,
                role: user.role
            }
        });
    } catch (error) {
        next(error);
    }
};
```

### Step 10: Product Controller

```javascript
// src/controllers/productController.js
const Product = require(''../models/Product'');

// @desc    Get all products
// @route   GET /api/products
// @access  Public
exports.getProducts = async (req, res, next) => {
    try {
        const { category, search, page = 1, limit = 10 } = req.query;
        
        // Build query
        const query = {};
        if (category) {
            query.category = category;
        }
        if (search) {
            query.$or = [
                { name: { $regex: search, $options: ''i'' } },
                { description: { $regex: search, $options: ''i'' } }
            ];
        }
        
        // Pagination
        const skip = (page - 1) * limit;
        
        const products = await Product.find(query)
            .populate(''createdBy'', ''name email'')
            .skip(skip)
            .limit(parseInt(limit))
            .sort({ createdAt: -1 });
        
        const total = await Product.countDocuments(query);
        
        res.json({
            success: true,
            count: products.length,
            total,
            page: parseInt(page),
            pages: Math.ceil(total / limit),
            data: products
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Get single product
// @route   GET /api/products/:id
// @access  Public
exports.getProduct = async (req, res, next) => {
    try {
        const product = await Product.findById(req.params.id)
            .populate(''createdBy'', ''name email'');
        
        if (!product) {
            return res.status(404).json({
                success: false,
                error: ''Product not found''
            });
        }
        
        res.json({
            success: true,
            data: product
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Create product
// @route   POST /api/products
// @access  Private
exports.createProduct = async (req, res, next) => {
    try {
        req.body.createdBy = req.user._id;
        
        const product = await Product.create(req.body);
        
        res.status(201).json({
            success: true,
            data: product
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Update product
// @route   PUT /api/products/:id
// @access  Private
exports.updateProduct = async (req, res, next) => {
    try {
        let product = await Product.findById(req.params.id);
        
        if (!product) {
            return res.status(404).json({
                success: false,
                error: ''Product not found''
            });
        }
        
        // Make sure user is product owner or admin
        if (product.createdBy.toString() !== req.user._id.toString() && req.user.role !== ''admin'') {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to update this product''
            });
        }
        
        product = await Product.findByIdAndUpdate(
            req.params.id,
            req.body,
            {
                new: true,
                runValidators: true
            }
        );
        
        res.json({
            success: true,
            data: product
        });
    } catch (error) {
        next(error);
    }
};

// @desc    Delete product
// @route   DELETE /api/products/:id
// @access  Private
exports.deleteProduct = async (req, res, next) => {
    try {
        const product = await Product.findById(req.params.id);
        
        if (!product) {
            return res.status(404).json({
                success: false,
                error: ''Product not found''
            });
        }
        
        // Make sure user is product owner or admin
        if (product.createdBy.toString() !== req.user._id.toString() && req.user.role !== ''admin'') {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to delete this product''
            });
        }
        
        await product.deleteOne();
        
        res.json({
            success: true,
            data: {}
        });
    } catch (error) {
        next(error);
    }
};
```

### Step 11: Auth Routes

```javascript
// src/routes/authRoutes.js
const express = require(''express'');
const { body } = require(''express-validator'');
const { register, login, getMe } = require(''../controllers/authController'');
const { protect } = require(''../middleware/auth'');
const validate = require(''../middleware/validate'');

const router = express.Router();

router.post(
    ''/register'',
    [
        body(''name'').trim().notEmpty().withMessage(''Name is required''),
        body(''email'').isEmail().withMessage(''Please provide a valid email''),
        body(''password'').isLength({ min: 6 }).withMessage(''Password must be at least 6 characters'')
    ],
    validate,
    register
);

router.post(
    ''/login'',
    [
        body(''email'').isEmail().withMessage(''Please provide a valid email''),
        body(''password'').notEmpty().withMessage(''Password is required'')
    ],
    validate,
    login
);

router.get(''/me'', protect, getMe);

module.exports = router;
```

### Step 12: Product Routes

```javascript
// src/routes/productRoutes.js
const express = require(''express'');
const { body } = require(''express-validator'');
const {
    getProducts,
    getProduct,
    createProduct,
    updateProduct,
    deleteProduct
} = require(''../controllers/productController'');
const { protect, authorize } = require(''../middleware/auth'');
const validate = require(''../middleware/validate'');

const router = express.Router();

router.get(''/'', getProducts);
router.get(''/:id'', getProduct);
router.post(
    ''/'',
    protect,
    [
        body(''name'').trim().notEmpty().withMessage(''Product name is required''),
        body(''description'').trim().notEmpty().withMessage(''Description is required''),
        body(''price'').isFloat({ min: 0 }).withMessage(''Price must be a positive number''),
        body(''category'').trim().notEmpty().withMessage(''Category is required'')
    ],
    validate,
    createProduct
);
router.put(
    ''/:id'',
    protect,
    [
        body(''name'').optional().trim().notEmpty().withMessage(''Product name cannot be empty''),
        body(''price'').optional().isFloat({ min: 0 }).withMessage(''Price must be a positive number'')
    ],
    validate,
    updateProduct
);
router.delete(''/:id'', protect, deleteProduct);

module.exports = router;
```

### Step 13: Server Setup

```javascript
// src/server.js
const express = require(''express'');
const mongoose = require(''mongoose'');
const cors = require(''cors'');
require(''dotenv'').config();

const authRoutes = require(''./routes/authRoutes'');
const productRoutes = require(''./routes/productRoutes'');
const errorHandler = require(''./middleware/errorHandler'');

const app = express();

// Middleware
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Routes
app.use(''/api/auth'', authRoutes);
app.use(''/api/products'', productRoutes);

// Health check
app.get(''/api/health'', (req, res) => {
    res.json({
        success: true,
        message: ''API is running''
    });
});

// Error handler (must be last)
app.use(errorHandler);

// Connect to database
mongoose.connect(process.env.MONGODB_URI)
    .then(() => {
        console.log(''Connected to MongoDB'');
        // Start server
        const PORT = process.env.PORT || 5000;
        app.listen(PORT, () => {
            console.log(`Server running on port ${PORT}`);
        });
    })
    .catch((error) => {
        console.error(''MongoDB connection error:'', error);
        process.exit(1);
    });
```

---

## API Endpoints

### Authentication

- `POST /api/auth/register` - Register new user
- `POST /api/auth/login` - Login user
- `GET /api/auth/me` - Get current user (Protected)

### Products

- `GET /api/products` - Get all products (with filters)
- `GET /api/products/:id` - Get single product
- `POST /api/products` - Create product (Protected)
- `PUT /api/products/:id` - Update product (Protected)
- `DELETE /api/products/:id` - Delete product (Protected)

---

## Testing Your API

### Using Postman or cURL

```bash
# Register user
curl -X POST http://localhost:5000/api/auth/register \\
  -H "Content-Type: application/json" \\
  -d ''{"name":"John Doe","email":"john@example.com","password":"password123"}''

# Login
curl -X POST http://localhost:5000/api/auth/login \\
  -H "Content-Type: application/json" \\
  -d ''{"email":"john@example.com","password":"password123"}''

# Get products
curl http://localhost:5000/api/products

# Create product (with token)
curl -X POST http://localhost:5000/api/products \\
  -H "Content-Type: application/json" \\
  -H "Authorization: Bearer YOUR_TOKEN" \\
  -d ''{"name":"Product Name","description":"Description","price":99.99,"category":"Electronics"}''
```

---

## Exercise: REST API

**Instructions**:

1. Set up the project
2. Create all files
3. Test all endpoints
4. Add more features
5. Document the API

**Enhancement Ideas**:

- Add order management
- Add review/rating system
- Add file upload for images
- Add pagination improvements
- Add sorting options
- Add caching
- Add rate limiting
- Add API documentation (Swagger)

---

## Common Issues and Solutions

### Issue: Database connection fails

**Solution**: Check MongoDB is running and connection string is correct.

### Issue: JWT token invalid

**Solution**: Ensure JWT_SECRET is set and token is sent in Authorization header.

### Issue: Validation errors

**Solution**: Check express-validator rules and request body format.

---

## Quiz: Backend API

1. **Express.js:**
   - A) Web framework
   - B) Database
   - C) Both
   - D) Neither

2. **Mongoose:**
   - A) MongoDB ODM
   - B) SQL ORM
   - C) Both
   - D) Neither

3. **JWT:**
   - A) Authentication token
   - B) Database
   - C) Both
   - D) Neither

4. **Middleware:**
   - A) Processes requests
   - B) Doesn''t process requests
   - C) Both
   - D) Neither

5. **REST API:**
   - A) Uses HTTP methods
   - B) Doesn''t use HTTP methods
   - C) Both
   - D) Neither

**Answers**:
1. A) Web framework
2. A) MongoDB ODM
3. A) Authentication token
4. A) Processes requests
5. A) Uses HTTP methods

---

## Key Takeaways

1. **Express.js**: Fast web framework
2. **Database Integration**: Connect to MongoDB
3. **CRUD Operations**: Create, read, update, delete
4. **Authentication**: JWT-based auth
5. **Best Practice**: Clean structure, error handling

---

## Next Steps

Congratulations! You''ve built a REST API. You now know:
- How to set up Express.js
- How to integrate databases
- How to implement CRUD operations
- How to add authentication

**What''s Next?**
- Project 3.2: Full-Stack Application
- Connect frontend and backend
- Build complete application
- Integrate all components

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 1, '2026-01-03 10:37:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Set up Express.js server
- Integrate with databases (MongoDB or MySQL)
- Implement CRUD operations
- Add authentication and authorization
- Handle errors properly
- Structure backend applications
- Test API endpoints');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (201, 73, 18, 'Full-Stack Application', 'full-stack-application', '# Project 3.2: Full-Stack Application

## Project Overview

Build a complete full-stack application combining the React frontend with the Node.js backend. This project will help you practice connecting frontend and backend, managing authentication across the stack, and building production-ready applications.

## Learning Objectives

By the end of this project, you will be able to:
- Connect React frontend to Node.js backend
- Implement authentication flow
- Manage API calls from frontend
- Handle authentication state
- Build complete full-stack applications
- Deploy full-stack applications
- Handle CORS and security

---

## Project Requirements

### Core Features

1. **User Authentication**: Register, login, logout
2. **Product Management**: View, create, edit, delete products
3. **Protected Routes**: Secure frontend routes
4. **API Integration**: Connect frontend to backend
5. **State Management**: Manage auth and data state
6. **Error Handling**: Handle API errors
7. **Loading States**: Show loading indicators
8. **Responsive Design**: Works on all devices

### Technical Requirements

- React frontend
- Node.js/Express backend
- MongoDB database
- JWT authentication
- Axios for API calls
- Context API for state
- Protected routes

---

## Project Structure

```
fullstack-app/
├── backend/
│   ├── src/
│   │   ├── controllers/
│   │   ├── models/
│   │   ├── routes/
│   │   ├── middleware/
│   │   └── server.js
│   ├── .env
│   └── package.json
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   ├── pages/
│   │   ├── context/
│   │   ├── services/
│   │   └── App.jsx
│   └── package.json
└── README.md
```

---

## Step-by-Step Implementation

### Backend Setup

Use the backend from Project 3.1 or set it up following those instructions.

### Frontend Setup

```bash
# Create React app
npx create-react-app frontend
cd frontend

# Install dependencies
npm install axios react-router-dom

# Start development server
npm start
```

### Frontend API Service

```javascript
// src/services/api.js
import axios from ''axios'';

const API_URL = process.env.REACT_APP_API_URL || ''http://localhost:5000/api'';

// Create axios instance
const api = axios.create({
    baseURL: API_URL,
    headers: {
        ''Content-Type'': ''application/json''
    }
});

// Add token to requests
api.interceptors.request.use(
    (config) => {
        const token = localStorage.getItem(''token'');
        if (token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    },
    (error) => {
        return Promise.reject(error);
    }
);

// Handle response errors
api.interceptors.response.use(
    (response) => response,
    (error) => {
        if (error.response?.status === 401) {
            localStorage.removeItem(''token'');
            window.location.href = ''/login'';
        }
        return Promise.reject(error);
    }
);

// Auth API
export const authAPI = {
    register: (userData) => api.post(''/auth/register'', userData),
    login: (credentials) => api.post(''/auth/login'', credentials),
    getMe: () => api.get(''/auth/me'')
};

// Products API
export const productsAPI = {
    getProducts: (params) => api.get(''/products'', { params }),
    getProduct: (id) => api.get(`/products/${id}`),
    createProduct: (productData) => api.post(''/products'', productData),
    updateProduct: (id, productData) => api.put(`/products/${id}`, productData),
    deleteProduct: (id) => api.delete(`/products/${id}`)
};

export default api;
```

### Auth Context

```javascript
// src/context/AuthContext.jsx
import { createContext, useContext, useState, useEffect } from ''react'';
import { authAPI } from ''../services/api'';

const AuthContext = createContext();

export function AuthProvider({ children }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    const [token, setToken] = useState(localStorage.getItem(''token''));
    
    useEffect(() => {
        if (token) {
            loadUser();
        } else {
            setLoading(false);
        }
    }, [token]);
    
    const loadUser = async () => {
        try {
            const response = await authAPI.getMe();
            setUser(response.data.user);
        } catch (error) {
            localStorage.removeItem(''token'');
            setToken(null);
        } finally {
            setLoading(false);
        }
    };
    
    const register = async (userData) => {
        try {
            const response = await authAPI.register(userData);
            const { token, user } = response.data;
            localStorage.setItem(''token'', token);
            setToken(token);
            setUser(user);
            return { success: true };
        } catch (error) {
            return {
                success: false,
                error: error.response?.data?.error || ''Registration failed''
            };
        }
    };
    
    const login = async (credentials) => {
        try {
            const response = await authAPI.login(credentials);
            const { token, user } = response.data;
            localStorage.setItem(''token'', token);
            setToken(token);
            setUser(user);
            return { success: true };
        } catch (error) {
            return {
                success: false,
                error: error.response?.data?.error || ''Login failed''
            };
        }
    };
    
    const logout = () => {
        localStorage.removeItem(''token'');
        setToken(null);
        setUser(null);
    };
    
    return (
        <AuthContext.Provider
            value={{
                user,
                loading,
                register,
                login,
                logout,
                isAuthenticated: !!user
            }}
        >
            {children}
        </AuthContext.Provider>
    );
}

export function useAuth() {
    const context = useContext(AuthContext);
    if (!context) {
        throw new Error(''useAuth must be used within AuthProvider'');
    }
    return context;
}
```

### Protected Route Component

```javascript
// src/components/ProtectedRoute.jsx
import { Navigate } from ''react-router-dom'';
import { useAuth } from ''../context/AuthContext'';

function ProtectedRoute({ children }) {
    const { isAuthenticated, loading } = useAuth();
    
    if (loading) {
        return <div>Loading...</div>;
    }
    
    return isAuthenticated ? children : <Navigate to="/login" />;
}

export default ProtectedRoute;
```

### Login Page

```javascript
// src/pages/Login.jsx
import { useState } from ''react'';
import { useNavigate, Link } from ''react-router-dom'';
import { useAuth } from ''../context/AuthContext'';
import ''./Login.css'';

function Login() {
    const navigate = useNavigate();
    const { login } = useAuth();
    const [formData, setFormData] = useState({
        email: '''',
        password: ''''
    });
    const [error, setError] = useState('''');
    const [loading, setLoading] = useState(false);
    
    const handleChange = (e) => {
        setFormData({
            ...formData,
            [e.target.name]: e.target.value
        });
    };
    
    const handleSubmit = async (e) => {
        e.preventDefault();
        setError('''');
        setLoading(true);
        
        const result = await login(formData);
        
        if (result.success) {
            navigate(''/'');
        } else {
            setError(result.error);
        }
        
        setLoading(false);
    };
    
    return (
        <div className="login-page">
            <div className="login-container">
                <h1>Login</h1>
                {error && <div className="error-message">{error}</div>}
                <form onSubmit={handleSubmit}>
                    <div className="form-group">
                        <label>Email</label>
                        <input
                            type="email"
                            name="email"
                            value={formData.email}
                            onChange={handleChange}
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>Password</label>
                        <input
                            type="password"
                            name="password"
                            value={formData.password}
                            onChange={handleChange}
                            required
                        />
                    </div>
                    <button type="submit" disabled={loading} className="btn btn-primary">
                        {loading ? ''Logging in...'' : ''Login''}
                    </button>
                </form>
                <p>
                    Don''t have an account? <Link to="/register">Register</Link>
                </p>
            </div>
        </div>
    );
}

export default Login;
```

### Register Page

```javascript
// src/pages/Register.jsx
import { useState } from ''react'';
import { useNavigate, Link } from ''react-router-dom'';
import { useAuth } from ''../context/AuthContext'';
import ''./Register.css'';

function Register() {
    const navigate = useNavigate();
    const { register } = useAuth();
    const [formData, setFormData] = useState({
        name: '''',
        email: '''',
        password: ''''
    });
    const [error, setError] = useState('''');
    const [loading, setLoading] = useState(false);
    
    const handleChange = (e) => {
        setFormData({
            ...formData,
            [e.target.name]: e.target.value
        });
    };
    
    const handleSubmit = async (e) => {
        e.preventDefault();
        setError('''');
        setLoading(true);
        
        const result = await register(formData);
        
        if (result.success) {
            navigate(''/'');
        } else {
            setError(result.error);
        }
        
        setLoading(false);
    };
    
    return (
        <div className="register-page">
            <div className="register-container">
                <h1>Register</h1>
                {error && <div className="error-message">{error}</div>}
                <form onSubmit={handleSubmit}>
                    <div className="form-group">
                        <label>Name</label>
                        <input
                            type="text"
                            name="name"
                            value={formData.name}
                            onChange={handleChange}
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>Email</label>
                        <input
                            type="email"
                            name="email"
                            value={formData.email}
                            onChange={handleChange}
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>Password</label>
                        <input
                            type="password"
                            name="password"
                            value={formData.password}
                            onChange={handleChange}
                            required
                            minLength="6"
                        />
                    </div>
                    <button type="submit" disabled={loading} className="btn btn-primary">
                        {loading ? ''Registering...'' : ''Register''}
                    </button>
                </form>
                <p>
                    Already have an account? <Link to="/login">Login</Link>
                </p>
            </div>
        </div>
    );
}

export default Register;
```

### Products Page

```javascript
// src/pages/Products.jsx
import { useState, useEffect } from ''react'';
import { Link } from ''react-router-dom'';
import { productsAPI } from ''../services/api'';
import { useAuth } from ''../context/AuthContext'';
import ''./Products.css'';

function Products() {
    const { isAuthenticated } = useAuth();
    const [products, setProducts] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState('''');
    const [filters, setFilters] = useState({
        search: '''',
        category: ''''
    });
    
    useEffect(() => {
        loadProducts();
    }, [filters]);
    
    const loadProducts = async () => {
        try {
            setLoading(true);
            const response = await productsAPI.getProducts(filters);
            setProducts(response.data.data);
        } catch (error) {
            setError(''Failed to load products'');
        } finally {
            setLoading(false);
        }
    };
    
    const handleDelete = async (id) => {
        if (window.confirm(''Are you sure you want to delete this product?'')) {
            try {
                await productsAPI.deleteProduct(id);
                loadProducts();
            } catch (error) {
                alert(''Failed to delete product'');
            }
        }
    };
    
    if (loading) {
        return <div className="loading">Loading products...</div>;
    }
    
    return (
        <div className="products-page">
            <div className="products-header">
                <h1>Products</h1>
                {isAuthenticated && (
                    <Link to="/products/new" className="btn btn-primary">
                        Add Product
                    </Link>
                )}
            </div>
            
            <div className="filters">
                <input
                    type="text"
                    placeholder="Search products..."
                    value={filters.search}
                    onChange={(e) => setFilters({ ...filters, search: e.target.value })}
                />
                <select
                    value={filters.category}
                    onChange={(e) => setFilters({ ...filters, category: e.target.value })}
                >
                    <option value="">All Categories</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Accessories">Accessories</option>
                </select>
            </div>
            
            {error && <div className="error">{error}</div>}
            
            <div className="products-grid">
                {products.map(product => (
                    <div key={product._id} className="product-card">
                        <Link to={`/products/${product._id}`}>
                            <img src={product.image} alt={product.name} />
                            <h3>{product.name}</h3>
                            <p className="price">${product.price.toFixed(2)}</p>
                        </Link>
                        {isAuthenticated && (
                            <div className="product-actions">
                                <Link
                                    to={`/products/${product._id}/edit`}
                                    className="btn btn-edit"
                                >
                                    Edit
                                </Link>
                                <button
                                    onClick={() => handleDelete(product._id)}
                                    className="btn btn-delete"
                                >
                                    Delete
                                </button>
                            </div>
                        )}
                    </div>
                ))}
            </div>
        </div>
    );
}

export default Products;
```

### Create Product Page

```javascript
// src/pages/CreateProduct.jsx
import { useState } from ''react'';
import { useNavigate } from ''react-router-dom'';
import { productsAPI } from ''../services/api'';
import ''./CreateProduct.css'';

function CreateProduct() {
    const navigate = useNavigate();
    const [formData, setFormData] = useState({
        name: '''',
        description: '''',
        price: '''',
        category: '''',
        image: ''https://via.placeholder.com/300'',
        inStock: true,
        stock: 0
    });
    const [error, setError] = useState('''');
    const [loading, setLoading] = useState(false);
    
    const handleChange = (e) => {
        const value = e.target.type === ''checkbox'' ? e.target.checked : e.target.value;
        setFormData({
            ...formData,
            [e.target.name]: value
        });
    };
    
    const handleSubmit = async (e) => {
        e.preventDefault();
        setError('''');
        setLoading(true);
        
        try {
            await productsAPI.createProduct({
                ...formData,
                price: parseFloat(formData.price),
                stock: parseInt(formData.stock)
            });
            navigate(''/products'');
        } catch (error) {
            setError(error.response?.data?.error || ''Failed to create product'');
        } finally {
            setLoading(false);
        }
    };
    
    return (
        <div className="create-product-page">
            <h1>Create Product</h1>
            {error && <div className="error-message">{error}</div>}
            <form onSubmit={handleSubmit} className="product-form">
                <div className="form-group">
                    <label>Name</label>
                    <input
                        type="text"
                        name="name"
                        value={formData.name}
                        onChange={handleChange}
                        required
                    />
                </div>
                <div className="form-group">
                    <label>Description</label>
                    <textarea
                        name="description"
                        value={formData.description}
                        onChange={handleChange}
                        required
                    />
                </div>
                <div className="form-row">
                    <div className="form-group">
                        <label>Price</label>
                        <input
                            type="number"
                            name="price"
                            value={formData.price}
                            onChange={handleChange}
                            step="0.01"
                            min="0"
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>Category</label>
                        <select
                            name="category"
                            value={formData.category}
                            onChange={handleChange}
                            required
                        >
                            <option value="">Select category</option>
                            <option value="Electronics">Electronics</option>
                            <option value="Accessories">Accessories</option>
                        </select>
                    </div>
                </div>
                <div className="form-group">
                    <label>Image URL</label>
                    <input
                        type="url"
                        name="image"
                        value={formData.image}
                        onChange={handleChange}
                    />
                </div>
                <div className="form-row">
                    <div className="form-group">
                        <label>Stock</label>
                        <input
                            type="number"
                            name="stock"
                            value={formData.stock}
                            onChange={handleChange}
                            min="0"
                        />
                    </div>
                    <div className="form-group">
                        <label>
                            <input
                                type="checkbox"
                                name="inStock"
                                checked={formData.inStock}
                                onChange={handleChange}
                            />
                            In Stock
                        </label>
                    </div>
                </div>
                <div className="form-actions">
                    <button type="submit" disabled={loading} className="btn btn-primary">
                        {loading ? ''Creating...'' : ''Create Product''}
                    </button>
                    <button
                        type="button"
                        onClick={() => navigate(''/products'')}
                        className="btn btn-secondary"
                    >
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    );
}

export default CreateProduct;
```

### App Component with Routes

```javascript
// src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import { AuthProvider } from ''./context/AuthContext'';
import ProtectedRoute from ''./components/ProtectedRoute'';
import Navigation from ''./components/Navigation'';
import Home from ''./pages/Home'';
import Login from ''./pages/Login'';
import Register from ''./pages/Register'';
import Products from ''./pages/Products'';
import ProductDetail from ''./pages/ProductDetail'';
import CreateProduct from ''./pages/CreateProduct'';
import EditProduct from ''./pages/EditProduct'';
import ''./App.css'';

function App() {
    return (
        <AuthProvider>
            <BrowserRouter>
                <Navigation />
                <Routes>
                    <Route path="/" element={<Home />} />
                    <Route path="/login" element={<Login />} />
                    <Route path="/register" element={<Register />} />
                    <Route path="/products" element={<Products />} />
                    <Route path="/products/:id" element={<ProductDetail />} />
                    <Route
                        path="/products/new"
                        element={
                            <ProtectedRoute>
                                <CreateProduct />
                            </ProtectedRoute>
                        }
                    />
                    <Route
                        path="/products/:id/edit"
                        element={
                            <ProtectedRoute>
                                <EditProduct />
                            </ProtectedRoute>
                        }
                    />
                </Routes>
            </BrowserRouter>
        </AuthProvider>
    );
}

export default App;
```

### Navigation Component

```javascript
// src/components/Navigation.jsx
import { Link } from ''react-router-dom'';
import { useAuth } from ''../context/AuthContext'';
import ''./Navigation.css'';

function Navigation() {
    const { isAuthenticated, user, logout } = useAuth();
    
    return (
        <nav className="navigation">
            <div className="nav-container">
                <Link to="/" className="nav-logo">
                    E-Commerce
                </Link>
                <div className="nav-links">
                    <Link to="/" className="nav-link">Home</Link>
                    <Link to="/products" className="nav-link">Products</Link>
                    {isAuthenticated ? (
                        <>
                            <span className="nav-user">Welcome, {user?.name}</span>
                            <button onClick={logout} className="btn btn-logout">
                                Logout
                            </button>
                        </>
                    ) : (
                        <>
                            <Link to="/login" className="nav-link">Login</Link>
                            <Link to="/register" className="nav-link">Register</Link>
                        </>
                    )}
                </div>
            </div>
        </nav>
    );
}

export default Navigation;
```

---

## Features Implementation

### Frontend-Backend Connection

- **API Service**: Centralized API calls
- **Axios Interceptors**: Automatic token handling
- **Error Handling**: Proper error responses
- **Loading States**: User feedback

### Authentication Flow

- **Register**: Create account, get token
- **Login**: Authenticate, get token
- **Token Storage**: Save in localStorage
- **Protected Routes**: Require authentication
- **Auto-logout**: On token expiration

### State Management

- **Auth Context**: Global auth state
- **API State**: Component-level state
- **Synchronization**: Keep frontend/backend in sync

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Register new user
- [ ] Login with credentials
- [ ] View products
- [ ] Create product (authenticated)
- [ ] Edit product (authenticated)
- [ ] Delete product (authenticated)
- [ ] Logout
- [ ] Access protected routes
- [ ] Test error handling

---

## Exercise: Full-Stack App

**Instructions**:

1. Set up both frontend and backend
2. Connect them together
3. Test all features
4. Deploy application
5. Add enhancements

**Enhancement Ideas**:

- Add order management
- Add shopping cart
- Add user profile page
- Add product reviews
- Add image upload
- Add email notifications
- Add admin dashboard
- Add analytics

---

## Deployment

### Backend Deployment

```bash
# Deploy to Heroku, Railway, or similar
# Set environment variables
# Update CORS settings
```

### Frontend Deployment

```bash
# Build for production
npm run build

# Deploy to Vercel, Netlify, or similar
# Set REACT_APP_API_URL environment variable
```

---

## Common Issues and Solutions

### Issue: CORS errors

**Solution**: Configure CORS in backend to allow frontend origin.

### Issue: Token not sent

**Solution**: Check axios interceptors and localStorage.

### Issue: API calls failing

**Solution**: Verify API URL and backend is running.

---

## Quiz: Full-Stack Concepts

1. **Full-stack app:**
   - A) Frontend + Backend
   - B) Frontend only
   - C) Both
   - D) Neither

2. **Axios:**
   - A) HTTP client
   - B) Database
   - C) Both
   - D) Neither

3. **Context API:**
   - A) Manages global state
   - B) Doesn''t manage state
   - C) Both
   - D) Neither

4. **Protected routes:**
   - A) Require authentication
   - B) Don''t require authentication
   - C) Both
   - D) Neither

5. **CORS:**
   - A) Cross-origin resource sharing
   - B) Same-origin only
   - C) Both
   - D) Neither

**Answers**:
1. A) Frontend + Backend
2. A) HTTP client
3. A) Manages global state
4. A) Require authentication
5. A) Cross-origin resource sharing

---

## Key Takeaways

1. **Full-Stack**: Combine frontend and backend
2. **API Integration**: Connect React to Express
3. **Authentication**: Manage auth across stack
4. **State Management**: Sync frontend/backend
5. **Best Practice**: Clean architecture, security

---

## Next Steps

Congratulations! You''ve built a Full-Stack Application. You now know:
- How to connect frontend and backend
- How to implement authentication
- How to manage state
- How to build complete applications

**What''s Next?**
- Project 4: Advanced Projects
- Learn WebSockets
- Build real-time applications
- Create advanced features

---

*Project completed! You''ve finished Project 3: Full-Stack Applications. Ready for Project 4: Advanced Projects!*

', NULL, 2, '2026-01-03 10:37:38', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Connect React frontend to Node.js backend
- Implement authentication flow
- Manage API calls from frontend
- Handle authentication state
- Build complete full-stack applications
- Deploy full-stack applications
- Handle CORS and security');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (202, 74, 18, 'Real-Time Chat Application', 'realtime-chat-application', '# Project 4.1: Real-Time Chat Application

## Project Overview

Build a real-time chat application using WebSockets and Socket.io. This project will help you practice real-time communication, WebSocket connections, user management, and building interactive applications.

## Learning Objectives

By the end of this project, you will be able to:
- Understand WebSockets and real-time communication
- Use Socket.io for bidirectional communication
- Manage user connections and disconnections
- Handle real-time messaging
- Build interactive chat interfaces
- Manage chat rooms and channels
- Handle user presence

---

## Project Requirements

### Core Features

1. **Real-Time Messaging**: Send and receive messages instantly
2. **User Management**: Join/leave, user list
3. **Chat Rooms**: Multiple chat rooms
4. **Typing Indicators**: Show when users are typing
5. **User Presence**: Show online/offline status
6. **Message History**: Store and display message history
7. **Notifications**: Notify users of new messages
8. **Responsive Design**: Works on all devices

### Technical Requirements

- Node.js backend with Socket.io
- React frontend with Socket.io client
- Real-time WebSocket connections
- User session management
- Message storage (optional database)
- Clean UI/UX

---

## Project Setup

### Backend Setup

```bash
# Create backend directory
mkdir chat-backend
cd chat-backend

# Initialize npm
npm init -y

# Install dependencies
npm install express socket.io cors dotenv
npm install --save-dev nodemon

# Create project structure
mkdir src
```

### Frontend Setup

```bash
# Create React app
npx create-react-app chat-frontend
cd chat-frontend

# Install Socket.io client
npm install socket.io-client

# Start development server
npm start
```

---

## Project Structure

```
chat-application/
├── backend/
│   ├── src/
│   │   ├── server.js
│   │   └── socketHandlers.js
│   ├── .env
│   └── package.json
└── frontend/
    ├── src/
    │   ├── components/
    │   │   ├── ChatRoom.jsx
    │   │   ├── MessageList.jsx
    │   │   ├── MessageInput.jsx
    │   │   ├── UserList.jsx
    │   │   └── Login.jsx
    │   ├── hooks/
    │   │   └── useSocket.js
    │   ├── App.jsx
    │   └── index.js
    └── package.json
```

---

## Step-by-Step Implementation

### Backend: Server Setup

```javascript
// backend/src/server.js
const express = require(''express'');
const http = require(''http'');
const { Server } = require(''socket.io'');
const cors = require(''cors'');
require(''dotenv'').config();

const app = express();
const server = http.createServer(app);

// Configure CORS for Socket.io
const io = new Server(server, {
    cors: {
        origin: process.env.CLIENT_URL || ''http://localhost:3000'',
        methods: [''GET'', ''POST'']
    }
});

app.use(cors());
app.use(express.json());

// Store connected users
const users = new Map();
const messages = [];

// Socket.io connection handling
io.on(''connection'', (socket) => {
    console.log(''User connected:'', socket.id);
    
    // User joins
    socket.on(''user:join'', (userData) => {
        users.set(socket.id, {
            id: socket.id,
            username: userData.username,
            room: userData.room || ''general''
        });
        
        // Join room
        socket.join(userData.room || ''general'');
        
        // Notify others
        socket.to(userData.room || ''general'').emit(''user:joined'', {
            username: userData.username,
            message: `${userData.username} joined the chat`
        });
        
        // Send current users
        const roomUsers = Array.from(users.values())
            .filter(user => user.room === (userData.room || ''general''));
        io.to(userData.room || ''general'').emit(''users:list'', roomUsers);
        
        // Send message history
        const roomMessages = messages.filter(
            msg => msg.room === (userData.room || ''general'')
        );
        socket.emit(''messages:history'', roomMessages);
    });
    
    // Send message
    socket.on(''message:send'', (messageData) => {
        const user = users.get(socket.id);
        if (user) {
            const message = {
                id: Date.now(),
                username: user.username,
                text: messageData.text,
                room: user.room,
                timestamp: new Date().toISOString()
            };
            
            messages.push(message);
            
            // Send to room
            io.to(user.room).emit(''message:receive'', message);
        }
    });
    
    // Typing indicator
    socket.on(''typing:start'', () => {
        const user = users.get(socket.id);
        if (user) {
            socket.to(user.room).emit(''typing:start'', {
                username: user.username
            });
        }
    });
    
    socket.on(''typing:stop'', () => {
        const user = users.get(socket.id);
        if (user) {
            socket.to(user.room).emit(''typing:stop'', {
                username: user.username
            });
        }
    });
    
    // User disconnects
    socket.on(''disconnect'', () => {
        const user = users.get(socket.id);
        if (user) {
            users.delete(socket.id);
            
            // Notify others
            socket.to(user.room).emit(''user:left'', {
                username: user.username,
                message: `${user.username} left the chat`
            });
            
            // Update user list
            const roomUsers = Array.from(users.values())
                .filter(u => u.room === user.room);
            io.to(user.room).emit(''users:list'', roomUsers);
        }
        console.log(''User disconnected:'', socket.id);
    });
});

const PORT = process.env.PORT || 5000;
server.listen(PORT, () => {
    console.log(`Server running on port ${PORT}`);
});
```

### Frontend: Socket Hook

```javascript
// frontend/src/hooks/useSocket.js
import { useEffect, useState } from ''react'';
import io from ''socket.io-client'';

const SOCKET_URL = process.env.REACT_APP_SOCKET_URL || ''http://localhost:5000'';

export function useSocket() {
    const [socket, setSocket] = useState(null);
    const [connected, setConnected] = useState(false);
    
    useEffect(() => {
        const newSocket = io(SOCKET_URL);
        
        newSocket.on(''connect'', () => {
            setConnected(true);
        });
        
        newSocket.on(''disconnect'', () => {
            setConnected(false);
        });
        
        setSocket(newSocket);
        
        return () => {
            newSocket.close();
        };
    }, []);
    
    return { socket, connected };
}
```

### Frontend: Login Component

```javascript
// frontend/src/components/Login.jsx
import { useState } from ''react'';
import ''./Login.css'';

function Login({ onLogin }) {
    const [username, setUsername] = useState('''');
    const [room, setRoom] = useState(''general'');
    
    const handleSubmit = (e) => {
        e.preventDefault();
        if (username.trim()) {
            onLogin(username.trim(), room);
        }
    };
    
    return (
        <div className="login-container">
            <div className="login-box">
                <h1>Join Chat</h1>
                <form onSubmit={handleSubmit}>
                    <div className="form-group">
                        <label>Username</label>
                        <input
                            type="text"
                            value={username}
                            onChange={(e) => setUsername(e.target.value)}
                            placeholder="Enter your username"
                            required
                        />
                    </div>
                    <div className="form-group">
                        <label>Room</label>
                        <select
                            value={room}
                            onChange={(e) => setRoom(e.target.value)}
                        >
                            <option value="general">General</option>
                            <option value="random">Random</option>
                            <option value="tech">Tech</option>
                            <option value="gaming">Gaming</option>
                        </select>
                    </div>
                    <button type="submit" className="btn btn-primary">
                        Join Chat
                    </button>
                </form>
            </div>
        </div>
    );
}

export default Login;
```

### Frontend: Message List Component

```javascript
// frontend/src/components/MessageList.jsx
import { useEffect, useRef } from ''react'';
import ''./MessageList.css'';

function MessageList({ messages, currentUser }) {
    const messagesEndRef = useRef(null);
    
    const scrollToBottom = () => {
        messagesEndRef.current?.scrollIntoView({ behavior: ''smooth'' });
    };
    
    useEffect(() => {
        scrollToBottom();
    }, [messages]);
    
    return (
        <div className="message-list">
            {messages.map(message => (
                <div
                    key={message.id}
                    className={`message ${message.username === currentUser ? ''own'' : ''''}`}
                >
                    <div className="message-header">
                        <span className="message-username">{message.username}</span>
                        <span className="message-time">
                            {new Date(message.timestamp).toLocaleTimeString()}
                        </span>
                    </div>
                    <div className="message-text">{message.text}</div>
                </div>
            ))}
            <div ref={messagesEndRef} />
        </div>
    );
}

export default MessageList;
```

### Frontend: Message Input Component

```javascript
// frontend/src/components/MessageInput.jsx
import { useState, useEffect, useRef } from ''react'';
import ''./MessageInput.css'';

function MessageInput({ socket, currentUser, room }) {
    const [message, setMessage] = useState('''');
    const [isTyping, setIsTyping] = useState(false);
    const typingTimeoutRef = useRef(null);
    
    useEffect(() => {
        return () => {
            if (typingTimeoutRef.current) {
                clearTimeout(typingTimeoutRef.current);
            }
        };
    }, []);
    
    const handleChange = (e) => {
        setMessage(e.target.value);
        
        if (!isTyping) {
            setIsTyping(true);
            socket.emit(''typing:start'');
        }
        
        clearTimeout(typingTimeoutRef.current);
        typingTimeoutRef.current = setTimeout(() => {
            setIsTyping(false);
            socket.emit(''typing:stop'');
        }, 1000);
    };
    
    const handleSubmit = (e) => {
        e.preventDefault();
        if (message.trim()) {
            socket.emit(''message:send'', { text: message.trim() });
            setMessage('''');
            setIsTyping(false);
            socket.emit(''typing:stop'');
        }
    };
    
    return (
        <form className="message-input" onSubmit={handleSubmit}>
            <input
                type="text"
                value={message}
                onChange={handleChange}
                placeholder="Type a message..."
                className="message-input-field"
            />
            <button type="submit" className="btn btn-send">
                Send
            </button>
        </form>
    );
}

export default MessageInput;
```

### Frontend: User List Component

```javascript
// frontend/src/components/UserList.jsx
import ''./UserList.css'';

function UserList({ users, currentUser }) {
    return (
        <div className="user-list">
            <h3>Online Users ({users.length})</h3>
            <ul>
                {users.map(user => (
                    <li key={user.id} className={user.username === currentUser ? ''current'' : ''''}>
                        <span className="user-indicator"></span>
                        {user.username}
                        {user.username === currentUser && '' (You)''}
                    </li>
                ))}
            </ul>
        </div>
    );
}

export default UserList;
```

### Frontend: Chat Room Component

```javascript
// frontend/src/components/ChatRoom.jsx
import { useState, useEffect } from ''react'';
import { useSocket } from ''../hooks/useSocket'';
import MessageList from ''./MessageList'';
import MessageInput from ''./MessageInput'';
import UserList from ''./UserList'';
import ''./ChatRoom.css'';

function ChatRoom({ username, room, onLeave }) {
    const { socket, connected } = useSocket();
    const [messages, setMessages] = useState([]);
    const [users, setUsers] = useState([]);
    const [typingUsers, setTypingUsers] = useState([]);
    const [systemMessage, setSystemMessage] = useState('''');
    
    useEffect(() => {
        if (socket && username) {
            // Join room
            socket.emit(''user:join'', { username, room });
            
            // Listen for messages
            socket.on(''message:receive'', (message) => {
                setMessages(prev => [...prev, message]);
            });
            
            // Listen for message history
            socket.on(''messages:history'', (history) => {
                setMessages(history);
            });
            
            // Listen for user list
            socket.on(''users:list'', (userList) => {
                setUsers(userList);
            });
            
            // Listen for user joined
            socket.on(''user:joined'', (data) => {
                setSystemMessage(`${data.username} joined the chat`);
                setTimeout(() => setSystemMessage(''''), 3000);
            });
            
            // Listen for user left
            socket.on(''user:left'', (data) => {
                setSystemMessage(`${data.username} left the chat`);
                setTimeout(() => setSystemMessage(''''), 3000);
            });
            
            // Listen for typing
            socket.on(''typing:start'', (data) => {
                setTypingUsers(prev => {
                    if (!prev.includes(data.username)) {
                        return [...prev, data.username];
                    }
                    return prev;
                });
            });
            
            socket.on(''typing:stop'', (data) => {
                setTypingUsers(prev => prev.filter(u => u !== data.username));
            });
            
            return () => {
                socket.off(''message:receive'');
                socket.off(''messages:history'');
                socket.off(''users:list'');
                socket.off(''user:joined'');
                socket.off(''user:left'');
                socket.off(''typing:start'');
                socket.off(''typing:stop'');
            };
        }
    }, [socket, username, room]);
    
    return (
        <div className="chat-room">
            <div className="chat-header">
                <div>
                    <h2>Room: {room}</h2>
                    <span className={`connection-status ${connected ? ''connected'' : ''disconnected''}`}>
                        {connected ? ''● Connected'' : ''○ Disconnected''}
                    </span>
                </div>
                <button onClick={onLeave} className="btn btn-leave">
                    Leave Room
                </button>
            </div>
            
            <div className="chat-content">
                <div className="chat-messages">
                    <MessageList messages={messages} currentUser={username} />
                    {systemMessage && (
                        <div className="system-message">{systemMessage}</div>
                    )}
                    {typingUsers.length > 0 && (
                        <div className="typing-indicator">
                            {typingUsers.join('', '')} {typingUsers.length === 1 ? ''is'' : ''are''} typing...
                        </div>
                    )}
                    <MessageInput socket={socket} currentUser={username} room={room} />
                </div>
                
                <UserList users={users} currentUser={username} />
            </div>
        </div>
    );
}

export default ChatRoom;
```

### Frontend: App Component

```javascript
// frontend/src/App.jsx
import { useState } from ''react'';
import Login from ''./components/Login'';
import ChatRoom from ''./components/ChatRoom'';
import ''./App.css'';

function App() {
    const [username, setUsername] = useState(null);
    const [room, setRoom] = useState(null);
    
    const handleLogin = (user, selectedRoom) => {
        setUsername(user);
        setRoom(selectedRoom);
    };
    
    const handleLeave = () => {
        setUsername(null);
        setRoom(null);
    };
    
    return (
        <div className="app">
            {!username ? (
                <Login onLogin={handleLogin} />
            ) : (
                <ChatRoom username={username} room={room} onLeave={handleLeave} />
            )}
        </div>
    );
}

export default App;
```

---

## Features Implementation

### WebSockets

- **Real-Time Connection**: Bidirectional communication
- **Event-Based**: Emit and listen to events
- **Room Management**: Join/leave rooms
- **Connection Status**: Track connection state

### Real-Time Communication

- **Instant Messaging**: Messages sent/received instantly
- **Typing Indicators**: Show when users are typing
- **User Presence**: Show online users
- **System Messages**: Notify of user joins/leaves

### User Management

- **User List**: Display connected users
- **User Identification**: Track users by socket ID
- **Room Assignment**: Users belong to rooms
- **Disconnect Handling**: Clean up on disconnect

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Connect to chat
- [ ] Send messages
- [ ] Receive messages
- [ ] See user list
- [ ] See typing indicators
- [ ] Join different rooms
- [ ] See system messages
- [ ] Handle disconnection
- [ ] Multiple users
- [ ] Message history

---

## Exercise: Chat App

**Instructions**:

1. Set up backend and frontend
2. Implement all features
3. Test with multiple users
4. Add enhancements
5. Deploy application

**Enhancement Ideas**:

- Add private messaging
- Add file sharing
- Add emoji support
- Add message reactions
- Add user avatars
- Add message search
- Add message editing/deleting
- Add voice/video chat

---

## Common Issues and Solutions

### Issue: Connection fails

**Solution**: Check CORS configuration and Socket.io URL.

### Issue: Messages not appearing

**Solution**: Verify event names match on emit and on.

### Issue: Users not updating

**Solution**: Ensure user list is updated on join/leave events.

---

## Quiz: WebSockets

1. **WebSockets:**
   - A) Real-time communication
   - B) Request-response only
   - C) Both
   - D) Neither

2. **Socket.io:**
   - A) WebSocket library
   - B) HTTP library
   - C) Both
   - D) Neither

3. **Real-time:**
   - A) Instant updates
   - B) Delayed updates
   - C) Both
   - D) Neither

4. **Rooms:**
   - A) Group users
   - B) Don''t group users
   - C) Both
   - D) Neither

5. **Typing indicators:**
   - A) Show user activity
   - B) Don''t show activity
   - C) Both
   - D) Neither

**Answers**:
1. A) Real-time communication
2. A) WebSocket library
3. A) Instant updates
4. A) Group users
5. A) Show user activity

---

## Key Takeaways

1. **WebSockets**: Real-time bidirectional communication
2. **Socket.io**: Easy WebSocket implementation
3. **Real-Time**: Instant updates without polling
4. **User Management**: Track connected users
5. **Best Practice**: Handle connections and disconnections

---

## Next Steps

Congratulations! You''ve built a Real-Time Chat Application. You now know:
- How to use WebSockets
- How to implement Socket.io
- How to handle real-time communication
- How to manage users

**What''s Next?**
- Project 4.2: Social Media Clone
- Learn complex state management
- Build social features
- Handle image uploads

---

*Project completed! You''re ready to move on to the next project.*

', NULL, 1, '2026-01-03 10:39:34', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Understand WebSockets and real-time communication
- Use Socket.io for bidirectional communication
- Manage user connections and disconnections
- Handle real-time messaging
- Build interactive chat interfaces
- Manage chat rooms and channels
- Handle user presence');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (203, 74, 18, 'Social Media Clone', 'social-media-clone', '# Project 4.2: Social Media Clone

## Project Overview

Build a Social Media Clone application with complex state management, image uploads, and user interactions. This project will help you practice advanced React concepts, file handling, and building complex user interfaces.

## Learning Objectives

By the end of this project, you will be able to:
- Manage complex application state
- Handle image uploads
- Implement user interactions (like, comment, share)
- Build feed systems
- Create user profiles
- Handle real-time updates
- Optimize performance

---

## Project Requirements

### Core Features

1. **User Profiles**: View and edit profiles
2. **Posts**: Create, view, edit, delete posts
3. **Feed**: Display posts in chronological order
4. **Image Upload**: Upload and display images
5. **Interactions**: Like, comment on posts
6. **Follow System**: Follow/unfollow users
7. **Notifications**: Show user notifications
8. **Search**: Search users and posts

### Technical Requirements

- React with Context API or Redux
- Image upload handling
- Complex state management
- API integration
- Responsive design
- Performance optimization

---

## Project Setup

```bash
# Create React app
npx create-react-app social-media-app
cd social-media-app

# Install dependencies
npm install axios react-router-dom
npm install react-dropzone  # For image uploads
npm install date-fns  # For date formatting

# Start development server
npm start
```

---

## Project Structure

```
social-media-app/
├── src/
│   ├── components/
│   │   ├── Layout.jsx
│   │   ├── Navigation.jsx
│   │   ├── PostCard.jsx
│   │   ├── PostForm.jsx
│   │   ├── CommentSection.jsx
│   │   ├── UserProfile.jsx
│   │   ├── Feed.jsx
│   │   └── ImageUpload.jsx
│   ├── context/
│   │   ├── AuthContext.jsx
│   │   └── PostContext.jsx
│   ├── pages/
│   │   ├── Home.jsx
│   │   ├── Profile.jsx
│   │   └── Explore.jsx
│   ├── services/
│   │   └── api.js
│   ├── utils/
│   │   └── imageUtils.js
│   ├── App.jsx
│   └── index.js
└── package.json
```

---

## Step-by-Step Implementation

### Image Upload Component

```javascript
// src/components/ImageUpload.jsx
import { useState, useCallback } from ''react'';
import { useDropzone } from ''react-dropzone'';
import ''./ImageUpload.css'';

function ImageUpload({ onImageSelect, maxSize = 5 * 1024 * 1024 }) {
    const [preview, setPreview] = useState(null);
    const [error, setError] = useState('''');
    
    const onDrop = useCallback((acceptedFiles, rejectedFiles) => {
        setError('''');
        
        if (rejectedFiles.length > 0) {
            setError(''File is too large or invalid format'');
            return;
        }
        
        const file = acceptedFiles[0];
        if (file.size > maxSize) {
            setError(''File size exceeds 5MB'');
            return;
        }
        
        // Create preview
        const reader = new FileReader();
        reader.onload = () => {
            setPreview(reader.result);
            onImageSelect(file);
        };
        reader.readAsDataURL(file);
    }, [onImageSelect, maxSize]);
    
    const { getRootProps, getInputProps, isDragActive } = useDropzone({
        onDrop,
        accept: {
            ''image/*'': [''.jpeg'', ''.jpg'', ''.png'', ''.gif'']
        },
        maxFiles: 1,
        maxSize: maxSize
    });
    
    const handleRemove = () => {
        setPreview(null);
        onImageSelect(null);
    };
    
    return (
        <div className="image-upload">
            {preview ? (
                <div className="image-preview">
                    <img src={preview} alt="Preview" />
                    <button onClick={handleRemove} className="btn-remove">
                        Remove
                    </button>
                </div>
            ) : (
                <div
                    {...getRootProps()}
                    className={`dropzone ${isDragActive ? ''active'' : ''''}`}
                >
                    <input {...getInputProps()} />
                    <p>Drag & drop an image, or click to select</p>
                    <p className="dropzone-hint">Max size: 5MB</p>
                </div>
            )}
            {error && <div className="error-message">{error}</div>}
        </div>
    );
}

export default ImageUpload;
```

### Post Context

```javascript
// src/context/PostContext.jsx
import { createContext, useContext, useReducer, useEffect } from ''react'';
import { postsAPI } from ''../services/api'';

const PostContext = createContext();

const postReducer = (state, action) => {
    switch (action.type) {
        case ''SET_LOADING'':
            return { ...state, loading: action.payload };
        case ''SET_POSTS'':
            return { ...state, posts: action.payload, loading: false };
        case ''ADD_POST'':
            return { ...state, posts: [action.payload, ...state.posts] };
        case ''UPDATE_POST'':
            return {
                ...state,
                posts: state.posts.map(post =>
                    post.id === action.payload.id ? action.payload : post
                )
            };
        case ''DELETE_POST'':
            return {
                ...state,
                posts: state.posts.filter(post => post.id !== action.payload)
            };
        case ''LIKE_POST'':
            return {
                ...state,
                posts: state.posts.map(post =>
                    post.id === action.payload.id
                        ? {
                              ...post,
                              likes: action.payload.liked
                                  ? [...post.likes, action.payload.userId]
                                  : post.likes.filter(id => id !== action.payload.userId)
                          }
                        : post
                )
            };
        case ''ADD_COMMENT'':
            return {
                ...state,
                posts: state.posts.map(post =>
                    post.id === action.payload.postId
                        ? {
                              ...post,
                              comments: [...post.comments, action.payload.comment]
                          }
                        : post
                )
            };
        default:
            return state;
    }
};

const initialState = {
    posts: [],
    loading: true,
    error: null
};

export function PostProvider({ children }) {
    const [state, dispatch] = useReducer(postReducer, initialState);
    
    useEffect(() => {
        loadPosts();
    }, []);
    
    const loadPosts = async () => {
        try {
            dispatch({ type: ''SET_LOADING'', payload: true });
            const response = await postsAPI.getPosts();
            dispatch({ type: ''SET_POSTS'', payload: response.data });
        } catch (error) {
            dispatch({ type: ''SET_ERROR'', payload: error.message });
        }
    };
    
    const createPost = async (postData) => {
        try {
            const response = await postsAPI.createPost(postData);
            dispatch({ type: ''ADD_POST'', payload: response.data });
            return { success: true };
        } catch (error) {
            return { success: false, error: error.message };
        }
    };
    
    const updatePost = async (id, postData) => {
        try {
            const response = await postsAPI.updatePost(id, postData);
            dispatch({ type: ''UPDATE_POST'', payload: response.data });
            return { success: true };
        } catch (error) {
            return { success: false, error: error.message };
        }
    };
    
    const deletePost = async (id) => {
        try {
            await postsAPI.deletePost(id);
            dispatch({ type: ''DELETE_POST'', payload: id });
            return { success: true };
        } catch (error) {
            return { success: false, error: error.message };
        }
    };
    
    const likePost = async (postId, userId) => {
        try {
            const post = state.posts.find(p => p.id === postId);
            const isLiked = post.likes.includes(userId);
            
            await postsAPI.likePost(postId, !isLiked);
            dispatch({
                type: ''LIKE_POST'',
                payload: { id: postId, userId, liked: !isLiked }
            });
        } catch (error) {
            console.error(''Failed to like post:'', error);
        }
    };
    
    const addComment = async (postId, commentText, userId) => {
        try {
            const comment = {
                id: Date.now(),
                userId,
                text: commentText,
                createdAt: new Date().toISOString()
            };
            
            await postsAPI.addComment(postId, comment);
            dispatch({
                type: ''ADD_COMMENT'',
                payload: { postId, comment }
            });
        } catch (error) {
            console.error(''Failed to add comment:'', error);
        }
    };
    
    return (
        <PostContext.Provider
            value={{
                ...state,
                loadPosts,
                createPost,
                updatePost,
                deletePost,
                likePost,
                addComment
            }}
        >
            {children}
        </PostContext.Provider>
    );
}

export function usePosts() {
    const context = useContext(PostContext);
    if (!context) {
        throw new Error(''usePosts must be used within PostProvider'');
    }
    return context;
}
```

### Post Form Component

```javascript
// src/components/PostForm.jsx
import { useState } from ''react'';
import { usePosts } from ''../context/PostContext'';
import { useAuth } from ''../context/AuthContext'';
import ImageUpload from ''./ImageUpload'';
import ''./PostForm.css'';

function PostForm({ onClose }) {
    const { createPost } = usePosts();
    const { user } = useAuth();
    const [text, setText] = useState('''');
    const [image, setImage] = useState(null);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState('''');
    
    const handleSubmit = async (e) => {
        e.preventDefault();
        
        if (!text.trim() && !image) {
            setError(''Please add text or an image'');
            return;
        }
        
        setLoading(true);
        setError('''');
        
        try {
            // Upload image if present
            let imageUrl = null;
            if (image) {
                const formData = new FormData();
                formData.append(''image'', image);
                // Upload image to server
                // imageUrl = await uploadImage(formData);
            }
            
            const result = await createPost({
                text: text.trim(),
                image: imageUrl,
                userId: user.id
            });
            
            if (result.success) {
                setText('''');
                setImage(null);
                if (onClose) onClose();
            } else {
                setError(result.error);
            }
        } catch (error) {
            setError(''Failed to create post'');
        } finally {
            setLoading(false);
        }
    };
    
    return (
        <div className="post-form-container">
            <form className="post-form" onSubmit={handleSubmit}>
                <div className="post-form-header">
                    <h2>Create Post</h2>
                    {onClose && (
                        <button type="button" onClick={onClose} className="btn-close">
                            ×
                        </button>
                    )}
                </div>
                
                <div className="post-form-content">
                    <textarea
                        value={text}
                        onChange={(e) => setText(e.target.value)}
                        placeholder="What''s on your mind?"
                        className="post-textarea"
                        rows="4"
                    />
                    
                    <ImageUpload onImageSelect={setImage} />
                    
                    {error && <div className="error-message">{error}</div>}
                </div>
                
                <div className="post-form-actions">
                    <button
                        type="submit"
                        disabled={loading}
                        className="btn btn-primary"
                    >
                        {loading ? ''Posting...'' : ''Post''}
                    </button>
                </div>
            </form>
        </div>
    );
}

export default PostForm;
```

### Post Card Component

```javascript
// src/components/PostCard.jsx
import { useState } from ''react'';
import { formatDistanceToNow } from ''date-fns'';
import { usePosts } from ''../context/PostContext'';
import { useAuth } from ''../context/AuthContext'';
import CommentSection from ''./CommentSection'';
import ''./PostCard.css'';

function PostCard({ post }) {
    const { likePost, deletePost } = usePosts();
    const { user } = useAuth();
    const [showComments, setShowComments] = useState(false);
    
    const isLiked = post.likes?.includes(user?.id) || false;
    const isOwner = post.userId === user?.id;
    
    const handleLike = () => {
        if (user) {
            likePost(post.id, user.id);
        }
    };
    
    const handleDelete = async () => {
        if (window.confirm(''Are you sure you want to delete this post?'')) {
            await deletePost(post.id);
        }
    };
    
    return (
        <div className="post-card">
            <div className="post-header">
                <div className="post-author">
                    <img
                        src={post.author?.avatar || ''https://via.placeholder.com/40''}
                        alt={post.author?.name}
                        className="author-avatar"
                    />
                    <div>
                        <h4>{post.author?.name || ''Unknown User''}</h4>
                        <span className="post-time">
                            {formatDistanceToNow(new Date(post.createdAt), { addSuffix: true })}
                        </span>
                    </div>
                </div>
                {isOwner && (
                    <button onClick={handleDelete} className="btn-delete">
                        Delete
                    </button>
                )}
            </div>
            
            {post.text && (
                <div className="post-content">
                    <p>{post.text}</p>
                </div>
            )}
            
            {post.image && (
                <div className="post-image">
                    <img src={post.image} alt="Post" />
                </div>
            )}
            
            <div className="post-actions">
                <button
                    onClick={handleLike}
                    className={`btn-action ${isLiked ? ''liked'' : ''''}`}
                >
                    <span>❤️</span>
                    <span>{post.likes?.length || 0}</span>
                </button>
                <button
                    onClick={() => setShowComments(!showComments)}
                    className="btn-action"
                >
                    <span>💬</span>
                    <span>{post.comments?.length || 0}</span>
                </button>
                <button className="btn-action">
                    <span>🔗</span>
                    <span>Share</span>
                </button>
            </div>
            
            {showComments && (
                <CommentSection postId={post.id} comments={post.comments || []} />
            )}
        </div>
    );
}

export default PostCard;
```

### Comment Section Component

```javascript
// src/components/CommentSection.jsx
import { useState } from ''react'';
import { formatDistanceToNow } from ''date-fns'';
import { usePosts } from ''../context/PostContext'';
import { useAuth } from ''../context/AuthContext'';
import ''./CommentSection.css'';

function CommentSection({ postId, comments }) {
    const { addComment } = usePosts();
    const { user } = useAuth();
    const [commentText, setCommentText] = useState('''');
    const [loading, setLoading] = useState(false);
    
    const handleSubmit = async (e) => {
        e.preventDefault();
        if (!commentText.trim() || !user) return;
        
        setLoading(true);
        await addComment(postId, commentText.trim(), user.id);
        setCommentText('''');
        setLoading(false);
    };
    
    return (
        <div className="comment-section">
            <div className="comments-list">
                {comments.map(comment => (
                    <div key={comment.id} className="comment">
                        <img
                            src={comment.author?.avatar || ''https://via.placeholder.com/30''}
                            alt={comment.author?.name}
                            className="comment-avatar"
                        />
                        <div className="comment-content">
                            <div className="comment-header">
                                <strong>{comment.author?.name || ''Unknown''}</strong>
                                <span className="comment-time">
                                    {formatDistanceToNow(new Date(comment.createdAt), { addSuffix: true })}
                                </span>
                            </div>
                            <p>{comment.text}</p>
                        </div>
                    </div>
                ))}
            </div>
            
            {user && (
                <form className="comment-form" onSubmit={handleSubmit}>
                    <input
                        type="text"
                        value={commentText}
                        onChange={(e) => setCommentText(e.target.value)}
                        placeholder="Write a comment..."
                        className="comment-input"
                    />
                    <button
                        type="submit"
                        disabled={loading || !commentText.trim()}
                        className="btn-comment"
                    >
                        Post
                    </button>
                </form>
            )}
        </div>
    );
}

export default CommentSection;
```

### Feed Component

```javascript
// src/components/Feed.jsx
import { usePosts } from ''../context/PostContext'';
import PostCard from ''./PostCard'';
import Loading from ''./Loading'';
import ''./Feed.css'';

function Feed() {
    const { posts, loading } = usePosts();
    
    if (loading) {
        return <Loading />;
    }
    
    if (posts.length === 0) {
        return (
            <div className="empty-feed">
                <p>No posts yet. Be the first to post!</p>
            </div>
        );
    }
    
    return (
        <div className="feed">
            {posts.map(post => (
                <PostCard key={post.id} post={post} />
            ))}
        </div>
    );
}

export default Feed;
```

### App Component

```javascript
// src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import { AuthProvider } from ''./context/AuthContext'';
import { PostProvider } from ''./context/PostContext'';
import Layout from ''./components/Layout'';
import Home from ''./pages/Home'';
import Profile from ''./pages/Profile'';
import Explore from ''./pages/Explore'';
import ''./App.css'';

function App() {
    return (
        <AuthProvider>
            <PostProvider>
                <BrowserRouter>
                    <Routes>
                        <Route path="/" element={<Layout />}>
                            <Route index element={<Home />} />
                            <Route path="profile/:userId" element={<Profile />} />
                            <Route path="explore" element={<Explore />} />
                        </Route>
                    </Routes>
                </BrowserRouter>
            </PostProvider>
        </AuthProvider>
    );
}

export default App;
```

---

## Features Implementation

### Complex State Management

- **Context API**: Global state for posts and auth
- **useReducer**: Complex state logic
- **Optimistic Updates**: Immediate UI updates
- **State Synchronization**: Keep state in sync

### Image Uploads

- **File Handling**: Process image files
- **Preview**: Show image before upload
- **Validation**: Check file size and type
- **Upload**: Send to server

### User Interactions

- **Likes**: Toggle like status
- **Comments**: Add and display comments
- **Shares**: Share posts
- **Real-Time**: Update UI instantly

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Create post with text
- [ ] Create post with image
- [ ] Like/unlike posts
- [ ] Add comments
- [ ] Delete own posts
- [ ] View feed
- [ ] View profiles
- [ ] Search functionality
- [ ] Follow users
- [ ] Handle errors

---

## Exercise: Social Media App

**Instructions**:

1. Set up React project
2. Create all components
3. Implement state management
4. Add image upload
5. Test all features

**Enhancement Ideas**:

- Add stories feature
- Add direct messaging
- Add video posts
- Add hashtags
- Add mentions
- Add notifications
- Add analytics
- Add dark mode

---

## Common Issues and Solutions

### Issue: Images not uploading

**Solution**: Check file size limits and server configuration.

### Issue: State not updating

**Solution**: Ensure reducer returns new state objects.

### Issue: Performance issues

**Solution**: Use React.memo, useMemo, and useCallback.

---

## Quiz: Complex App

1. **Complex state:**
   - A) Requires careful management
   - B) Simple to manage
   - C) Both
   - D) Neither

2. **Image uploads:**
   - A) Need file handling
   - B) Don''t need handling
   - C) Both
   - D) Neither

3. **User interactions:**
   - A) Update state
   - B) Don''t update state
   - C) Both
   - D) Neither

4. **Performance:**
   - A) Important for complex apps
   - B) Not important
   - C) Both
   - D) Neither

5. **State management:**
   - A) Critical for complex apps
   - B) Not critical
   - C) Both
   - D) Neither

**Answers**:
1. A) Requires careful management
2. A) Need file handling
3. A) Update state
4. A) Important for complex apps
5. A) Critical for complex apps

---

## Key Takeaways

1. **Complex State**: Use Context API and useReducer
2. **Image Uploads**: Handle files properly
3. **User Interactions**: Real-time updates
4. **Performance**: Optimize with memoization
5. **Best Practice**: Clean architecture, proper state management

---

## Next Steps

Congratulations! You''ve built a Social Media Clone. You now know:
- How to manage complex state
- How to handle image uploads
- How to implement user interactions
- How to build complex applications

**What''s Next?**
- Final Projects: Capstone Projects
- Build complete applications
- Apply all learned concepts
- Create portfolio projects

---

*Project completed! You''ve finished Project 4: Advanced Projects. Ready for Final Projects!*

', NULL, 2, '2026-01-03 10:40:10', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Manage complex application state
- Handle image uploads
- Implement user interactions (like, comment, share)
- Build feed systems
- Create user profiles
- Handle real-time updates
- Optimize performance');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (204, 75, 18, 'Full-Stack Web Application', 'full-stack-web-application', '# Capstone Project 1: Full-Stack Web Application

## Project Overview

Build a complete, production-ready Full-Stack Web Application that demonstrates mastery of JavaScript, React, Node.js, databases, and deployment. This capstone project will showcase all the skills you''ve learned throughout the JavaScript curriculum.

## Learning Objectives

By the end of this project, you will be able to:
- Design and build a complete full-stack application
- Implement secure authentication and authorization
- Integrate databases effectively
- Design RESTful APIs
- Deploy applications to production
- Handle errors and edge cases
- Write clean, maintainable code
- Document your application

---

## Project Requirements

### Core Features

1. **User Authentication & Authorization**
   - User registration and login
   - JWT-based authentication
   - Protected routes
   - User profiles
   - Password reset (optional)

2. **Core Application Features**
   - CRUD operations for main entities
   - Data relationships
   - Search and filtering
   - Pagination
   - Sorting

3. **Database Integration**
   - MongoDB or MySQL/PostgreSQL
   - Proper schema design
   - Relationships and associations
   - Data validation

4. **API Design**
   - RESTful API endpoints
   - Proper HTTP methods
   - Status codes
   - Error handling
   - API documentation

5. **Frontend**
   - React application
   - State management
   - Routing
   - Responsive design
   - Error handling
   - Loading states

6. **Deployment**
   - Backend deployment
   - Frontend deployment
   - Environment configuration
   - Database setup

### Technical Requirements

- **Backend**: Node.js, Express.js
- **Frontend**: React
- **Database**: MongoDB (Mongoose) or MySQL/PostgreSQL (Sequelize)
- **Authentication**: JWT
- **Validation**: Input validation on both ends
- **Error Handling**: Comprehensive error handling
- **Security**: CORS, rate limiting, input sanitization
- **Documentation**: README with setup instructions

---

## Project Ideas

Choose one of these or create your own:

### Option 1: Task Management System
- Projects, tasks, subtasks
- Team collaboration
- Due dates and priorities
- File attachments
- Activity logs

### Option 2: E-Commerce Platform
- Product catalog
- Shopping cart
- Checkout process
- Order management
- Payment integration (Stripe)

### Option 3: Social Media Platform
- User profiles
- Posts and comments
- Likes and shares
- Follow system
- News feed

### Option 4: Learning Management System
- Courses and lessons
- Student enrollment
- Progress tracking
- Quizzes and assessments
- Certificates

### Option 5: Recipe Sharing Platform
- Recipe creation
- Categories and tags
- Ratings and reviews
- Search and filtering
- User collections

---

## Recommended Project: Task Management System

We''ll use a Task Management System as our example. You can adapt this to any of the options above.

---

## Project Structure

```
task-management-system/
├── backend/
│   ├── src/
│   │   ├── config/
│   │   │   └── database.js
│   │   ├── controllers/
│   │   │   ├── authController.js
│   │   │   ├── projectController.js
│   │   │   ├── taskController.js
│   │   │   └── userController.js
│   │   ├── models/
│   │   │   ├── User.js
│   │   │   ├── Project.js
│   │   │   └── Task.js
│   │   ├── routes/
│   │   │   ├── authRoutes.js
│   │   │   ├── projectRoutes.js
│   │   │   ├── taskRoutes.js
│   │   │   └── userRoutes.js
│   │   ├── middleware/
│   │   │   ├── auth.js
│   │   │   ├── errorHandler.js
│   │   │   └── validate.js
│   │   ├── utils/
│   │   │   └── generateToken.js
│   │   └── server.js
│   ├── .env
│   ├── .gitignore
│   └── package.json
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── Layout.jsx
│   │   │   ├── Navigation.jsx
│   │   │   ├── ProjectCard.jsx
│   │   │   ├── TaskCard.jsx
│   │   │   ├── ProjectForm.jsx
│   │   │   ├── TaskForm.jsx
│   │   │   └── Loading.jsx
│   │   ├── pages/
│   │   │   ├── Home.jsx
│   │   │   ├── Login.jsx
│   │   │   ├── Register.jsx
│   │   │   ├── Dashboard.jsx
│   │   │   ├── Projects.jsx
│   │   │   ├── ProjectDetail.jsx
│   │   │   └── Profile.jsx
│   │   ├── context/
│   │   │   ├── AuthContext.jsx
│   │   │   └── ProjectContext.jsx
│   │   ├── services/
│   │   │   └── api.js
│   │   ├── App.jsx
│   │   └── index.js
│   ├── .env
│   └── package.json
└── README.md
```

---

## Step-by-Step Implementation

### Phase 1: Backend Setup

#### 1. Initialize Backend

```bash
mkdir task-management-backend
cd task-management-backend
npm init -y
npm install express mongoose dotenv bcrypt jsonwebtoken express-validator cors helmet express-rate-limit
npm install --save-dev nodemon
```

#### 2. Database Models

```javascript
// backend/src/models/User.js
const mongoose = require(''mongoose'');
const bcrypt = require(''bcrypt'');

const userSchema = new mongoose.Schema({
    name: {
        type: String,
        required: [true, ''Please provide a name''],
        trim: true
    },
    email: {
        type: String,
        required: [true, ''Please provide an email''],
        unique: true,
        lowercase: true,
        trim: true,
        match: [/^\\S+@\\S+\\.\\S+$/, ''Please provide a valid email'']
    },
    password: {
        type: String,
        required: [true, ''Please provide a password''],
        minlength: [6, ''Password must be at least 6 characters''],
        select: false
    },
    avatar: {
        type: String,
        default: ''https://via.placeholder.com/150''
    },
    role: {
        type: String,
        enum: [''user'', ''admin''],
        default: ''user''
    }
}, {
    timestamps: true
});

userSchema.pre(''save'', async function(next) {
    if (!this.isModified(''password'')) return next();
    const salt = await bcrypt.genSalt(10);
    this.password = await bcrypt.hash(this.password, salt);
    next();
});

userSchema.methods.comparePassword = async function(candidatePassword) {
    return await bcrypt.compare(candidatePassword, this.password);
};

module.exports = mongoose.model(''User'', userSchema);
```

```javascript
// backend/src/models/Project.js
const mongoose = require(''mongoose'');

const projectSchema = new mongoose.Schema({
    name: {
        type: String,
        required: [true, ''Please provide a project name''],
        trim: true
    },
    description: {
        type: String,
        trim: true
    },
    owner: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User'',
        required: true
    },
    members: [{
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User''
    }],
    status: {
        type: String,
        enum: [''active'', ''completed'', ''archived''],
        default: ''active''
    },
    color: {
        type: String,
        default: ''#667eea''
    }
}, {
    timestamps: true
});

module.exports = mongoose.model(''Project'', projectSchema);
```

```javascript
// backend/src/models/Task.js
const mongoose = require(''mongoose'');

const taskSchema = new mongoose.Schema({
    title: {
        type: String,
        required: [true, ''Please provide a task title''],
        trim: true
    },
    description: {
        type: String,
        trim: true
    },
    project: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''Project'',
        required: true
    },
    assignedTo: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User''
    },
    createdBy: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User'',
        required: true
    },
    status: {
        type: String,
        enum: [''todo'', ''in-progress'', ''completed''],
        default: ''todo''
    },
    priority: {
        type: String,
        enum: [''low'', ''medium'', ''high''],
        default: ''medium''
    },
    dueDate: {
        type: Date
    },
    tags: [{
        type: String
    }]
}, {
    timestamps: true
});

module.exports = mongoose.model(''Task'', taskSchema);
```

#### 3. Controllers

```javascript
// backend/src/controllers/projectController.js
const Project = require(''../models/Project'');
const Task = require(''../models/Task'');

exports.getProjects = async (req, res, next) => {
    try {
        const projects = await Project.find({
            $or: [
                { owner: req.user._id },
                { members: req.user._id }
            ]
        })
        .populate(''owner'', ''name email'')
        .populate(''members'', ''name email'')
        .sort({ createdAt: -1 });
        
        res.json({
            success: true,
            count: projects.length,
            data: projects
        });
    } catch (error) {
        next(error);
    }
};

exports.getProject = async (req, res, next) => {
    try {
        const project = await Project.findById(req.params.id)
            .populate(''owner'', ''name email'')
            .populate(''members'', ''name email'');
        
        if (!project) {
            return res.status(404).json({
                success: false,
                error: ''Project not found''
            });
        }
        
        // Check access
        const hasAccess = project.owner._id.toString() === req.user._id.toString() ||
                         project.members.some(m => m._id.toString() === req.user._id.toString());
        
        if (!hasAccess) {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to access this project''
            });
        }
        
        res.json({
            success: true,
            data: project
        });
    } catch (error) {
        next(error);
    }
};

exports.createProject = async (req, res, next) => {
    try {
        req.body.owner = req.user._id;
        const project = await Project.create(req.body);
        
        const populatedProject = await Project.findById(project._id)
            .populate(''owner'', ''name email'');
        
        res.status(201).json({
            success: true,
            data: populatedProject
        });
    } catch (error) {
        next(error);
    }
};

exports.updateProject = async (req, res, next) => {
    try {
        let project = await Project.findById(req.params.id);
        
        if (!project) {
            return res.status(404).json({
                success: false,
                error: ''Project not found''
            });
        }
        
        // Check ownership
        if (project.owner.toString() !== req.user._id.toString() && req.user.role !== ''admin'') {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to update this project''
            });
        }
        
        project = await Project.findByIdAndUpdate(
            req.params.id,
            req.body,
            { new: true, runValidators: true }
        ).populate(''owner'', ''name email'')
         .populate(''members'', ''name email'');
        
        res.json({
            success: true,
            data: project
        });
    } catch (error) {
        next(error);
    }
};

exports.deleteProject = async (req, res, next) => {
    try {
        const project = await Project.findById(req.params.id);
        
        if (!project) {
            return res.status(404).json({
                success: false,
                error: ''Project not found''
            });
        }
        
        // Check ownership
        if (project.owner.toString() !== req.user._id.toString() && req.user.role !== ''admin'') {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to delete this project''
            });
        }
        
        // Delete associated tasks
        await Task.deleteMany({ project: project._id });
        
        await project.deleteOne();
        
        res.json({
            success: true,
            data: {}
        });
    } catch (error) {
        next(error);
    }
};
```

```javascript
// backend/src/controllers/taskController.js
const Task = require(''../models/Task'');
const Project = require(''../models/Project'');

exports.getTasks = async (req, res, next) => {
    try {
        const { projectId, status, priority } = req.query;
        const query = {};
        
        if (projectId) {
            query.project = projectId;
        }
        if (status) {
            query.status = status;
        }
        if (priority) {
            query.priority = priority;
        }
        
        // Only get tasks from projects user has access to
        const userProjects = await Project.find({
            $or: [
                { owner: req.user._id },
                { members: req.user._id }
            ]
        }).select(''_id'');
        
        const projectIds = userProjects.map(p => p._id);
        query.project = { $in: projectIds };
        
        const tasks = await Task.find(query)
            .populate(''project'', ''name'')
            .populate(''assignedTo'', ''name email'')
            .populate(''createdBy'', ''name email'')
            .sort({ createdAt: -1 });
        
        res.json({
            success: true,
            count: tasks.length,
            data: tasks
        });
    } catch (error) {
        next(error);
    }
};

exports.getTask = async (req, res, next) => {
    try {
        const task = await Task.findById(req.params.id)
            .populate(''project'', ''name owner members'')
            .populate(''assignedTo'', ''name email'')
            .populate(''createdBy'', ''name email'');
        
        if (!task) {
            return res.status(404).json({
                success: false,
                error: ''Task not found''
            });
        }
        
        // Check access through project
        const project = task.project;
        const hasAccess = project.owner.toString() === req.user._id.toString() ||
                         project.members.some(m => m.toString() === req.user._id.toString());
        
        if (!hasAccess) {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to access this task''
            });
        }
        
        res.json({
            success: true,
            data: task
        });
    } catch (error) {
        next(error);
    }
};

exports.createTask = async (req, res, next) => {
    try {
        // Verify project access
        const project = await Project.findById(req.body.project);
        if (!project) {
            return res.status(404).json({
                success: false,
                error: ''Project not found''
            });
        }
        
        const hasAccess = project.owner.toString() === req.user._id.toString() ||
                         project.members.some(m => m.toString() === req.user._id.toString());
        
        if (!hasAccess) {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to create tasks in this project''
            });
        }
        
        req.body.createdBy = req.user._id;
        const task = await Task.create(req.body);
        
        const populatedTask = await Task.findById(task._id)
            .populate(''project'', ''name'')
            .populate(''assignedTo'', ''name email'')
            .populate(''createdBy'', ''name email'');
        
        res.status(201).json({
            success: true,
            data: populatedTask
        });
    } catch (error) {
        next(error);
    }
};

exports.updateTask = async (req, res, next) => {
    try {
        let task = await Task.findById(req.params.id).populate(''project'');
        
        if (!task) {
            return res.status(404).json({
                success: false,
                error: ''Task not found''
            });
        }
        
        // Check access
        const project = task.project;
        const hasAccess = project.owner.toString() === req.user._id.toString() ||
                         project.members.some(m => m.toString() === req.user._id.toString()) ||
                         task.assignedTo?.toString() === req.user._id.toString();
        
        if (!hasAccess) {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to update this task''
            });
        }
        
        task = await Task.findByIdAndUpdate(
            req.params.id,
            req.body,
            { new: true, runValidators: true }
        ).populate(''project'', ''name'')
         .populate(''assignedTo'', ''name email'')
         .populate(''createdBy'', ''name email'');
        
        res.json({
            success: true,
            data: task
        });
    } catch (error) {
        next(error);
    }
};

exports.deleteTask = async (req, res, next) => {
    try {
        const task = await Task.findById(req.params.id).populate(''project'');
        
        if (!task) {
            return res.status(404).json({
                success: false,
                error: ''Task not found''
            });
        }
        
        // Check access
        const project = task.project;
        const hasAccess = project.owner.toString() === req.user._id.toString() ||
                         project.members.some(m => m.toString() === req.user._id.toString()) ||
                         task.createdBy.toString() === req.user._id.toString();
        
        if (!hasAccess) {
            return res.status(403).json({
                success: false,
                error: ''Not authorized to delete this task''
            });
        }
        
        await task.deleteOne();
        
        res.json({
            success: true,
            data: {}
        });
    } catch (error) {
        next(error);
    }
};
```

#### 4. Routes

```javascript
// backend/src/routes/projectRoutes.js
const express = require(''express'');
const {
    getProjects,
    getProject,
    createProject,
    updateProject,
    deleteProject
} = require(''../controllers/projectController'');
const { protect } = require(''../middleware/auth'');
const { body } = require(''express-validator'');
const validate = require(''../middleware/validate'');

const router = express.Router();

router.use(protect);

router.get(''/'', getProjects);
router.get(''/:id'', getProject);
router.post(
    ''/'',
    [
        body(''name'').trim().notEmpty().withMessage(''Project name is required'')
    ],
    validate,
    createProject
);
router.put(''/:id'', updateProject);
router.delete(''/:id'', deleteProject);

module.exports = router;
```

```javascript
// backend/src/routes/taskRoutes.js
const express = require(''express'');
const {
    getTasks,
    getTask,
    createTask,
    updateTask,
    deleteTask
} = require(''../controllers/taskController'');
const { protect } = require(''../middleware/auth'');
const { body } = require(''express-validator'');
const validate = require(''../middleware/validate'');

const router = express.Router();

router.use(protect);

router.get(''/'', getTasks);
router.get(''/:id'', getTask);
router.post(
    ''/'',
    [
        body(''title'').trim().notEmpty().withMessage(''Task title is required''),
        body(''project'').notEmpty().withMessage(''Project is required'')
    ],
    validate,
    createTask
);
router.put(''/:id'', updateTask);
router.delete(''/:id'', deleteTask);

module.exports = router;
```

#### 5. Server Setup

```javascript
// backend/src/server.js
const express = require(''express'');
const mongoose = require(''mongoose'');
const cors = require(''cors'');
const helmet = require(''helmet'');
const rateLimit = require(''express-rate-limit'');
require(''dotenv'').config();

const authRoutes = require(''./routes/authRoutes'');
const projectRoutes = require(''./routes/projectRoutes'');
const taskRoutes = require(''./routes/taskRoutes'');
const userRoutes = require(''./routes/userRoutes'');
const errorHandler = require(''./middleware/errorHandler'');

const app = express();

// Security middleware
app.use(helmet());
app.use(cors({
    origin: process.env.CLIENT_URL || ''http://localhost:3000'',
    credentials: true
}));

// Rate limiting
const limiter = rateLimit({
    windowMs: 15 * 60 * 1000, // 15 minutes
    max: 100 // limit each IP to 100 requests per windowMs
});
app.use(''/api/'', limiter);

// Body parser
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Routes
app.use(''/api/auth'', authRoutes);
app.use(''/api/projects'', projectRoutes);
app.use(''/api/tasks'', taskRoutes);
app.use(''/api/users'', userRoutes);

// Health check
app.get(''/api/health'', (req, res) => {
    res.json({
        success: true,
        message: ''API is running'',
        timestamp: new Date().toISOString()
    });
});

// Error handler (must be last)
app.use(errorHandler);

// Connect to database
mongoose.connect(process.env.MONGODB_URI)
    .then(() => {
        console.log(''Connected to MongoDB'');
        const PORT = process.env.PORT || 5000;
        app.listen(PORT, () => {
            console.log(`Server running on port ${PORT}`);
        });
    })
    .catch((error) => {
        console.error(''MongoDB connection error:'', error);
        process.exit(1);
    });
```

### Phase 2: Frontend Setup

#### 1. Initialize Frontend

```bash
npx create-react-app task-management-frontend
cd task-management-frontend
npm install axios react-router-dom date-fns
```

#### 2. API Service

```javascript
// frontend/src/services/api.js
import axios from ''axios'';

const API_URL = process.env.REACT_APP_API_URL || ''http://localhost:5000/api'';

const api = axios.create({
    baseURL: API_URL,
    headers: {
        ''Content-Type'': ''application/json''
    }
});

// Add token to requests
api.interceptors.request.use(
    (config) => {
        const token = localStorage.getItem(''token'');
        if (token) {
            config.headers.Authorization = `Bearer ${token}`;
        }
        return config;
    },
    (error) => Promise.reject(error)
);

// Handle response errors
api.interceptors.response.use(
    (response) => response,
    (error) => {
        if (error.response?.status === 401) {
            localStorage.removeItem(''token'');
            window.location.href = ''/login'';
        }
        return Promise.reject(error);
    }
);

export const authAPI = {
    register: (userData) => api.post(''/auth/register'', userData),
    login: (credentials) => api.post(''/auth/login'', credentials),
    getMe: () => api.get(''/auth/me'')
};

export const projectsAPI = {
    getProjects: () => api.get(''/projects''),
    getProject: (id) => api.get(`/projects/${id}`),
    createProject: (data) => api.post(''/projects'', data),
    updateProject: (id, data) => api.put(`/projects/${id}`, data),
    deleteProject: (id) => api.delete(`/projects/${id}`)
};

export const tasksAPI = {
    getTasks: (params) => api.get(''/tasks'', { params }),
    getTask: (id) => api.get(`/tasks/${id}`),
    createTask: (data) => api.post(''/tasks'', data),
    updateTask: (id, data) => api.put(`/tasks/${id}`, data),
    deleteTask: (id) => api.delete(`/tasks/${id}`)
};

export default api;
```

#### 3. Context Providers

```javascript
// frontend/src/context/AuthContext.jsx
import { createContext, useContext, useState, useEffect } from ''react'';
import { authAPI } from ''../services/api'';

const AuthContext = createContext();

export function AuthProvider({ children }) {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);
    const [token, setToken] = useState(localStorage.getItem(''token''));
    
    useEffect(() => {
        if (token) {
            loadUser();
        } else {
            setLoading(false);
        }
    }, [token]);
    
    const loadUser = async () => {
        try {
            const response = await authAPI.getMe();
            setUser(response.data.user);
        } catch (error) {
            localStorage.removeItem(''token'');
            setToken(null);
        } finally {
            setLoading(false);
        }
    };
    
    const register = async (userData) => {
        try {
            const response = await authAPI.register(userData);
            const { token, user } = response.data;
            localStorage.setItem(''token'', token);
            setToken(token);
            setUser(user);
            return { success: true };
        } catch (error) {
            return {
                success: false,
                error: error.response?.data?.error || ''Registration failed''
            };
        }
    };
    
    const login = async (credentials) => {
        try {
            const response = await authAPI.login(credentials);
            const { token, user } = response.data;
            localStorage.setItem(''token'', token);
            setToken(token);
            setUser(user);
            return { success: true };
        } catch (error) {
            return {
                success: false,
                error: error.response?.data?.error || ''Login failed''
            };
        }
    };
    
    const logout = () => {
        localStorage.removeItem(''token'');
        setToken(null);
        setUser(null);
    };
    
    return (
        <AuthContext.Provider
            value={{
                user,
                loading,
                register,
                login,
                logout,
                isAuthenticated: !!user
            }}
        >
            {children}
        </AuthContext.Provider>
    );
}

export function useAuth() {
    const context = useContext(AuthContext);
    if (!context) {
        throw new Error(''useAuth must be used within AuthProvider'');
    }
    return context;
}
```

#### 4. Main Pages

```javascript
// frontend/src/pages/Dashboard.jsx
import { useState, useEffect } from ''react'';
import { Link } from ''react-router-dom'';
import { projectsAPI, tasksAPI } from ''../services/api'';
import { useAuth } from ''../context/AuthContext'';
import ProjectCard from ''../components/ProjectCard'';
import Loading from ''../components/Loading'';
import ''./Dashboard.css'';

function Dashboard() {
    const { user } = useAuth();
    const [projects, setProjects] = useState([]);
    const [tasks, setTasks] = useState([]);
    const [loading, setLoading] = useState(true);
    const [stats, setStats] = useState({
        totalProjects: 0,
        totalTasks: 0,
        completedTasks: 0,
        activeTasks: 0
    });
    
    useEffect(() => {
        loadData();
    }, []);
    
    const loadData = async () => {
        try {
            setLoading(true);
            const [projectsRes, tasksRes] = await Promise.all([
                projectsAPI.getProjects(),
                tasksAPI.getTasks()
            ]);
            
            setProjects(projectsRes.data.data.slice(0, 5));
            setTasks(tasksRes.data.data.slice(0, 5));
            
            const allTasks = tasksRes.data.data;
            setStats({
                totalProjects: projectsRes.data.count,
                totalTasks: allTasks.length,
                completedTasks: allTasks.filter(t => t.status === ''completed'').length,
                activeTasks: allTasks.filter(t => t.status !== ''completed'').length
            });
        } catch (error) {
            console.error(''Failed to load data:'', error);
        } finally {
            setLoading(false);
        }
    };
    
    if (loading) {
        return <Loading />;
    }
    
    return (
        <div className="dashboard">
            <h1>Welcome, {user?.name}!</h1>
            
            <div className="stats-grid">
                <div className="stat-card">
                    <h3>{stats.totalProjects}</h3>
                    <p>Projects</p>
                </div>
                <div className="stat-card">
                    <h3>{stats.totalTasks}</h3>
                    <p>Total Tasks</p>
                </div>
                <div className="stat-card">
                    <h3>{stats.activeTasks}</h3>
                    <p>Active Tasks</p>
                </div>
                <div className="stat-card">
                    <h3>{stats.completedTasks}</h3>
                    <p>Completed Tasks</p>
                </div>
            </div>
            
            <div className="dashboard-sections">
                <section className="recent-projects">
                    <div className="section-header">
                        <h2>Recent Projects</h2>
                        <Link to="/projects" className="btn btn-link">View All</Link>
                    </div>
                    <div className="projects-grid">
                        {projects.map(project => (
                            <ProjectCard key={project._id} project={project} />
                        ))}
                    </div>
                </section>
                
                <section className="recent-tasks">
                    <div className="section-header">
                        <h2>Recent Tasks</h2>
                        <Link to="/tasks" className="btn btn-link">View All</Link>
                    </div>
                    <div className="tasks-list">
                        {tasks.map(task => (
                            <TaskCard key={task._id} task={task} />
                        ))}
                    </div>
                </section>
            </div>
        </div>
    );
}

export default Dashboard;
```

---

## Deployment Guide

### Backend Deployment (Heroku Example)

```bash
# Install Heroku CLI
# Login to Heroku
heroku login

# Create app
heroku create your-app-name

# Set environment variables
heroku config:set NODE_ENV=production
heroku config:set MONGODB_URI=your-mongodb-uri
heroku config:set JWT_SECRET=your-secret-key
heroku config:set CLIENT_URL=https://your-frontend-url.com

# Deploy
git push heroku main
```

### Frontend Deployment (Vercel Example)

```bash
# Install Vercel CLI
npm install -g vercel

# Build project
npm run build

# Deploy
vercel

# Set environment variable
vercel env add REACT_APP_API_URL
```

---

## Testing Checklist

- [ ] User registration
- [ ] User login
- [ ] Protected routes
- [ ] Create project
- [ ] View projects
- [ ] Update project
- [ ] Delete project
- [ ] Create task
- [ ] View tasks
- [ ] Update task
- [ ] Delete task
- [ ] Filter and search
- [ ] Error handling
- [ ] Responsive design
- [ ] Deployment

---

## Documentation Requirements

### README.md Should Include:

1. **Project Description**: What the application does
2. **Features**: List of features
3. **Tech Stack**: Technologies used
4. **Installation**: Step-by-step setup
5. **Configuration**: Environment variables
6. **API Documentation**: Endpoints and examples
7. **Deployment**: Deployment instructions
8. **Screenshots**: Application screenshots
9. **Contributing**: How to contribute
10. **License**: License information

---

## Evaluation Criteria

Your project will be evaluated on:

1. **Functionality** (30%)
   - All features work correctly
   - No critical bugs
   - Edge cases handled

2. **Code Quality** (25%)
   - Clean, readable code
   - Proper structure
   - Comments where needed

3. **Security** (20%)
   - Authentication implemented
   - Input validation
   - Error handling
   - Security best practices

4. **Design** (15%)
   - User-friendly interface
   - Responsive design
   - Good UX

5. **Documentation** (10%)
   - Complete README
   - API documentation
   - Setup instructions

---

## Exercise: Full-Stack Web Application

**Instructions**:

1. Choose your project idea
2. Plan your application architecture
3. Set up backend and frontend
4. Implement all features
5. Test thoroughly
6. Deploy to production
7. Document your project

**Timeline**: 2-4 weeks recommended

---

## Key Takeaways

1. **Full-Stack Development**: Complete application development
2. **Architecture**: Plan before coding
3. **Security**: Always prioritize security
4. **Testing**: Test all features
5. **Deployment**: Deploy to production
6. **Documentation**: Document everything

---

## Next Steps

Congratulations! You''ve completed your Capstone Project. You now know:
- How to build complete full-stack applications
- How to implement authentication
- How to integrate databases
- How to design APIs
- How to deploy applications

**What''s Next?**
- Capstone Project 2: Single Page Application (SPA)
- Build modern SPAs
- Apply advanced concepts
- Create portfolio projects

---

*Capstone Project completed! You''ve demonstrated mastery of full-stack JavaScript development!*

', NULL, 1, '2026-01-03 10:41:52', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Design and build a complete full-stack application
- Implement secure authentication and authorization
- Integrate databases effectively
- Design RESTful APIs
- Deploy applications to production
- Handle errors and edge cases
- Write clean, maintainable code
- Document your application');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (205, 75, 18, 'Single Page Application (SPA)', 'single-page-application-spa', '# Capstone Project 2: Single Page Application (SPA)

## Project Overview

Build a production-ready Single Page Application (SPA) using a modern framework (React or Vue). This capstone project will demonstrate mastery of frontend development, state management, routing, API integration, and responsive design.

## Learning Objectives

By the end of this project, you will be able to:
- Build complex single-page applications
- Implement advanced state management
- Create seamless routing and navigation
- Integrate with external APIs
- Design responsive, modern UIs
- Optimize application performance
- Handle complex user interactions
- Deploy SPAs to production

---

## Project Requirements

### Core Features

1. **Multiple Routes & Navigation**
   - At least 5-7 different pages/routes
   - Protected routes
   - Dynamic routes with parameters
   - Nested routes (optional)

2. **State Management**
   - Global state management (Context API or Redux)
   - Local component state
   - State persistence
   - Complex state interactions

3. **API Integration**
   - Connect to external APIs or mock backend
   - Handle loading states
   - Error handling
   - Data caching (optional)

4. **User Interface**
   - Modern, polished design
   - Responsive (mobile, tablet, desktop)
   - Smooth animations and transitions
   - Accessible components

5. **Advanced Features**
   - Search and filtering
   - Pagination or infinite scroll
   - Form validation
   - Image handling
   - Real-time updates (optional)

### Technical Requirements

- **Framework**: React or Vue.js
- **State Management**: Context API, Redux, or Vuex
- **Routing**: React Router or Vue Router
- **Styling**: CSS Modules, Styled Components, or Tailwind CSS
- **API**: Axios or Fetch API
- **Build Tool**: Vite, Create React App, or Vue CLI
- **Performance**: Code splitting, lazy loading
- **Responsive**: Mobile-first design

---

## Project Ideas

Choose one of these or create your own:

### Option 1: Movie Database App
- Browse movies and TV shows
- Search functionality
- Movie details with cast and reviews
- Watchlist/favorites
- User ratings

### Option 2: Recipe Finder App
- Search recipes by ingredients
- Recipe details with instructions
- Save favorite recipes
- Meal planning
- Shopping list generation

### Option 3: News Aggregator
- Multiple news sources
- Category filtering
- Article reading view
- Bookmark articles
- Search functionality

### Option 4: Music Discovery App
- Browse artists and albums
- Playlist creation
- Search songs
- Recently played
- Favorite tracks

### Option 5: Job Board Application
- Browse job listings
- Filter by location, type, salary
- Save jobs
- Application tracking
- Company profiles

---

## Recommended Project: Movie Database App

We''ll use a Movie Database App as our example. You can adapt this to any of the options above.

---

## Project Structure

```
movie-database-app/
├── public/
│   └── index.html
├── src/
│   ├── components/
│   │   ├── Layout/
│   │   │   ├── Header.jsx
│   │   │   ├── Navigation.jsx
│   │   │   └── Footer.jsx
│   │   ├── Movie/
│   │   │   ├── MovieCard.jsx
│   │   │   ├── MovieList.jsx
│   │   │   ├── MovieDetail.jsx
│   │   │   └── MovieSearch.jsx
│   │   ├── Common/
│   │   │   ├── Loading.jsx
│   │   │   ├── Error.jsx
│   │   │   ├── Pagination.jsx
│   │   │   └── FilterBar.jsx
│   │   └── Watchlist/
│   │       └── WatchlistButton.jsx
│   ├── pages/
│   │   ├── Home.jsx
│   │   ├── Movies.jsx
│   │   ├── MovieDetail.jsx
│   │   ├── Watchlist.jsx
│   │   ├── Search.jsx
│   │   └── About.jsx
│   ├── context/
│   │   ├── MovieContext.jsx
│   │   └── WatchlistContext.jsx
│   ├── hooks/
│   │   ├── useMovies.js
│   │   ├── useLocalStorage.js
│   │   └── useDebounce.js
│   ├── services/
│   │   └── api.js
│   ├── utils/
│   │   └── helpers.js
│   ├── styles/
│   │   ├── App.css
│   │   └── components.css
│   ├── App.jsx
│   └── index.js
└── package.json
```

---

## Step-by-Step Implementation

### Phase 1: Project Setup

```bash
# Create React app with Vite
npm create vite@latest movie-database-app -- --template react
cd movie-database-app
npm install

# Install dependencies
npm install react-router-dom axios date-fns
npm install --save-dev @vitejs/plugin-react

# Start development server
npm run dev
```

### Phase 2: API Service

```javascript
// src/services/api.js
import axios from ''axios'';

// Using The Movie Database (TMDB) API
// Sign up at https://www.themoviedb.org/ to get API key
const API_KEY = process.env.REACT_APP_TMDB_API_KEY || ''your-api-key'';
const BASE_URL = ''https://api.themoviedb.org/3'';
const IMAGE_BASE_URL = ''https://image.tmdb.org/t/p/w500'';

const api = axios.create({
    baseURL: BASE_URL,
    params: {
        api_key: API_KEY
    }
});

export const moviesAPI = {
    // Get popular movies
    getPopularMovies: (page = 1) => 
        api.get(''/movie/popular'', { params: { page } }),
    
    // Get top rated movies
    getTopRatedMovies: (page = 1) => 
        api.get(''/movie/top_rated'', { params: { page } }),
    
    // Get now playing movies
    getNowPlayingMovies: (page = 1) => 
        api.get(''/movie/now_playing'', { params: { page } }),
    
    // Get upcoming movies
    getUpcomingMovies: (page = 1) => 
        api.get(''/movie/upcoming'', { params: { page } }),
    
    // Get movie by ID
    getMovieById: (id) => 
        api.get(`/movie/${id}`),
    
    // Search movies
    searchMovies: (query, page = 1) => 
        api.get(''/search/movie'', { params: { query, page } }),
    
    // Get movie credits
    getMovieCredits: (id) => 
        api.get(`/movie/${id}/credits`),
    
    // Get movie reviews
    getMovieReviews: (id, page = 1) => 
        api.get(`/movie/${id}/reviews`, { params: { page } }),
    
    // Get similar movies
    getSimilarMovies: (id, page = 1) => 
        api.get(`/movie/${id}/similar`, { params: { page } })
};

export const getImageUrl = (path) => {
    return path ? `${IMAGE_BASE_URL}${path}` : ''https://via.placeholder.com/500'';
};

export default api;
```

### Phase 3: Custom Hooks

```javascript
// src/hooks/useMovies.js
import { useState, useEffect } from ''react'';
import { moviesAPI } from ''../services/api'';

export function useMovies(endpoint, page = 1) {
    const [movies, setMovies] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    const [totalPages, setTotalPages] = useState(1);
    
    useEffect(() => {
        loadMovies();
    }, [endpoint, page]);
    
    const loadMovies = async () => {
        try {
            setLoading(true);
            setError(null);
            const response = await moviesAPI[endpoint](page);
            setMovies(response.data.results);
            setTotalPages(response.data.total_pages);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    return { movies, loading, error, totalPages, refetch: loadMovies };
}

export function useMovie(id) {
    const [movie, setMovie] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    const [credits, setCredits] = useState(null);
    const [reviews, setReviews] = useState([]);
    
    useEffect(() => {
        if (id) {
            loadMovie();
        }
    }, [id]);
    
    const loadMovie = async () => {
        try {
            setLoading(true);
            setError(null);
            
            const [movieRes, creditsRes, reviewsRes] = await Promise.all([
                moviesAPI.getMovieById(id),
                moviesAPI.getMovieCredits(id),
                moviesAPI.getMovieReviews(id)
            ]);
            
            setMovie(movieRes.data);
            setCredits(creditsRes.data);
            setReviews(reviewsRes.data.results);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    return { movie, credits, reviews, loading, error };
}

export function useSearchMovies(query, page = 1) {
    const [movies, setMovies] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);
    const [totalPages, setTotalPages] = useState(1);
    
    useEffect(() => {
        if (query.trim()) {
            searchMovies();
        } else {
            setMovies([]);
        }
    }, [query, page]);
    
    const searchMovies = async () => {
        try {
            setLoading(true);
            setError(null);
            const response = await moviesAPI.searchMovies(query, page);
            setMovies(response.data.results);
            setTotalPages(response.data.total_pages);
        } catch (err) {
            setError(err.message);
        } finally {
            setLoading(false);
        }
    };
    
    return { movies, loading, error, totalPages };
}
```

```javascript
// src/hooks/useDebounce.js
import { useState, useEffect } from ''react'';

export function useDebounce(value, delay = 500) {
    const [debouncedValue, setDebouncedValue] = useState(value);
    
    useEffect(() => {
        const handler = setTimeout(() => {
            setDebouncedValue(value);
        }, delay);
        
        return () => {
            clearTimeout(handler);
        };
    }, [value, delay]);
    
    return debouncedValue;
}
```

```javascript
// src/hooks/useLocalStorage.js
import { useState, useEffect } from ''react'';

export function useLocalStorage(key, initialValue) {
    const [storedValue, setStoredValue] = useState(() => {
        try {
            const item = window.localStorage.getItem(key);
            return item ? JSON.parse(item) : initialValue;
        } catch (error) {
            return initialValue;
        }
    });
    
    const setValue = (value) => {
        try {
            const valueToStore = value instanceof Function ? value(storedValue) : value;
            setStoredValue(valueToStore);
            window.localStorage.setItem(key, JSON.stringify(valueToStore));
        } catch (error) {
            console.error(error);
        }
    };
    
    return [storedValue, setValue];
}
```

### Phase 4: Context Providers

```javascript
// src/context/WatchlistContext.jsx
import { createContext, useContext } from ''react'';
import { useLocalStorage } from ''../hooks/useLocalStorage'';

const WatchlistContext = createContext();

export function WatchlistProvider({ children }) {
    const [watchlist, setWatchlist] = useLocalStorage(''watchlist'', []);
    
    const addToWatchlist = (movie) => {
        if (!watchlist.find(m => m.id === movie.id)) {
            setWatchlist([...watchlist, movie]);
        }
    };
    
    const removeFromWatchlist = (movieId) => {
        setWatchlist(watchlist.filter(m => m.id !== movieId));
    };
    
    const isInWatchlist = (movieId) => {
        return watchlist.some(m => m.id === movieId);
    };
    
    return (
        <WatchlistContext.Provider
            value={{
                watchlist,
                addToWatchlist,
                removeFromWatchlist,
                isInWatchlist
            }}
        >
            {children}
        </WatchlistContext.Provider>
    );
}

export function useWatchlist() {
    const context = useContext(WatchlistContext);
    if (!context) {
        throw new Error(''useWatchlist must be used within WatchlistProvider'');
    }
    return context;
}
```

### Phase 5: Components

```javascript
// src/components/Movie/MovieCard.jsx
import { Link } from ''react-router-dom'';
import { getImageUrl } from ''../../services/api'';
import { useWatchlist } from ''../../context/WatchlistContext'';
import ''./MovieCard.css'';

function MovieCard({ movie }) {
    const { addToWatchlist, removeFromWatchlist, isInWatchlist } = useWatchlist();
    const inWatchlist = isInWatchlist(movie.id);
    
    const handleWatchlistToggle = (e) => {
        e.preventDefault();
        if (inWatchlist) {
            removeFromWatchlist(movie.id);
        } else {
            addToWatchlist(movie);
        }
    };
    
    return (
        <div className="movie-card">
            <Link to={`/movie/${movie.id}`} className="movie-link">
                <div className="movie-image-container">
                    <img
                        src={getImageUrl(movie.poster_path)}
                        alt={movie.title}
                        className="movie-image"
                    />
                    <div className="movie-overlay">
                        <div className="movie-rating">
                            ⭐ {movie.vote_average?.toFixed(1)}
                        </div>
                    </div>
                </div>
                <div className="movie-info">
                    <h3 className="movie-title">{movie.title}</h3>
                    <p className="movie-date">
                        {movie.release_date ? new Date(movie.release_date).getFullYear() : ''N/A''}
                    </p>
                </div>
            </Link>
            <button
                onClick={handleWatchlistToggle}
                className={`watchlist-btn ${inWatchlist ? ''active'' : ''''}`}
                title={inWatchlist ? ''Remove from watchlist'' : ''Add to watchlist''}
            >
                {inWatchlist ? ''✓'' : ''+''}
            </button>
        </div>
    );
}

export default MovieCard;
```

```javascript
// src/components/Movie/MovieList.jsx
import { lazy, Suspense } from ''react'';
import MovieCard from ''./MovieCard'';
import Loading from ''../Common/Loading'';
import ''./MovieList.css'';

const MovieCardLazy = lazy(() => import(''./MovieCard''));

function MovieList({ movies, loading }) {
    if (loading) {
        return <Loading />;
    }
    
    if (movies.length === 0) {
        return (
            <div className="no-movies">
                <p>No movies found</p>
            </div>
        );
    }
    
    return (
        <div className="movie-list">
            <Suspense fallback={<Loading />}>
                {movies.map(movie => (
                    <MovieCard key={movie.id} movie={movie} />
                ))}
            </Suspense>
        </div>
    );
}

export default MovieList;
```

```javascript
// src/components/Movie/MovieDetail.jsx
import { useMovie } from ''../../hooks/useMovies'';
import { getImageUrl } from ''../../services/api'';
import { format } from ''date-fns'';
import Loading from ''../Common/Loading'';
import Error from ''../Common/Error'';
import ''./MovieDetail.css'';

function MovieDetail({ movieId }) {
    const { movie, credits, reviews, loading, error } = useMovie(movieId);
    
    if (loading) {
        return <Loading />;
    }
    
    if (error) {
        return <Error message={error} />;
    }
    
    if (!movie) {
        return <Error message="Movie not found" />;
    }
    
    return (
        <div className="movie-detail">
            <div className="movie-detail-hero">
                <img
                    src={getImageUrl(movie.backdrop_path)}
                    alt={movie.title}
                    className="movie-backdrop"
                />
                <div className="movie-detail-content">
                    <div className="movie-detail-poster">
                        <img
                            src={getImageUrl(movie.poster_path)}
                            alt={movie.title}
                        />
                    </div>
                    <div className="movie-detail-info">
                        <h1>{movie.title}</h1>
                        <div className="movie-meta">
                            <span>⭐ {movie.vote_average?.toFixed(1)}</span>
                            <span>•</span>
                            <span>{movie.runtime} min</span>
                            <span>•</span>
                            <span>{format(new Date(movie.release_date), ''yyyy'')}</span>
                        </div>
                        <div className="movie-genres">
                            {movie.genres?.map(genre => (
                                <span key={genre.id} className="genre-tag">
                                    {genre.name}
                                </span>
                            ))}
                        </div>
                        <p className="movie-overview">{movie.overview}</p>
                    </div>
                </div>
            </div>
            
            {credits && credits.cast && (
                <section className="movie-cast">
                    <h2>Cast</h2>
                    <div className="cast-list">
                        {credits.cast.slice(0, 10).map(actor => (
                            <div key={actor.id} className="cast-item">
                                <img
                                    src={getImageUrl(actor.profile_path)}
                                    alt={actor.name}
                                />
                                <p className="actor-name">{actor.name}</p>
                                <p className="character-name">{actor.character}</p>
                            </div>
                        ))}
                    </div>
                </section>
            )}
            
            {reviews.length > 0 && (
                <section className="movie-reviews">
                    <h2>Reviews</h2>
                    <div className="reviews-list">
                        {reviews.map(review => (
                            <div key={review.id} className="review-item">
                                <div className="review-header">
                                    <strong>{review.author}</strong>
                                    <span>{format(new Date(review.created_at), ''MMM dd, yyyy'')}</span>
                                </div>
                                <p>{review.content}</p>
                            </div>
                        ))}
                    </div>
                </section>
            )}
        </div>
    );
}

export default MovieDetail;
```

```javascript
// src/components/Movie/MovieSearch.jsx
import { useState, useEffect } from ''react'';
import { useSearchMovies } from ''../../hooks/useMovies'';
import { useDebounce } from ''../../hooks/useDebounce'';
import MovieList from ''./MovieList'';
import Pagination from ''../Common/Pagination'';
import ''./MovieSearch.css'';

function MovieSearch() {
    const [searchQuery, setSearchQuery] = useState('''');
    const [page, setPage] = useState(1);
    const debouncedQuery = useDebounce(searchQuery, 500);
    const { movies, loading, error, totalPages } = useSearchMovies(debouncedQuery, page);
    
    useEffect(() => {
        setPage(1);
    }, [debouncedQuery]);
    
    return (
        <div className="movie-search">
            <div className="search-container">
                <input
                    type="text"
                    value={searchQuery}
                    onChange={(e) => setSearchQuery(e.target.value)}
                    placeholder="Search movies..."
                    className="search-input"
                />
            </div>
            
            {debouncedQuery && (
                <>
                    <h2>Search Results for "{debouncedQuery}"</h2>
                    <MovieList movies={movies} loading={loading} />
                    {totalPages > 1 && (
                        <Pagination
                            currentPage={page}
                            totalPages={totalPages}
                            onPageChange={setPage}
                        />
                    )}
                </>
            )}
        </div>
    );
}

export default MovieSearch;
```

```javascript
// src/components/Common/Pagination.jsx
import ''./Pagination.css'';

function Pagination({ currentPage, totalPages, onPageChange }) {
    const getPageNumbers = () => {
        const pages = [];
        const maxVisible = 5;
        let start = Math.max(1, currentPage - Math.floor(maxVisible / 2));
        let end = Math.min(totalPages, start + maxVisible - 1);
        
        if (end - start < maxVisible - 1) {
            start = Math.max(1, end - maxVisible + 1);
        }
        
        for (let i = start; i <= end; i++) {
            pages.push(i);
        }
        
        return pages;
    };
    
    return (
        <div className="pagination">
            <button
                onClick={() => onPageChange(currentPage - 1)}
                disabled={currentPage === 1}
                className="pagination-btn"
            >
                Previous
            </button>
            
            <div className="pagination-numbers">
                {getPageNumbers().map(page => (
                    <button
                        key={page}
                        onClick={() => onPageChange(page)}
                        className={`pagination-btn ${currentPage === page ? ''active'' : ''''}`}
                    >
                        {page}
                    </button>
                ))}
            </div>
            
            <button
                onClick={() => onPageChange(currentPage + 1)}
                disabled={currentPage === totalPages}
                className="pagination-btn"
            >
                Next
            </button>
        </div>
    );
}

export default Pagination;
```

### Phase 6: Pages

```javascript
// src/pages/Home.jsx
import { Link } from ''react-router-dom'';
import { useMovies } from ''../hooks/useMovies'';
import MovieList from ''../components/Movie/MovieList'';
import ''./Home.css'';

function Home() {
    const { movies, loading } = useMovies(''getPopularMovies'', 1);
    
    return (
        <div className="home">
            <section className="hero">
                <h1>Discover Amazing Movies</h1>
                <p>Explore the latest and greatest films</p>
                <Link to="/movies" className="btn btn-primary">
                    Browse Movies
                </Link>
            </section>
            
            <section className="featured-section">
                <h2>Popular Movies</h2>
                <MovieList movies={movies} loading={loading} />
                <div className="section-footer">
                    <Link to="/movies" className="btn btn-link">
                        View All Movies →
                    </Link>
                </div>
            </section>
        </div>
    );
}

export default Home;
```

```javascript
// src/pages/Movies.jsx
import { useState } from ''react'';
import { useMovies } from ''../hooks/useMovies'';
import MovieList from ''../components/Movie/MovieList'';
import FilterBar from ''../components/Common/FilterBar'';
import Pagination from ''../components/Common/Pagination'';
import ''./Movies.css'';

const FILTERS = {
    popular: ''getPopularMovies'',
    topRated: ''getTopRatedMovies'',
    nowPlaying: ''getNowPlayingMovies'',
    upcoming: ''getUpcomingMovies''
};

function Movies() {
    const [filter, setFilter] = useState(''popular'');
    const [page, setPage] = useState(1);
    const { movies, loading, totalPages } = useMovies(FILTERS[filter], page);
    
    return (
        <div className="movies-page">
            <h1>Movies</h1>
            
            <FilterBar
                filters={[
                    { key: ''popular'', label: ''Popular'' },
                    { key: ''topRated'', label: ''Top Rated'' },
                    { key: ''nowPlaying'', label: ''Now Playing'' },
                    { key: ''upcoming'', label: ''Upcoming'' }
                ]}
                activeFilter={filter}
                onFilterChange={setFilter}
            />
            
            <MovieList movies={movies} loading={loading} />
            
            {totalPages > 1 && (
                <Pagination
                    currentPage={page}
                    totalPages={totalPages}
                    onPageChange={setPage}
                />
            )}
        </div>
    );
}

export default Movies;
```

```javascript
// src/pages/MovieDetail.jsx
import { useParams } from ''react-router-dom'';
import MovieDetail from ''../components/Movie/MovieDetail'';
import ''./MovieDetailPage.css'';

function MovieDetailPage() {
    const { id } = useParams();
    
    return (
        <div className="movie-detail-page">
            <MovieDetail movieId={id} />
        </div>
    );
}

export default MovieDetailPage;
```

```javascript
// src/pages/Watchlist.jsx
import { useWatchlist } from ''../context/WatchlistContext'';
import MovieList from ''../components/Movie/MovieList'';
import ''./Watchlist.css'';

function Watchlist() {
    const { watchlist } = useWatchlist();
    
    return (
        <div className="watchlist-page">
            <h1>My Watchlist</h1>
            {watchlist.length === 0 ? (
                <div className="empty-watchlist">
                    <p>Your watchlist is empty</p>
                    <p>Start adding movies to your watchlist!</p>
                </div>
            ) : (
                <MovieList movies={watchlist} loading={false} />
            )}
        </div>
    );
}

export default Watchlist;
```

```javascript
// src/pages/Search.jsx
import MovieSearch from ''../components/Movie/MovieSearch'';
import ''./Search.css'';

function Search() {
    return (
        <div className="search-page">
            <h1>Search Movies</h1>
            <MovieSearch />
        </div>
    );
}

export default Search;
```

### Phase 7: App Component with Routing

```javascript
// src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import { lazy, Suspense } from ''react'';
import { WatchlistProvider } from ''./context/WatchlistContext'';
import Layout from ''./components/Layout/Layout'';
import Loading from ''./components/Common/Loading'';
import ''./App.css'';

// Lazy load pages for code splitting
const Home = lazy(() => import(''./pages/Home''));
const Movies = lazy(() => import(''./pages/Movies''));
const MovieDetail = lazy(() => import(''./pages/MovieDetail''));
const Watchlist = lazy(() => import(''./pages/Watchlist''));
const Search = lazy(() => import(''./pages/Search''));
const About = lazy(() => import(''./pages/About''));

function App() {
    return (
        <WatchlistProvider>
            <BrowserRouter>
                <Layout>
                    <Suspense fallback={<Loading />}>
                        <Routes>
                            <Route path="/" element={<Home />} />
                            <Route path="/movies" element={<Movies />} />
                            <Route path="/movie/:id" element={<MovieDetail />} />
                            <Route path="/watchlist" element={<Watchlist />} />
                            <Route path="/search" element={<Search />} />
                            <Route path="/about" element={<About />} />
                        </Routes>
                    </Suspense>
                </Layout>
            </BrowserRouter>
        </WatchlistProvider>
    );
}

export default App;
```

### Phase 8: Layout Component

```javascript
// src/components/Layout/Layout.jsx
import Header from ''./Header'';
import Footer from ''./Footer'';
import ''./Layout.css'';

function Layout({ children }) {
    return (
        <div className="layout">
            <Header />
            <main className="main-content">
                {children}
            </main>
            <Footer />
        </div>
    );
}

export default Layout;
```

```javascript
// src/components/Layout/Header.jsx
import { Link, useLocation } from ''react-router-dom'';
import { useWatchlist } from ''../../context/WatchlistContext'';
import ''./Header.css'';

function Header() {
    const location = useLocation();
    const { watchlist } = useWatchlist();
    
    const isActive = (path) => location.pathname === path;
    
    return (
        <header className="header">
            <div className="header-container">
                <Link to="/" className="logo">
                    🎬 MovieDB
                </Link>
                <nav className="nav">
                    <Link
                        to="/"
                        className={`nav-link ${isActive(''/'') ? ''active'' : ''''}`}
                    >
                        Home
                    </Link>
                    <Link
                        to="/movies"
                        className={`nav-link ${isActive(''/movies'') ? ''active'' : ''''}`}
                    >
                        Movies
                    </Link>
                    <Link
                        to="/search"
                        className={`nav-link ${isActive(''/search'') ? ''active'' : ''''}`}
                    >
                        Search
                    </Link>
                    <Link
                        to="/watchlist"
                        className={`nav-link ${isActive(''/watchlist'') ? ''active'' : ''''}`}
                    >
                        Watchlist
                        {watchlist.length > 0 && (
                            <span className="badge">{watchlist.length}</span>
                        )}
                    </Link>
                    <Link
                        to="/about"
                        className={`nav-link ${isActive(''/about'') ? ''active'' : ''''}`}
                    >
                        About
                    </Link>
                </nav>
            </div>
        </header>
    );
}

export default Header;
```

---

## Features Implementation

### State Management

- **Watchlist Context**: Global watchlist state
- **Custom Hooks**: Reusable data fetching hooks
- **Local Storage**: Persist watchlist
- **Optimistic Updates**: Immediate UI feedback

### Routing

- **React Router**: Client-side routing
- **Lazy Loading**: Code splitting for performance
- **Dynamic Routes**: Movie detail pages
- **Navigation**: Smooth page transitions

### API Integration

- **TMDB API**: External movie database
- **Error Handling**: Graceful error handling
- **Loading States**: User feedback
- **Caching**: Reduce API calls

### Responsive Design

- **Mobile-First**: Start with mobile
- **Flexible Layouts**: Grid and flexbox
- **Breakpoints**: Multiple screen sizes
- **Touch-Friendly**: Large tap targets

---

## Performance Optimization

### Code Splitting

```javascript
// Lazy load components
const MovieDetail = lazy(() => import(''./pages/MovieDetail''));
```

### Image Optimization

```javascript
// Use different image sizes
const getImageUrl = (path, size = ''w500'') => {
    return path ? `https://image.tmdb.org/t/p/${size}${path}` : placeholder;
};
```

### Memoization

```javascript
import { useMemo } from ''react'';

const filteredMovies = useMemo(() => {
    return movies.filter(movie => /* filter logic */);
}, [movies, filter]);
```

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Navigate between all routes
- [ ] Search functionality works
- [ ] Add/remove from watchlist
- [ ] Pagination works
- [ ] Filter movies
- [ ] View movie details
- [ ] Responsive on mobile
- [ ] Loading states display
- [ ] Error handling works
- [ ] Performance is good

---

## Deployment

### Build for Production

```bash
npm run build
```

### Deploy to Vercel

```bash
# Install Vercel CLI
npm install -g vercel

# Deploy
vercel

# Set environment variables
vercel env add REACT_APP_TMDB_API_KEY
```

### Deploy to Netlify

```bash
# Install Netlify CLI
npm install -g netlify-cli

# Deploy
netlify deploy --prod

# Set environment variables in Netlify dashboard
```

---

## Exercise: Single Page Application

**Instructions**:

1. Choose your project idea
2. Set up React/Vue project
3. Plan your routes and state
4. Implement all features
5. Optimize performance
6. Test thoroughly
7. Deploy to production

**Timeline**: 2-3 weeks recommended

---

## Evaluation Criteria

Your project will be evaluated on:

1. **Functionality** (30%)
   - All features work correctly
   - Smooth navigation
   - No critical bugs

2. **State Management** (20%)
   - Proper state organization
   - Efficient updates
   - State persistence

3. **Routing** (15%)
   - All routes work
   - Navigation is smooth
   - Protected routes (if applicable)

4. **API Integration** (15%)
   - Proper API usage
   - Error handling
   - Loading states

5. **Design & UX** (15%)
   - Modern, polished design
   - Responsive layout
   - Good user experience

6. **Performance** (5%)
   - Fast load times
   - Smooth interactions
   - Optimized code

---

## Common Issues and Solutions

### Issue: Slow performance

**Solution**: Implement code splitting, lazy loading, and memoization.

### Issue: API rate limiting

**Solution**: Implement caching and debouncing for search.

### Issue: Routing not working

**Solution**: Ensure BrowserRouter wraps the app and routes are correct.

---

## Quiz: SPA Concepts

1. **SPA:**
   - A) Single Page Application
   - B) Multiple pages
   - C) Both
   - D) Neither

2. **State management:**
   - A) Important for SPAs
   - B) Not important
   - C) Both
   - D) Neither

3. **Routing:**
   - A) Client-side navigation
   - B) Server-side navigation
   - C) Both
   - D) Neither

4. **Code splitting:**
   - A) Improves performance
   - B) Doesn''t improve performance
   - C) Both
   - D) Neither

5. **Responsive design:**
   - A) Works on all devices
   - B) Desktop only
   - C) Both
   - D) Neither

**Answers**:
1. A) Single Page Application
2. A) Important for SPAs
3. A) Client-side navigation
4. A) Improves performance
5. A) Works on all devices

---

## Key Takeaways

1. **SPA Architecture**: Single page with client-side routing
2. **State Management**: Critical for complex apps
3. **Routing**: Smooth navigation without page reloads
4. **API Integration**: Connect to external services
5. **Performance**: Optimize with code splitting and lazy loading
6. **Best Practice**: Clean code, good UX, responsive design

---

## Next Steps

Congratulations! You''ve built a Single Page Application. You now know:
- How to build complex SPAs
- How to manage state effectively
- How to implement routing
- How to integrate with APIs
- How to optimize performance

**What''s Next?**
- Capstone Project 3: Real-Time Application
- Learn WebSocket integration
- Build real-time features
- Create advanced applications

---

*Capstone Project completed! You''ve demonstrated mastery of modern frontend development!*

', NULL, 2, '2026-01-03 10:42:44', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Build complex single-page applications
- Implement advanced state management
- Create seamless routing and navigation
- Integrate with external APIs
- Design responsive, modern UIs
- Optimize application performance
- Handle complex user interactions
- Deploy SPAs to production');
INSERT INTO `lessons` (`id`, `module_id`, `course_id`, `title`, `slug`, `content`, `code_examples`, `sort_order`, `created_at`, `updated_at`, `status`, `content_type`, `featured_image`, `estimated_time`, `objectives`) VALUES (206, 75, 18, 'Real-Time Application', 'realtime-application', '# Capstone Project 3: Real-Time Application

## Project Overview

Build a production-ready Real-Time Application using WebSockets, combining frontend and backend with real-time communication. This capstone project will demonstrate mastery of WebSocket integration, real-time features, backend API development, database integration, and deployment.

## Learning Objectives

By the end of this project, you will be able to:
- Implement WebSocket connections
- Build real-time features
- Design and develop backend APIs
- Integrate databases with real-time updates
- Handle concurrent connections
- Optimize real-time performance
- Deploy real-time applications
- Handle edge cases and errors

---

## Project Requirements

### Core Features

1. **Real-Time Communication**
   - Instant message delivery
   - Live updates
   - User presence indicators
   - Typing indicators
   - Notifications

2. **Backend API**
   - RESTful API endpoints
   - WebSocket server
   - Database integration
   - Authentication
   - Error handling

3. **Database**
   - Store messages and data
   - User management
   - Real-time data sync
   - Data persistence

4. **User Features**
   - User authentication
   - User profiles
   - Online/offline status
   - Message history
   - Room/channel management

5. **Advanced Features**
   - File sharing
   - Message reactions
   - Read receipts
   - Message editing/deleting
   - Search functionality

### Technical Requirements

- **Backend**: Node.js, Express.js, Socket.io
- **Frontend**: React or Vue.js
- **Database**: MongoDB or PostgreSQL
- **Authentication**: JWT
- **WebSockets**: Socket.io
- **Deployment**: Backend and frontend deployment

---

## Project Ideas

Choose one of these or create your own:

### Option 1: Real-Time Collaboration Tool
- Multiple users editing documents
- Live cursor positions
- Change tracking
- Comments and suggestions
- Version history

### Option 2: Live Dashboard Application
- Real-time data visualization
- Multiple data sources
- Live updates
- Customizable widgets
- Alerts and notifications

### Option 3: Multiplayer Game
- Real-time game state
- Player interactions
- Leaderboards
- Game rooms
- Chat system

### Option 4: Live Polling/Voting App
- Create polls
- Real-time vote counting
- Results visualization
- Multiple poll types
- Admin controls

### Option 5: Team Communication Platform
- Channels and direct messages
- File sharing
- Video/audio calls (optional)
- Notifications
- Message threads

---

## Recommended Project: Real-Time Collaboration Tool

We''ll use a Real-Time Collaboration Tool as our example. You can adapt this to any of the options above.

---

## Project Structure

```
collaboration-app/
├── backend/
│   ├── src/
│   │   ├── config/
│   │   │   └── database.js
│   │   ├── models/
│   │   │   ├── User.js
│   │   │   ├── Document.js
│   │   │   └── Change.js
│   │   ├── controllers/
│   │   │   ├── authController.js
│   │   │   ├── documentController.js
│   │   │   └── userController.js
│   │   ├── routes/
│   │   │   ├── authRoutes.js
│   │   │   ├── documentRoutes.js
│   │   │   └── userRoutes.js
│   │   ├── socket/
│   │   │   ├── socketHandlers.js
│   │   │   └── documentHandlers.js
│   │   ├── middleware/
│   │   │   ├── auth.js
│   │   │   └── errorHandler.js
│   │   └── server.js
│   ├── .env
│   └── package.json
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── Layout/
│   │   │   ├── Document/
│   │   │   ├── Editor/
│   │   │   └── UserList/
│   │   ├── pages/
│   │   │   ├── Home.jsx
│   │   │   ├── DocumentPage.jsx
│   │   │   └── Dashboard.jsx
│   │   ├── context/
│   │   │   ├── AuthContext.jsx
│   │   │   └── SocketContext.jsx
│   │   ├── hooks/
│   │   │   └── useSocket.js
│   │   ├── services/
│   │   │   └── api.js
│   │   └── App.jsx
│   └── package.json
└── README.md
```

---

## Step-by-Step Implementation

### Phase 1: Backend Setup

```bash
# Create backend directory
mkdir collaboration-backend
cd collaboration-backend
npm init -y

# Install dependencies
npm install express socket.io mongoose dotenv bcrypt jsonwebtoken cors helmet express-rate-limit
npm install --save-dev nodemon

# Create project structure
mkdir -p src/{config,models,controllers,routes,socket,middleware}
```

### Phase 2: Database Models

```javascript
// backend/src/models/Document.js
const mongoose = require(''mongoose'');

const changeSchema = new mongoose.Schema({
    type: {
        type: String,
        enum: [''insert'', ''delete'', ''format''],
        required: true
    },
    position: {
        type: Number,
        required: true
    },
    text: String,
    length: Number,
    format: {
        type: Map,
        of: String
    },
    userId: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User'',
        required: true
    },
    timestamp: {
        type: Date,
        default: Date.now
    }
}, { _id: false });

const documentSchema = new mongoose.Schema({
    title: {
        type: String,
        required: true,
        trim: true
    },
    content: {
        type: String,
        default: ''''
    },
    owner: {
        type: mongoose.Schema.Types.ObjectId,
        ref: ''User'',
        required: true
    },
    collaborators: [{
        user: {
            type: mongoose.Schema.Types.ObjectId,
            ref: ''User''
        },
        role: {
            type: String,
            enum: [''viewer'', ''editor''],
            default: ''editor''
        }
    }],
    changes: [changeSchema],
    version: {
        type: Number,
        default: 1
    },
    isPublic: {
        type: Boolean,
        default: false
    }
}, {
    timestamps: true
});

module.exports = mongoose.model(''Document'', documentSchema);
```

### Phase 3: Socket Handlers

```javascript
// backend/src/socket/documentHandlers.js
const Document = require(''../models/Document'');
const User = require(''../models/User'');

// Store active users per document
const activeUsers = new Map();

function setupDocumentHandlers(io, socket) {
    // Join document room
    socket.on(''document:join'', async (data) => {
        const { documentId, userId } = data;
        
        try {
            const document = await Document.findById(documentId);
            if (!document) {
                socket.emit(''error'', { message: ''Document not found'' });
                return;
            }
            
            // Check access
            const hasAccess = document.owner.toString() === userId ||
                            document.collaborators.some(c => c.user.toString() === userId) ||
                            document.isPublic;
            
            if (!hasAccess) {
                socket.emit(''error'', { message: ''Access denied'' });
                return;
            }
            
            // Join room
            socket.join(documentId);
            
            // Track active user
            if (!activeUsers.has(documentId)) {
                activeUsers.set(documentId, new Map());
            }
            
            const user = await User.findById(userId).select(''name email'');
            activeUsers.get(documentId).set(socket.id, {
                userId,
                name: user.name,
                cursor: null
            });
            
            // Notify others
            socket.to(documentId).emit(''user:joined'', {
                userId,
                name: user.name
            });
            
            // Send current document state
            socket.emit(''document:state'', {
                content: document.content,
                version: document.version
            });
            
            // Send active users
            const users = Array.from(activeUsers.get(documentId).values());
            io.to(documentId).emit(''users:list'', users);
            
        } catch (error) {
            socket.emit(''error'', { message: error.message });
        }
    });
    
    // Handle text changes
    socket.on(''document:change'', async (data) => {
        const { documentId, change, userId } = data;
        
        try {
            const document = await Document.findById(documentId);
            if (!document) return;
            
            // Apply change to content
            let newContent = document.content;
            if (change.type === ''insert'') {
                newContent = newContent.slice(0, change.position) +
                           change.text +
                           newContent.slice(change.position);
            } else if (change.type === ''delete'') {
                newContent = newContent.slice(0, change.position) +
                           newContent.slice(change.position + change.length);
            }
            
            // Save change
            document.content = newContent;
            document.changes.push({
                ...change,
                userId
            });
            document.version += 1;
            await document.save();
            
            // Broadcast to other users in room
            socket.to(documentId).emit(''document:change'', {
                change,
                userId,
                version: document.version
            });
            
        } catch (error) {
            socket.emit(''error'', { message: error.message });
        }
    });
    
    // Handle cursor position
    socket.on(''cursor:update'', (data) => {
        const { documentId, position, userId } = data;
        
        if (activeUsers.has(documentId)) {
            const user = activeUsers.get(documentId).get(socket.id);
            if (user) {
                user.cursor = position;
                socket.to(documentId).emit(''cursor:update'', {
                    userId,
                    position,
                    name: user.name
                });
            }
        }
    });
    
    // Handle user leaving
    socket.on(''document:leave'', (data) => {
        const { documentId, userId } = data;
        
        if (activeUsers.has(documentId)) {
            activeUsers.get(documentId).delete(socket.id);
            
            if (activeUsers.get(documentId).size === 0) {
                activeUsers.delete(documentId);
            } else {
                socket.to(documentId).emit(''user:left'', { userId });
                const users = Array.from(activeUsers.get(documentId).values());
                io.to(documentId).emit(''users:list'', users);
            }
        }
    });
    
    // Cleanup on disconnect
    socket.on(''disconnect'', () => {
        activeUsers.forEach((users, documentId) => {
            if (users.has(socket.id)) {
                const user = users.get(socket.id);
                users.delete(socket.id);
                
                if (users.size === 0) {
                    activeUsers.delete(documentId);
                } else {
                    io.to(documentId).emit(''user:left'', { userId: user.userId });
                    const userList = Array.from(users.values());
                    io.to(documentId).emit(''users:list'', userList);
                }
            }
        });
    });
}

module.exports = setupDocumentHandlers;
```

### Phase 4: Socket Server Setup

```javascript
// backend/src/socket/socketHandlers.js
const jwt = require(''jsonwebtoken'');
const User = require(''../models/User'');
const setupDocumentHandlers = require(''./documentHandlers'');

function setupSocketIO(io) {
    // Authentication middleware for Socket.io
    io.use(async (socket, next) => {
        try {
            const token = socket.handshake.auth.token;
            
            if (!token) {
                return next(new Error(''Authentication error''));
            }
            
            const decoded = jwt.verify(token, process.env.JWT_SECRET);
            const user = await User.findById(decoded.userId).select(''-password'');
            
            if (!user) {
                return next(new Error(''User not found''));
            }
            
            socket.userId = user._id.toString();
            socket.user = user;
            next();
        } catch (error) {
            next(new Error(''Authentication error''));
        }
    });
    
    io.on(''connection'', (socket) => {
        console.log(''User connected:'', socket.userId);
        
        // Setup document handlers
        setupDocumentHandlers(io, socket);
        
        socket.on(''disconnect'', () => {
            console.log(''User disconnected:'', socket.userId);
        });
    });
}

module.exports = setupSocketIO;
```

### Phase 5: Server with Socket.io

```javascript
// backend/src/server.js
const express = require(''express'');
const http = require(''http'');
const { Server } = require(''socket.io'');
const mongoose = require(''mongoose'');
const cors = require(''cors'');
const helmet = require(''helmet'');
require(''dotenv'').config();

const authRoutes = require(''./routes/authRoutes'');
const documentRoutes = require(''./routes/documentRoutes'');
const errorHandler = require(''./middleware/errorHandler'');
const setupSocketIO = require(''./socket/socketHandlers'');

const app = express();
const server = http.createServer(app);

// Configure Socket.io
const io = new Server(server, {
    cors: {
        origin: process.env.CLIENT_URL || ''http://localhost:3000'',
        methods: [''GET'', ''POST''],
        credentials: true
    }
});

// Setup Socket.io handlers
setupSocketIO(io);

// Middleware
app.use(helmet());
app.use(cors({
    origin: process.env.CLIENT_URL || ''http://localhost:3000'',
    credentials: true
}));
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// Routes
app.use(''/api/auth'', authRoutes);
app.use(''/api/documents'', documentRoutes);

// Health check
app.get(''/api/health'', (req, res) => {
    res.json({
        success: true,
        message: ''API is running'',
        timestamp: new Date().toISOString()
    });
});

// Error handler
app.use(errorHandler);

// Connect to database
mongoose.connect(process.env.MONGODB_URI)
    .then(() => {
        console.log(''Connected to MongoDB'');
        const PORT = process.env.PORT || 5000;
        server.listen(PORT, () => {
            console.log(`Server running on port ${PORT}`);
        });
    })
    .catch((error) => {
        console.error(''MongoDB connection error:'', error);
        process.exit(1);
    });
```

### Phase 6: Frontend Socket Context

```javascript
// frontend/src/context/SocketContext.jsx
import { createContext, useContext, useEffect, useState } from ''react'';
import { io } from ''socket.io-client'';
import { useAuth } from ''./AuthContext'';

const SocketContext = createContext();

export function SocketProvider({ children }) {
    const { user, isAuthenticated } = useAuth();
    const [socket, setSocket] = useState(null);
    const [connected, setConnected] = useState(false);
    
    useEffect(() => {
        if (isAuthenticated && user) {
            const token = localStorage.getItem(''token'');
            const newSocket = io(process.env.REACT_APP_SOCKET_URL || ''http://localhost:5000'', {
                auth: {
                    token
                },
                transports: [''websocket'']
            });
            
            newSocket.on(''connect'', () => {
                console.log(''Socket connected'');
                setConnected(true);
            });
            
            newSocket.on(''disconnect'', () => {
                console.log(''Socket disconnected'');
                setConnected(false);
            });
            
            newSocket.on(''error'', (error) => {
                console.error(''Socket error:'', error);
            });
            
            setSocket(newSocket);
            
            return () => {
                newSocket.close();
            };
        }
    }, [isAuthenticated, user]);
    
    return (
        <SocketContext.Provider value={{ socket, connected }}>
            {children}
        </SocketContext.Provider>
    );
}

export function useSocket() {
    const context = useContext(SocketContext);
    if (!context) {
        throw new Error(''useSocket must be used within SocketProvider'');
    }
    return context;
}
```

### Phase 7: Document Editor Component

```javascript
// frontend/src/components/Editor/DocumentEditor.jsx
import { useState, useEffect, useRef } from ''react'';
import { useSocket } from ''../../context/SocketContext'';
import { useAuth } from ''../../context/AuthContext'';
import ''./DocumentEditor.css'';

function DocumentEditor({ documentId, initialContent }) {
    const { socket } = useSocket();
    const { user } = useAuth();
    const [content, setContent] = useState(initialContent || '''');
    const [version, setVersion] = useState(1);
    const [activeUsers, setActiveUsers] = useState([]);
    const [cursors, setCursors] = useState(new Map());
    const editorRef = useRef(null);
    const lastChangeRef = useRef(null);
    
    useEffect(() => {
        if (!socket || !documentId) return;
        
        // Join document
        socket.emit(''document:join'', {
            documentId,
            userId: user.id
        });
        
        // Listen for document state
        socket.on(''document:state'', (data) => {
            setContent(data.content);
            setVersion(data.version);
        });
        
        // Listen for changes from others
        socket.on(''document:change'', (data) => {
            if (data.userId !== user.id) {
                applyChange(data.change);
                setVersion(data.version);
            }
        });
        
        // Listen for active users
        socket.on(''users:list'', (users) => {
            setActiveUsers(users);
        });
        
        // Listen for cursor updates
        socket.on(''cursor:update'', (data) => {
            if (data.userId !== user.id) {
                setCursors(prev => {
                    const newCursors = new Map(prev);
                    newCursors.set(data.userId, {
                        position: data.position,
                        name: data.name
                    });
                    return newCursors;
                });
            }
        });
        
        // Listen for user joined/left
        socket.on(''user:joined'', (data) => {
            console.log(`${data.name} joined`);
        });
        
        socket.on(''user:left'', (data) => {
            setCursors(prev => {
                const newCursors = new Map(prev);
                newCursors.delete(data.userId);
                return newCursors;
            });
        });
        
        return () => {
            socket.emit(''document:leave'', { documentId, userId: user.id });
            socket.off(''document:state'');
            socket.off(''document:change'');
            socket.off(''users:list'');
            socket.off(''cursor:update'');
            socket.off(''user:joined'');
            socket.off(''user:left'');
        };
    }, [socket, documentId, user]);
    
    const applyChange = (change) => {
        setContent(prev => {
            if (change.type === ''insert'') {
                return prev.slice(0, change.position) +
                       change.text +
                       prev.slice(change.position);
            } else if (change.type === ''delete'') {
                return prev.slice(0, change.position) +
                       prev.slice(change.position + change.length);
            }
            return prev;
        });
    };
    
    const handleChange = (e) => {
        const newContent = e.target.value;
        const oldContent = content;
        const position = e.target.selectionStart;
        
        // Calculate change
        let change;
        if (newContent.length > oldContent.length) {
            // Insert
            const insertedText = newContent.slice(position - (newContent.length - oldContent.length), position);
            change = {
                type: ''insert'',
                position: position - insertedText.length,
                text: insertedText
            };
        } else {
            // Delete
            change = {
                type: ''delete'',
                position,
                length: oldContent.length - newContent.length
            };
        }
        
        // Update local state
        setContent(newContent);
        
        // Debounce and send change
        if (lastChangeRef.current) {
            clearTimeout(lastChangeRef.current);
        }
        
        lastChangeRef.current = setTimeout(() => {
            if (socket && documentId) {
                socket.emit(''document:change'', {
                    documentId,
                    change,
                    userId: user.id
                });
            }
        }, 100);
        
        // Update cursor position
        if (socket && documentId) {
            socket.emit(''cursor:update'', {
                documentId,
                position: e.target.selectionStart,
                userId: user.id
            });
        }
    };
    
    const handleSelectionChange = (e) => {
        if (socket && documentId) {
            socket.emit(''cursor:update'', {
                documentId,
                position: e.target.selectionStart,
                userId: user.id
            });
        }
    };
    
    return (
        <div className="document-editor">
            <div className="editor-header">
                <div className="active-users">
                    {activeUsers.map(u => (
                        <span key={u.userId} className="user-badge">
                            {u.name}
                        </span>
                    ))}
                </div>
                <div className="editor-version">
                    Version: {version}
                </div>
            </div>
            
            <textarea
                ref={editorRef}
                value={content}
                onChange={handleChange}
                onSelect={handleSelectionChange}
                className="editor-textarea"
                placeholder="Start typing..."
            />
            
            <div className="cursors-overlay">
                {Array.from(cursors.entries()).map(([userId, cursor]) => (
                    <div
                        key={userId}
                        className="cursor-indicator"
                        style={{ left: `${cursor.position * 8}px` }}
                    >
                        <span className="cursor-name">{cursor.name}</span>
                        <div className="cursor-line"></div>
                    </div>
                ))}
            </div>
        </div>
    );
}

export default DocumentEditor;
```

### Phase 8: Document Page

```javascript
// frontend/src/pages/DocumentPage.jsx
import { useState, useEffect } from ''react'';
import { useParams, useNavigate } from ''react-router-dom'';
import { documentsAPI } from ''../services/api'';
import { useAuth } from ''../context/AuthContext'';
import DocumentEditor from ''../components/Editor/DocumentEditor'';
import Loading from ''../components/Common/Loading'';
import Error from ''../components/Common/Error'';
import ''./DocumentPage.css'';

function DocumentPage() {
    const { id } = useParams();
    const navigate = useNavigate();
    const { user } = useAuth();
    const [document, setDocument] = useState(null);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);
    
    useEffect(() => {
        loadDocument();
    }, [id]);
    
    const loadDocument = async () => {
        try {
            setLoading(true);
            const response = await documentsAPI.getDocument(id);
            setDocument(response.data.data);
        } catch (err) {
            setError(err.response?.data?.error || ''Failed to load document'');
        } finally {
            setLoading(false);
        }
    };
    
    if (loading) {
        return <Loading />;
    }
    
    if (error) {
        return <Error message={error} />;
    }
    
    if (!document) {
        return <Error message="Document not found" />;
    }
    
    return (
        <div className="document-page">
            <div className="document-header">
                <button onClick={() => navigate(-1)} className="btn btn-back">
                    ← Back
                </button>
                <h1>{document.title}</h1>
                <div className="document-actions">
                    <button className="btn btn-secondary">Share</button>
                    <button className="btn btn-secondary">Export</button>
                </div>
            </div>
            
            <DocumentEditor
                documentId={id}
                initialContent={document.content}
            />
        </div>
    );
}

export default DocumentPage;
```

### Phase 9: App Component

```javascript
// frontend/src/App.jsx
import { BrowserRouter, Routes, Route } from ''react-router-dom'';
import { AuthProvider } from ''./context/AuthContext'';
import { SocketProvider } from ''./context/SocketContext'';
import Layout from ''./components/Layout/Layout'';
import Home from ''./pages/Home'';
import Login from ''./pages/Login'';
import Register from ''./pages/Register'';
import Dashboard from ''./pages/Dashboard'';
import DocumentPage from ''./pages/DocumentPage'';
import ProtectedRoute from ''./components/ProtectedRoute'';
import ''./App.css'';

function App() {
    return (
        <AuthProvider>
            <SocketProvider>
                <BrowserRouter>
                    <Layout>
                        <Routes>
                            <Route path="/" element={<Home />} />
                            <Route path="/login" element={<Login />} />
                            <Route path="/register" element={<Register />} />
                            <Route
                                path="/dashboard"
                                element={
                                    <ProtectedRoute>
                                        <Dashboard />
                                    </ProtectedRoute>
                                }
                            />
                            <Route
                                path="/document/:id"
                                element={
                                    <ProtectedRoute>
                                        <DocumentPage />
                                    </ProtectedRoute>
                                }
                            />
                        </Routes>
                    </Layout>
                </BrowserRouter>
            </SocketProvider>
        </AuthProvider>
    );
}

export default App;
```

---

## Features Implementation

### WebSocket Integration

- **Socket.io Server**: Real-time server setup
- **Socket.io Client**: Frontend connection
- **Authentication**: JWT-based socket auth
- **Room Management**: Document rooms

### Real-Time Features

- **Live Editing**: Collaborative text editing
- **Cursor Tracking**: See other users'' cursors
- **User Presence**: Show active users
- **Change Broadcasting**: Instant updates
- **Version Control**: Track document versions

### Backend API

- **REST Endpoints**: Document CRUD
- **WebSocket Events**: Real-time events
- **Database**: MongoDB integration
- **Authentication**: Secure access

### Database

- **Document Storage**: Store documents
- **Change History**: Track all changes
- **User Management**: User data
- **Relationships**: User-document relationships

---

## Testing Your Application

### Manual Testing Checklist

- [ ] Connect multiple users
- [ ] Real-time text editing
- [ ] See other users'' cursors
- [ ] User join/leave notifications
- [ ] Document persistence
- [ ] Change history
- [ ] Error handling
- [ ] Reconnection handling
- [ ] Performance with many users
- [ ] Mobile responsiveness

---

## Deployment

### Backend Deployment

```bash
# Heroku example
heroku create your-app-backend
heroku config:set MONGODB_URI=your-uri
heroku config:set JWT_SECRET=your-secret
heroku config:set CLIENT_URL=https://your-frontend.com
git push heroku main
```

### Frontend Deployment

```bash
# Vercel example
npm run build
vercel
vercel env add REACT_APP_SOCKET_URL
vercel env add REACT_APP_API_URL
```

### Environment Variables

**Backend (.env)**:
```
NODE_ENV=production
PORT=5000
MONGODB_URI=your-mongodb-uri
JWT_SECRET=your-secret-key
CLIENT_URL=https://your-frontend.com
```

**Frontend (.env)**:
```
REACT_APP_API_URL=https://your-backend.com/api
REACT_APP_SOCKET_URL=https://your-backend.com
```

---

## Exercise: Real-Time Application

**Instructions**:

1. Choose your project idea
2. Set up backend with Socket.io
3. Set up frontend
4. Implement real-time features
5. Test with multiple users
6. Deploy to production

**Timeline**: 3-4 weeks recommended

---

## Common Issues and Solutions

### Issue: Socket connection fails

**Solution**: Check CORS configuration and authentication token.

### Issue: Changes not syncing

**Solution**: Verify event names match and changes are being saved.

### Issue: Performance issues

**Solution**: Implement debouncing, optimize change broadcasting.

---

## Quiz: WebSockets

1. **WebSockets:**
   - A) Real-time bidirectional communication
   - B) One-way communication
   - C) Both
   - D) Neither

2. **Socket.io:**
   - A) WebSocket library
   - B) HTTP library
   - C) Both
   - D) Neither

3. **Real-time features:**
   - A) Instant updates
   - B) Delayed updates
   - C) Both
   - D) Neither

4. **Rooms:**
   - A) Group connections
   - B) Don''t group connections
   - C) Both
   - D) Neither

5. **Database:**
   - A) Persists real-time data
   - B) Doesn''t persist data
   - C) Both
   - D) Neither

**Answers**:
1. A) Real-time bidirectional communication
2. A) WebSocket library
3. A) Instant updates
4. A) Group connections
5. A) Persists real-time data

---

## Key Takeaways

1. **WebSockets**: Enable real-time communication
2. **Socket.io**: Simplifies WebSocket implementation
3. **Real-Time Features**: Instant updates and collaboration
4. **Backend API**: REST + WebSocket combination
5. **Database**: Persist real-time data
6. **Best Practice**: Handle connections, errors, and performance

---

## Next Steps

Congratulations! You''ve built a Real-Time Application. You now know:
- How to implement WebSockets
- How to build real-time features
- How to integrate backend APIs
- How to work with databases
- How to deploy real-time apps

**What''s Next?**
- Assessment and Certification
- Complete all projects
- Pass assessments
- Get certified

---

*Capstone Project completed! You''ve demonstrated mastery of real-time application development!*

', NULL, 3, '2026-01-03 10:43:39', '2026-01-03 10:43:39', 'published', 'markdown', NULL, NULL, 'By the end of this project, you will be able to:
- Implement WebSocket connections
- Build real-time features
- Design and develop backend APIs
- Integrate databases with real-time updates
- Handle concurrent connections
- Optimize real-time performance
- Deploy real-time applications
- Handle edge cases and errors');

SET FOREIGN_KEY_CHECKS=1;
